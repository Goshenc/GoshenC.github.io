<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>å…¨å±€è·å–contextçš„æŠ€å·§</title>
      <link href="/2025/04/06/%E5%85%A8%E5%B1%80%E8%8E%B7%E5%8F%96context%E7%9A%84%E6%8A%80%E5%B7%A7/"/>
      <url>/2025/04/06/%E5%85%A8%E5%B1%80%E8%8E%B7%E5%8F%96context%E7%9A%84%E6%8A%80%E5%B7%A7/</url>
      
        <content type="html"><![CDATA[<h1 id="å…¨å±€è·å–-Context-çš„æŠ€å·§ï¼ˆAndroidï¼‰"><a href="#å…¨å±€è·å–-Context-çš„æŠ€å·§ï¼ˆAndroidï¼‰" class="headerlink" title="å…¨å±€è·å– Context çš„æŠ€å·§ï¼ˆAndroidï¼‰"></a>å…¨å±€è·å– Context çš„æŠ€å·§ï¼ˆAndroidï¼‰</h1><p>åœ¨ Android å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦è·å– <code>Context</code>ï¼Œä¾‹å¦‚å¯åŠ¨ Activityã€åˆ›å»º Viewã€è®¿é—®èµ„æºã€ä½¿ç”¨ç³»ç»ŸæœåŠ¡ç­‰ã€‚ä½†ä¸æ°å½“åœ°è·å–æˆ–ä¿ç•™ <code>Context</code> ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ç­‰é—®é¢˜ã€‚</p><p>æœ¬ç¯‡æ–‡ç« ä»‹ç»å‡ ç§<strong>å®‰å…¨ã€è§„èŒƒåœ°å…¨å±€è·å– Context çš„æŠ€å·§</strong>ï¼Œå¹¶è¯´æ˜å“ªäº›æ–¹å¼åº”å½“é¿å…ã€‚</p><hr><h2 id="ä¸ºä»€ä¹ˆéœ€è¦å…¨å±€-Contextï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆéœ€è¦å…¨å±€-Contextï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦å…¨å±€ Contextï¼Ÿ"></a>ä¸ºä»€ä¹ˆéœ€è¦å…¨å±€ Contextï¼Ÿ</h2><p>ä¸€äº›å…¸å‹çš„ä½¿ç”¨åœºæ™¯ï¼š</p><ul><li>åˆå§‹åŒ–ç¬¬ä¸‰æ–¹ SDK</li><li>å¼¹ Toast æ¶ˆæ¯</li><li>è·å–ç³»ç»ŸæœåŠ¡ï¼ˆå¦‚ <code>ClipboardManager</code>ï¼‰</li><li>è®¿é—®èµ„æºæ–‡ä»¶ï¼ˆ<code>getString()</code>ã€<code>getDrawable()</code> ç­‰ï¼‰</li></ul><hr><h2 id="æ­£ç¡®æ–¹å¼ï¼šä½¿ç”¨-Application-Context"><a href="#æ­£ç¡®æ–¹å¼ï¼šä½¿ç”¨-Application-Context" class="headerlink" title="æ­£ç¡®æ–¹å¼ï¼šä½¿ç”¨ Application Context"></a>æ­£ç¡®æ–¹å¼ï¼šä½¿ç”¨ Application Context</h2><h3 id="æ–¹æ³•-1ï¼šè‡ªå®šä¹‰-Application-ç±»"><a href="#æ–¹æ³•-1ï¼šè‡ªå®šä¹‰-Application-ç±»" class="headerlink" title="æ–¹æ³• 1ï¼šè‡ªå®šä¹‰ Application ç±»"></a>æ–¹æ³• 1ï¼šè‡ªå®šä¹‰ Application ç±»</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">class MyApp : Application() &#123;</span><br><span class="line"></span><br><span class="line">    override fun onCreate() &#123;</span><br><span class="line">        super.onCreate()</span><br><span class="line">        appContext = applicationContext</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    companion object &#123;</span><br><span class="line">        lateinit var appContext: Context</span><br><span class="line">            private set</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>åœ¨ <code>AndroidManifest.xml</code> ä¸­æ³¨å†Œï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;application</span><br><span class="line">    android:name=&quot;.MyApp&quot;</span><br><span class="line">    ...&gt;</span><br><span class="line">&lt;/application&gt;</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨æ–¹å¼ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val ctx = MyApp.appContext</span><br></pre></td></tr></table></figure><p>âœ… <strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>ç”Ÿå‘½å‘¨æœŸå’Œ App ä¸€è‡´ï¼Œä¸ä¼šæ³„æ¼</li><li>é€‚ç”¨äº Toastã€èµ„æºè®¿é—®ã€åˆå§‹åŒ–ç­‰åœºæ™¯</li></ul><p>âŒ <strong>æ³¨æ„ï¼š</strong></p><ul><li>ä¸å¯ç”¨äº UI åˆ›å»ºï¼ˆå¦‚ <code>Dialog(this)</code>ï¼‰ï¼Œéœ€è¦ä¼ å…¥ Activity Context</li></ul><hr><h2 id="æ–¹æ³•-2ï¼šä½¿ç”¨-Singleton-Application-Context"><a href="#æ–¹æ³•-2ï¼šä½¿ç”¨-Singleton-Application-Context" class="headerlink" title="æ–¹æ³• 2ï¼šä½¿ç”¨ Singleton + Application Context"></a>æ–¹æ³• 2ï¼šä½¿ç”¨ Singleton + Application Context</h2><p>é€‚ç”¨äºå·¥å…·ç±»æˆ–ç®¡ç†ç±»ä¸­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">object ToastUtil &#123;</span><br><span class="line"></span><br><span class="line">    fun show(msg: String) &#123;</span><br><span class="line">        Toast.makeText(MyApp.appContext, msg, Toast.LENGTH_SHORT).show()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="é”™è¯¯ç¤ºèŒƒï¼ˆâš ï¸é¿å…ï¼‰ï¼š"><a href="#é”™è¯¯ç¤ºèŒƒï¼ˆâš ï¸é¿å…ï¼‰ï¼š" class="headerlink" title="é”™è¯¯ç¤ºèŒƒï¼ˆâš ï¸é¿å…ï¼‰ï¼š"></a>é”™è¯¯ç¤ºèŒƒï¼ˆâš ï¸é¿å…ï¼‰ï¼š</h2><h3 id="âŒ-é™æ€ä¿å­˜-Activity-Context"><a href="#âŒ-é™æ€ä¿å­˜-Activity-Context" class="headerlink" title="âŒ é™æ€ä¿å­˜ Activity Context"></a>âŒ é™æ€ä¿å­˜ Activity Context</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">object MyManager &#123;</span><br><span class="line">    var context: Context? = null</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¿™ä¼šå¯¼è‡´ Activity æ— æ³•è¢«å›æ”¶ï¼Œä¸¥é‡æ—¶å¼•å‘å†…å­˜æ³„æ¼ã€‚</p></blockquote><h3 id="âŒ-ä½¿ç”¨-View-getContext-åšé-UI-æ“ä½œ"><a href="#âŒ-ä½¿ç”¨-View-getContext-åšé-UI-æ“ä½œ" class="headerlink" title="âŒ ä½¿ç”¨ View.getContext() åšé UI æ“ä½œ"></a>âŒ ä½¿ç”¨ <code>View.getContext()</code> åšé UI æ“ä½œ</h3><p>View çš„ <code>Context</code> å®é™…ä¸Šæ˜¯ Activityï¼Œä¸€æ—¦é¡µé¢é”€æ¯ä»ä¿ç•™å¼•ç”¨ï¼Œä¹Ÿå¯èƒ½æ³„æ¼ã€‚</p><hr><h2 id="Jetpack-æ¨èæ–¹å¼ï¼ˆè¿›é˜¶ï¼‰"><a href="#Jetpack-æ¨èæ–¹å¼ï¼ˆè¿›é˜¶ï¼‰" class="headerlink" title="Jetpack æ¨èæ–¹å¼ï¼ˆè¿›é˜¶ï¼‰"></a>Jetpack æ¨èæ–¹å¼ï¼ˆè¿›é˜¶ï¼‰</h2><p>åœ¨ä½¿ç”¨ <strong>ViewModelã€Hiltã€Jetpack Compose</strong> æ—¶ï¼Œå»ºè®®ä½¿ç”¨ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰æˆ– <code>SavedStateHandle</code> ç­‰æ–¹å¼è·å– <code>Context</code>ï¼Œæ›´åŠ çµæ´»å’Œå¯æµ‹è¯•ã€‚</p><p>ä¾‹å¦‚ä½¿ç”¨ Hiltï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@HiltViewModel</span><br><span class="line">class MyViewModel @Inject constructor(</span><br><span class="line">    @ApplicationContext val context: Context</span><br><span class="line">) : ViewModel()</span><br></pre></td></tr></table></figure><hr><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><table><thead><tr><th>è·å–æ–¹å¼</th><th>æ˜¯å¦æ¨è</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>applicationContext</code></td><td>âœ… æ¨è</td><td>ç”Ÿå‘½å‘¨æœŸé•¿ï¼Œä¸æ˜“æ³„æ¼</td></tr><tr><td>è‡ªå®šä¹‰ <code>Application</code> ä¿å­˜ context</td><td>âœ… æ¨è</td><td>å…¨å±€å·¥å…·ç±»ä¸­ä½¿ç”¨</td></tr><tr><td>Activity &#x2F; View context é™æ€æŒæœ‰</td><td>âŒ é¿å…</td><td>æ˜“æ³„æ¼å†…å­˜</td></tr><tr><td>ä¾èµ–æ³¨å…¥æ¡†æ¶æ³¨å…¥ context</td><td>âœ… æ¨è</td><td>å¯æµ‹è¯•æ€§å¥½ï¼Œæ¶æ„ç°ä»£</td></tr></tbody></table><hr><h2 id="æœ€ä½³å®è·µ"><a href="#æœ€ä½³å®è·µ" class="headerlink" title="æœ€ä½³å®è·µ"></a>æœ€ä½³å®è·µ</h2><ul><li>é¿å…ä¼ é€’ Context ç»™å•ä¾‹æˆ–é™æ€ç±»</li><li>åªåœ¨éœ€è¦ UI çš„åœ°æ–¹ä½¿ç”¨ Activity Context</li><li>å·¥å…·ç±»ä¸­å°½å¯èƒ½ä½¿ç”¨ Application Context</li><li>å¼•å…¥ Hilt &#x2F; Koin ç­‰ä¾èµ–æ³¨å…¥æ¡†æ¶ç®¡ç†ä¾èµ–</li></ul><hr><p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©ä½ åœ¨é¡¹ç›®ä¸­æ›´å¥½åœ°ç®¡ç† Contextï¼Œé¿å…å¸¸è§é™·é˜±ã€‚å¦‚æœä½ æœ‰å…¶ä»–æŠ€å·§æˆ–é—®é¢˜ï¼Œæ¬¢è¿ç•™è¨€äº¤æµï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“å¼€å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kotlin DSL</title>
      <link href="/2025/04/05/Kotlin-DSL/"/>
      <url>/2025/04/05/Kotlin-DSL/</url>
      
        <content type="html"><![CDATA[<h2 id="ğŸ’¬-ä»€ä¹ˆæ˜¯-Kotlin-DSLï¼Ÿ"><a href="#ğŸ’¬-ä»€ä¹ˆæ˜¯-Kotlin-DSLï¼Ÿ" class="headerlink" title="ğŸ’¬ ä»€ä¹ˆæ˜¯ Kotlin DSLï¼Ÿ"></a>ğŸ’¬ ä»€ä¹ˆæ˜¯ Kotlin DSLï¼Ÿ</h2><p>DSL å°±åƒä½ ç”¨ Kotlin å†™çš„â€œ<strong>å°è¯­è¨€</strong>â€æˆ–â€œ<strong>ä¸“å±è¯­æ³•</strong>â€ã€‚</p><p>æ¯”å¦‚ä½ å†™ä¸€ä¸ªé…ç½®æ–‡ä»¶æˆ–è€…æè¿°é¡µé¢å†…å®¹æ—¶ï¼Œå¸Œæœ›è¿™æ ·å†™ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">page &#123;</span><br><span class="line">    title = &quot;æ¬¢è¿æ¥åˆ°æˆ‘çš„ç½‘ç«™&quot;</span><br><span class="line">    header &#123;</span><br><span class="line">        text = &quot;Hello!&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    paragraph &#123;</span><br><span class="line">        text = &quot;è¿™é‡Œæ˜¯æ­£æ–‡å†…å®¹&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœ‹èµ·æ¥åƒâ€œè‡ªå·±å‘æ˜çš„è¯­è¨€â€ï¼Œå¯¹å§ï¼Ÿè¿™ä¸ªå°±æ˜¯ Kotlin DSL çš„ç›®æ ‡ï¼š<strong>å†™å‡ºæ¥è¿‘è‡ªç„¶è¯­è¨€çš„ä»£ç </strong>ï¼Œè®©ä»£ç æ›´â€œä¼šè¯´è¯â€ã€‚</p><hr><h2 id="ğŸ§±-æ€ä¹ˆåšï¼Ÿç”¨-Kotlin-çš„-3-ä¸ªå°æŠ€å·§å°±å¯ä»¥äº†ï¼š"><a href="#ğŸ§±-æ€ä¹ˆåšï¼Ÿç”¨-Kotlin-çš„-3-ä¸ªå°æŠ€å·§å°±å¯ä»¥äº†ï¼š" class="headerlink" title="ğŸ§± æ€ä¹ˆåšï¼Ÿç”¨ Kotlin çš„ 3 ä¸ªå°æŠ€å·§å°±å¯ä»¥äº†ï¼š"></a>ğŸ§± æ€ä¹ˆåšï¼Ÿç”¨ Kotlin çš„ 3 ä¸ªå°æŠ€å·§å°±å¯ä»¥äº†ï¼š</h2><h3 id="1ï¸âƒ£-é«˜é˜¶å‡½æ•°ï¼ˆå‡½æ•°é‡Œé¢ä¼ å‡½æ•°ï¼‰"><a href="#1ï¸âƒ£-é«˜é˜¶å‡½æ•°ï¼ˆå‡½æ•°é‡Œé¢ä¼ å‡½æ•°ï¼‰" class="headerlink" title="1ï¸âƒ£ é«˜é˜¶å‡½æ•°ï¼ˆå‡½æ•°é‡Œé¢ä¼ å‡½æ•°ï¼‰"></a>1ï¸âƒ£ é«˜é˜¶å‡½æ•°ï¼ˆå‡½æ•°é‡Œé¢ä¼ å‡½æ•°ï¼‰</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fun doSomething(block: () -&gt; Unit) &#123;</span><br><span class="line">    block()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½ å¯ä»¥è¿™æ ·ç”¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">doSomething &#123;</span><br><span class="line">    println(&quot;Hello&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="2ï¸âƒ£-Lambda-with-Receiverï¼ˆè¿™ä¸ªè¶…é‡è¦ï¼Œæ˜¯-DSL-çš„æ ¸å¿ƒï¼‰"><a href="#2ï¸âƒ£-Lambda-with-Receiverï¼ˆè¿™ä¸ªè¶…é‡è¦ï¼Œæ˜¯-DSL-çš„æ ¸å¿ƒï¼‰" class="headerlink" title="2ï¸âƒ£ Lambda with Receiverï¼ˆè¿™ä¸ªè¶…é‡è¦ï¼Œæ˜¯ DSL çš„æ ¸å¿ƒï¼‰"></a>2ï¸âƒ£ Lambda with Receiverï¼ˆè¿™ä¸ªè¶…é‡è¦ï¼Œæ˜¯ DSL çš„æ ¸å¿ƒï¼‰</h3><p>çœ‹ä¸ªä¾‹å­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">class Person &#123;</span><br><span class="line">    var name = &quot;&quot;</span><br><span class="line">    fun sayHello() &#123;</span><br><span class="line">        println(&quot;Hello, my name is $name&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun createPerson(block: Person.() -&gt; Unit): Person &#123;</span><br><span class="line">    val person = Person()</span><br><span class="line">    person.block() // æ³¨æ„æ˜¯ person.block()</span><br><span class="line">    return person</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·ç”¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">val p = createPerson &#123;</span><br><span class="line">    name = &quot;Tom&quot;</span><br><span class="line">    sayHello()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ˜¯ä¸æ˜¯å¾ˆåƒè‡ªå·±åœ¨å†™ä¸€é—¨â€œäººç±»å»ºé€ è¯­è¨€â€ï¼Ÿè¿™å°±æ˜¯ DSL çš„å‘³é“ï¼</p><hr><h3 id="3ï¸âƒ£-apply-æ˜¯å¸®ä½ çœä»£ç çš„ç¥å™¨"><a href="#3ï¸âƒ£-apply-æ˜¯å¸®ä½ çœä»£ç çš„ç¥å™¨" class="headerlink" title="3ï¸âƒ£ apply æ˜¯å¸®ä½ çœä»£ç çš„ç¥å™¨"></a>3ï¸âƒ£ <code>apply</code> æ˜¯å¸®ä½ çœä»£ç çš„ç¥å™¨</h3><p>ç­‰ä»·äºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">val person = Person()</span><br><span class="line">person.name = &quot;Tom&quot;</span><br><span class="line">person.sayHello()</span><br></pre></td></tr></table></figure><p>å†™æˆï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">val person = Person().apply &#123;</span><br><span class="line">    name = &quot;Tom&quot;</span><br><span class="line">    sayHello()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="ğŸ› -æˆ‘ä»¬åšä¸ªæœ€ç®€å•çš„-DSL-ç¤ºä¾‹ï¼šæ„å»ºèœå•"><a href="#ğŸ› -æˆ‘ä»¬åšä¸ªæœ€ç®€å•çš„-DSL-ç¤ºä¾‹ï¼šæ„å»ºèœå•" class="headerlink" title="ğŸ›  æˆ‘ä»¬åšä¸ªæœ€ç®€å•çš„ DSL ç¤ºä¾‹ï¼šæ„å»ºèœå•"></a>ğŸ›  æˆ‘ä»¬åšä¸ªæœ€ç®€å•çš„ DSL ç¤ºä¾‹ï¼šæ„å»ºèœå•</h2><p>æˆ‘ä»¬å¸Œæœ›èƒ½è¿™æ ·å†™ä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">menu &#123;</span><br><span class="line">    item(&quot;æ‰“å¼€&quot;)</span><br><span class="line">    item(&quot;ä¿å­˜&quot;)</span><br><span class="line">    item(&quot;é€€å‡º&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ğŸ‘‰-DSL-å®ç°ä»£ç ï¼š"><a href="#ğŸ‘‰-DSL-å®ç°ä»£ç ï¼š" class="headerlink" title="ğŸ‘‰ DSL å®ç°ä»£ç ï¼š"></a>ğŸ‘‰ DSL å®ç°ä»£ç ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">class Menu &#123;</span><br><span class="line">    private val items = mutableListOf&lt;String&gt;()</span><br><span class="line"></span><br><span class="line">    fun item(name: String) &#123;</span><br><span class="line">        items.add(name)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fun show() &#123;</span><br><span class="line">        println(&quot;èœå•å†…å®¹ï¼š&quot;)</span><br><span class="line">        items.forEach &#123;</span><br><span class="line">            println(&quot; - $it&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun menu(block: Menu.() -&gt; Unit): Menu &#123;</span><br><span class="line">    val m = Menu()</span><br><span class="line">    m.block()</span><br><span class="line">    return m</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="âœ…-ä½¿ç”¨ï¼š"><a href="#âœ…-ä½¿ç”¨ï¼š" class="headerlink" title="âœ… ä½¿ç”¨ï¼š"></a>âœ… ä½¿ç”¨ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">val myMenu = menu &#123;</span><br><span class="line">    item(&quot;æ‰“å¼€&quot;)</span><br><span class="line">    item(&quot;ä¿å­˜&quot;)</span><br><span class="line">    item(&quot;é€€å‡º&quot;)</span><br><span class="line">&#125;</span><br><span class="line">myMenu.show()</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">èœå•å†…å®¹ï¼š</span><br><span class="line"> - æ‰“å¼€</span><br><span class="line"> - ä¿å­˜</span><br><span class="line"> - é€€å‡º</span><br></pre></td></tr></table></figure><hr><h2 id="âœ…-å°ç»“ä¸€å¥è¯ï¼š"><a href="#âœ…-å°ç»“ä¸€å¥è¯ï¼š" class="headerlink" title="âœ… å°ç»“ä¸€å¥è¯ï¼š"></a>âœ… å°ç»“ä¸€å¥è¯ï¼š</h2><blockquote><p>Kotlin DSL &#x3D; è‡ªå·±å†™ä¸€ä¸ªå‡½æ•°ï¼ˆç”¨ lambda with receiverï¼‰ + å®šä¹‰ç±»ç»“æ„ + <code>apply()</code>ï¼Œå°±èƒ½é€ å‡ºä¸€å¥—çœ‹èµ·æ¥åƒâ€œè‡ªå·±å†™çš„è¯­è¨€â€çš„ä»£ç ã€‚</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> Kotlin </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LiveDataç”¨æ³•è¯¦è§£</title>
      <link href="/2025/04/04/LiveData%E7%94%A8%E6%B3%95%E8%AF%A6%E8%A7%A3/"/>
      <url>/2025/04/04/LiveData%E7%94%A8%E6%B3%95%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h2><p><strong>LiveData</strong> æ˜¯ Android Jetpack ä¸­çš„ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥å‹æ•°æ®å®¹å™¨ã€‚å®ƒçš„ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼š</p><ul><li><strong>ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥</strong>ï¼šLiveData ä¼šæ ¹æ®è§‚å¯Ÿè€…ï¼ˆå¦‚ Activityã€Fragmentï¼‰çš„ç”Ÿå‘½å‘¨æœŸçŠ¶æ€è‡ªåŠ¨ç®¡ç†æ•°æ®æ›´æ–°ï¼Œé¿å…å†…å­˜æ³„æ¼å’Œå´©æºƒé—®é¢˜ã€‚</li><li><strong>æ•°æ®é©±åŠ¨ UI æ›´æ–°</strong>ï¼šå½“ LiveData æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ‰€æœ‰å¤„äºæ´»è·ƒçŠ¶æ€çš„è§‚å¯Ÿè€…éƒ½ä¼šè¢«è‡ªåŠ¨é€šçŸ¥æ›´æ–° UIï¼Œæ— éœ€æ‰‹åŠ¨ç®¡ç†ã€‚</li><li><strong>è§£è€¦ UI ä¸æ•°æ®</strong>ï¼šåœ¨ MVVM æ¶æ„ä¸­ï¼ŒViewModel å°†æ•°æ®æ”¾å…¥ LiveData ä¸­ï¼ŒUI å±‚åªè´Ÿè´£è§‚å¯Ÿæ•°æ®å˜åŒ–ï¼Œä»è€Œå®ç°æ•°æ®å’Œ UI çš„åˆ†ç¦»ï¼Œé™ä½è€¦åˆåº¦ã€‚</li></ul><hr><h2 id="äºŒã€ä¸ºä»€ä¹ˆé€‰æ‹©-LiveDataï¼Ÿ"><a href="#äºŒã€ä¸ºä»€ä¹ˆé€‰æ‹©-LiveDataï¼Ÿ" class="headerlink" title="äºŒã€ä¸ºä»€ä¹ˆé€‰æ‹© LiveDataï¼Ÿ"></a>äºŒã€ä¸ºä»€ä¹ˆé€‰æ‹© LiveDataï¼Ÿ</h2><h3 id="1-ç”Ÿå‘½å‘¨æœŸå®‰å…¨"><a href="#1-ç”Ÿå‘½å‘¨æœŸå®‰å…¨" class="headerlink" title="1. ç”Ÿå‘½å‘¨æœŸå®‰å…¨"></a>1. ç”Ÿå‘½å‘¨æœŸå®‰å…¨</h3><p>LiveData äº†è§£è§‚å¯Ÿè€…çš„ç”Ÿå‘½å‘¨æœŸçŠ¶æ€ï¼ˆå¦‚åˆ›å»ºã€å¯åŠ¨ã€æš‚åœã€é”€æ¯ï¼‰ï¼Œä»…å½“è§‚å¯Ÿè€…å¤„äºæ´»è·ƒçŠ¶æ€æ—¶æ‰å‘é€æ›´æ–°ï¼Œè¿™æ ·å¯ä»¥é¿å…ï¼š</p><ul><li>å†…å­˜æ³„æ¼ï¼šå½“ Activity æˆ– Fragment é”€æ¯åï¼ŒLiveData ä¸å†æŒæœ‰æ— ç”¨çš„å¼•ç”¨ã€‚</li><li>æ›´æ–°å´©æºƒï¼šä¾‹å¦‚ï¼Œå½“ UI å·²ç»é”€æ¯æ—¶ï¼Œä¸å†å°è¯•æ›´æ–°è§†å›¾ã€‚</li></ul><h3 id="2-è‡ªåŠ¨æ•°æ®æ›´æ–°"><a href="#2-è‡ªåŠ¨æ•°æ®æ›´æ–°" class="headerlink" title="2. è‡ªåŠ¨æ•°æ®æ›´æ–°"></a>2. è‡ªåŠ¨æ•°æ®æ›´æ–°</h3><p>æ— éœ€æ‰‹åŠ¨è°ƒç”¨åˆ·æ–°æ–¹æ³•ã€‚åªè¦æ•°æ®å˜åŒ–ï¼Œæ‰€æœ‰ç»‘å®šäº† LiveData çš„ UI éƒ½ä¼šè‡ªåŠ¨æ›´æ–°ï¼Œè¿™å¤§å¤§ç®€åŒ–äº†ä»£ç é€»è¾‘ã€‚</p><h3 id="3-ä¸-MVVM-æ¶æ„çš„å®Œç¾ç»“åˆ"><a href="#3-ä¸-MVVM-æ¶æ„çš„å®Œç¾ç»“åˆ" class="headerlink" title="3. ä¸ MVVM æ¶æ„çš„å®Œç¾ç»“åˆ"></a>3. ä¸ MVVM æ¶æ„çš„å®Œç¾ç»“åˆ</h3><p>åœ¨ MVVM æ¶æ„ä¸­ï¼ŒViewModel å­˜å‚¨ UI æ•°æ®ï¼ŒLiveData åˆ™è´Ÿè´£å°†æ•°æ®ä¼ é€’ç»™ UI å±‚ï¼Œè¿™ç§æ¨¡å¼ä½¿å¾—æ•°æ®å’Œç•Œé¢é€»è¾‘å½»åº•åˆ†ç¦»ï¼Œä¾¿äºç»´æŠ¤å’Œæµ‹è¯•ã€‚</p><hr><h2 id="ä¸‰ã€LiveData-çš„åŸºæœ¬ä½¿ç”¨"><a href="#ä¸‰ã€LiveData-çš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="ä¸‰ã€LiveData çš„åŸºæœ¬ä½¿ç”¨"></a>ä¸‰ã€LiveData çš„åŸºæœ¬ä½¿ç”¨</h2><h3 id="1-åˆ›å»º-LiveData-å¯¹è±¡"><a href="#1-åˆ›å»º-LiveData-å¯¹è±¡" class="headerlink" title="1. åˆ›å»º LiveData å¯¹è±¡"></a>1. åˆ›å»º LiveData å¯¹è±¡</h3><p>é€šå¸¸ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ <code>MutableLiveData</code> æ¥åˆ›å»ºä¸€ä¸ªå¯ä»¥ä¿®æ”¹çš„æ•°æ®å®¹å™¨ï¼Œç„¶ååœ¨ ViewModel ä¸­å…¬å¼€ä¸ºåªè¯»çš„ <code>LiveData</code> ç»™ UI å±‚ä½¿ç”¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">class MyViewModel : ViewModel() &#123;</span><br><span class="line">    // å†…éƒ¨å¯å˜çš„ LiveData</span><br><span class="line">    private val _message = MutableLiveData&lt;String&gt;()</span><br><span class="line">    </span><br><span class="line">    // å¯¹å¤–åªè¯»çš„ LiveData</span><br><span class="line">    val message: LiveData&lt;String&gt; = _message</span><br><span class="line"></span><br><span class="line">    fun updateMessage(newMessage: String) &#123;</span><br><span class="line">        // setValue() åœ¨ä¸»çº¿ç¨‹æ›´æ–°æ•°æ®ï¼ŒpostValue() åˆ™é€‚ç”¨äºå­çº¿ç¨‹æ›´æ–°æ•°æ®</span><br><span class="line">        _message.value = newMessage</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-è§‚å¯Ÿ-LiveData-æ•°æ®å˜åŒ–"><a href="#2-è§‚å¯Ÿ-LiveData-æ•°æ®å˜åŒ–" class="headerlink" title="2. è§‚å¯Ÿ LiveData æ•°æ®å˜åŒ–"></a>2. è§‚å¯Ÿ LiveData æ•°æ®å˜åŒ–</h3><p>åœ¨ Activity æˆ– Fragment ä¸­è§‚å¯Ÿ LiveDataï¼Œå½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè§‚å¯Ÿè€…ä¼šæ”¶åˆ°é€šçŸ¥ï¼Œä»è€Œæ›´æ–° UIï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">class MyActivity : AppCompatActivity() &#123;</span><br><span class="line"></span><br><span class="line">    private lateinit var viewModel: MyViewModel</span><br><span class="line"></span><br><span class="line">    override fun onCreate(savedInstanceState: Bundle?) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line">        </span><br><span class="line">        viewModel = ViewModelProvider(this).get(MyViewModel::class.java)</span><br><span class="line">        </span><br><span class="line">        // ç»‘å®šè§‚å¯Ÿè€…</span><br><span class="line">        viewModel.message.observe(this, Observer &#123; newMessage -&gt;</span><br><span class="line">            // å½“ LiveData æ•°æ®å˜åŒ–æ—¶ï¼Œè¿™é‡Œçš„ä»£ç ä¼šæ‰§è¡Œï¼Œæ›´æ–°ç•Œé¢</span><br><span class="line">            findViewById&lt;TextView&gt;(R.id.textView).text = newMessage</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-æ•°æ®æ›´æ–°æ–¹æ³•"><a href="#3-æ•°æ®æ›´æ–°æ–¹æ³•" class="headerlink" title="3. æ•°æ®æ›´æ–°æ–¹æ³•"></a>3. æ•°æ®æ›´æ–°æ–¹æ³•</h3><ul><li><strong>setValue()</strong>ï¼šå¿…é¡»åœ¨ä¸»çº¿ç¨‹ä¸­è°ƒç”¨ï¼Œç”¨äºåŒæ­¥æ›´æ–°æ•°æ®ã€‚</li><li><strong>postValue()</strong>ï¼šå¯åœ¨å­çº¿ç¨‹ä¸­è°ƒç”¨ï¼Œå†…éƒ¨æœºåˆ¶ä¼šå°†æ›´æ–°åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹å†é€šçŸ¥è§‚å¯Ÿè€…ã€‚</li></ul><p>ä¾‹å¦‚ï¼Œåœ¨å¼‚æ­¥ä»»åŠ¡ä¸­æ›´æ–°æ•°æ®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Thread &#123;</span><br><span class="line">    // æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ</span><br><span class="line">    Thread.sleep(1000)</span><br><span class="line">    // å­çº¿ç¨‹ä¸­æ›´æ–°æ•°æ®</span><br><span class="line">    viewModel.updateMessage(&quot;å¼‚æ­¥æ›´æ–°åçš„æ•°æ®&quot;)</span><br><span class="line">&#125;.start()</span><br></pre></td></tr></table></figure><hr><h2 id="å››ã€LiveData-çš„é«˜çº§æ‰©å±•"><a href="#å››ã€LiveData-çš„é«˜çº§æ‰©å±•" class="headerlink" title="å››ã€LiveData çš„é«˜çº§æ‰©å±•"></a>å››ã€LiveData çš„é«˜çº§æ‰©å±•</h2><h3 id="1-Transformations-map"><a href="#1-Transformations-map" class="headerlink" title="1. Transformations.map()"></a>1. Transformations.map()</h3><p><code>map()</code> ç”¨äºå°†ä¸€ä¸ª LiveData æ•°æ®è½¬æ¢æˆå¦ä¸€ç§ç±»å‹çš„ LiveDataï¼Œè€Œæ— éœ€æ‰‹åŠ¨åˆ›å»ºæ–°çš„è§‚å¯Ÿè€…ã€‚<br> <strong>ç¤ºä¾‹ï¼š</strong> å°†ç”¨æˆ·çš„å¹´é¾„è½¬æ¢ä¸ºæ˜¯å¦æˆå¹´ï¼ˆå¸ƒå°”å€¼ï¼‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">val ageLiveData = MutableLiveData&lt;Int&gt;()</span><br><span class="line"></span><br><span class="line">// ä½¿ç”¨ map() å°† ageLiveData è½¬æ¢ä¸ºæ˜¯å¦æˆå¹´</span><br><span class="line">val isAdultLiveData: LiveData&lt;Boolean&gt; = Transformations.map(ageLiveData) &#123; age -&gt;</span><br><span class="line">    age &gt;= 18</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">isAdultLiveData.observe(this, Observer &#123; isAdult -&gt;</span><br><span class="line">    val message = if (isAdult) &quot;ç”¨æˆ·æ˜¯æˆå¹´äºº&quot; else &quot;ç”¨æˆ·æ˜¯æœªæˆå¹´äºº&quot;</span><br><span class="line">    println(message)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// æ”¹å˜å¹´é¾„æ•°æ®ï¼Œè§‚å¯Ÿè€…ä¼šè‡ªåŠ¨æ›´æ–°</span><br><span class="line">ageLiveData.value = 20  // è¾“å‡ºï¼šç”¨æˆ·æ˜¯æˆå¹´äºº</span><br></pre></td></tr></table></figure><h3 id="2-Transformations-switchMap"><a href="#2-Transformations-switchMap" class="headerlink" title="2. Transformations.switchMap()"></a>2. Transformations.switchMap()</h3><p><code>switchMap()</code> ç”¨äºæ ¹æ®ä¸€ä¸ª LiveData çš„å€¼åˆ‡æ¢åˆ°å¦ä¸€ä¸ª LiveData æ•°æ®æºï¼Œé€‚åˆäºéœ€è¦åŠ¨æ€æŸ¥è¯¢æ•°æ®çš„åœºæ™¯ï¼ˆä¾‹å¦‚æ ¹æ®ç”¨æˆ· ID è¯·æ±‚æ•°æ®ï¼‰ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">val userIdLiveData = MutableLiveData&lt;String&gt;()</span><br><span class="line"></span><br><span class="line">// å‡è®¾ fetchUserDetails è¿”å›ä¸€ä¸ª LiveData&lt;User&gt;</span><br><span class="line">val userLiveData: LiveData&lt;User&gt; = Transformations.switchMap(userIdLiveData) &#123; userId -&gt;</span><br><span class="line">    fetchUserDetails(userId)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">userLiveData.observe(this, Observer &#123; user -&gt;</span><br><span class="line">    println(&quot;ç”¨æˆ·ä¿¡æ¯ï¼š$&#123;user.name&#125;, $&#123;user.email&#125;&quot;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// å½“ userId å˜åŒ–æ—¶ï¼Œä¼šè‡ªåŠ¨è§¦å‘æ–°çš„æ•°æ®è¯·æ±‚</span><br><span class="line">userIdLiveData.value = &quot;12345&quot;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œï¼Œå½“ <code>userIdLiveData</code> æ”¹å˜æ—¶ï¼Œ<code>switchMap()</code> ä¼šå–æ¶ˆä¹‹å‰çš„æŸ¥è¯¢å¹¶å¯åŠ¨æ–°çš„æŸ¥è¯¢ï¼Œå°†ç»“æœè¿”å›ç»™ <code>userLiveData</code>ã€‚</p><hr><h2 id="äº”ã€LiveData-åœ¨-MVVM-ä¸­çš„åº”ç”¨"><a href="#äº”ã€LiveData-åœ¨-MVVM-ä¸­çš„åº”ç”¨" class="headerlink" title="äº”ã€LiveData åœ¨ MVVM ä¸­çš„åº”ç”¨"></a>äº”ã€LiveData åœ¨ MVVM ä¸­çš„åº”ç”¨</h2><p>åœ¨ MVVM æ¶æ„ä¸­ï¼ŒLiveData æ‰®æ¼”ç€æ•°æ®å’Œ UI é—´çš„æ¡¥æ¢ä½œç”¨ï¼š</p><ol><li><strong>ViewModel å­˜å‚¨ä¸šåŠ¡æ•°æ®</strong>ï¼šViewModel é€šè¿‡ MutableLiveData å­˜å‚¨æ•°æ®ï¼Œå¹¶å¯¹å¤–æš´éœ²åªè¯» LiveDataã€‚</li><li><strong>UI å±‚è§‚å¯Ÿæ•°æ®å˜åŒ–</strong>ï¼šActivity æˆ– Fragment è§‚å¯Ÿ LiveDataï¼Œå½“æ•°æ®æ›´æ–°æ—¶è‡ªåŠ¨åˆ·æ–°ç•Œé¢ã€‚</li><li><strong>ç”Ÿå‘½å‘¨æœŸç®¡ç†</strong>ï¼šLiveData ä¼šè‡ªåŠ¨åœ¨ UI ç»„ä»¶å¤„äºæ´»è·ƒçŠ¶æ€æ—¶é€šçŸ¥æ›´æ–°ï¼Œåœ¨ UI ä¸æ´»è·ƒæ—¶åœæ­¢é€šçŸ¥ï¼Œé¿å…æ— ç”¨çš„æ“ä½œå’Œå†…å­˜æ³„æ¼ã€‚</li></ol><p>è¿™ç§æ–¹å¼ä½¿å¾—æ•°æ®æ›´æ–°ã€UI åˆ·æ–°ä»¥åŠç”Ÿå‘½å‘¨æœŸç®¡ç†å˜å¾—ç®€å•ä¸”ä¸€è‡´ï¼Œå¼€å‘è€…æ— éœ€æ‰‹åŠ¨ç®¡ç†å¤æ‚çš„å›è°ƒå’ŒçŠ¶æ€å˜åŒ–ã€‚</p><hr><h2 id="å…­ã€æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ"><a href="#å…­ã€æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ" class="headerlink" title="å…­ã€æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ"></a>å…­ã€æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ</h2><h3 id="1-é¿å…å†…å­˜æ³„æ¼"><a href="#1-é¿å…å†…å­˜æ³„æ¼" class="headerlink" title="1. é¿å…å†…å­˜æ³„æ¼"></a>1. é¿å…å†…å­˜æ³„æ¼</h3><ul><li><strong>ä½¿ç”¨ ViewModel</strong>ï¼šå°† LiveData å­˜å‚¨åœ¨ ViewModel ä¸­ï¼Œç¡®ä¿ Activity æˆ– Fragment é”€æ¯æ—¶ï¼Œæ•°æ®ä¸ä¼šå› å¼•ç”¨è€Œæ³„æ¼ã€‚</li><li><strong>ç»‘å®šç”Ÿå‘½å‘¨æœŸ</strong>ï¼šåœ¨ observe() æ—¶ä¼ å…¥ç”Ÿå‘½å‘¨æœŸæ‹¥æœ‰è€…ï¼Œå¦‚ Activity æˆ– Fragmentï¼Œä»¥ä¾¿ LiveData æ ¹æ®ç”Ÿå‘½å‘¨æœŸè‡ªåŠ¨å–æ¶ˆè§‚å¯Ÿã€‚</li></ul><h3 id="2-æ•°æ®ä¸€è‡´æ€§é—®é¢˜"><a href="#2-æ•°æ®ä¸€è‡´æ€§é—®é¢˜" class="headerlink" title="2. æ•°æ®ä¸€è‡´æ€§é—®é¢˜"></a>2. æ•°æ®ä¸€è‡´æ€§é—®é¢˜</h3><ul><li>å¦‚æœåŒæ—¶æœ‰å¤šä¸ªæ•°æ®æºéœ€è¦æ›´æ–° UIï¼Œç¡®ä¿æ•°æ®çš„å‘å¸ƒé¡ºåºå’Œä¾èµ–å…³ç³»æ­£ç¡®ã€‚</li><li>ä½¿ç”¨ Transformations å¯ä»¥æ–¹ä¾¿åœ°ç®¡ç†æ•°æ®è½¬æ¢ï¼Œç¡®ä¿è½¬æ¢é€»è¾‘ä¸ä¸šåŠ¡é€»è¾‘åˆ†ç¦»ã€‚</li></ul><h3 id="3-ä¸»çº¿ç¨‹ä¸å­çº¿ç¨‹æ›´æ–°"><a href="#3-ä¸»çº¿ç¨‹ä¸å­çº¿ç¨‹æ›´æ–°" class="headerlink" title="3. ä¸»çº¿ç¨‹ä¸å­çº¿ç¨‹æ›´æ–°"></a>3. ä¸»çº¿ç¨‹ä¸å­çº¿ç¨‹æ›´æ–°</h3><ul><li>åœ¨ä¸»çº¿ç¨‹ä¸­ä½¿ç”¨ setValue()ï¼Œåœ¨å­çº¿ç¨‹ä¸­ä½¿ç”¨ postValue()ï¼Œä»¥å…å¼•èµ·çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</li></ul><hr><h2 id="ä¸ƒã€æ€»ç»“"><a href="#ä¸ƒã€æ€»ç»“" class="headerlink" title="ä¸ƒã€æ€»ç»“"></a>ä¸ƒã€æ€»ç»“</h2><p><strong>LiveData</strong> ä½œä¸º Android Jetpack çš„æ ¸å¿ƒç»„ä»¶ï¼Œåœ¨ MVVM æ¶æ„ä¸­å‘æŒ¥ç€è‡³å…³é‡è¦çš„ä½œç”¨ã€‚å®ƒä¸ä»…èƒ½å¤Ÿè‡ªåŠ¨æ„ŸçŸ¥ç”Ÿå‘½å‘¨æœŸï¼Œé¿å…å†…å­˜æ³„æ¼ï¼Œè¿˜èƒ½ç®€åŒ–æ•°æ®å’Œ UI ä¹‹é—´çš„æ›´æ–°é€»è¾‘ã€‚é€šè¿‡ä½¿ç”¨ <code>Transformations.map()</code> å’Œ <code>switchMap()</code>ï¼Œä½ å¯ä»¥æ–¹ä¾¿åœ°å¯¹æ•°æ®è¿›è¡Œè½¬æ¢å’ŒåŠ¨æ€åˆ‡æ¢ï¼Œè¿›ä¸€æ­¥æé«˜ä»£ç çš„ç®€æ´æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p><h3 id="å…³é”®ç‚¹å›é¡¾ï¼š"><a href="#å…³é”®ç‚¹å›é¡¾ï¼š" class="headerlink" title="å…³é”®ç‚¹å›é¡¾ï¼š"></a>å…³é”®ç‚¹å›é¡¾ï¼š</h3><ul><li><strong>ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥</strong>ï¼šLiveData ä¼šè‡ªåŠ¨æ ¹æ®è§‚å¯Ÿè€…çš„ç”Ÿå‘½å‘¨æœŸçŠ¶æ€é€šçŸ¥æ•°æ®æ›´æ–°ã€‚</li><li><strong>æ•°æ®é©±åŠ¨ UI æ›´æ–°</strong>ï¼šæ•°æ®å˜åŒ–åï¼Œæ‰€æœ‰æ´»è·ƒçš„è§‚å¯Ÿè€…éƒ½ä¼šè‡ªåŠ¨åˆ·æ–° UIã€‚</li><li><strong>æ•°æ®è½¬æ¢</strong>ï¼šé€šè¿‡ map() å’Œ switchMap() æ‰©å±•æ–¹æ³•ï¼Œå¯ä»¥æ–¹ä¾¿åœ°å¯¹æ•°æ®è¿›è¡Œè½¬æ¢å’ŒåŠ¨æ€åˆ‡æ¢ã€‚</li><li><strong>MVVM ä¸­çš„åº”ç”¨</strong>ï¼šViewModel å­˜å‚¨æ•°æ®ï¼ŒUI é€šè¿‡è§‚å¯Ÿ LiveData æ¥æ›´æ–°è§†å›¾ï¼Œæå¤§ç®€åŒ–äº†æ•°æ®æµè½¬é€»è¾‘ã€‚</li></ul><p>æŒæ¡äº† LiveData çš„ä½¿ç”¨å’Œæ‰©å±•æ–¹æ³•ï¼Œä½ å°†èƒ½å¤Ÿæ›´é«˜æ•ˆã€æ›´å®‰å…¨åœ°æ„å»ºå“åº”å¼çš„ Android åº”ç”¨ã€‚å¦‚æœä½ åœ¨å®é™…å¼€å‘ä¸­é‡åˆ°é—®é¢˜ï¼Œæ¬¢è¿æ·±å…¥æ¢è®¨æˆ–æŸ¥é˜…ç›¸å…³èµ„æ–™ï¼ŒæŒç»­æå‡å¼€å‘æŠ€èƒ½ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“å¼€å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Lifecyclesç”¨æ³•ç¤ºä¾‹</title>
      <link href="/2025/04/04/Lifecycles%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B/"/>
      <url>/2025/04/04/Lifecycles%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<p>ä¸‹é¢æä¾›ä¸€ä¸ªä½¿ç”¨ Kotlin è®²è§£ Android Lifecycle çš„ç¤ºä¾‹ï¼ŒåŒ…å« LifecycleObserverã€LiveData å’Œ ViewModel çš„ä½¿ç”¨ï¼Œå¸®åŠ©ä½ ç†è§£å¦‚ä½•åœ¨ Kotlin ä¸­ç®¡ç† Activity çš„ç”Ÿå‘½å‘¨æœŸã€‚</p><hr><h2 id="1-æ·»åŠ ä¾èµ–"><a href="#1-æ·»åŠ ä¾èµ–" class="headerlink" title="1. æ·»åŠ ä¾èµ–"></a>1. æ·»åŠ ä¾èµ–</h2><p>åœ¨ä½ çš„ <code>build.gradle</code> æ–‡ä»¶ä¸­æ·»åŠ  Lifecycle ç›¸å…³ä¾èµ–ï¼ˆç‰ˆæœ¬å·å¯æ ¹æ®é¡¹ç›®éœ€æ±‚è°ƒæ•´ï¼‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    // Lifecycle ç»„ä»¶ä¾èµ–</span><br><span class="line">    implementation &quot;androidx.lifecycle:lifecycle-extensions:2.2.0&quot;</span><br><span class="line">    // å•ç‹¬ä½¿ç”¨ ViewModel ä¸ LiveDataï¼ˆæ¨èè¿™ç§æ–¹å¼ï¼Œä¾èµ–æ›´æ˜ç¡®ï¼‰</span><br><span class="line">    implementation &quot;androidx.lifecycle:lifecycle-viewmodel-ktx:2.2.0&quot;</span><br><span class="line">    implementation &quot;androidx.lifecycle:lifecycle-livedata-ktx:2.2.0&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="2-ä½¿ç”¨-LifecycleObserver-ç›‘å¬ç”Ÿå‘½å‘¨æœŸå˜åŒ–"><a href="#2-ä½¿ç”¨-LifecycleObserver-ç›‘å¬ç”Ÿå‘½å‘¨æœŸå˜åŒ–" class="headerlink" title="2. ä½¿ç”¨ LifecycleObserver ç›‘å¬ç”Ÿå‘½å‘¨æœŸå˜åŒ–"></a>2. ä½¿ç”¨ LifecycleObserver ç›‘å¬ç”Ÿå‘½å‘¨æœŸå˜åŒ–</h2><p>ä½¿ç”¨ Kotlin ç¼–å†™ä¸€ä¸ª LifecycleObserver ç±»ï¼Œé€šè¿‡æ³¨è§£ç›‘å¬ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import androidx.lifecycle.Lifecycle</span><br><span class="line">import androidx.lifecycle.LifecycleObserver</span><br><span class="line">import androidx.lifecycle.OnLifecycleEvent</span><br><span class="line">import android.util.Log</span><br><span class="line"></span><br><span class="line">class MyObserver : LifecycleObserver &#123;</span><br><span class="line"></span><br><span class="line">    @OnLifecycleEvent(Lifecycle.Event.ON_CREATE)</span><br><span class="line">    fun onCreateEvent() &#123;</span><br><span class="line">        Log.d(&quot;MyObserver&quot;, &quot;onCreate è§¦å‘&quot;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @OnLifecycleEvent(Lifecycle.Event.ON_START)</span><br><span class="line">    fun onStartEvent() &#123;</span><br><span class="line">        Log.d(&quot;MyObserver&quot;, &quot;onStart è§¦å‘&quot;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @OnLifecycleEvent(Lifecycle.Event.ON_DESTROY)</span><br><span class="line">    fun onDestroyEvent() &#123;</span><br><span class="line">        Log.d(&quot;MyObserver&quot;, &quot;onDestroy è§¦å‘&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨ Activity ä¸­æ³¨å†Œè¿™ä¸ªè§‚å¯Ÿè€…ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import androidx.appcompat.app.AppCompatActivity</span><br><span class="line">import android.os.Bundle</span><br><span class="line"></span><br><span class="line">class MainActivity : AppCompatActivity() &#123;</span><br><span class="line">    override fun onCreate(savedInstanceState: Bundle?) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line"></span><br><span class="line">        // æ³¨å†Œ LifecycleObserver</span><br><span class="line">        val observer = MyObserver()</span><br><span class="line">        lifecycle.addObserver(observer)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·ï¼Œ<code>MyObserver</code> ä¸­çš„æ–¹æ³•ä¼šåœ¨å¯¹åº”çš„ç”Ÿå‘½å‘¨æœŸäº‹ä»¶æ—¶è‡ªåŠ¨è°ƒç”¨ã€‚</p><hr><h2 id="3-ä½¿ç”¨-LiveData-ä¸-ViewModel"><a href="#3-ä½¿ç”¨-LiveData-ä¸-ViewModel" class="headerlink" title="3. ä½¿ç”¨ LiveData ä¸ ViewModel"></a>3. ä½¿ç”¨ LiveData ä¸ ViewModel</h2><h3 id="å®šä¹‰-ViewModel"><a href="#å®šä¹‰-ViewModel" class="headerlink" title="å®šä¹‰ ViewModel"></a>å®šä¹‰ ViewModel</h3><p>åˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ª <code>ViewModel</code> çš„ç±»ï¼Œä½¿ç”¨ MutableLiveData æ¥ç®¡ç†æ•°æ®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import androidx.lifecycle.LiveData</span><br><span class="line">import androidx.lifecycle.MutableLiveData</span><br><span class="line">import androidx.lifecycle.ViewModel</span><br><span class="line"></span><br><span class="line">class MyViewModel : ViewModel() &#123;</span><br><span class="line">    // å†…éƒ¨å¯ä¿®æ”¹çš„ LiveData</span><br><span class="line">    private val _myData = MutableLiveData&lt;String&gt;()</span><br><span class="line">    // å¯¹å¤–åªæš´éœ²ä¸å¯å˜çš„ LiveData</span><br><span class="line">    val myData: LiveData&lt;String&gt; = _myData</span><br><span class="line"></span><br><span class="line">    init &#123;</span><br><span class="line">        loadData()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private fun loadData() &#123;</span><br><span class="line">        // æ¨¡æ‹Ÿå¼‚æ­¥åŠ è½½æ•°æ®ï¼Œè¿™é‡Œç›´æ¥èµ‹å€¼</span><br><span class="line">        _myData.value = &quot;Hello, Lifecycle in Kotlin!&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åœ¨-Activity-ä¸­è§‚å¯Ÿ-LiveData"><a href="#åœ¨-Activity-ä¸­è§‚å¯Ÿ-LiveData" class="headerlink" title="åœ¨ Activity ä¸­è§‚å¯Ÿ LiveData"></a>åœ¨ Activity ä¸­è§‚å¯Ÿ LiveData</h3><p>åœ¨ Activity ä¸­è·å– ViewModelï¼Œå¹¶è§‚å¯Ÿ LiveData æ•°æ®å˜åŒ–ï¼Œè‡ªåŠ¨æ›´æ–° UIï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import androidx.appcompat.app.AppCompatActivity</span><br><span class="line">import android.os.Bundle</span><br><span class="line">import android.util.Log</span><br><span class="line">import androidx.lifecycle.Observer</span><br><span class="line">import androidx.lifecycle.ViewModelProvider</span><br><span class="line"></span><br><span class="line">class MainActivity : AppCompatActivity() &#123;</span><br><span class="line">    override fun onCreate(savedInstanceState: Bundle?) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line"></span><br><span class="line">        // è·å– ViewModel å®ä¾‹</span><br><span class="line">        val viewModel = ViewModelProvider(this).get(MyViewModel::class.java)</span><br><span class="line"></span><br><span class="line">        // è§‚å¯Ÿ LiveData çš„å˜åŒ–</span><br><span class="line">        viewModel.myData.observe(this, Observer &#123; data -&gt;</span><br><span class="line">            // å½“æ•°æ®å˜åŒ–æ—¶ï¼Œè¿™é‡Œçš„ä»£ç ä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œæ¯”å¦‚æ›´æ–° UI</span><br><span class="line">            Log.d(&quot;MainActivity&quot;, &quot;æ¥æ”¶åˆ°æ•°æ®ï¼š$data&quot;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>LiveData</code> ä¼šè‡ªåŠ¨æ„ŸçŸ¥ <code>MainActivity</code> çš„ç”Ÿå‘½å‘¨æœŸï¼Œä»…åœ¨ç•Œé¢å¤„äºæ´»è·ƒçŠ¶æ€æ—¶æ›´æ–°æ•°æ®ï¼Œä»è€Œé¿å…å†…å­˜æ³„éœ²é—®é¢˜ã€‚</p><hr><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li><strong>LifecycleObserver</strong>ï¼šé€šè¿‡æ³¨è§£æ–¹æ³•è‡ªåŠ¨ç›‘å¬ Activity æˆ– Fragment çš„ç”Ÿå‘½å‘¨æœŸï¼Œç®€åŒ–äº†ä¼ ç»Ÿç”Ÿå‘½å‘¨æœŸå›è°ƒçš„ä»£ç ç®¡ç†ã€‚</li><li><strong>LifecycleOwner</strong>ï¼šActivity å’Œ Fragment é»˜è®¤å®ç°æ­¤æ¥å£ï¼Œå¯ç›´æ¥ä½¿ç”¨ <code>lifecycle.addObserver()</code> æ³¨å†Œè§‚å¯Ÿè€…ã€‚</li><li><strong>LiveData ä¸ ViewModel</strong>ï¼šé…åˆä½¿ç”¨å¯ä»¥è‡ªåŠ¨æ›´æ–° UIï¼Œå¤„ç†é…ç½®å˜åŒ–ï¼ˆå¦‚å±å¹•æ—‹è½¬ï¼‰æ—¶æ•°æ®ä¸ä¼šä¸¢å¤±ï¼ŒåŒæ—¶å‡å°‘å†…å­˜æ³„éœ²é£é™©ã€‚</li></ul><p>è¿™ç§æ–¹å¼èƒ½è®©ä½ ç¼–å†™çš„ä»£ç æ›´åŠ æ¨¡å—åŒ–ã€æ˜“äºç»´æŠ¤å’Œæµ‹è¯•ã€‚å¸Œæœ›è¿™ä¸ª Kotlin ç¤ºä¾‹å¯¹ä½ ç†è§£ Android Lifecycle çš„ä½¿ç”¨æœ‰æ‰€å¸®åŠ©ï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“å¼€å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CollapsingToolbarLayoutç”¨æ³•è¯¦è§£</title>
      <link href="/2025/04/04/CollapsingToolbarLayout%E7%94%A8%E6%B3%95%E8%AF%A6%E8%A7%A3/"/>
      <url>/2025/04/04/CollapsingToolbarLayout%E7%94%A8%E6%B3%95%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h2><p><code>CollapsingToolbarLayout</code> æ˜¯ Android Material Components åº“ä¸­çš„ä¸€ä¸ªå¸ƒå±€ç»„ä»¶ï¼Œä¸»è¦ç”¨äºåˆ›å»ºå¯ä»¥åœ¨æ»šåŠ¨è¿‡ç¨‹ä¸­æŠ˜å å’Œå±•å¼€çš„åº”ç”¨æ ï¼ˆAppBarï¼‰ã€‚å®ƒé€šå¸¸ä¸ <code>AppBarLayout</code> ä¸€èµ·ä½¿ç”¨ï¼Œä»¥ä¾¿ä¸ºåº”ç”¨çš„é¡¶éƒ¨åŒºåŸŸæä¾›ä¸°å¯Œçš„äº¤äº’æ•ˆæœã€‚<code>CollapsingToolbarLayout</code> æ˜¯å®ç° Material Design é£æ ¼ä¸­çš„å¯æŠ˜å åº”ç”¨æ çš„é‡è¦å·¥å…·ï¼Œå¹¿æ³›åº”ç”¨äºé‚£äº›éœ€è¦åŠ¨æ€è°ƒæ•´åº”ç”¨æ å†…å®¹çš„åœºæ™¯ã€‚</p><p><code>CollapsingToolbarLayout</code> å¯ä»¥ç»“åˆ <code>Toolbar</code>ã€<code>ImageView</code> ç­‰æ§ä»¶ä¸€èµ·ä½¿ç”¨ï¼Œæ”¯æŒæ»šåŠ¨æ—¶è‡ªåŠ¨æŠ˜å ã€åŠ¨æ€æ”¹å˜æ ‡é¢˜ã€èƒŒæ™¯ç­‰æ•ˆæœã€‚å®ƒèƒ½å¤Ÿåœ¨ç”¨æˆ·æ»šåŠ¨é¡µé¢æ—¶æä¾›ä¸°å¯Œçš„è§†è§‰åé¦ˆï¼Œæé«˜ç”¨æˆ·ä½“éªŒã€‚</p><hr><h2 id="äºŒã€ä¾èµ–ä¸å¯¼å…¥"><a href="#äºŒã€ä¾èµ–ä¸å¯¼å…¥" class="headerlink" title="äºŒã€ä¾èµ–ä¸å¯¼å…¥"></a>äºŒã€ä¾èµ–ä¸å¯¼å…¥</h2><p>åœ¨ä½¿ç”¨ <code>CollapsingToolbarLayout</code> ä¹‹å‰ï¼Œç¡®ä¿ä½ çš„é¡¹ç›®å·²åŠ å…¥ <code>Material Components</code> çš„ä¾èµ–ã€‚å¯ä»¥åœ¨é¡¹ç›®çš„ <code>build.gradle</code> æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    implementation &#x27;com.google.android.material:material:1.4.0&#x27;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="ä¸‰ã€CollapsingToolbarLayout-åŸºæœ¬ç”¨æ³•"><a href="#ä¸‰ã€CollapsingToolbarLayout-åŸºæœ¬ç”¨æ³•" class="headerlink" title="ä¸‰ã€CollapsingToolbarLayout åŸºæœ¬ç”¨æ³•"></a>ä¸‰ã€CollapsingToolbarLayout åŸºæœ¬ç”¨æ³•</h2><h3 id="1-åœ¨-XML-å¸ƒå±€ä¸­ä½¿ç”¨-CollapsingToolbarLayout"><a href="#1-åœ¨-XML-å¸ƒå±€ä¸­ä½¿ç”¨-CollapsingToolbarLayout" class="headerlink" title="1. åœ¨ XML å¸ƒå±€ä¸­ä½¿ç”¨ CollapsingToolbarLayout"></a>1. åœ¨ XML å¸ƒå±€ä¸­ä½¿ç”¨ <code>CollapsingToolbarLayout</code></h3><p><code>CollapsingToolbarLayout</code> é€šå¸¸éœ€è¦æ”¾ç½®åœ¨ <code>AppBarLayout</code> ä¸­ï¼Œå¹¶ä¸ <code>Toolbar</code>ã€<code>ImageView</code> ç­‰æ§ä»¶ä¸€èµ·ä½¿ç”¨ï¼Œä»¥å®ç°æŠ˜å å’Œå±•å¼€çš„æ•ˆæœã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªåŸºæœ¬çš„ä¾‹å­ï¼Œå±•ç¤ºäº†å¦‚ä½•åœ¨ XML å¸ƒå±€ä¸­ä½¿ç”¨ <code>CollapsingToolbarLayout</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.google.android.material.appbar.AppBarLayout</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;wrap_content&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- CollapsingToolbarLayout åŒ…è£¹ Toolbar å’Œå…¶ä»–è§†å›¾ --&gt;</span><br><span class="line">    &lt;com.google.android.material.appbar.CollapsingToolbarLayout</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        app:layout_scrollFlags=&quot;scroll|exitUntilCollapsed&quot;</span><br><span class="line">        app:contentScrim=&quot;?attr/colorPrimary&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- Toolbar ç”¨äºæ˜¾ç¤ºæ ‡é¢˜ --&gt;</span><br><span class="line">        &lt;androidx.appcompat.widget.Toolbar</span><br><span class="line">            android:id=&quot;@+id/toolbar&quot;</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            android:layout_height=&quot;?attr/actionBarSize&quot;</span><br><span class="line">            android:title=&quot;Collapsing Toolbar Example&quot;</span><br><span class="line">            android:theme=&quot;@style/ThemeOverlay.MaterialComponents.ActionBar&quot; /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- ç”¨äºæ˜¾ç¤ºèƒŒæ™¯å›¾åƒï¼Œå½“æ»šåŠ¨æ—¶å›¾åƒä¼šæŠ˜å  --&gt;</span><br><span class="line">        &lt;ImageView</span><br><span class="line">            android:id=&quot;@+id/headerImage&quot;</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            android:layout_height=&quot;200dp&quot;</span><br><span class="line">            android:src=&quot;@drawable/sample_image&quot;</span><br><span class="line">            android:scaleType=&quot;centerCrop&quot; /&gt;</span><br><span class="line">    &lt;/com.google.android.material.appbar.CollapsingToolbarLayout&gt;</span><br><span class="line"></span><br><span class="line">&lt;/com.google.android.material.appbar.AppBarLayout&gt;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªå¸ƒå±€ä¸­ï¼š</p><ul><li><code>CollapsingToolbarLayout</code> åŒ…è£¹äº† <code>Toolbar</code> å’Œå…¶ä»–è§†å›¾ï¼ˆä¾‹å¦‚ <code>ImageView</code>ï¼‰ã€‚</li><li><code>layout_scrollFlags</code> æ§åˆ¶è§†å›¾æ»šåŠ¨æ—¶çš„è¡Œä¸ºã€‚<code>scroll|exitUntilCollapsed</code> è¡¨ç¤ºè¯¥è§†å›¾ä¼šéšç€é¡µé¢æ»šåŠ¨è€ŒæŠ˜å ï¼Œç›´åˆ°å®Œå…¨æ¶ˆå¤±ã€‚</li><li><code>contentScrim</code> å±æ€§ç”¨äºè®¾ç½®æŠ˜å æ—¶çš„èƒŒæ™¯é¢œè‰²ã€‚</li></ul><h3 id="2-é…ç½®æŠ˜å è¡Œä¸º"><a href="#2-é…ç½®æŠ˜å è¡Œä¸º" class="headerlink" title="2. é…ç½®æŠ˜å è¡Œä¸º"></a>2. é…ç½®æŠ˜å è¡Œä¸º</h3><p><code>CollapsingToolbarLayout</code> å¯ä»¥è®¾ç½®å¤šä¸ªæ»šåŠ¨æ ‡å¿—ï¼Œæ¥æ§åˆ¶æŠ˜å è¡Œä¸ºã€‚è¿™äº›æ ‡å¿—ä¸ <code>AppBarLayout</code> çš„æ»šåŠ¨æ ‡å¿—ç›¸ä¼¼ã€‚å¸¸è§çš„æ»šåŠ¨æ ‡å¿—åŒ…æ‹¬ï¼š</p><ul><li><strong>scroll</strong>ï¼šè¯¥è§†å›¾åœ¨æ»šåŠ¨æ—¶ä¼šè·Ÿéšæ»šåŠ¨è§†å›¾ä¸€èµ·ç§»åŠ¨ã€‚</li><li><strong>exitUntilCollapsed</strong>ï¼šè¯¥è§†å›¾ä¼šåœ¨æ»šåŠ¨è¿‡ç¨‹ä¸­æŠ˜å ï¼Œç›´åˆ°å®Œå…¨æ¶ˆå¤±ã€‚</li><li><strong>enterAlways</strong>ï¼šè¯¥è§†å›¾åœ¨æ»šåŠ¨æ—¶å§‹ç»ˆæ˜¾ç¤ºï¼Œå¹¶è¿›å…¥å±å¹•ã€‚</li><li><strong>snap</strong>ï¼šåœ¨æ»šåŠ¨ç»“æŸæ—¶ï¼Œè§†å›¾ä¼šç«‹å³æŠ˜å åˆ°å›ºå®šä½ç½®ã€‚</li></ul><p>ä½ å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©åˆé€‚çš„æ»šåŠ¨æ ‡å¿—æ¥å®ç°ä¸åŒçš„æ»šåŠ¨å’ŒæŠ˜å æ•ˆæœã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app:layout_scrollFlags=&quot;scroll|exitUntilCollapsed|snap&quot;</span><br></pre></td></tr></table></figure><h3 id="3-æ»šåŠ¨è§†å›¾ä¸-CollapsingToolbarLayout-é…åˆ"><a href="#3-æ»šåŠ¨è§†å›¾ä¸-CollapsingToolbarLayout-é…åˆ" class="headerlink" title="3. æ»šåŠ¨è§†å›¾ä¸ CollapsingToolbarLayout é…åˆ"></a>3. æ»šåŠ¨è§†å›¾ä¸ <code>CollapsingToolbarLayout</code> é…åˆ</h3><p><code>CollapsingToolbarLayout</code> é€šå¸¸ä¸å¯ä»¥æ»šåŠ¨çš„è§†å›¾ï¼ˆå¦‚ <code>RecyclerView</code> æˆ– <code>NestedScrollView</code>ï¼‰ç»“åˆä½¿ç”¨ï¼Œä»¥å®ç°æ›´æµç•…çš„æ»šåŠ¨æŠ˜å æ•ˆæœã€‚ä½ å¯ä»¥é€šè¿‡è®¾ç½® <code>app:layout_behavior</code> å±æ€§ï¼Œæ§åˆ¶è¿™äº›æ»šåŠ¨è§†å›¾ä¸åº”ç”¨æ çš„äº¤äº’è¡Œä¸ºã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;androidx.recyclerview.widget.RecyclerView</span><br><span class="line">    android:id=&quot;@+id/recyclerView&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;</span><br><span class="line">    app:layout_behavior=&quot;@string/appbar_scrolling_view_behavior&quot; /&gt;</span><br></pre></td></tr></table></figure><p><code>@string/appbar_scrolling_view_behavior</code> æ˜¯ Material Design ä¸­é¢„å®šä¹‰çš„æ»šåŠ¨è¡Œä¸ºï¼Œèƒ½å¤Ÿè®©æ»šåŠ¨è§†å›¾ä¸ <code>AppBarLayout</code> ååŒå·¥ä½œã€‚</p><hr><h2 id="å››ã€CollapsingToolbarLayout-ç‰¹æ€§"><a href="#å››ã€CollapsingToolbarLayout-ç‰¹æ€§" class="headerlink" title="å››ã€CollapsingToolbarLayout ç‰¹æ€§"></a>å››ã€CollapsingToolbarLayout ç‰¹æ€§</h2><h3 id="1-åŠ¨æ€æ”¹å˜æ ‡é¢˜"><a href="#1-åŠ¨æ€æ”¹å˜æ ‡é¢˜" class="headerlink" title="1. åŠ¨æ€æ”¹å˜æ ‡é¢˜"></a>1. åŠ¨æ€æ”¹å˜æ ‡é¢˜</h3><p><code>CollapsingToolbarLayout</code> å…è®¸ä½ åœ¨æ»šåŠ¨è¿‡ç¨‹ä¸­åŠ¨æ€æ”¹å˜ <code>Toolbar</code> ä¸Šçš„æ ‡é¢˜ã€‚é€šå¸¸ï¼ŒæŠ˜å æ—¶æ˜¾ç¤ºä¸€ä¸ªç®€çŸ­çš„æ ‡é¢˜ï¼Œå±•å¼€æ—¶æ˜¾ç¤ºå®Œæ•´çš„æ ‡é¢˜ã€‚ä½ å¯ä»¥é€šè¿‡ <code>setTitle()</code> å’Œ <code>setExpandedTitleTextAppearance()</code> ç­‰æ–¹æ³•åŠ¨æ€æ›´æ–°æ ‡é¢˜ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">val collapsingToolbarLayout = findViewById&lt;CollapsingToolbarLayout&gt;(R.id.collapsingToolbarLayout)</span><br><span class="line">val toolbar = findViewById&lt;Toolbar&gt;(R.id.toolbar)</span><br><span class="line"></span><br><span class="line">// è®¾ç½®å±•å¼€æ—¶çš„æ ‡é¢˜</span><br><span class="line">collapsingToolbarLayout.title = &quot;Collapsing Toolbar&quot;</span><br><span class="line"></span><br><span class="line">// è®¾ç½®æŠ˜å æ—¶çš„æ ‡é¢˜æ ·å¼</span><br><span class="line">collapsingToolbarLayout.setCollapsedTitleTextAppearance(R.style.CollapsedTitleTextStyle)</span><br><span class="line">collapsingToolbarLayout.setExpandedTitleTextAppearance(R.style.ExpandedTitleTextStyle)</span><br></pre></td></tr></table></figure><h3 id="2-è®¾ç½®æŠ˜å çš„èƒŒæ™¯å›¾åƒ"><a href="#2-è®¾ç½®æŠ˜å çš„èƒŒæ™¯å›¾åƒ" class="headerlink" title="2. è®¾ç½®æŠ˜å çš„èƒŒæ™¯å›¾åƒ"></a>2. è®¾ç½®æŠ˜å çš„èƒŒæ™¯å›¾åƒ</h3><p><code>CollapsingToolbarLayout</code> æ”¯æŒåŠ¨æ€è®¾ç½®èƒŒæ™¯å›¾åƒï¼Œå½“ç”¨æˆ·æ»šåŠ¨æ—¶ï¼Œå›¾åƒä¼šæŠ˜å æˆ–å±•å¼€ã€‚ä½ å¯ä»¥é€šè¿‡ <code>setBackground()</code> æ–¹æ³•è®¾ç½®èƒŒæ™¯ï¼Œæˆ–è€…ç›´æ¥åœ¨ XML ä¸­ä½¿ç”¨ <code>ImageView</code> æ¥å®ç°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">val imageView = findViewById&lt;ImageView&gt;(R.id.headerImage)</span><br><span class="line">collapsingToolbarLayout.setBackgroundResource(R.drawable.sample_image)</span><br></pre></td></tr></table></figure><h3 id="3-æ”¯æŒæ¸å˜æ•ˆæœ"><a href="#3-æ”¯æŒæ¸å˜æ•ˆæœ" class="headerlink" title="3. æ”¯æŒæ¸å˜æ•ˆæœ"></a>3. æ”¯æŒæ¸å˜æ•ˆæœ</h3><p>ä½ å¯ä»¥è®¾ç½®æ¸å˜æ•ˆæœï¼Œè®© <code>CollapsingToolbarLayout</code> åœ¨æ»šåŠ¨æ—¶äº§ç”Ÿæ›´å¹³æ»‘çš„æŠ˜å æ•ˆæœã€‚ä¾‹å¦‚ï¼Œå¯ä»¥è®¾ç½®èƒŒæ™¯é¢œè‰²çš„æ¸å˜ã€æ ‡é¢˜æ–‡å­—çš„æ¸å˜ç­‰ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">app:contentScrim=&quot;?attr/colorPrimary&quot;</span><br><span class="line">app:statusBarScrim=&quot;?attr/colorPrimaryDark&quot;</span><br></pre></td></tr></table></figure><p><code>contentScrim</code> è®¾ç½®æŠ˜å æ—¶çš„èƒŒæ™¯é¢œè‰²ï¼Œ<code>statusBarScrim</code> è®¾ç½®çŠ¶æ€æ çš„èƒŒæ™¯é¢œè‰²ã€‚</p><hr><h2 id="äº”ã€ä½¿ç”¨åœºæ™¯"><a href="#äº”ã€ä½¿ç”¨åœºæ™¯" class="headerlink" title="äº”ã€ä½¿ç”¨åœºæ™¯"></a>äº”ã€ä½¿ç”¨åœºæ™¯</h2><p><code>CollapsingToolbarLayout</code> é€‚ç”¨äºéœ€è¦åŠ¨æ€ã€äº¤äº’æ€§å¼ºçš„åº”ç”¨æ è®¾è®¡åœºæ™¯ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„åº”ç”¨åœºæ™¯ï¼š</p><ol><li><strong>ç¤¾äº¤åª’ä½“åº”ç”¨</strong>ï¼šå±•ç¤ºç”¨æˆ·å¤´åƒã€æ˜µç§°ä»¥åŠä¸ªäººèµ„æ–™ï¼Œæ”¯æŒæŠ˜å å±•å¼€æ•ˆæœï¼Œå¢å¼ºç”¨æˆ·ä½“éªŒã€‚</li><li><strong>æ–°é—»æˆ–åšå®¢åº”ç”¨</strong>ï¼šå±•ç¤ºæ–‡ç« æ ‡é¢˜ã€èƒŒæ™¯å›¾ç‰‡ç­‰å†…å®¹ï¼Œéšç€ç”¨æˆ·æ»šåŠ¨ï¼Œæ ‡é¢˜å’Œå›¾ç‰‡åŠ¨æ€å˜åŒ–ã€‚</li><li><strong>ç”µå­å•†åŠ¡åº”ç”¨</strong>ï¼šå•†å“è¯¦æƒ…é¡µé¢ä¸­ï¼Œå±•ç¤ºå•†å“å›¾ç‰‡ã€ä»·æ ¼ã€æè¿°ç­‰å†…å®¹ï¼ŒæŠ˜å å’Œå±•å¼€çš„åŠ¨æ€æ•ˆæœå¢å¼ºäº†è§†è§‰æ•ˆæœã€‚</li><li><strong>å›¾ç‰‡æµè§ˆåº”ç”¨</strong>ï¼šå±•ç¤ºå¤§å›¾æˆ–å°é¢å›¾åƒï¼ŒæŠ˜å æ—¶å¯æ˜¾ç¤ºç®€çŸ­çš„æ ‡é¢˜æˆ–æè¿°ã€‚</li></ol><hr><h2 id="å…­ã€æ€»ç»“"><a href="#å…­ã€æ€»ç»“" class="headerlink" title="å…­ã€æ€»ç»“"></a>å…­ã€æ€»ç»“</h2><p><code>CollapsingToolbarLayout</code> æ˜¯ Android Material Design ä¸­ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ç»„ä»¶ï¼Œå®ƒä½¿å¾—åº”ç”¨æ èƒ½å¤Ÿåœ¨æ»šåŠ¨æ—¶å®ç°æŠ˜å ä¸å±•å¼€çš„æ•ˆæœï¼Œæå¤§åœ°æå‡äº†ç”¨æˆ·ä½“éªŒã€‚å®ƒä¸ <code>AppBarLayout</code> é…åˆä½¿ç”¨ï¼Œæ”¯æŒä¸°å¯Œçš„äº¤äº’æ•ˆæœï¼Œèƒ½å¤Ÿæ ¹æ®ä¸åŒçš„åœºæ™¯åŠ¨æ€è°ƒæ•´åº”ç”¨æ çš„å†…å®¹å’Œè§†è§‰æ•ˆæœã€‚</p><h3 id="ä¸»è¦ä¼˜ç‚¹ï¼š"><a href="#ä¸»è¦ä¼˜ç‚¹ï¼š" class="headerlink" title="ä¸»è¦ä¼˜ç‚¹ï¼š"></a>ä¸»è¦ä¼˜ç‚¹ï¼š</h3><ul><li><strong>åŠ¨æ€æŠ˜å ä¸å±•å¼€</strong>ï¼šé€šè¿‡è®¾ç½®æ»šåŠ¨æ ‡å¿—ï¼Œ<code>CollapsingToolbarLayout</code> èƒ½å¤Ÿåœ¨ç”¨æˆ·æ»šåŠ¨æ—¶æä¾›ä¸°å¯Œçš„è§†è§‰åé¦ˆã€‚</li><li><strong>æ”¯æŒè‡ªå®šä¹‰èƒŒæ™¯ä¸æ ‡é¢˜</strong>ï¼šå¯ä»¥åŠ¨æ€è®¾ç½®èƒŒæ™¯å›¾ç‰‡ã€æ ‡é¢˜æ–‡å­—çš„æ˜¾ç¤ºæ•ˆæœã€‚</li><li><strong>ä¸æ»šåŠ¨è§†å›¾ååŒå·¥ä½œ</strong>ï¼šå¯ä»¥ä¸ <code>RecyclerView</code>ã€<code>NestedScrollView</code> ç­‰æ§ä»¶ç»“åˆï¼Œå®ç°æµç•…çš„æ»šåŠ¨å’ŒæŠ˜å äº¤äº’ã€‚</li></ul><p><code>CollapsingToolbarLayout</code> æ˜¯æ„å»ºç°ä»£åŒ–ã€äº¤äº’æ€§å¼ºçš„ Android åº”ç”¨ä¸­ä¸å¯æˆ–ç¼ºçš„å¸ƒå±€ç»„ä»¶ï¼Œå®ƒæä¾›äº†æå¤§çš„çµæ´»æ€§å’Œå¯å®šåˆ¶æ€§ï¼Œé€‚åˆå„ç§æŠ˜å å¼åº”ç”¨æ åœºæ™¯ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“å¼€å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AppbarLayoutç”¨æ³•è¯¦è§£</title>
      <link href="/2025/04/04/AppbarLayout%E7%94%A8%E6%B3%95%E8%AF%A6%E8%A7%A3/"/>
      <url>/2025/04/04/AppbarLayout%E7%94%A8%E6%B3%95%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h2><p><code>AppBarLayout</code> æ˜¯ Android Material Components åº“ä¸­çš„ä¸€ä¸ªé‡è¦è§†å›¾ç»„ä»¶ï¼Œä½œä¸ºå¸ƒå±€çš„ä¸€éƒ¨åˆ†ï¼Œé€šå¸¸ç”¨äºå®ç°å¯æ»šåŠ¨çš„åº”ç”¨æ ã€‚å®ƒé€šè¿‡ä¸å…¶ä»–å¸ƒå±€æ§ä»¶ï¼ˆå¦‚ <code>Toolbar</code>ã€<code>CollapsingToolbarLayout</code>ï¼‰ç»“åˆä½¿ç”¨ï¼Œæ”¯æŒä¸€äº›å¸¸è§çš„äº¤äº’æ•ˆæœï¼Œæ¯”å¦‚æŠ˜å å’Œå±•å¼€çš„åŠ¨ç”»æ•ˆæœã€‚<code>AppBarLayout</code> ä¸»è¦ç”¨æ¥åˆ›å»ºç¬¦åˆ Material Design é£æ ¼çš„é¡¶éƒ¨åŒºåŸŸï¼Œå®ƒä¸ºå¤æ‚çš„åº”ç”¨æ äº¤äº’æä¾›äº†å¼ºå¤§çš„æ”¯æŒï¼Œå°¤å…¶æ˜¯åœ¨å¤šå±‚æ»šåŠ¨è§†å›¾ä¸­ã€‚</p><h3 id="ä¸»è¦ç‰¹æ€§ï¼š"><a href="#ä¸»è¦ç‰¹æ€§ï¼š" class="headerlink" title="ä¸»è¦ç‰¹æ€§ï¼š"></a>ä¸»è¦ç‰¹æ€§ï¼š</h3><ul><li><strong>æ»šåŠ¨è¡Œä¸º</strong>ï¼šæ”¯æŒå’Œå­è§†å›¾ï¼ˆå¦‚ <code>RecyclerView</code>ï¼‰çš„æ»šåŠ¨äº¤äº’ï¼Œå¯ä»¥æŠ˜å å’Œå±•å¼€åº”ç”¨æ ã€‚</li><li><strong>æŠ˜å ä¸å±•å¼€</strong>ï¼šé€šè¿‡ <code>CollapsingToolbarLayout</code> æ”¯æŒåº”ç”¨æ çš„æŠ˜å ä¸å±•å¼€åŠ¨ç”»ã€‚</li><li><strong>Material Design æ”¯æŒ</strong>ï¼šå†…ç½® Material Design é£æ ¼ï¼Œç¬¦åˆç°ä»£ Android åº”ç”¨çš„è®¾è®¡è§„èŒƒã€‚</li></ul><hr><h2 id="äºŒã€ä¾èµ–ä¸å¯¼å…¥"><a href="#äºŒã€ä¾èµ–ä¸å¯¼å…¥" class="headerlink" title="äºŒã€ä¾èµ–ä¸å¯¼å…¥"></a>äºŒã€ä¾èµ–ä¸å¯¼å…¥</h2><p><code>AppBarLayout</code> æ˜¯ Android Material Components åº“çš„ä¸€éƒ¨åˆ†ï¼Œåœ¨ä½¿ç”¨æ—¶éœ€è¦ç¡®ä¿å·²ç»åœ¨é¡¹ç›®çš„ <code>build.gradle</code> æ–‡ä»¶ä¸­æ·»åŠ äº† Material Components çš„ä¾èµ–ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    implementation &#x27;com.google.android.material:material:1.4.0&#x27;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="ä¸‰ã€AppBarLayout-åŸºæœ¬ç”¨æ³•"><a href="#ä¸‰ã€AppBarLayout-åŸºæœ¬ç”¨æ³•" class="headerlink" title="ä¸‰ã€AppBarLayout åŸºæœ¬ç”¨æ³•"></a>ä¸‰ã€AppBarLayout åŸºæœ¬ç”¨æ³•</h2><p><code>AppBarLayout</code> é€šå¸¸ä¸ <code>Toolbar</code>ã€<code>CollapsingToolbarLayout</code> ç­‰ç»„ä»¶ä¸€èµ·ä½¿ç”¨ã€‚é€šè¿‡è¿™äº›ç»„ä»¶ï¼Œä½ å¯ä»¥å®ç°åº”ç”¨æ çš„åŠ¨æ€æŠ˜å æ•ˆæœå’Œå…¶ä»–äº¤äº’åŠ¨ç”»ã€‚</p><h3 id="1-åœ¨å¸ƒå±€æ–‡ä»¶ä¸­ä½¿ç”¨-AppBarLayout"><a href="#1-åœ¨å¸ƒå±€æ–‡ä»¶ä¸­ä½¿ç”¨-AppBarLayout" class="headerlink" title="1. åœ¨å¸ƒå±€æ–‡ä»¶ä¸­ä½¿ç”¨ AppBarLayout"></a>1. åœ¨å¸ƒå±€æ–‡ä»¶ä¸­ä½¿ç”¨ <code>AppBarLayout</code></h3><p><code>AppBarLayout</code> æ˜¯ä¸€ä¸ªå®¹å™¨å¸ƒå±€ï¼Œå¯ä»¥åŒ…å« <code>Toolbar</code> å’Œå…¶ä»–è§†å›¾æ§ä»¶ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå±•ç¤ºå¦‚ä½•åœ¨ XML å¸ƒå±€æ–‡ä»¶ä¸­ä½¿ç”¨ <code>AppBarLayout</code> æ¥å®ç°é¡¶éƒ¨å¯æŠ˜å çš„åº”ç”¨æ ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.google.android.material.appbar.AppBarLayout</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">    app:layout_scrollFlags=&quot;scroll|enterAlways&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- CollapsingToolbarLayout ç”¨äºå®ç°æŠ˜å å’Œå±•å¼€æ•ˆæœ --&gt;</span><br><span class="line">    &lt;com.google.android.material.appbar.CollapsingToolbarLayout</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        app:layout_scrollFlags=&quot;scroll|exitUntilCollapsed&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- Toolbar ä½œä¸ºåº”ç”¨æ çš„å·¥å…·æ  --&gt;</span><br><span class="line">        &lt;androidx.appcompat.widget.Toolbar</span><br><span class="line">            android:id=&quot;@+id/toolbar&quot;</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            android:layout_height=&quot;?attr/actionBarSize&quot;</span><br><span class="line">            android:title=&quot;AppBarLayout Example&quot;</span><br><span class="line">            android:theme=&quot;@style/ThemeOverlay.MaterialComponents.ActionBar&quot;/&gt;</span><br><span class="line">    &lt;/com.google.android.material.appbar.CollapsingToolbarLayout&gt;</span><br><span class="line"></span><br><span class="line">&lt;/com.google.android.material.appbar.AppBarLayout&gt;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p><ul><li><code>AppBarLayout</code> æ˜¯åº”ç”¨æ çš„çˆ¶å®¹å™¨ï¼ŒåŒ…å« <code>CollapsingToolbarLayout</code> å’Œ <code>Toolbar</code>ã€‚</li><li><code>CollapsingToolbarLayout</code> æä¾›æŠ˜å æ•ˆæœï¼Œå…è®¸ <code>Toolbar</code> åœ¨æ»šåŠ¨æ—¶æŠ˜å æˆ–å±•å¼€ã€‚</li><li><code>layout_scrollFlags</code> ç”¨äºæŒ‡å®š <code>AppBarLayout</code> çš„æ»šåŠ¨è¡Œä¸ºï¼Œå¦‚â€œscrollâ€ã€â€œenterAlwaysâ€ã€â€œexitUntilCollapsedâ€ç­‰ã€‚</li></ul><h3 id="2-é…ç½®æ»šåŠ¨è¡Œä¸º"><a href="#2-é…ç½®æ»šåŠ¨è¡Œä¸º" class="headerlink" title="2. é…ç½®æ»šåŠ¨è¡Œä¸º"></a>2. é…ç½®æ»šåŠ¨è¡Œä¸º</h3><p><code>AppBarLayout</code> æ”¯æŒä¸å­è§†å›¾ï¼ˆå¦‚ <code>RecyclerView</code>ï¼‰çš„æ»šåŠ¨è¡Œä¸ºäº¤äº’ï¼Œé€šå¸¸é€šè¿‡ <code>layout_behavior</code> å±æ€§æ¥æŒ‡å®šå­è§†å›¾çš„æ»šåŠ¨æ•ˆæœã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ <code>RecyclerView</code> åœ¨æ»šåŠ¨æ—¶ä¸ <code>AppBarLayout</code> ååŒæ»šåŠ¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;androidx.recyclerview.widget.RecyclerView</span><br><span class="line">    android:id=&quot;@+id/recycler_view&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;</span><br><span class="line">    app:layout_behavior=&quot;@string/appbar_scrolling_view_behavior&quot;/&gt;</span><br></pre></td></tr></table></figure><p>é€šè¿‡è®¾ç½® <code>layout_behavior=&quot;@string/appbar_scrolling_view_behavior&quot;</code>ï¼Œ<code>RecyclerView</code> ä¼šæ ¹æ® <code>AppBarLayout</code> çš„æ»šåŠ¨æ¥æ§åˆ¶è‡ªèº«çš„æ˜¾ç¤ºå’Œæ»šåŠ¨ã€‚</p><hr><h2 id="å››ã€AppBarLayout-ç‰¹æ€§"><a href="#å››ã€AppBarLayout-ç‰¹æ€§" class="headerlink" title="å››ã€AppBarLayout ç‰¹æ€§"></a>å››ã€AppBarLayout ç‰¹æ€§</h2><h3 id="1-layout-scrollFlags-å±æ€§"><a href="#1-layout-scrollFlags-å±æ€§" class="headerlink" title="1. layout_scrollFlags å±æ€§"></a>1. <code>layout_scrollFlags</code> å±æ€§</h3><p><code>layout_scrollFlags</code> å±æ€§ç”¨äºæ§åˆ¶ <code>AppBarLayout</code> ä¸­å„ä¸ªå­è§†å›¾çš„æ»šåŠ¨è¡Œä¸ºã€‚å¸¸è§çš„æ»šåŠ¨æ ‡å¿—æœ‰ï¼š</p><ul><li><strong>scroll</strong>ï¼šè¡¨ç¤ºè¯¥è§†å›¾å¯ä»¥éšç€æ»šåŠ¨è§†å›¾çš„æ»šåŠ¨è€Œæ»šåŠ¨ã€‚</li><li><strong>enterAlways</strong>ï¼šå½“æ»šåŠ¨å‘ç”Ÿæ—¶ï¼Œè¯¥è§†å›¾å°†å§‹ç»ˆå‡ºç°åœ¨å±å¹•ä¸Šã€‚</li><li><strong>exitUntilCollapsed</strong>ï¼šå½“æ»šåŠ¨æ—¶ï¼Œè¯¥è§†å›¾å°†è¢«æŠ˜å ï¼Œç›´åˆ°å®Œå…¨æ¶ˆå¤±ã€‚</li></ul><p>é€šè¿‡ç»„åˆè¿™äº›æ ‡å¿—ï¼Œå¯ä»¥åˆ›å»ºéå¸¸çµæ´»çš„åº”ç”¨æ è¡Œä¸ºã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app:layout_scrollFlags=&quot;scroll|enterAlways&quot;</span><br></pre></td></tr></table></figure><p>è¡¨ç¤ºè¯¥è§†å›¾åœ¨æ»šåŠ¨æ—¶å¯ä»¥æ˜¾ç¤ºï¼Œå¹¶åœ¨éœ€è¦æ—¶è¿”å›ã€‚</p><h3 id="2-AppBarLayout-ä¸-CollapsingToolbarLayout-é…åˆ"><a href="#2-AppBarLayout-ä¸-CollapsingToolbarLayout-é…åˆ" class="headerlink" title="2. AppBarLayout ä¸ CollapsingToolbarLayout é…åˆ"></a>2. <code>AppBarLayout</code> ä¸ <code>CollapsingToolbarLayout</code> é…åˆ</h3><p><code>CollapsingToolbarLayout</code> æ˜¯ <code>AppBarLayout</code> çš„å¸¸ç”¨å­å¸ƒå±€ï¼Œç”¨äºå®ç°æ›´å¤æ‚çš„æŠ˜å æ•ˆæœã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ <code>CollapsingToolbarLayout</code> å¯ä»¥å®ç°åŠ¨æ€ç¼©å°çš„ <code>Toolbar</code> å’ŒèƒŒæ™¯å›¾ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.google.android.material.appbar.AppBarLayout</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;wrap_content&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;com.google.android.material.appbar.CollapsingToolbarLayout</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        app:layout_scrollFlags=&quot;scroll|exitUntilCollapsed&quot;</span><br><span class="line">        app:contentScrim=&quot;?attr/colorPrimary&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;androidx.appcompat.widget.Toolbar</span><br><span class="line">            android:id=&quot;@+id/toolbar&quot;</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            android:layout_height=&quot;?attr/actionBarSize&quot;</span><br><span class="line">            android:title=&quot;Collapsing Toolbar&quot;</span><br><span class="line">            android:theme=&quot;@style/ThemeOverlay.MaterialComponents.ActionBar&quot;/&gt;</span><br><span class="line">    &lt;/com.google.android.material.appbar.CollapsingToolbarLayout&gt;</span><br><span class="line">&lt;/com.google.android.material.appbar.AppBarLayout&gt;</span><br></pre></td></tr></table></figure><ul><li><code>app:contentScrim</code> è®¾ç½®æŠ˜å æ—¶çš„èƒŒæ™¯é¢œè‰²ã€‚</li><li><code>app:layout_scrollFlags=&quot;scroll|exitUntilCollapsed&quot;</code> ä½¿å¾— <code>Toolbar</code> å¯ä»¥éšç€æ»šåŠ¨è€ŒæŠ˜å ï¼Œç›´åˆ°å®Œå…¨æ¶ˆå¤±ã€‚</li></ul><h3 id="3-setExpanded-ä¸-setCollapsed-æ–¹æ³•"><a href="#3-setExpanded-ä¸-setCollapsed-æ–¹æ³•" class="headerlink" title="3. setExpanded() ä¸ setCollapsed() æ–¹æ³•"></a>3. <code>setExpanded()</code> ä¸ <code>setCollapsed()</code> æ–¹æ³•</h3><p><code>AppBarLayout</code> è¿˜æä¾›äº† <code>setExpanded()</code> å’Œ <code>setCollapsed()</code> æ–¹æ³•ï¼Œå¯ä»¥åŠ¨æ€æ§åˆ¶åº”ç”¨æ çš„å±•å¼€æˆ–æŠ˜å çŠ¶æ€ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">val appBarLayout: AppBarLayout = findViewById(R.id.app_bar_layout)</span><br><span class="line">appBarLayout.setExpanded(true)  // å±•å¼€åº”ç”¨æ </span><br><span class="line">appBarLayout.setExpanded(false) // æŠ˜å åº”ç”¨æ </span><br></pre></td></tr></table></figure><p>è¿™äº›æ–¹æ³•å¯ä»¥ç»“åˆåŠ¨ç”»æ•ˆæœæ¥åŠ¨æ€æ§åˆ¶åº”ç”¨æ çš„å±•å¼€æˆ–æŠ˜å çŠ¶æ€ã€‚</p><h3 id="4-åŠ¨æ€ç›‘å¬æ»šåŠ¨çŠ¶æ€"><a href="#4-åŠ¨æ€ç›‘å¬æ»šåŠ¨çŠ¶æ€" class="headerlink" title="4. åŠ¨æ€ç›‘å¬æ»šåŠ¨çŠ¶æ€"></a>4. åŠ¨æ€ç›‘å¬æ»šåŠ¨çŠ¶æ€</h3><p>ä½ å¯ä»¥é€šè¿‡ <code>AppBarLayout.OnOffsetChangedListener</code> æ¥ç›‘å¬ <code>AppBarLayout</code> çš„æ»šåŠ¨åç§»é‡ï¼Œä»è€Œæ‰§è¡Œç‰¹å®šæ“ä½œï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">val appBarLayout = findViewById&lt;AppBarLayout&gt;(R.id.app_bar_layout)</span><br><span class="line">appBarLayout.addOnOffsetChangedListener(object : AppBarLayout.OnOffsetChangedListener &#123;</span><br><span class="line">    override fun onOffsetChanged(appBarLayout: AppBarLayout, verticalOffset: Int) &#123;</span><br><span class="line">        if (verticalOffset == 0) &#123;</span><br><span class="line">            // å±•å¼€</span><br><span class="line">        &#125; else if (Math.abs(verticalOffset) &gt;= appBarLayout.totalScrollRange) &#123;</span><br><span class="line">            // æŠ˜å </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>é€šè¿‡ç›‘å¬ <code>verticalOffset</code>ï¼Œå¯ä»¥åœ¨åº”ç”¨æ å®Œå…¨å±•å¼€æˆ–å®Œå…¨æŠ˜å æ—¶æ‰§è¡Œç›¸åº”çš„æ“ä½œã€‚</p><hr><h2 id="äº”ã€ä½¿ç”¨åœºæ™¯"><a href="#äº”ã€ä½¿ç”¨åœºæ™¯" class="headerlink" title="äº”ã€ä½¿ç”¨åœºæ™¯"></a>äº”ã€ä½¿ç”¨åœºæ™¯</h2><p><code>AppBarLayout</code> çš„ä¸»è¦ä½œç”¨æ˜¯å¤„ç†å¯æ»šåŠ¨åº”ç”¨æ çš„äº¤äº’è¡Œä¸ºï¼Œç‰¹åˆ«é€‚ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š</p><ol><li><strong>ç¤¾äº¤åº”ç”¨</strong>ï¼šç”¨äºå±•ç¤ºç”¨æˆ·å¤´åƒã€ä¸ªäººèµ„æ–™æˆ–çŠ¶æ€ï¼Œæ”¯æŒæ»šåŠ¨æ—¶çš„æŠ˜å å’Œå±•å¼€æ•ˆæœã€‚</li><li><strong>æ–°é—»æˆ–å†…å®¹æµè§ˆåº”ç”¨</strong>ï¼šç”¨äºå±•ç¤ºé¡µé¢æ ‡é¢˜ã€èƒŒæ™¯å›¾ç­‰å†…å®¹ï¼Œæ”¯æŒå’Œæ»šåŠ¨è§†å›¾çš„ååŒæ»šåŠ¨ã€‚</li><li><strong>ç”µå­å•†åŠ¡åº”ç”¨</strong>ï¼šç”¨äºå±•ç¤ºå•†å“ä¿¡æ¯æˆ–äº§å“å±•ç¤ºï¼Œæä¾›æ›´åŠ å¸å¼•çœ¼çƒçš„é¡¶éƒ¨åº”ç”¨æ ã€‚</li></ol><hr><h2 id="å…­ã€æ€»ç»“"><a href="#å…­ã€æ€»ç»“" class="headerlink" title="å…­ã€æ€»ç»“"></a>å…­ã€æ€»ç»“</h2><p><code>AppBarLayout</code> æ˜¯ Android Material Design ä¸­ä¸€ä¸ªé‡è¦çš„å¸ƒå±€ç»„ä»¶ï¼Œå®ƒæä¾›äº†åº”ç”¨æ çš„é«˜åº¦è‡ªå®šä¹‰ã€æŠ˜å å’Œå±•å¼€åŠ¨ç”»ã€ä»¥åŠä¸æ»šåŠ¨è§†å›¾çš„äº¤äº’ã€‚ç»“åˆ <code>CollapsingToolbarLayout</code> å’Œå…¶ä»–æ§ä»¶ï¼Œå¼€å‘è€…å¯ä»¥å®ç°å¤æ‚ä¸”å¯Œæœ‰åŠ¨æ„Ÿçš„é¡¶éƒ¨åŒºåŸŸï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚</p><h3 id="ä¸»è¦ä¼˜ç‚¹ï¼š"><a href="#ä¸»è¦ä¼˜ç‚¹ï¼š" class="headerlink" title="ä¸»è¦ä¼˜ç‚¹ï¼š"></a>ä¸»è¦ä¼˜ç‚¹ï¼š</h3><ul><li>æä¾›çµæ´»çš„æ»šåŠ¨è¡Œä¸ºï¼Œæ”¯æŒä¸å…¶ä»–è§†å›¾çš„ååŒæ»šåŠ¨ã€‚</li><li>å†…ç½®æ”¯æŒ Material Design é£æ ¼ï¼Œç¬¦åˆç°ä»£ Android åº”ç”¨è®¾è®¡è§„èŒƒã€‚</li><li>æ”¯æŒä¸ <code>CollapsingToolbarLayout</code> é…åˆä½¿ç”¨ï¼Œå®ç°æ›´åŠ ä¸°å¯Œçš„äº¤äº’æ•ˆæœã€‚</li></ul><p><code>AppBarLayout</code> æ˜¯æ„å»ºç°ä»£åŒ–ã€äº’åŠ¨æ€§å¼ºçš„ Android åº”ç”¨ä¸­ä¸å¯æˆ–ç¼ºçš„å¸ƒå±€ç»„ä»¶ï¼Œå®ƒå¸®åŠ©å¼€å‘è€…è½»æ¾å®ç°æŠ˜å å¼åº”ç”¨æ ä»¥åŠå…¶ä»–å¤æ‚çš„åŠ¨ç”»æ•ˆæœã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“å¼€å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MaterialCardViewç”¨æ³•è¯¦è§£</title>
      <link href="/2025/04/04/MateriaCardView%E7%94%A8%E6%B3%95%E8%AF%A6%E8%A7%A3/"/>
      <url>/2025/04/04/MateriaCardView%E7%94%A8%E6%B3%95%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h2><p><code>MaterialCardView</code> æ˜¯ Android Material Components åº“ä¸­çš„ä¸€ä¸ªè§†å›¾æ§ä»¶ï¼Œå®ƒåŸºäº <code>CardView</code> è¿›è¡Œäº†å¢å¼ºï¼ŒåŠ å…¥äº†æ›´å¤š Material Design é£æ ¼çš„ç‰¹æ€§ï¼Œä½¿å…¶æ›´é€‚åˆç°ä»£ Android åº”ç”¨çš„è®¾è®¡è¦æ±‚ã€‚<code>MaterialCardView</code> æä¾›äº†ç®€æ´çš„å¡ç‰‡å¼ç•Œé¢ï¼Œèƒ½å¤Ÿæ–¹ä¾¿åœ°å®ç°åœ†è§’ã€é˜´å½±ã€èƒŒæ™¯ç­‰æ•ˆæœï¼Œä»è€Œå¸®åŠ©å¼€å‘è€…æ„å»ºæ›´åŠ ç¾è§‚ã€æ˜“äºäº¤äº’çš„ UI å…ƒç´ ã€‚</p><p>ä¸ <code>CardView</code> ç›¸æ¯”ï¼Œ<code>MaterialCardView</code> æ”¯æŒæ›´å¤šçš„åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼š</p><ul><li><strong>å½¢çŠ¶</strong>ï¼šæ”¯æŒæ›´å¤æ‚çš„å½¢çŠ¶ï¼Œé™¤äº†åœ†è§’å¤–ï¼Œè¿˜æ”¯æŒè‡ªå®šä¹‰çš„å½¢çŠ¶å’Œé˜´å½±æ•ˆæœã€‚</li><li><strong>èƒŒæ™¯</strong>ï¼šå¯ä»¥è®¾ç½®ä¸èƒŒæ™¯ç›¸å…³çš„æ›´å¤šå±æ€§ã€‚</li><li><strong>Ripple æ•ˆæœ</strong>ï¼šå†…ç½® Material Design é£æ ¼çš„æ°´æ³¢çº¹ç‚¹å‡»æ•ˆæœã€‚</li></ul><p><code>MaterialCardView</code> é€‚åˆç”¨äºå±•ç¤ºå†…å®¹å¡ç‰‡ã€åˆ—è¡¨é¡¹ã€ç…§ç‰‡ã€äº§å“å±•ç¤ºç­‰ï¼Œå°¤å…¶æ˜¯éœ€è¦åœ†è§’å’Œé˜´å½±æ•ˆæœçš„åœºæ™¯ã€‚</p><hr><h2 id="äºŒã€ä¾èµ–ä¸å¯¼å…¥"><a href="#äºŒã€ä¾èµ–ä¸å¯¼å…¥" class="headerlink" title="äºŒã€ä¾èµ–ä¸å¯¼å…¥"></a>äºŒã€ä¾èµ–ä¸å¯¼å…¥</h2><p>åœ¨ä½¿ç”¨ <code>MaterialCardView</code> ä¹‹å‰ï¼Œéœ€è¦ç¡®ä¿ä½ çš„é¡¹ç›®å·²ç»åŠ å…¥äº† Material Components åº“çš„ä¾èµ–ã€‚å¯ä»¥åœ¨é¡¹ç›®çš„ <code>build.gradle</code> æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    implementation &#x27;com.google.android.material:material:1.4.0&#x27;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="ä¸‰ã€åŸºæœ¬ä½¿ç”¨"><a href="#ä¸‰ã€åŸºæœ¬ä½¿ç”¨" class="headerlink" title="ä¸‰ã€åŸºæœ¬ä½¿ç”¨"></a>ä¸‰ã€åŸºæœ¬ä½¿ç”¨</h2><h3 id="1-ä½¿ç”¨-XML-å¸ƒå±€"><a href="#1-ä½¿ç”¨-XML-å¸ƒå±€" class="headerlink" title="1. ä½¿ç”¨ XML å¸ƒå±€"></a>1. ä½¿ç”¨ XML å¸ƒå±€</h3><p><code>MaterialCardView</code> çš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•ç±»ä¼¼äº <code>CardView</code>ï¼Œåªéœ€åœ¨å¸ƒå±€æ–‡ä»¶ä¸­æ·»åŠ è¯¥æ§ä»¶ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.google.android.material.card.MaterialCardView</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">    app:cardCornerRadius=&quot;8dp&quot;</span><br><span class="line">    app:cardElevation=&quot;4dp&quot;</span><br><span class="line">    app:strokeColor=&quot;@color/colorAccent&quot;</span><br><span class="line">    app:strokeWidth=&quot;2dp&quot;</span><br><span class="line">    android:padding=&quot;16dp&quot;&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;!-- å¡ç‰‡å†…å®¹ --&gt;</span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:text=&quot;This is a MaterialCardView&quot;</span><br><span class="line">        android:textSize=&quot;16sp&quot;</span><br><span class="line">        android:textColor=&quot;@android:color/black&quot;/&gt;</span><br><span class="line">&lt;/com.google.android.material.card.MaterialCardView&gt;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ XML å¸ƒå±€ä¸­ï¼š</p><ul><li><code>app:cardCornerRadius</code> ç”¨äºè®¾ç½®å¡ç‰‡çš„åœ†è§’åŠå¾„ã€‚</li><li><code>app:cardElevation</code> ç”¨äºè®¾ç½®å¡ç‰‡çš„é˜´å½±æ·±åº¦ï¼Œå½±å“å¡ç‰‡çš„æµ®åŠ¨æ•ˆæœã€‚</li><li><code>app:strokeColor</code> ç”¨äºè®¾ç½®å¡ç‰‡çš„è¾¹æ¡†é¢œè‰²ã€‚</li><li><code>app:strokeWidth</code> ç”¨äºè®¾ç½®å¡ç‰‡è¾¹æ¡†çš„å®½åº¦ã€‚</li><li><code>android:padding</code> ç”¨äºè®¾ç½®å¡ç‰‡å†…è¾¹è·ã€‚</li></ul><h3 id="2-åœ¨ä»£ç ä¸­ä½¿ç”¨"><a href="#2-åœ¨ä»£ç ä¸­ä½¿ç”¨" class="headerlink" title="2. åœ¨ä»£ç ä¸­ä½¿ç”¨"></a>2. åœ¨ä»£ç ä¸­ä½¿ç”¨</h3><p>ä½ ä¹Ÿå¯ä»¥åœ¨ Java æˆ– Kotlin ä»£ç ä¸­åŠ¨æ€åˆ›å»ºå’Œè®¾ç½® <code>MaterialCardView</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">val materialCardView = MaterialCardView(this).apply &#123;</span><br><span class="line">    layoutParams = ViewGroup.LayoutParams(</span><br><span class="line">        ViewGroup.LayoutParams.MATCH_PARENT, </span><br><span class="line">        ViewGroup.LayoutParams.WRAP_CONTENT</span><br><span class="line">    )</span><br><span class="line">    radius = 8f</span><br><span class="line">    elevation = 4f</span><br><span class="line">    setCardBackgroundColor(ContextCompat.getColor(context, R.color.white))</span><br><span class="line">    setContentPadding(16, 16, 16, 16)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">val textView = TextView(this).apply &#123;</span><br><span class="line">    text = &quot;This is a MaterialCardView&quot;</span><br><span class="line">    textSize = 16f</span><br><span class="line">    setTextColor(Color.BLACK)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">materialCardView.addView(textView)</span><br><span class="line">container.addView(materialCardView)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œï¼Œæˆ‘ä»¬é€šè¿‡ä»£ç åˆ›å»ºäº†ä¸€ä¸ª <code>MaterialCardView</code>ï¼Œå¹¶ä¸ºå®ƒè®¾ç½®äº†åœ†è§’ã€é˜´å½±ã€å†…è¾¹è·ç­‰å±æ€§ã€‚</p><hr><h2 id="å››ã€MaterialCardView-ç‰¹æ€§"><a href="#å››ã€MaterialCardView-ç‰¹æ€§" class="headerlink" title="å››ã€MaterialCardView ç‰¹æ€§"></a>å››ã€MaterialCardView ç‰¹æ€§</h2><h3 id="1-åœ†è§’å’Œé˜´å½±"><a href="#1-åœ†è§’å’Œé˜´å½±" class="headerlink" title="1. åœ†è§’å’Œé˜´å½±"></a>1. åœ†è§’å’Œé˜´å½±</h3><p><code>MaterialCardView</code> é€šè¿‡ <code>app:cardCornerRadius</code> å’Œ <code>app:cardElevation</code> å±æ€§æä¾›äº†åœ†è§’å’Œé˜´å½±æ•ˆæœï¼Œé€‚ç”¨äºå¤§å¤šæ•°éœ€è¦å¡ç‰‡é£æ ¼çš„ UI å…ƒç´ ã€‚ä¾‹å¦‚ï¼Œå¸¦æœ‰åœ†è§’å’Œé˜´å½±çš„å¡ç‰‡å¯ä»¥ç”¨äºå•†å“åˆ—è¡¨ã€ç”¨æˆ·ä¿¡æ¯å±•ç¤ºç­‰åœºæ™¯ã€‚</p><ul><li><strong>åœ†è§’</strong>ï¼šé€šè¿‡ <code>cardCornerRadius</code> è®¾ç½®åœ†è§’åŠå¾„ï¼Œä½¿å¾—å¡ç‰‡çš„è§’è½å‘ˆç°åœ†å½¢æ•ˆæœã€‚</li><li><strong>é˜´å½±</strong>ï¼šé€šè¿‡ <code>cardElevation</code> è®¾ç½®é˜´å½±çš„æ·±åº¦ï¼Œå½±å“å¡ç‰‡ä¸èƒŒæ™¯çš„åˆ†ç¦»æ„Ÿï¼Œæå‡è§†è§‰æ•ˆæœã€‚</li></ul><h3 id="2-èƒŒæ™¯ä¸è¾¹æ¡†"><a href="#2-èƒŒæ™¯ä¸è¾¹æ¡†" class="headerlink" title="2. èƒŒæ™¯ä¸è¾¹æ¡†"></a>2. èƒŒæ™¯ä¸è¾¹æ¡†</h3><p><code>MaterialCardView</code> æ”¯æŒè®¾ç½®èƒŒæ™¯è‰²å’Œè¾¹æ¡†æ ·å¼ï¼Œå¯ä»¥ä½¿å¡ç‰‡çœ‹èµ·æ¥æ›´å…·å±‚æ¬¡æ„Ÿã€‚ä½ å¯ä»¥é€šè¿‡ <code>setCardBackgroundColor()</code> æ–¹æ³•è®¾ç½®å¡ç‰‡çš„èƒŒæ™¯é¢œè‰²ï¼Œæˆ–è€…é€šè¿‡ <code>app:strokeColor</code> å’Œ <code>app:strokeWidth</code> è®¾ç½®è¾¹æ¡†çš„é¢œè‰²å’Œå®½åº¦ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.google.android.material.card.MaterialCardView</span><br><span class="line">    app:strokeColor=&quot;@color/colorPrimary&quot;</span><br><span class="line">    app:strokeWidth=&quot;2dp&quot;</span><br><span class="line">    app:cardBackgroundColor=&quot;@android:color/white&quot;</span><br><span class="line">    app:cardCornerRadius=&quot;12dp&quot;</span><br><span class="line">    app:cardElevation=&quot;6dp&quot; /&gt;</span><br></pre></td></tr></table></figure><h3 id="3-æ°´æ³¢çº¹æ•ˆæœï¼ˆRippleï¼‰"><a href="#3-æ°´æ³¢çº¹æ•ˆæœï¼ˆRippleï¼‰" class="headerlink" title="3. æ°´æ³¢çº¹æ•ˆæœï¼ˆRippleï¼‰"></a>3. æ°´æ³¢çº¹æ•ˆæœï¼ˆRippleï¼‰</h3><p><code>MaterialCardView</code> å†…ç½®äº† Material Design çš„æ°´æ³¢çº¹æ•ˆæœï¼ˆRippleï¼‰ï¼Œå³ç‚¹å‡»æ—¶å¡ç‰‡ä¼šæ˜¾ç¤ºæ°´æ³¢çº¹æ‰©å±•çš„åŠ¨ç”»æ•ˆæœã€‚è¿™ç§æ•ˆæœå¢å¼ºäº†ç”¨æˆ·äº¤äº’æ„Ÿï¼Œä½¿å¾—åº”ç”¨çœ‹èµ·æ¥æ›´åŠ ç°ä»£åŒ–ã€‚</p><p><code>MaterialCardView</code> çš„æ°´æ³¢çº¹æ•ˆæœé»˜è®¤å¯ç”¨ï¼Œä½ å¯ä»¥é€šè¿‡ <code>android:clickable</code> å±æ€§æ§åˆ¶ç‚¹å‡»äº‹ä»¶çš„å“åº”ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.google.android.material.card.MaterialCardView</span><br><span class="line">    android:clickable=&quot;true&quot;</span><br><span class="line">    android:focusable=&quot;true&quot;</span><br><span class="line">    app:rippleColor=&quot;@color/ripple_color&quot;</span><br><span class="line">    ... /&gt;</span><br></pre></td></tr></table></figure><p>ä½ å¯ä»¥ä½¿ç”¨ <code>app:rippleColor</code> å±æ€§è‡ªå®šä¹‰æ°´æ³¢çº¹çš„é¢œè‰²ã€‚</p><h3 id="4-åŠ¨æ€å¯ç”¨å’Œç¦ç”¨"><a href="#4-åŠ¨æ€å¯ç”¨å’Œç¦ç”¨" class="headerlink" title="4. åŠ¨æ€å¯ç”¨å’Œç¦ç”¨"></a>4. åŠ¨æ€å¯ç”¨å’Œç¦ç”¨</h3><p><code>MaterialCardView</code> çš„å¯ç”¨ä¸ç¦ç”¨çŠ¶æ€ä¸å…¶ä»–è§†å›¾ç»„ä»¶ç±»ä¼¼ï¼Œå¯ä»¥ä½¿ç”¨ <code>setEnabled()</code> æ–¹æ³•æ§åˆ¶ã€‚ç¦ç”¨æ—¶ï¼Œå¡ç‰‡çš„ç‚¹å‡»å’Œäº¤äº’æ•ˆæœéƒ½ä¼šå¤±æ•ˆã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">materialCardView.isEnabled = false</span><br></pre></td></tr></table></figure><h3 id="5-è®¾ç½®ç‚¹å‡»ç›‘å¬å™¨"><a href="#5-è®¾ç½®ç‚¹å‡»ç›‘å¬å™¨" class="headerlink" title="5. è®¾ç½®ç‚¹å‡»ç›‘å¬å™¨"></a>5. è®¾ç½®ç‚¹å‡»ç›‘å¬å™¨</h3><p>ä½ å¯ä»¥ä¸º <code>MaterialCardView</code> è®¾ç½®ç‚¹å‡»ç›‘å¬å™¨ï¼Œå½“å¡ç‰‡è¢«ç‚¹å‡»æ—¶è§¦å‘æŸäº›æ“ä½œï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">materialCardView.setOnClickListener &#123;</span><br><span class="line">    Toast.makeText(this, &quot;Card Clicked&quot;, Toast.LENGTH_SHORT).show()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="äº”ã€ä½¿ç”¨åœºæ™¯"><a href="#äº”ã€ä½¿ç”¨åœºæ™¯" class="headerlink" title="äº”ã€ä½¿ç”¨åœºæ™¯"></a>äº”ã€ä½¿ç”¨åœºæ™¯</h2><p><code>MaterialCardView</code> å¹¿æ³›åº”ç”¨äºéœ€è¦è§†è§‰å±‚æ¬¡å’Œäº¤äº’æ•ˆæœçš„åœºæ™¯ã€‚ä¾‹å¦‚ï¼š</p><ol><li><strong>å•†å“å¡ç‰‡</strong>ï¼šç”¨äºå±•ç¤ºå•†å“ä¿¡æ¯çš„å¡ç‰‡ï¼Œå¯ä»¥ç»“åˆå›¾ç‰‡ã€ä»·æ ¼ã€å•†å“åç§°ç­‰å†…å®¹ã€‚</li><li><strong>ç”¨æˆ·å¡ç‰‡</strong>ï¼šå±•ç¤ºç”¨æˆ·å¤´åƒã€æ˜µç§°ç­‰ä¿¡æ¯ï¼Œæ”¯æŒç‚¹å‡»è¿›å…¥è¯¦ç»†é¡µé¢ã€‚</li><li><strong>ä¿¡æ¯å±•ç¤º</strong>ï¼šç”¨äºå±•ç¤ºæŸäº›æç¤ºä¿¡æ¯æˆ–æ“ä½œæŒ‰é’®ï¼Œå¡ç‰‡å¼è®¾è®¡èƒ½å¤Ÿä½¿ç•Œé¢æ›´åŠ æ¸…æ™°ã€‚</li><li><strong>åˆ—è¡¨é¡¹</strong>ï¼šåœ¨åˆ—è¡¨ä¸­ä½¿ç”¨ <code>MaterialCardView</code> æ¥å±•ç¤ºæ¯ä¸€é¡¹ï¼Œæä¾›äº¤äº’æ€§ã€‚</li></ol><hr><h2 id="å…­ã€æ€»ç»“"><a href="#å…­ã€æ€»ç»“" class="headerlink" title="å…­ã€æ€»ç»“"></a>å…­ã€æ€»ç»“</h2><p><code>MaterialCardView</code> æ˜¯ Android Material Design åº“ä¸­çš„é‡è¦ç»„ä»¶ï¼Œå®ƒä¸ºå¼€å‘è€…æä¾›äº†æ›´ä¸ºä¸°å¯Œå’Œç°ä»£åŒ–çš„å¡ç‰‡å¼ç•Œé¢è®¾è®¡å·¥å…·ã€‚é€šè¿‡æ”¯æŒåœ†è§’ã€é˜´å½±ã€è¾¹æ¡†ã€èƒŒæ™¯ä»¥åŠæ°´æ³¢çº¹æ•ˆæœï¼Œ<code>MaterialCardView</code> ä½¿å¾— UI å…ƒç´ çš„è¡¨ç°æ›´åŠ ç”ŸåŠ¨ä¸çµæ´»ã€‚</p><ul><li><strong>ä¼˜åŠ¿</strong>ï¼š<ul><li>ä¸°å¯Œçš„ Material Design ç‰¹æ€§ï¼Œæå‡ç•Œé¢è§†è§‰æ•ˆæœã€‚</li><li>è‡ªå¸¦æ°´æ³¢çº¹ç‚¹å‡»æ•ˆæœï¼Œå¢å¼ºç”¨æˆ·ä½“éªŒã€‚</li><li>å¯ä»¥éå¸¸æ–¹ä¾¿åœ°ä¸å…¶ä»–è§†å›¾ç»„ä»¶ï¼ˆå¦‚ <code>RecyclerView</code>ã€<code>TextView</code> ç­‰ï¼‰ç»“åˆä½¿ç”¨ï¼Œæ„å»ºæ›´åŠ å¤æ‚çš„ UIã€‚</li></ul></li><li><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼š<ul><li>å•†å“å¡ç‰‡ã€ç”¨æˆ·å¡ç‰‡ã€åˆ—è¡¨é¡¹ç­‰å¤šç§åœºæ™¯ã€‚</li><li>æä¾›ç®€æ´ã€ç°ä»£ã€äº¤äº’æ€§å¼ºçš„ç•Œé¢è®¾è®¡ã€‚</li></ul></li></ul><p><code>MaterialCardView</code> æ˜¯ç°ä»£ Android åº”ç”¨è®¾è®¡ä¸­ä¸å¯æˆ–ç¼ºçš„æ§ä»¶ä¹‹ä¸€ï¼Œé€šè¿‡å®ƒï¼Œå¼€å‘è€…èƒ½å¤Ÿåˆ›å»ºå‡ºæ›´åŠ ç¾è§‚ä¸”æ˜“äºäº¤äº’çš„ç”¨æˆ·ç•Œé¢ã€‚å¦‚æœä½ æ­£åœ¨æ„å»º Material Design é£æ ¼çš„åº”ç”¨ï¼Œä¸å¦¨å°è¯•ä½¿ç”¨ <code>MaterialCardView</code>ï¼Œå®ƒå°†å¸®åŠ©ä½ æ‰“é€ æ›´åŠ å‡ºè‰²çš„ UIã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“å¼€å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CoordinatorLayoutç”¨æ³•è¯¦è§£</title>
      <link href="/2025/04/04/CoordinatorLayout%E7%94%A8%E6%B3%95%E8%AF%A6%E8%A7%A3/"/>
      <url>/2025/04/04/CoordinatorLayout%E7%94%A8%E6%B3%95%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h2><p><code>CoordinatorLayout</code> æ˜¯ Android æ”¯æŒåº“ï¼ˆSupport Libraryï¼‰æä¾›çš„ä¸€ä¸ªé«˜çº§å¸ƒå±€å®¹å™¨ï¼Œå®ƒç»§æ‰¿è‡ª <code>FrameLayout</code>ï¼Œæ˜¯ä¸€ä¸ªå¼ºå¤§çš„å¸ƒå±€å®¹å™¨ï¼Œèƒ½å¤Ÿåè°ƒå¹¶æ”¯æŒæ›´å¤æ‚çš„äº¤äº’è®¾è®¡ï¼Œå°¤å…¶æ˜¯åœ¨ Material Design ä¸­ã€‚å®ƒæä¾›äº†ä¸€ç§çµæ´»çš„æ–¹å¼æ¥åä½œå¤„ç†å­è§†å›¾ä¹‹é—´çš„è¡Œä¸ºï¼Œå¦‚ä¸ <code>AppBarLayout</code>ã€<code>FloatingActionButton</code>ã€<code>Snackbar</code> ç­‰ç»„ä»¶çš„äº¤äº’æ•ˆæœã€‚</p><p><code>CoordinatorLayout</code> ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ç§â€œåè°ƒâ€å„ä¸ªè§†å›¾è¡Œä¸ºçš„æœºåˆ¶ï¼Œå¯ä»¥é€šè¿‡è‡ªå®šä¹‰æˆ–ç°æˆçš„è¡Œä¸ºï¼ˆ<code>Behavior</code>ï¼‰æ¥æ§åˆ¶å­è§†å›¾çš„æ»‘åŠ¨ã€åŠ¨ç”»å’Œå“åº”ã€‚</p><hr><h2 id="äºŒã€CoordinatorLayout-ç‰¹æ€§"><a href="#äºŒã€CoordinatorLayout-ç‰¹æ€§" class="headerlink" title="äºŒã€CoordinatorLayout ç‰¹æ€§"></a>äºŒã€CoordinatorLayout ç‰¹æ€§</h2><p><code>CoordinatorLayout</code> æä¾›äº†ä»¥ä¸‹å‡ ä¸ªé‡è¦ç‰¹æ€§ï¼š</p><ol><li><strong>å“åº”æ»šåŠ¨å’Œæ‰‹åŠ¿</strong>ï¼š<code>CoordinatorLayout</code> èƒ½å¤Ÿæ•æ‰å­è§†å›¾çš„æ»šåŠ¨å’Œæ‰‹åŠ¿äº‹ä»¶ï¼Œå¹¶æ ¹æ®éœ€è¦è°ƒæ•´å¸ƒå±€ä½ç½®ã€‚</li><li><strong>å­è§†å›¾è¡Œä¸ºåè°ƒ</strong>ï¼šå¯ä»¥è®©ä¸åŒçš„è§†å›¾ï¼ˆå¦‚ <code>AppBarLayout</code> å’Œ <code>FloatingActionButton</code>ï¼‰ä¹‹é—´åè°ƒè¿åŠ¨ï¼Œç¡®ä¿ç•Œé¢ä¸€è‡´æ€§å’Œæµç•…çš„è¿‡æ¸¡æ•ˆæœã€‚</li><li><strong>æ”¯æŒè‡ªå®šä¹‰è¡Œä¸º</strong>ï¼šé€šè¿‡è‡ªå®šä¹‰ <code>Behavior</code> ç±»ï¼Œå¯ä»¥éå¸¸çµæ´»åœ°æ§åˆ¶è§†å›¾ä¹‹é—´çš„äº¤äº’æ–¹å¼ã€‚</li><li><strong>Material Design æ”¯æŒ</strong>ï¼šåè°ƒ <code>AppBarLayout</code>ã€<code>Toolbar</code>ã€<code>FloatingActionButton</code> ç­‰ Material Design ç»„ä»¶çš„è¡Œä¸ºã€‚</li></ol><hr><h2 id="ä¸‰ã€CoordinatorLayout-çš„åŸºæœ¬ä½¿ç”¨"><a href="#ä¸‰ã€CoordinatorLayout-çš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="ä¸‰ã€CoordinatorLayout çš„åŸºæœ¬ä½¿ç”¨"></a>ä¸‰ã€CoordinatorLayout çš„åŸºæœ¬ä½¿ç”¨</h2><h3 id="1-ä¾èµ–"><a href="#1-ä¾èµ–" class="headerlink" title="1. ä¾èµ–"></a>1. ä¾èµ–</h3><p>é¦–å…ˆï¼Œéœ€è¦åœ¨ <code>build.gradle</code> æ–‡ä»¶ä¸­åŠ å…¥ä¾èµ–ï¼ˆå¦‚æœè¿˜æ²¡æœ‰åŠ å…¥çš„è¯ï¼‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    implementation &#x27;com.google.android.material:material:1.4.0&#x27;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-CoordinatorLayout-ç»“æ„"><a href="#2-CoordinatorLayout-ç»“æ„" class="headerlink" title="2. CoordinatorLayout ç»“æ„"></a>2. CoordinatorLayout ç»“æ„</h3><p><code>CoordinatorLayout</code> æ˜¯ä¸€ä¸ªå®¹å™¨å¸ƒå±€ï¼Œæ‰€æœ‰å…¶ä»–å­è§†å›¾éƒ½å¯ä»¥æ”¾ç½®åœ¨å…¶å†…ã€‚é€šå¸¸ï¼Œ<code>CoordinatorLayout</code> ä¸­çš„å­è§†å›¾ä¼šæ¶‰åŠåˆ°ä¸€äº›åè°ƒè¡Œä¸ºï¼Œä¾‹å¦‚ä¸ <code>AppBarLayout</code> ä¸€èµ·æ»šåŠ¨ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;androidx.coordinatorlayout.widget.CoordinatorLayout</span><br><span class="line">    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- AppBarLayout ç”¨äºå®ç°å¯æ»šåŠ¨çš„ Toolbar å’Œå…¶ä»–ç»„ä»¶ --&gt;</span><br><span class="line">    &lt;com.google.android.material.appbar.AppBarLayout</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;com.google.android.material.appbar.CollapsingToolbarLayout</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            app:layout_scrollFlags=&quot;scroll|exitUntilCollapsed&quot;&gt;</span><br><span class="line"></span><br><span class="line">            &lt;androidx.appcompat.widget.Toolbar</span><br><span class="line">                android:id=&quot;@+id/toolbar&quot;</span><br><span class="line">                android:layout_width=&quot;match_parent&quot;</span><br><span class="line">                android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">                android:title=&quot;CoordinatorLayout Example&quot;</span><br><span class="line">                android:theme=&quot;@style/ThemeOverlay.MaterialComponents.ActionBar&quot;/&gt;</span><br><span class="line">        &lt;/com.google.android.material.appbar.CollapsingToolbarLayout&gt;</span><br><span class="line">    &lt;/com.google.android.material.appbar.AppBarLayout&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- ä¸»ä½“å†…å®¹åŒºåŸŸ --&gt;</span><br><span class="line">    &lt;androidx.recyclerview.widget.RecyclerView</span><br><span class="line">        android:id=&quot;@+id/recycler_view&quot;</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;match_parent&quot;</span><br><span class="line">        app:layout_behavior=&quot;@string/appbar_scrolling_view_behavior&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- æ‚¬æµ®çš„ FloatingActionButton --&gt;</span><br><span class="line">    &lt;com.google.android.material.floatingactionbutton.FloatingActionButton</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_gravity=&quot;end|bottom&quot;</span><br><span class="line">        android:src=&quot;@drawable/ic_add&quot;</span><br><span class="line">        app:layout_behavior=&quot;com.google.android.material.behavior.HideBottomViewOnScrollBehavior&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;/androidx.coordinatorlayout.widget.CoordinatorLayout&gt;</span><br></pre></td></tr></table></figure><h3 id="3-å…³é”®ç»„ä»¶"><a href="#3-å…³é”®ç»„ä»¶" class="headerlink" title="3. å…³é”®ç»„ä»¶"></a>3. å…³é”®ç»„ä»¶</h3><ul><li><strong>AppBarLayout</strong>ï¼šç”¨äºå®ç°å¯æ»šåŠ¨çš„åº”ç”¨æ ï¼Œé€šå¸¸ä¸ <code>Toolbar</code> å’Œ <code>CollapsingToolbarLayout</code> ä¸€èµ·ä½¿ç”¨ï¼Œä»¥å®ç°æŠ˜å æ•ˆæœã€‚</li><li><strong>FloatingActionButton</strong>ï¼šé€šå¸¸ä¼šæ”¾ç½®åœ¨å±å¹•çš„å³ä¸‹è§’ï¼Œ<code>CoordinatorLayout</code> å¯ä»¥åè°ƒå…¶åœ¨æ»šåŠ¨è§†å›¾ä¸­çš„è¡Œä¸ºã€‚</li><li><strong>RecyclerView</strong>ï¼šå¯ä»¥ä¸ <code>AppBarLayout</code> åä½œï¼Œé…åˆ <code>layout_behavior</code> å±æ€§å®ç°æ»šåŠ¨ç›‘å¬å’Œäº¤äº’ã€‚</li></ul><hr><h2 id="å››ã€CoordinatorLayout-çš„å…³é”®å±æ€§å’Œæ–¹æ³•"><a href="#å››ã€CoordinatorLayout-çš„å…³é”®å±æ€§å’Œæ–¹æ³•" class="headerlink" title="å››ã€CoordinatorLayout çš„å…³é”®å±æ€§å’Œæ–¹æ³•"></a>å››ã€CoordinatorLayout çš„å…³é”®å±æ€§å’Œæ–¹æ³•</h2><h3 id="1-app-layout-behavior"><a href="#1-app-layout-behavior" class="headerlink" title="1. app:layout_behavior"></a>1. <code>app:layout_behavior</code></h3><p><code>app:layout_behavior</code> å±æ€§ç”¨äºæŒ‡å®šè¯¥è§†å›¾ä¸ <code>CoordinatorLayout</code> ä¸­å…¶ä»–è§†å›¾çš„è¡Œä¸ºã€‚å¸¸è§çš„è¡Œä¸ºç±»åŒ…æ‹¬ï¼š</p><ul><li><code>com.google.android.material.behavior.HideBottomViewOnScrollBehavior</code>ï¼šä½¿åº•éƒ¨è§†å›¾ï¼ˆå¦‚ <code>FloatingActionButton</code>ï¼‰åœ¨æ»šåŠ¨æ—¶éšè—ã€‚</li><li><code>com.google.android.material.appbar.AppBarLayout.ScrollingViewBehavior</code>ï¼šä½¿ <code>RecyclerView</code> æˆ–å…¶ä»–æ»šåŠ¨è§†å›¾ä¸ <code>AppBarLayout</code> ååŒæ»šåŠ¨ã€‚</li></ul><h3 id="2-setBehavior"><a href="#2-setBehavior" class="headerlink" title="2. setBehavior()"></a>2. <code>setBehavior()</code></h3><p>å¯ä»¥é€šè¿‡ <code>CoordinatorLayout</code> æä¾›çš„ <code>setBehavior()</code> æ–¹æ³•ä¸ºå­è§†å›¾è®¾ç½®è¡Œä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">val coordinatorLayout: CoordinatorLayout = findViewById(R.id.coordinator_layout)</span><br><span class="line">val fab: FloatingActionButton = findViewById(R.id.fab)</span><br><span class="line">val params = fab.layoutParams as CoordinatorLayout.LayoutParams</span><br><span class="line">params.behavior = HideBottomViewOnScrollBehavior()</span><br><span class="line">fab.layoutParams = params</span><br></pre></td></tr></table></figure><h3 id="3-è‡ªå®šä¹‰-Behavior"><a href="#3-è‡ªå®šä¹‰-Behavior" class="headerlink" title="3. è‡ªå®šä¹‰ Behavior"></a>3. è‡ªå®šä¹‰ Behavior</h3><p>é€šè¿‡ç»§æ‰¿ <code>CoordinatorLayout.Behavior</code> ç±»ï¼Œå¯ä»¥åˆ›å»ºè‡ªå·±çš„è§†å›¾è¡Œä¸ºã€‚è¡Œä¸ºç±»ä¸»è¦é‡å†™ä»¥ä¸‹æ–¹æ³•ï¼š</p><ul><li><code>onNestedScroll()</code></li><li><code>onInterceptTouchEvent()</code></li><li><code>onLayoutChild()</code></li></ul><p>ä¾‹å¦‚ï¼Œä¸‹é¢çš„ä»£ç å®ç°äº†ä¸€ä¸ª <code>Behavior</code>ï¼Œå®ƒè®© <code>FloatingActionButton</code> åœ¨æ»šåŠ¨æ—¶éšè—ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">class MyFloatingActionButtonBehavior(context: Context, attrs: AttributeSet) :</span><br><span class="line">    CoordinatorLayout.Behavior&lt;FloatingActionButton&gt;(context, attrs) &#123;</span><br><span class="line"></span><br><span class="line">    override fun onNestedScroll(</span><br><span class="line">        coordinatorLayout: CoordinatorLayout,</span><br><span class="line">        child: FloatingActionButton,</span><br><span class="line">        target: View,</span><br><span class="line">        dx: Int,</span><br><span class="line">        dy: Int,</span><br><span class="line">        consumed: IntArray</span><br><span class="line">    ) &#123;</span><br><span class="line">        if (dy &gt; 0) &#123;</span><br><span class="line">            child.hide() // å‘ä¸‹æ»šåŠ¨æ—¶éšè— FloatingActionButton</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            child.show() // å‘ä¸Šæ»šåŠ¨æ—¶æ˜¾ç¤º FloatingActionButton</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="äº”ã€CoordinatorLayout-å¸¸è§ç”¨æ³•"><a href="#äº”ã€CoordinatorLayout-å¸¸è§ç”¨æ³•" class="headerlink" title="äº”ã€CoordinatorLayout å¸¸è§ç”¨æ³•"></a>äº”ã€CoordinatorLayout å¸¸è§ç”¨æ³•</h2><h3 id="1-ä¸-AppBarLayout-é…åˆä½¿ç”¨"><a href="#1-ä¸-AppBarLayout-é…åˆä½¿ç”¨" class="headerlink" title="1. ä¸ AppBarLayout é…åˆä½¿ç”¨"></a>1. ä¸ <code>AppBarLayout</code> é…åˆä½¿ç”¨</h3><p><code>AppBarLayout</code> æ˜¯ä¸ <code>CoordinatorLayout</code> é…åˆä½¿ç”¨çš„ä¸€ä¸ªå…³é”®ç»„ä»¶ã€‚å®ƒèƒ½å¤Ÿå®ç° <code>Toolbar</code> å’Œå…¶ä»–è§†å›¾çš„æŠ˜å æ•ˆæœã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.google.android.material.appbar.AppBarLayout</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">    app:layout_scrollFlags=&quot;scroll|enterAlways&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;androidx.appcompat.widget.Toolbar</span><br><span class="line">        android:id=&quot;@+id/toolbar&quot;</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;?attr/actionBarSize&quot;</span><br><span class="line">        android:title=&quot;CoordinatorLayout Example&quot;</span><br><span class="line">        android:theme=&quot;@style/ThemeOverlay.MaterialComponents.ActionBar&quot;/&gt;</span><br><span class="line">&lt;/com.google.android.material.appbar.AppBarLayout&gt;</span><br></pre></td></tr></table></figure><h3 id="2-ä¸-FloatingActionButton-é…åˆä½¿ç”¨"><a href="#2-ä¸-FloatingActionButton-é…åˆä½¿ç”¨" class="headerlink" title="2. ä¸ FloatingActionButton é…åˆä½¿ç”¨"></a>2. ä¸ <code>FloatingActionButton</code> é…åˆä½¿ç”¨</h3><p><code>FloatingActionButton</code> å¯ä»¥ä¸ <code>CoordinatorLayout</code> é…åˆï¼Œé€šè¿‡è®¾ç½®è¡Œä¸ºæ¥å®ç°æ›´ä¸°å¯Œçš„äº¤äº’ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ <code>HideBottomViewOnScrollBehavior</code> æ¥åœ¨åˆ—è¡¨æ»šåŠ¨æ—¶éšè— <code>FloatingActionButton</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.google.android.material.floatingactionbutton.FloatingActionButton</span><br><span class="line">    android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">    android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">    android:layout_gravity=&quot;end|bottom&quot;</span><br><span class="line">    android:src=&quot;@drawable/ic_add&quot;</span><br><span class="line">    app:layout_behavior=&quot;com.google.android.material.behavior.HideBottomViewOnScrollBehavior&quot;/&gt;</span><br></pre></td></tr></table></figure><hr><h2 id="å…­ã€æ€»ç»“"><a href="#å…­ã€æ€»ç»“" class="headerlink" title="å…­ã€æ€»ç»“"></a>å…­ã€æ€»ç»“</h2><p><code>CoordinatorLayout</code> æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å¸ƒå±€å®¹å™¨ï¼Œå®ƒèƒ½å¤Ÿåè°ƒå¤šä¸ªè§†å›¾ä¹‹é—´çš„äº¤äº’è¡Œä¸ºï¼Œå°¤å…¶é€‚ç”¨äº Material Design é£æ ¼çš„ UI è®¾è®¡ã€‚é€šè¿‡ä¸ <code>AppBarLayout</code>ã€<code>FloatingActionButton</code> ç­‰ç»„ä»¶çš„ç»“åˆï¼Œå¼€å‘è€…èƒ½å¤Ÿåˆ›å»ºå‡ºæå…·äº¤äº’æ„Ÿçš„ç•Œé¢æ•ˆæœã€‚ä½ å¯ä»¥é€šè¿‡å†…ç½®çš„ <code>Behavior</code> ç±»æˆ–è€…è‡ªå®šä¹‰è¡Œä¸ºæ¥å®ç°å¤æ‚çš„å¸ƒå±€å’ŒåŠ¨ç”»æ•ˆæœï¼Œæå¤§åœ°å¢å¼ºç”¨æˆ·ä½“éªŒã€‚</p><h3 id="ä¸»è¦ä¼˜åŠ¿ï¼š"><a href="#ä¸»è¦ä¼˜åŠ¿ï¼š" class="headerlink" title="ä¸»è¦ä¼˜åŠ¿ï¼š"></a>ä¸»è¦ä¼˜åŠ¿ï¼š</h3><ul><li>æä¾›äº†å¤šç§ä¸è§†å›¾äº¤äº’çš„è¡Œä¸ºã€‚</li><li>èƒ½å¤Ÿç®€åŒ–å¤æ‚çš„å¸ƒå±€åè°ƒï¼Œå°¤å…¶æ˜¯åœ¨åŒ…å« <code>AppBarLayout</code> å’Œ <code>FloatingActionButton</code> ç­‰ç»„ä»¶æ—¶ã€‚</li><li>çµæ´»çš„è‡ªå®šä¹‰è¡Œä¸ºæ”¯æŒï¼Œè®©å¼€å‘è€…å¯ä»¥é’ˆå¯¹åº”ç”¨çš„éœ€æ±‚å®ç°ä¸ªæ€§åŒ–çš„äº¤äº’æ•ˆæœã€‚</li></ul><p><code>CoordinatorLayout</code> æ˜¯ Android ä¸­éå¸¸å®ç”¨çš„å¸ƒå±€å®¹å™¨ï¼Œç‰¹åˆ«é€‚ç”¨äºæ„å»ºç°ä»£åŒ–çš„ç”¨æˆ·ç•Œé¢ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“å¼€å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Snackbarç”¨æ³•è¯¦è§£</title>
      <link href="/2025/04/04/Snackbar%E7%94%A8%E6%B3%95%E8%AF%A6%E8%A7%A3/"/>
      <url>/2025/04/04/Snackbar%E7%94%A8%E6%B3%95%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h2><p><code>Snackbar</code> æ˜¯ Android æä¾›çš„ä¸€ç§ç®€æ´ã€è½»é‡çº§çš„æç¤ºæ¡†ï¼Œç”¨äºåœ¨å±å¹•åº•éƒ¨å±•ç¤ºçŸ­æš‚çš„ä¿¡æ¯æç¤ºã€‚å®ƒçš„è®¾è®¡åˆè¡·æ˜¯ä¸ºäº†æä¾›ä¸€ç§æ¯” <code>Toast</code> æ›´å…·äº’åŠ¨æ€§å’Œçµæ´»æ€§çš„æç¤ºæ–¹å¼ã€‚ä¸ <code>Toast</code> çš„é™æ€æç¤ºä¸åŒï¼Œ<code>Snackbar</code> æä¾›äº†æ›´å¤šçš„äº¤äº’åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼šæ”¯æŒæ’¤é”€æ“ä½œã€è‡ªåŠ¨éšè—å’Œæ‰‹åŠ¨å…³é—­ã€‚</p><p><code>Snackbar</code> é€‚ç”¨äºå±•ç¤ºçŸ­æœŸé€šçŸ¥ï¼Œå°¤å…¶æ˜¯éœ€è¦ç”¨æˆ·è¿›è¡Œäº¤äº’ï¼ˆå¦‚æ’¤é”€æ“ä½œï¼‰çš„åœºæ™¯ã€‚</p><hr><h2 id="äºŒã€Snackbar-ä¸-Toast-çš„å¯¹æ¯”"><a href="#äºŒã€Snackbar-ä¸-Toast-çš„å¯¹æ¯”" class="headerlink" title="äºŒã€Snackbar ä¸ Toast çš„å¯¹æ¯”"></a>äºŒã€Snackbar ä¸ Toast çš„å¯¹æ¯”</h2><table><thead><tr><th>ç‰¹æ€§</th><th>Snackbar</th><th>Toast</th></tr></thead><tbody><tr><td><strong>æ˜¾ç¤ºä½ç½®</strong></td><td>å±å¹•åº•éƒ¨</td><td>å±å¹•ä¸­é—´æˆ–åº•éƒ¨</td></tr><tr><td><strong>æ˜¾ç¤ºæ—¶é—´</strong></td><td>å¯å®šåˆ¶ï¼ˆä¸€èˆ¬æ˜¾ç¤º 2-3 ç§’ï¼‰</td><td>è‡ªåŠ¨æ¶ˆå¤±ï¼ˆä¸€èˆ¬ 2-3 ç§’ï¼‰</td></tr><tr><td><strong>å¯äº¤äº’æ€§</strong></td><td>æ”¯æŒæŒ‰é’®æ“ä½œï¼ˆå¦‚æ’¤é”€ï¼‰</td><td>æ— æ³•äº¤äº’</td></tr><tr><td><strong>å¯ä»¥è®¾ç½®è‡ªå®šä¹‰åŠ¨ä½œ</strong></td><td>å¯ä»¥æ·»åŠ æ’¤é”€æŒ‰é’®ã€åŠ¨ä½œ</td><td>åªèƒ½æ˜¾ç¤ºæ–‡æœ¬</td></tr></tbody></table><p><code>Snackbar</code> çš„ä¸»è¦ä¼˜åŠ¿åœ¨äºæ”¯æŒäº¤äº’æ“ä½œå’Œè‡ªå®šä¹‰åŠ¨ä½œï¼Œæ¯”å¦‚ç”¨æˆ·å¯ä»¥ç‚¹å‡»â€œæ’¤é”€â€æŒ‰é’®æ’¤å›æŸä¸ªæ“ä½œï¼Œè€Œ <code>Toast</code> ä»…æ˜¯å±•ç¤ºæç¤ºä¿¡æ¯å¹¶è‡ªåŠ¨æ¶ˆå¤±ã€‚</p><hr><h2 id="ä¸‰ã€Snackbar-åŸºæœ¬ä½¿ç”¨"><a href="#ä¸‰ã€Snackbar-åŸºæœ¬ä½¿ç”¨" class="headerlink" title="ä¸‰ã€Snackbar åŸºæœ¬ä½¿ç”¨"></a>ä¸‰ã€Snackbar åŸºæœ¬ä½¿ç”¨</h2><h3 id="1-å¯¼å…¥å¿…è¦çš„ä¾èµ–"><a href="#1-å¯¼å…¥å¿…è¦çš„ä¾èµ–" class="headerlink" title="1. å¯¼å…¥å¿…è¦çš„ä¾èµ–"></a>1. å¯¼å…¥å¿…è¦çš„ä¾èµ–</h3><p>åœ¨ä½¿ç”¨ <code>Snackbar</code> ä¹‹å‰ï¼Œé¦–å…ˆéœ€è¦ç¡®ä¿ä½ çš„é¡¹ç›®å·²ç»åŒ…å«äº† Material Components åº“ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gradleå¤åˆ¶ç¼–è¾‘dependencies &#123;</span><br><span class="line">    implementation &#x27;com.google.android.material:material:1.4.0&#x27;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-æ˜¾ç¤ºç®€å•çš„-Snackbar"><a href="#2-æ˜¾ç¤ºç®€å•çš„-Snackbar" class="headerlink" title="2. æ˜¾ç¤ºç®€å•çš„ Snackbar"></a>2. æ˜¾ç¤ºç®€å•çš„ Snackbar</h3><p>æœ€ç®€å•çš„ Snackbar åªéœ€è¦ä¼ å…¥è¦æ˜¾ç¤ºçš„æ–‡æœ¬ï¼Œå®ƒä¼šè‡ªåŠ¨æ˜¾ç¤ºåœ¨å±å¹•åº•éƒ¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">val rootView: View = findViewById(R.id.root_view)</span><br><span class="line">Snackbar.make(rootView, &quot;æ“ä½œæˆåŠŸ&quot;, Snackbar.LENGTH_SHORT).show()</span><br></pre></td></tr></table></figure><ul><li><strong>å‚æ•°è§£é‡Š</strong>ï¼š<ul><li><code>rootView</code>ï¼š<code>Snackbar</code> å°†ä¾é™„åœ¨è¿™ä¸ªè§†å›¾ä¸Šï¼Œé€šå¸¸é€‰æ‹©æ ¹è§†å›¾ï¼ˆ<code>rootView</code>ï¼‰ä½œä¸ºå®¹å™¨ã€‚</li><li><code>&quot;æ“ä½œæˆåŠŸ&quot;</code>ï¼šè¦å±•ç¤ºçš„æ–‡æœ¬ã€‚</li><li><code>Snackbar.LENGTH_SHORT</code>ï¼šæ˜¾ç¤ºçš„æ—¶é•¿ã€‚ä¹Ÿå¯ä»¥é€‰æ‹© <code>LENGTH_LONG</code> æˆ– <code>LENGTH_INDEFINITE</code>ï¼ˆæ— é™æ˜¾ç¤ºï¼Œç›´åˆ°ç”¨æˆ·ä¸»åŠ¨æ¶ˆå¤±ï¼‰ã€‚</li></ul></li></ul><hr><h2 id="å››ã€Snackbar-è¿›é˜¶ä½¿ç”¨"><a href="#å››ã€Snackbar-è¿›é˜¶ä½¿ç”¨" class="headerlink" title="å››ã€Snackbar è¿›é˜¶ä½¿ç”¨"></a>å››ã€Snackbar è¿›é˜¶ä½¿ç”¨</h2><h3 id="1-æ·»åŠ æ“ä½œæŒ‰é’®ï¼ˆäº¤äº’æ€§ï¼‰"><a href="#1-æ·»åŠ æ“ä½œæŒ‰é’®ï¼ˆäº¤äº’æ€§ï¼‰" class="headerlink" title="1. æ·»åŠ æ“ä½œæŒ‰é’®ï¼ˆäº¤äº’æ€§ï¼‰"></a>1. æ·»åŠ æ“ä½œæŒ‰é’®ï¼ˆäº¤äº’æ€§ï¼‰</h3><p>å¯ä»¥ä¸º <code>Snackbar</code> æ·»åŠ ä¸€ä¸ªæ“ä½œæŒ‰é’®ï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿæ‰§è¡Œä¸€äº›åŠ¨ä½œï¼Œä¾‹å¦‚æ’¤é”€åˆ é™¤æ“ä½œï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">val rootView: View = findViewById(R.id.root_view)</span><br><span class="line">Snackbar.make(rootView, &quot;æ“ä½œæˆåŠŸ&quot;, Snackbar.LENGTH_LONG)</span><br><span class="line">    .setAction(&quot;æ’¤é”€&quot;) &#123;</span><br><span class="line">        // æ‰§è¡Œæ’¤é”€æ“ä½œ</span><br><span class="line">        Toast.makeText(this, &quot;æ’¤é”€æ“ä½œ&quot;, Toast.LENGTH_SHORT).show()</span><br><span class="line">    &#125;</span><br><span class="line">    .show()</span><br></pre></td></tr></table></figure><ul><li><code>setAction()</code>ï¼šæ·»åŠ ä¸€ä¸ªæŒ‰é’®åŠå…¶ç‚¹å‡»äº‹ä»¶ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æ·»åŠ äº†â€œæ’¤é”€â€æŒ‰é’®ï¼Œç‚¹å‡»æ—¶ä¼šæ˜¾ç¤ºä¸€ä¸ªæç¤ºã€‚</li><li><code>setActionTextColor()</code>ï¼šå¯ä»¥ç”¨æ¥è®¾ç½®æŒ‰é’®æ–‡æœ¬çš„é¢œè‰²ã€‚</li></ul><hr><h3 id="2-ä¿®æ”¹-Snackbar-æ ·å¼"><a href="#2-ä¿®æ”¹-Snackbar-æ ·å¼" class="headerlink" title="2. ä¿®æ”¹ Snackbar æ ·å¼"></a>2. ä¿®æ”¹ Snackbar æ ·å¼</h3><p><code>Snackbar</code> è¿˜æ”¯æŒè‡ªå®šä¹‰æ ·å¼ï¼Œä¾‹å¦‚èƒŒæ™¯è‰²ã€æ–‡æœ¬é¢œè‰²ç­‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">val rootView: View = findViewById(R.id.root_view)</span><br><span class="line">val snackbar = Snackbar.make(rootView, &quot;æ“ä½œæˆåŠŸ&quot;, Snackbar.LENGTH_LONG)</span><br><span class="line"></span><br><span class="line">val snackbarView = snackbar.view</span><br><span class="line">snackbarView.setBackgroundColor(ContextCompat.getColor(this, R.color.snackbar_background))</span><br><span class="line">val textView = snackbarView.findViewById&lt;TextView&gt;(com.google.android.material.R.id.snackbar_text)</span><br><span class="line">textView.setTextColor(Color.WHITE)</span><br><span class="line"></span><br><span class="line">snackbar.show()</span><br></pre></td></tr></table></figure><ul><li>é€šè¿‡ <code>snackbar.view</code> è·å–åˆ° <code>Snackbar</code> çš„æ ¹è§†å›¾ï¼Œè¿›ä¸€æ­¥å®šåˆ¶ <code>Snackbar</code> çš„æ ·å¼ã€‚</li><li><code>setBackgroundColor()</code> å¯ä»¥ä¿®æ”¹ <code>Snackbar</code> èƒŒæ™¯è‰²ã€‚</li><li><code>findViewById&lt;TextView&gt;(com.google.android.material.R.id.snackbar_text)</code> è·å–åˆ°æ–‡æœ¬è§†å›¾ï¼Œä¿®æ”¹æ–‡æœ¬é¢œè‰²ã€‚</li></ul><hr><h3 id="3-è®¾ç½®è‡ªå®šä¹‰åŠ¨ç”»"><a href="#3-è®¾ç½®è‡ªå®šä¹‰åŠ¨ç”»" class="headerlink" title="3. è®¾ç½®è‡ªå®šä¹‰åŠ¨ç”»"></a>3. è®¾ç½®è‡ªå®šä¹‰åŠ¨ç”»</h3><p>Snackbar çš„å‡ºç°ä¸æ¶ˆå¤±æ˜¯æœ‰é»˜è®¤åŠ¨ç”»çš„ï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå®šä¹‰åŠ¨ç”»æ•ˆæœï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">val snackbar = Snackbar.make(rootView, &quot;æ“ä½œæˆåŠŸ&quot;, Snackbar.LENGTH_LONG)</span><br><span class="line">snackbar.view.animation = AnimationUtils.loadAnimation(this, R.anim.snackbar_animation)</span><br><span class="line">snackbar.show()</span><br></pre></td></tr></table></figure><ul><li>é€šè¿‡ <code>snackbar.view.animation</code> è®¾ç½®è‡ªå®šä¹‰åŠ¨ç”»ï¼Œå¯ä»¥é…åˆè‡ªå·±çš„åŠ¨ç”»èµ„æºæ–‡ä»¶è¿›è¡Œå®šåˆ¶ã€‚</li></ul><hr><h2 id="äº”ã€Snackbar-çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#äº”ã€Snackbar-çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="äº”ã€Snackbar çš„ç”Ÿå‘½å‘¨æœŸ"></a>äº”ã€Snackbar çš„ç”Ÿå‘½å‘¨æœŸ</h2><p><code>Snackbar</code> çš„ç”Ÿå‘½å‘¨æœŸç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼šæ˜¾ç¤ºã€æ¶ˆå¤±ä¸æ’¤é”€ã€‚</p><ol><li><strong>æ˜¾ç¤º</strong>ï¼š<code>Snackbar</code> ä¼šåœ¨çŸ­æ—¶é—´å†…æ˜¾ç¤ºåœ¨å±å¹•åº•éƒ¨ã€‚</li><li><strong>è‡ªåŠ¨æ¶ˆå¤±</strong>ï¼šæ ¹æ®ä¼ å…¥çš„æ˜¾ç¤ºæ—¶é—´ï¼ˆ<code>LENGTH_SHORT</code>ã€<code>LENGTH_LONG</code> ç­‰ï¼‰ï¼Œ<code>Snackbar</code> ä¼šè‡ªåŠ¨æ¶ˆå¤±ã€‚</li><li><strong>æ‰‹åŠ¨æ¶ˆå¤±</strong>ï¼šå¦‚æœä½ éœ€è¦æ‰‹åŠ¨å…³é—­ <code>Snackbar</code>ï¼Œå¯ä»¥ä½¿ç”¨ <code>dismiss()</code> æ–¹æ³•ï¼š</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">snackbar.dismiss()</span><br></pre></td></tr></table></figure><ol><li><strong>æ’¤é”€æ“ä½œ</strong>ï¼šé€šè¿‡ <code>setAction()</code> æ–¹æ³•ï¼Œå¯ä»¥ä¸º <code>Snackbar</code> æ·»åŠ äº¤äº’æ“ä½œï¼Œå…è®¸ç”¨æˆ·ç‚¹å‡»æ’¤é”€ç­‰æŒ‰é’®ã€‚</li></ol><hr><h2 id="å…­ã€Snackbar-çš„æ³¨æ„äº‹é¡¹"><a href="#å…­ã€Snackbar-çš„æ³¨æ„äº‹é¡¹" class="headerlink" title="å…­ã€Snackbar çš„æ³¨æ„äº‹é¡¹"></a>å…­ã€Snackbar çš„æ³¨æ„äº‹é¡¹</h2><ol><li><strong>åµŒå¥—ä½¿ç”¨</strong>ï¼šåœ¨ä¸€ä¸ª <code>Activity</code> æˆ– <code>Fragment</code> ä¸­ï¼Œ<code>Snackbar</code> ä¸åº”åµŒå¥—å¤šä¸ªä½¿ç”¨ã€‚å¦‚æœéœ€è¦æ˜¾ç¤ºå¤šä¸ªæç¤ºä¿¡æ¯ï¼Œå»ºè®®å…ˆè°ƒç”¨ <code>dismiss()</code> æ‰‹åŠ¨å…³é—­å‰ä¸€ä¸ª <code>Snackbar</code>ã€‚</li><li><strong>ä¸é”®ç›˜äº¤äº’</strong>ï¼š<code>Snackbar</code> ä¼šéšç€é”®ç›˜çš„å¼¹å‡ºè‡ªåŠ¨è°ƒæ•´ä½ç½®ï¼Œå› æ­¤é€šå¸¸ä¸ä¼šè¢«é”®ç›˜é®æŒ¡ã€‚</li><li><strong>é•¿æ—¶é—´æ˜¾ç¤º</strong>ï¼šå¦‚æœä½ ä½¿ç”¨ <code>Snackbar.LENGTH_INDEFINITE</code> é•¿æ—¶é—´æ˜¾ç¤º <code>Snackbar</code>ï¼Œè®°å¾—è°ƒç”¨ <code>dismiss()</code> å…³é—­ <code>Snackbar</code>ï¼Œä»¥å…ä¸€ç›´æ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚</li><li><strong>é€‚åº”ä¸åŒå±å¹•</strong>ï¼šç”±äº <code>Snackbar</code> æ˜¯ä¸€ä¸ªæµ®åŠ¨è§†å›¾ï¼Œå®ƒä¸ä¼šå ç”¨å¸ƒå±€ä¸­çš„ç©ºé—´ï¼Œå› æ­¤å¯¹äºå°å±è®¾å¤‡ï¼Œå»ºè®®ä¸è¦è®© <code>Snackbar</code> æ˜¾ç¤ºè¿‡é•¿æ—¶é—´ï¼Œé¿å…é®æŒ¡é‡è¦å†…å®¹ã€‚</li></ol><hr><h2 id="ä¸ƒã€æ€»ç»“"><a href="#ä¸ƒã€æ€»ç»“" class="headerlink" title="ä¸ƒã€æ€»ç»“"></a>ä¸ƒã€æ€»ç»“</h2><p><code>Snackbar</code> æ˜¯ä¸€ç§éå¸¸é€‚åˆåœ¨ Android ä¸­å±•ç¤ºçŸ­æš‚æç¤ºä¿¡æ¯çš„æ§ä»¶ï¼Œç‰¹åˆ«é€‚ç”¨äºéœ€è¦ç”¨æˆ·äº¤äº’ï¼ˆå¦‚æ’¤é”€ï¼‰çš„åœºæ™¯ã€‚é€šè¿‡ç®€å•çš„ APIï¼Œå¼€å‘è€…å¯ä»¥å®ç°ä¸°å¯Œçš„æç¤ºåŠŸèƒ½ï¼Œæ”¹å–„ç”¨æˆ·ä½“éªŒã€‚</p><h3 id="ä¼˜ç‚¹ï¼š"><a href="#ä¼˜ç‚¹ï¼š" class="headerlink" title="ä¼˜ç‚¹ï¼š"></a>ä¼˜ç‚¹ï¼š</h3><ul><li>æ˜¾ç¤ºç®€æ´</li><li>å¯ä»¥è¿›è¡Œäº¤äº’æ“ä½œï¼ˆå¦‚æ’¤é”€ï¼‰</li><li>çµæ´»çš„è‡ªå®šä¹‰æ ·å¼</li></ul><h3 id="ç¼ºç‚¹ï¼š"><a href="#ç¼ºç‚¹ï¼š" class="headerlink" title="ç¼ºç‚¹ï¼š"></a>ç¼ºç‚¹ï¼š</h3><ul><li>é€‚ç”¨äºçŸ­æœŸæç¤ºï¼Œä¸é€‚åˆé•¿æ—¶é—´æ˜¾ç¤º</li><li>éœ€è¦æ‰‹åŠ¨ç®¡ç†æ˜¾ç¤ºæ—¶é•¿å’Œè¡Œä¸º</li></ul><hr><p><code>Snackbar</code> æ˜¯ä¸€ä¸ªé«˜æ•ˆçš„ç•Œé¢æç¤ºå·¥å…·ï¼Œèƒ½å¤Ÿè®©ç”¨æˆ·å¿«é€Ÿç†è§£åº”ç”¨çŠ¶æ€ï¼ŒåŒæ—¶ä¿æŒç•Œé¢çš„æ•´æ´å’Œç®€æ´ã€‚å¸Œæœ›æœ¬æ–‡èƒ½å¤Ÿå¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨ <code>Snackbar</code>ï¼Œä»è€Œæé«˜ç”¨æˆ·ä½“éªŒã€‚å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜ï¼Œæˆ–è€…éœ€è¦æ›´æ·±å…¥çš„å®ä¾‹æ¼”ç¤ºï¼Œæ¬¢è¿éšæ—¶å‘æˆ‘æé—®ï¼</p><h1 id="æˆ‘çš„ä¾‹å­ï¼"><a href="#æˆ‘çš„ä¾‹å­ï¼" class="headerlink" title="æˆ‘çš„ä¾‹å­ï¼"></a>æˆ‘çš„ä¾‹å­ï¼</h1><p>åœ¨æˆ‘çš„ä¾‹å­ä¸­ï¼Œæ˜¯ç‚¹å‡»ä¸€ä¸ªfabæ¢èµ·Snackbarï¼Œå…¶ä¸­äº®ç‚¹æ˜¯å¼ºåˆ¶æ”¹å˜äº†Snackbarçš„èƒŒæ™¯å’Œå­—ä½“çš„é¢œè‰²ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">binding.fab.setOnClickListener &#123; view -&gt;</span><br><span class="line">    val snackbar = Snackbar.make(view, &quot;Data deleted&quot;, Snackbar.LENGTH_SHORT)</span><br><span class="line">        .setAction(&quot;Undo&quot;) &#123;</span><br><span class="line">            Toast.makeText(this, &quot;Data restored&quot;, Toast.LENGTH_SHORT).show()</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    //è·å– Snackbar çš„ View å¹¶è®¾ç½® tintList å¼ºåˆ¶èƒŒæ™¯ä¸ºç™½è‰².tiniListè¶…çº§è¶…çº§è¶…çº§çº§å‰å®³çš„ï¼Œèƒ½å¼ºåˆ¶ä¿®æ”¹é¢œè‰²ï¼Œ</span><br><span class="line">    //å¯ç”¨åœ¨button,ImageView,FloatingActionButton,ä½†ä¸èƒ½ç”¨åœ¨popupmenuä¸Šï¼Œä¿®æ”¹popupmenuéœ€è¦åœ¨valueä¸­å®šä¹‰styleï¼Œç„¶ååœ¨layoutä¸­ä½¿ç”¨è¿™ä¸ªstyle</span><br><span class="line">    val snackbarView = snackbar.view</span><br><span class="line">    snackbarView.backgroundTintList = ColorStateList.valueOf(Color.WHITE)</span><br><span class="line"></span><br><span class="line">    // è®¾ç½®æ–‡å­—ä¸ºé»‘è‰²</span><br><span class="line">    val textView = snackbarView.findViewById&lt;TextView&gt;(com.google.android.material.R.id.snackbar_text)</span><br><span class="line">    textView?.setTextColor(Color.BLACK)</span><br><span class="line"></span><br><span class="line">    // è®¾ç½® Action æŒ‰é’®çš„é¢œè‰²ï¼ˆè¿™é‡Œç¤ºä¾‹ç”¨é»‘è‰²ï¼Œä½ å¯ä»¥æ¢æˆå…¶å®ƒé¢œè‰²ï¼‰</span><br><span class="line">    val actionTextView = snackbarView.findViewById&lt;TextView&gt;(com.google.android.material.R.id.snackbar_action)</span><br><span class="line">    actionTextView?.setTextColor(Color.BLUE)</span><br><span class="line"></span><br><span class="line">    snackbar.show()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“å¼€å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NavigationViewè¯¦è§£</title>
      <link href="/2025/04/04/NavigationView%E8%AF%A6%E8%A7%A3/"/>
      <url>/2025/04/04/NavigationView%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h1 id="ğŸ“Œ-Android-NavigationView-æŠ€æœ¯è¯¦è§£ï¼ˆ2025-å¹´ç‰ˆï¼‰"><a href="#ğŸ“Œ-Android-NavigationView-æŠ€æœ¯è¯¦è§£ï¼ˆ2025-å¹´ç‰ˆï¼‰" class="headerlink" title="ğŸ“Œ Android NavigationView æŠ€æœ¯è¯¦è§£ï¼ˆ2025 å¹´ç‰ˆï¼‰"></a>ğŸ“Œ Android <code>NavigationView</code> æŠ€æœ¯è¯¦è§£ï¼ˆ2025 å¹´ç‰ˆï¼‰</h1><p>åœ¨ç°ä»£ Android åº”ç”¨ä¸­ï¼Œè‰¯å¥½çš„å¯¼èˆªä½“éªŒæ˜¯æå‡ç”¨æˆ·æ»¡æ„åº¦çš„å…³é”®ã€‚<code>NavigationView</code> æ˜¯ Google Material Design æŒ‡å—æ¨èçš„ç»„ä»¶ä¹‹ä¸€ï¼Œå¸¸ä¸ <code>DrawerLayout</code> ç»“åˆä½¿ç”¨ï¼Œä¸ºåº”ç”¨æä¾›<strong>ä¾§æ»‘å¯¼èˆªèœå•</strong>ï¼ˆSide Navigation Drawerï¼‰åŠŸèƒ½ã€‚æœ¬æ–‡å°†å…¨é¢è§£æ <code>NavigationView</code> çš„ç”¨æ³•ã€ç‰¹æ€§ä¸æœ€ä½³å®è·µï¼Œå¸®åŠ©ä½ æ„å»ºç¬¦åˆç°ä»£è®¾è®¡è§„èŒƒçš„ Android åº”ç”¨ã€‚</p><hr><h2 id="ğŸ”§-ä»€ä¹ˆæ˜¯-NavigationViewï¼Ÿ"><a href="#ğŸ”§-ä»€ä¹ˆæ˜¯-NavigationViewï¼Ÿ" class="headerlink" title="ğŸ”§ ä»€ä¹ˆæ˜¯ NavigationViewï¼Ÿ"></a>ğŸ”§ ä»€ä¹ˆæ˜¯ <code>NavigationView</code>ï¼Ÿ</h2><p><code>NavigationView</code> æ˜¯ <code>com.google.android.material.navigation.NavigationView</code>ï¼Œå®ƒæ˜¯ Material Components æä¾›çš„ UI ç»„ä»¶ï¼Œç”¨äºæ„å»ºå·¦ä¾§ä¾§æ»‘èœå•ï¼Œé€šå¸¸åµŒå¥—åœ¨ <code>DrawerLayout</code> ä¸­ã€‚</p><blockquote><p>ğŸ“Œ <code>NavigationView</code> å®é™…ä¸Šæ˜¯ä¸€ä¸ªå¸¦æœ‰èœå•é¡¹ï¼ˆMenuï¼‰å’Œå¯é€‰å¤´éƒ¨è§†å›¾ï¼ˆHeaderï¼‰çš„ <code>FrameLayout</code>ã€‚</p></blockquote><hr><h2 id="ğŸ§±-åŸºæœ¬ç»“æ„"><a href="#ğŸ§±-åŸºæœ¬ç»“æ„" class="headerlink" title="ğŸ§± åŸºæœ¬ç»“æ„"></a>ğŸ§± åŸºæœ¬ç»“æ„</h2><p>å…¸å‹å¸ƒå±€å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;androidx.drawerlayout.widget.DrawerLayout</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- ä¸»å†…å®¹ --&gt;</span><br><span class="line">    &lt;FrameLayout</span><br><span class="line">        android:id=&quot;@+id/main_content&quot;</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;match_parent&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- ä¾§æ»‘èœå• --&gt;</span><br><span class="line">    &lt;com.google.android.material.navigation.NavigationView</span><br><span class="line">        android:id=&quot;@+id/navigation_view&quot;</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;match_parent&quot;</span><br><span class="line">        android:layout_gravity=&quot;start&quot;</span><br><span class="line">        app:menu=&quot;@menu/drawer_menu&quot;</span><br><span class="line">        app:headerLayout=&quot;@layout/nav_header&quot;/&gt;</span><br><span class="line">&lt;/androidx.drawerlayout.widget.DrawerLayout&gt;</span><br></pre></td></tr></table></figure><hr><h2 id="ğŸ“‚-èœå•ä¸å¤´éƒ¨è§†å›¾"><a href="#ğŸ“‚-èœå•ä¸å¤´éƒ¨è§†å›¾" class="headerlink" title="ğŸ“‚ èœå•ä¸å¤´éƒ¨è§†å›¾"></a>ğŸ“‚ èœå•ä¸å¤´éƒ¨è§†å›¾</h2><h3 id="menu-å±æ€§"><a href="#menu-å±æ€§" class="headerlink" title="menu å±æ€§"></a><code>menu</code> å±æ€§</h3><p>é€šè¿‡ <code>app:menu</code> æŒ‡å®š XML èœå•èµ„æºï¼Œèœå•é¡¹å¯ä»¥è®¾ç½®å›¾æ ‡å’Œ IDï¼š</p><p><strong>res&#x2F;menu&#x2F;drawer_menu.xml</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;menu xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;</span><br><span class="line">    &lt;item</span><br><span class="line">        android:id=&quot;@+id/nav_home&quot;</span><br><span class="line">        android:icon=&quot;@drawable/ic_home&quot;</span><br><span class="line">        android:title=&quot;é¦–é¡µ&quot;/&gt;</span><br><span class="line">    &lt;item</span><br><span class="line">        android:id=&quot;@+id/nav_settings&quot;</span><br><span class="line">        android:icon=&quot;@drawable/ic_settings&quot;</span><br><span class="line">        android:title=&quot;è®¾ç½®&quot;/&gt;</span><br><span class="line">&lt;/menu&gt;</span><br></pre></td></tr></table></figure><h3 id="headerLayout-å±æ€§"><a href="#headerLayout-å±æ€§" class="headerlink" title="headerLayout å±æ€§"></a><code>headerLayout</code> å±æ€§</h3><p>ç”¨äºå®šä¹‰é¡¶éƒ¨å¤´åƒæˆ–è´¦å·ä¿¡æ¯ï¼š</p><p><strong>res&#x2F;layout&#x2F;nav_header.xml</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;LinearLayout</span><br><span class="line">    android:orientation=&quot;vertical&quot;</span><br><span class="line">    android:background=&quot;?attr/colorPrimary&quot;</span><br><span class="line">    android:padding=&quot;16dp&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;160dp&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;ImageView</span><br><span class="line">        android:src=&quot;@drawable/ic_person&quot;</span><br><span class="line">        android:layout_width=&quot;64dp&quot;</span><br><span class="line">        android:layout_height=&quot;64dp&quot;</span><br><span class="line">        android:tint=&quot;@android:color/white&quot;/&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:text=&quot;æ¬¢è¿ï¼Œç”¨æˆ·ï¼&quot;</span><br><span class="line">        android:textColor=&quot;@android:color/white&quot;</span><br><span class="line">        android:textSize=&quot;18sp&quot;/&gt;</span><br><span class="line">&lt;/LinearLayout&gt;</span><br></pre></td></tr></table></figure><hr><h2 id="ğŸš€-ä¸-Navigation-Component-é›†æˆï¼ˆæ¨èï¼‰"><a href="#ğŸš€-ä¸-Navigation-Component-é›†æˆï¼ˆæ¨èï¼‰" class="headerlink" title="ğŸš€ ä¸ Navigation Component é›†æˆï¼ˆæ¨èï¼‰"></a>ğŸš€ ä¸ Navigation Component é›†æˆï¼ˆæ¨èï¼‰</h2><p><code>NavigationView</code> èƒ½æ— ç¼é›†æˆ Jetpack çš„ Navigation ç»„ä»¶ï¼Œåªéœ€ç»‘å®š NavControllerï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kotlinå¤åˆ¶ç¼–è¾‘val navController = findNavController(R.id.nav_host_fragment)</span><br><span class="line">val navigationView = findViewById&lt;NavigationView&gt;(R.id.navigation_view)</span><br><span class="line">navigationView.setupWithNavController(navController)</span><br></pre></td></tr></table></figure><p>è¿™æ ·ç‚¹å‡»èœå•é¡¹å°±ä¼šè‡ªåŠ¨å¯¼èˆªåˆ°ç›®æ ‡ Fragmentï¼Œæ— éœ€æ‰‹åŠ¨å¤„ç†ç‚¹å‡»äº‹ä»¶ã€‚</p><hr><h2 id="ğŸ”-åŠ¨æ€æ“ä½œèœå•é¡¹"><a href="#ğŸ”-åŠ¨æ€æ“ä½œèœå•é¡¹" class="headerlink" title="ğŸ” åŠ¨æ€æ“ä½œèœå•é¡¹"></a>ğŸ” åŠ¨æ€æ“ä½œèœå•é¡¹</h2><p>ä½ ä¹Ÿå¯ä»¥é€šè¿‡ä»£ç è®¿é—®æˆ–ä¿®æ”¹èœå•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">val menu = navigationView.menu</span><br><span class="line">val settingsItem = menu.findItem(R.id.nav_settings)</span><br><span class="line">settingsItem.title = &quot;åå¥½è®¾ç½®&quot;</span><br></pre></td></tr></table></figure><p>æˆ–è€…æ·»åŠ &#x2F;éšè—èœå•é¡¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">settingsItem.isVisible = false</span><br></pre></td></tr></table></figure><hr><h2 id="ğŸŒ™-æ”¯æŒæš—é»‘æ¨¡å¼"><a href="#ğŸŒ™-æ”¯æŒæš—é»‘æ¨¡å¼" class="headerlink" title="ğŸŒ™ æ”¯æŒæš—é»‘æ¨¡å¼"></a>ğŸŒ™ æ”¯æŒæš—é»‘æ¨¡å¼</h2><p>ç”±äºä½¿ç”¨ Material3 æ ·å¼ï¼Œ<code>NavigationView</code> ä¼šè‡ªåŠ¨é€‚é…æš—é»‘ä¸»é¢˜ï¼ˆNight Modeï¼‰ã€‚ä½ å¯ä»¥é€šè¿‡åˆ‡æ¢ç³»ç»Ÿä¸»é¢˜æˆ–æ‰‹åŠ¨è®¾ç½® <code>AppCompatDelegate.setDefaultNightMode()</code> æµ‹è¯•æ•ˆæœã€‚</p><hr><h2 id="ğŸ§ -å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ"><a href="#ğŸ§ -å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ" class="headerlink" title="ğŸ§  å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ"></a>ğŸ§  å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h2><h3 id="1-æŠ½å±‰å›¾æ ‡ä¸æ˜¾ç¤ºï¼Ÿ"><a href="#1-æŠ½å±‰å›¾æ ‡ä¸æ˜¾ç¤ºï¼Ÿ" class="headerlink" title="1. æŠ½å±‰å›¾æ ‡ä¸æ˜¾ç¤ºï¼Ÿ"></a>1. æŠ½å±‰å›¾æ ‡ä¸æ˜¾ç¤ºï¼Ÿ</h3><p>ç¡®ä¿åœ¨ <code>AppCompatActivity</code> ä¸­è°ƒç”¨äº†ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">setSupportActionBar(toolbar)</span><br><span class="line">setupActionBarWithNavController(navController, appBarConfiguration)</span><br></pre></td></tr></table></figure><p>å¹¶è®¾ç½® <code>AppBarConfiguration</code> ä¼ å…¥é¡¶çº§ç›®çš„åœ°å’Œ DrawerLayoutã€‚</p><hr><h3 id="2-NavigationView-å†…å®¹è¢«çŠ¶æ€æ é®æŒ¡ï¼Ÿ"><a href="#2-NavigationView-å†…å®¹è¢«çŠ¶æ€æ é®æŒ¡ï¼Ÿ" class="headerlink" title="2. NavigationView å†…å®¹è¢«çŠ¶æ€æ é®æŒ¡ï¼Ÿ"></a>2. NavigationView å†…å®¹è¢«çŠ¶æ€æ é®æŒ¡ï¼Ÿ</h3><p>åŠ ä¸Šï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:fitsSystemWindows=&quot;true&quot;</span><br></pre></td></tr></table></figure><p>å¹¶åœ¨ä¸»é¢˜ä¸­å¯ç”¨é€æ˜çŠ¶æ€æ æ ·å¼ã€‚</p><hr><h3 id="3-å¦‚ä½•é«˜äº®å½“å‰é€‰ä¸­çš„èœå•é¡¹ï¼Ÿ"><a href="#3-å¦‚ä½•é«˜äº®å½“å‰é€‰ä¸­çš„èœå•é¡¹ï¼Ÿ" class="headerlink" title="3. å¦‚ä½•é«˜äº®å½“å‰é€‰ä¸­çš„èœå•é¡¹ï¼Ÿ"></a>3. å¦‚ä½•é«˜äº®å½“å‰é€‰ä¸­çš„èœå•é¡¹ï¼Ÿ</h3><p>Jetpack Navigation ä¼šè‡ªåŠ¨å¤„ç†ï¼Œåªè¦ <code>menu</code> ä¸­çš„ <code>id</code> ä¸å¯¼èˆªå›¾ Fragment çš„ <code>id</code> å¯¹åº”å³å¯ã€‚</p><hr><h2 id="âœ…-æ€»ç»“"><a href="#âœ…-æ€»ç»“" class="headerlink" title="âœ… æ€»ç»“"></a>âœ… æ€»ç»“</h2><table><thead><tr><th>ç‰¹æ€§</th><th>æè¿°</th></tr></thead><tbody><tr><td>ç»„ä»¶</td><td><code>NavigationView</code> æ˜¯ä¾§æ»‘èœå•ç»„ä»¶</td></tr><tr><td>æ ·å¼</td><td>æ”¯æŒ Material3 ä¸æš—é»‘æ¨¡å¼</td></tr><tr><td>é›†æˆ</td><td>å»ºè®®é…åˆ Jetpack Navigation ä½¿ç”¨</td></tr><tr><td>æ‰©å±•æ€§</td><td>å¯è‡ªå®šä¹‰èœå•ã€å¤´éƒ¨ã€ç›‘å¬ç‚¹å‡»äº‹ä»¶</td></tr><tr><td>åœºæ™¯</td><td>å¤§å¤šæ•°éœ€è¦æŠ½å±‰å¼å¯¼èˆªçš„ Appï¼Œå¦‚é‚®ç®±ã€ç¤¾äº¤ã€å·¥å…·ç±»åº”ç”¨</td></tr></tbody></table><hr><h2 id="ğŸ”š-å†™åœ¨æœ€å"><a href="#ğŸ”š-å†™åœ¨æœ€å" class="headerlink" title="ğŸ”š å†™åœ¨æœ€å"></a>ğŸ”š å†™åœ¨æœ€å</h2><p>åœ¨å½“ä»Š Android å¼€å‘ä¸­ï¼Œä½¿ç”¨ <code>DrawerLayout + NavigationView + NavController</code> æ˜¯æ„å»ºé«˜è´¨é‡å¯¼èˆªç•Œé¢çš„é»„é‡‘ç»„åˆã€‚æŒæ¡ <code>NavigationView</code>ï¼Œä¸ä»…èƒ½æå‡ä½ çš„ UI å®åŠ›ï¼Œä¹Ÿèƒ½ä¸ºç”¨æˆ·å¸¦æ¥æ¸…æ™°ã€é«˜æ•ˆçš„å¯¼èˆªä½“éªŒã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“å¼€å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DrawerLayoutè¯¦è§£</title>
      <link href="/2025/04/04/DrawerLayout%E8%AF%A6%E8%A7%A3/"/>
      <url>/2025/04/04/DrawerLayout%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h1 id="ğŸ“˜-DrawerLayout-æŠ€æœ¯æ–‡æ¡£ï¼ˆ2025-å¹´ç‰ˆï¼‰"><a href="#ğŸ“˜-DrawerLayout-æŠ€æœ¯æ–‡æ¡£ï¼ˆ2025-å¹´ç‰ˆï¼‰" class="headerlink" title="ğŸ“˜ DrawerLayout æŠ€æœ¯æ–‡æ¡£ï¼ˆ2025 å¹´ç‰ˆï¼‰"></a>ğŸ“˜ DrawerLayout æŠ€æœ¯æ–‡æ¡£ï¼ˆ2025 å¹´ç‰ˆï¼‰</h1><hr><h2 id="1-ğŸ§­-ç®€ä»‹"><a href="#1-ğŸ§­-ç®€ä»‹" class="headerlink" title="1. ğŸ§­ ç®€ä»‹"></a>1. ğŸ§­ ç®€ä»‹</h2><p><code>DrawerLayout</code> æ˜¯ Android å®˜æ–¹æ”¯æŒçš„å¸ƒå±€å®¹å™¨ï¼Œç”¨äºå®ç°ä¾§è¾¹æ»‘å‡ºçš„å¯¼èˆªæŠ½å±‰æ•ˆæœï¼ˆNavigation Drawerï¼‰ã€‚å¹¿æ³›åº”ç”¨äºåŒ…å«å¤šä¸ªå¯¼èˆªé¡¹çš„ App ä¸­ï¼Œä¾‹å¦‚é‚®ç®±å®¢æˆ·ç«¯ã€æ–°é—»é˜…è¯»å™¨ã€ç¤¾äº¤ç±»åº”ç”¨ç­‰ã€‚</p><p><strong>ç‰¹æ€§ï¼š</strong></p><ul><li>æ”¯æŒå·¦ä¾§&#x2F;å³ä¾§æŠ½å±‰ï¼ˆæˆ–åŒæ—¶å­˜åœ¨ï¼‰</li><li>æ”¯æŒæ»‘åŠ¨æ‰‹åŠ¿ä¸èœå•å›¾æ ‡è§¦å‘</li><li>ä¸ <code>NavigationView</code> å’Œ Jetpack Navigation ç»„ä»¶è‰¯å¥½å…¼å®¹</li><li>æ”¯æŒ Material Design é£æ ¼</li></ul><hr><h2 id="2-ğŸ§©-æ ¸å¿ƒæ¦‚å¿µä¸ç»„ä»¶ç»“æ„"><a href="#2-ğŸ§©-æ ¸å¿ƒæ¦‚å¿µä¸ç»„ä»¶ç»“æ„" class="headerlink" title="2. ğŸ§© æ ¸å¿ƒæ¦‚å¿µä¸ç»„ä»¶ç»“æ„"></a>2. ğŸ§© æ ¸å¿ƒæ¦‚å¿µä¸ç»„ä»¶ç»“æ„</h2><p><code>DrawerLayout</code> æ˜¯ä¸€ä¸ª <code>ViewGroup</code> å®¹å™¨ï¼Œè‡³å°‘åŒ…å«ä¸¤ä¸ªå­å¸ƒå±€ï¼š</p><ul><li><strong>ä¸»å†…å®¹åŒºåŸŸ</strong>ï¼šé€šå¸¸ä¸ºä¸»ç•Œé¢ï¼Œå¦‚ <code>FragmentContainerView</code> æˆ– <code>ConstraintLayout</code></li><li><strong>æŠ½å±‰å†…å®¹åŒºåŸŸ</strong>ï¼šé€šå¸¸æ”¾ç½® <code>NavigationView</code>ï¼Œç”¨äºæ˜¾ç¤ºå¯¼èˆªèœå•é¡¹</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">plaintextå¤åˆ¶ç¼–è¾‘DrawerLayout</span><br><span class="line">â”œâ”€â”€ ä¸»ç•Œé¢å†…å®¹ï¼ˆMain Contentï¼‰</span><br><span class="line">â””â”€â”€ æŠ½å±‰å†…å®¹ï¼ˆDrawer - NavigationViewï¼‰</span><br></pre></td></tr></table></figure><hr><h2 id="3-ğŸ› ï¸-åŸºç¡€ç”¨æ³•"><a href="#3-ğŸ› ï¸-åŸºç¡€ç”¨æ³•" class="headerlink" title="3. ğŸ› ï¸ åŸºç¡€ç”¨æ³•"></a>3. ğŸ› ï¸ åŸºç¡€ç”¨æ³•</h2><h3 id="3-1-XML-ç¤ºä¾‹"><a href="#3-1-XML-ç¤ºä¾‹" class="headerlink" title="3.1 XML ç¤ºä¾‹"></a>3.1 XML ç¤ºä¾‹</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">xmlå¤åˆ¶ç¼–è¾‘&lt;androidx.drawerlayout.widget.DrawerLayout</span><br><span class="line">    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    android:id=&quot;@+id/drawer_layout&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- ä¸»ç•Œé¢å†…å®¹ --&gt;</span><br><span class="line">    &lt;FrameLayout</span><br><span class="line">        android:id=&quot;@+id/content_frame&quot;</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;match_parent&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- ä¾§è¾¹æŠ½å±‰èœå• --&gt;</span><br><span class="line">    &lt;com.google.android.material.navigation.NavigationView</span><br><span class="line">        android:id=&quot;@+id/navigation_view&quot;</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;match_parent&quot;</span><br><span class="line">        android:layout_gravity=&quot;start&quot;</span><br><span class="line">        app:menu=&quot;@menu/drawer_menu&quot;</span><br><span class="line">        app:headerLayout=&quot;@layout/nav_header&quot; /&gt;</span><br><span class="line">&lt;/androidx.drawerlayout.widget.DrawerLayout&gt;</span><br></pre></td></tr></table></figure><h3 id="3-2-Kotlin-æ§åˆ¶æ‰“å¼€ä¸å…³é—­"><a href="#3-2-Kotlin-æ§åˆ¶æ‰“å¼€ä¸å…³é—­" class="headerlink" title="3.2 Kotlin æ§åˆ¶æ‰“å¼€ä¸å…³é—­"></a>3.2 Kotlin æ§åˆ¶æ‰“å¼€ä¸å…³é—­</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">kotlinå¤åˆ¶ç¼–è¾‘val drawerLayout = findViewById&lt;DrawerLayout&gt;(R.id.drawer_layout)</span><br><span class="line"></span><br><span class="line">drawerLayout.openDrawer(GravityCompat.START)  // æ‰“å¼€æŠ½å±‰</span><br><span class="line">drawerLayout.closeDrawer(GravityCompat.START) // å…³é—­æŠ½å±‰</span><br></pre></td></tr></table></figure><hr><h2 id="4-ğŸ”—-ä¸-NavigationView-æ­é…ä½¿ç”¨"><a href="#4-ğŸ”—-ä¸-NavigationView-æ­é…ä½¿ç”¨" class="headerlink" title="4. ğŸ”— ä¸ NavigationView æ­é…ä½¿ç”¨"></a>4. ğŸ”— ä¸ NavigationView æ­é…ä½¿ç”¨</h2><p><code>NavigationView</code> æ˜¯ Material Design æä¾›çš„æ§ä»¶ï¼Œç”¨äºåœ¨æŠ½å±‰ä¸­æ˜¾ç¤ºèœå•é¡¹ã€‚</p><h3 id="4-1-menu-drawer-menu-xml"><a href="#4-1-menu-drawer-menu-xml" class="headerlink" title="4.1 menu&#x2F;drawer_menu.xml"></a>4.1 menu&#x2F;drawer_menu.xml</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">xmlå¤åˆ¶ç¼–è¾‘&lt;menu xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;</span><br><span class="line">    &lt;item android:id=&quot;@+id/nav_home&quot;</span><br><span class="line">          android:title=&quot;é¦–é¡µ&quot;</span><br><span class="line">          android:icon=&quot;@drawable/ic_home&quot;/&gt;</span><br><span class="line">    &lt;item android:id=&quot;@+id/nav_settings&quot;</span><br><span class="line">          android:title=&quot;è®¾ç½®&quot;</span><br><span class="line">          android:icon=&quot;@drawable/ic_settings&quot;/&gt;</span><br><span class="line">&lt;/menu&gt;</span><br></pre></td></tr></table></figure><h3 id="4-2-Kotlin-ä¸­ç›‘å¬èœå•ç‚¹å‡»"><a href="#4-2-Kotlin-ä¸­ç›‘å¬èœå•ç‚¹å‡»" class="headerlink" title="4.2 Kotlin ä¸­ç›‘å¬èœå•ç‚¹å‡»"></a>4.2 Kotlin ä¸­ç›‘å¬èœå•ç‚¹å‡»</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">kotlinå¤åˆ¶ç¼–è¾‘navigationView.setNavigationItemSelectedListener &#123; menuItem -&gt;</span><br><span class="line">    when (menuItem.itemId) &#123;</span><br><span class="line">        R.id.nav_home -&gt; &#123;</span><br><span class="line">            // TODO: å¯¼èˆªåˆ°é¦–é¡µ</span><br><span class="line">        &#125;</span><br><span class="line">        R.id.nav_settings -&gt; &#123;</span><br><span class="line">            // TODO: å¯¼èˆªåˆ°è®¾ç½®é¡µ</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    drawerLayout.closeDrawer(GravityCompat.START)</span><br><span class="line">    true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="5-ğŸš€-ä¸-Jetpack-Navigation-é›†æˆï¼ˆæ¨èæ–¹å¼ï¼‰"><a href="#5-ğŸš€-ä¸-Jetpack-Navigation-é›†æˆï¼ˆæ¨èæ–¹å¼ï¼‰" class="headerlink" title="5. ğŸš€ ä¸ Jetpack Navigation é›†æˆï¼ˆæ¨èæ–¹å¼ï¼‰"></a>5. ğŸš€ ä¸ Jetpack Navigation é›†æˆï¼ˆæ¨èæ–¹å¼ï¼‰</h2><p>ç°ä»£ Android æ¨èä½¿ç”¨ <strong>Navigation Component</strong> ç®¡ç† Fragment å¯¼èˆªã€‚</p><h3 id="5-1-æ·»åŠ -Navigation-ä¾èµ–"><a href="#5-1-æ·»åŠ -Navigation-ä¾èµ–" class="headerlink" title="5.1 æ·»åŠ  Navigation ä¾èµ–"></a>5.1 æ·»åŠ  Navigation ä¾èµ–</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">groovyå¤åˆ¶ç¼–è¾‘implementation &quot;androidx.navigation:navigation-fragment-ktx:2.7.7&quot;</span><br><span class="line">implementation &quot;androidx.navigation:navigation-ui-ktx:2.7.7&quot;</span><br></pre></td></tr></table></figure><h3 id="5-2-ä½¿ç”¨-NavHostFragment-æ›¿æ¢-FrameLayout"><a href="#5-2-ä½¿ç”¨-NavHostFragment-æ›¿æ¢-FrameLayout" class="headerlink" title="5.2 ä½¿ç”¨ NavHostFragment æ›¿æ¢ FrameLayout"></a>5.2 ä½¿ç”¨ NavHostFragment æ›¿æ¢ FrameLayout</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">xmlå¤åˆ¶ç¼–è¾‘&lt;androidx.fragment.app.FragmentContainerView</span><br><span class="line">    android:id=&quot;@+id/nav_host_fragment&quot;</span><br><span class="line">    android:name=&quot;androidx.navigation.fragment.NavHostFragment&quot;</span><br><span class="line">    app:navGraph=&quot;@navigation/nav_graph&quot;</span><br><span class="line">    app:defaultNavHost=&quot;true&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot; /&gt;</span><br></pre></td></tr></table></figure><h3 id="5-3-Kotlin-ä¸­é…ç½®-AppBar-å’Œ-DrawerLayout"><a href="#5-3-Kotlin-ä¸­é…ç½®-AppBar-å’Œ-DrawerLayout" class="headerlink" title="5.3 Kotlin ä¸­é…ç½® AppBar å’Œ DrawerLayout"></a>5.3 Kotlin ä¸­é…ç½® AppBar å’Œ DrawerLayout</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">kotlinå¤åˆ¶ç¼–è¾‘val navController = findNavController(R.id.nav_host_fragment)</span><br><span class="line">val appBarConfig = AppBarConfiguration(</span><br><span class="line">    setOf(R.id.nav_home, R.id.nav_settings), drawerLayout</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">setupActionBarWithNavController(navController, appBarConfig)</span><br><span class="line">navigationView.setupWithNavController(navController)</span><br></pre></td></tr></table></figure><hr><h2 id="6-ğŸ¨-UI-è‡ªå®šä¹‰ä¸æœ€ä½³å®è·µ"><a href="#6-ğŸ¨-UI-è‡ªå®šä¹‰ä¸æœ€ä½³å®è·µ" class="headerlink" title="6. ğŸ¨ UI è‡ªå®šä¹‰ä¸æœ€ä½³å®è·µ"></a>6. ğŸ¨ UI è‡ªå®šä¹‰ä¸æœ€ä½³å®è·µ</h2><h3 id="âœ…-å»ºè®®ä½¿ç”¨-Material-ä¸»é¢˜"><a href="#âœ…-å»ºè®®ä½¿ç”¨-Material-ä¸»é¢˜" class="headerlink" title="âœ… å»ºè®®ä½¿ç”¨ Material ä¸»é¢˜"></a>âœ… å»ºè®®ä½¿ç”¨ Material ä¸»é¢˜</h3><p>ç¡®ä¿ä½ çš„ä¸»é¢˜ç»§æ‰¿è‡ª <code>Theme.Material3.DayNight</code>ï¼Œä»¥è·å¾—æœ€æ–° UI æ”¯æŒã€‚</p><h3 id="âœ…-è‡ªå®šä¹‰å¤´éƒ¨å¸ƒå±€"><a href="#âœ…-è‡ªå®šä¹‰å¤´éƒ¨å¸ƒå±€" class="headerlink" title="âœ… è‡ªå®šä¹‰å¤´éƒ¨å¸ƒå±€"></a>âœ… è‡ªå®šä¹‰å¤´éƒ¨å¸ƒå±€</h3><p>ä½ å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªå¸ƒå±€ç”¨äº <code>NavigationView</code> çš„ <code>app:headerLayout</code> å±æ€§ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">xml</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å¤åˆ¶ç¼–è¾‘</span><br><span class="line">app:headerLayout=&quot;@layout/nav_header&quot;</span><br></pre></td></tr></table></figure><h3 id="âœ…-æ”¯æŒæš—è‰²æ¨¡å¼"><a href="#âœ…-æ”¯æŒæš—è‰²æ¨¡å¼" class="headerlink" title="âœ… æ”¯æŒæš—è‰²æ¨¡å¼"></a>âœ… æ”¯æŒæš—è‰²æ¨¡å¼</h3><p>ç¡®ä¿èµ„æºä½¿ç”¨ <code>night</code> ç›®å½•æ”¯æŒå¤œé—´æ¨¡å¼ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pgsqlå¤åˆ¶ç¼–è¾‘res/</span><br><span class="line">â”œâ”€â”€ layout/</span><br><span class="line">â”‚   â””â”€â”€ nav_header.xml</span><br><span class="line">â”œâ”€â”€ values-night/</span><br><span class="line">â”‚   â””â”€â”€ themes.xml</span><br></pre></td></tr></table></figure><hr><h2 id="7-âœ‹-æ‰‹åŠ¿æ§åˆ¶ä¸ç›‘å¬æŠ½å±‰çŠ¶æ€"><a href="#7-âœ‹-æ‰‹åŠ¿æ§åˆ¶ä¸ç›‘å¬æŠ½å±‰çŠ¶æ€" class="headerlink" title="7. âœ‹ æ‰‹åŠ¿æ§åˆ¶ä¸ç›‘å¬æŠ½å±‰çŠ¶æ€"></a>7. âœ‹ æ‰‹åŠ¿æ§åˆ¶ä¸ç›‘å¬æŠ½å±‰çŠ¶æ€</h2><h3 id="7-1-æ§åˆ¶æ˜¯å¦å…è®¸æ‰‹åŠ¿æ‰“å¼€"><a href="#7-1-æ§åˆ¶æ˜¯å¦å…è®¸æ‰‹åŠ¿æ‰“å¼€" class="headerlink" title="7.1 æ§åˆ¶æ˜¯å¦å…è®¸æ‰‹åŠ¿æ‰“å¼€"></a>7.1 æ§åˆ¶æ˜¯å¦å…è®¸æ‰‹åŠ¿æ‰“å¼€</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">kotlin</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å¤åˆ¶ç¼–è¾‘</span><br><span class="line">drawerLayout.setDrawerLockMode(DrawerLayout.LOCK_MODE_LOCKED_CLOSED)</span><br></pre></td></tr></table></figure><h3 id="7-2-ç›‘å¬æŠ½å±‰æ»‘åŠ¨-æ‰“å¼€-å…³é—­äº‹ä»¶"><a href="#7-2-ç›‘å¬æŠ½å±‰æ»‘åŠ¨-æ‰“å¼€-å…³é—­äº‹ä»¶" class="headerlink" title="7.2 ç›‘å¬æŠ½å±‰æ»‘åŠ¨&#x2F;æ‰“å¼€&#x2F;å…³é—­äº‹ä»¶"></a>7.2 ç›‘å¬æŠ½å±‰æ»‘åŠ¨&#x2F;æ‰“å¼€&#x2F;å…³é—­äº‹ä»¶</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">kotlinå¤åˆ¶ç¼–è¾‘drawerLayout.addDrawerListener(object : DrawerLayout.DrawerListener &#123;</span><br><span class="line">    override fun onDrawerSlide(drawerView: View, slideOffset: Float) &#123;&#125;</span><br><span class="line">    override fun onDrawerOpened(drawerView: View) &#123;</span><br><span class="line">        Log.d(&quot;Drawer&quot;, &quot;å·²æ‰“å¼€&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">    override fun onDrawerClosed(drawerView: View) &#123;</span><br><span class="line">        Log.d(&quot;Drawer&quot;, &quot;å·²å…³é—­&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">    override fun onDrawerStateChanged(newState: Int) &#123;&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><hr><h2 id="8-ğŸ§°-å¸¸è§é—®é¢˜ä¸æ’æŸ¥æŠ€å·§"><a href="#8-ğŸ§°-å¸¸è§é—®é¢˜ä¸æ’æŸ¥æŠ€å·§" class="headerlink" title="8. ğŸ§° å¸¸è§é—®é¢˜ä¸æ’æŸ¥æŠ€å·§"></a>8. ğŸ§° å¸¸è§é—®é¢˜ä¸æ’æŸ¥æŠ€å·§</h2><table><thead><tr><th>é—®é¢˜</th><th>åŸå› å’Œè§£å†³æ–¹å¼</th></tr></thead><tbody><tr><td>æŠ½å±‰æ»‘ä¸å‡ºæ¥</td><td>æ£€æŸ¥æ˜¯å¦è®¾ç½®äº†é”™è¯¯çš„ <code>layout_gravity</code>ï¼›åº”ä¸º <code>start</code> æˆ– <code>left</code></td></tr><tr><td>èœå•å›¾æ ‡æœªæ˜¾ç¤º</td><td>ä½¿ç”¨ <code>app:showAsAction=&quot;always&quot;</code> æˆ–ä½¿ç”¨ MaterialIcons</td></tr><tr><td>ç‚¹å‡»èœå•é¡¹åæŠ½å±‰ä¸è‡ªåŠ¨å…³é—­</td><td>æ‰‹åŠ¨è°ƒç”¨ <code>drawerLayout.closeDrawer(GravityCompat.START)</code></td></tr><tr><td>å’Œè¿”å›æŒ‰é’®å†²çªï¼ˆæŒ‰è¿”å›æ—¶ä¸å…³é—­æŠ½å±‰ï¼‰</td><td>åœ¨ <code>onBackPressedDispatcher</code> ä¸­ä¼˜å…ˆå…³é—­æŠ½å±‰</td></tr></tbody></table><hr><h2 id="9-âœ…-æ€»ç»“"><a href="#9-âœ…-æ€»ç»“" class="headerlink" title="9. âœ… æ€»ç»“"></a>9. âœ… æ€»ç»“</h2><table><thead><tr><th>ç‰¹æ€§</th><th>æè¿°</th></tr></thead><tbody><tr><td>åŸç”Ÿæ”¯æŒ</td><td>AndroidX ä¸­çš„å®˜æ–¹ç»„ä»¶</td></tr><tr><td>å¼ºå¤§çµæ´»</td><td>æ”¯æŒå·¦&#x2F;å³æŠ½å±‰ã€æ‰‹åŠ¿æ§åˆ¶ã€çŠ¶æ€ç›‘å¬</td></tr><tr><td>å¯ç»„åˆæ€§å¼º</td><td>å¯ä¸ <code>NavigationView</code> å’Œ Jetpack Navigation æ­é…</td></tr><tr><td>UI å¯è‡ªå®šä¹‰</td><td>æ”¯æŒå¤´éƒ¨ã€æš—è‰²æ¨¡å¼ã€åŠ¨ç”»ã€å›¾æ ‡æ ·å¼ç­‰</td></tr></tbody></table><hr><h3 id="ğŸ”š-æ¨èå®è·µ"><a href="#ğŸ”š-æ¨èå®è·µ" class="headerlink" title="ğŸ”š æ¨èå®è·µ"></a>ğŸ”š æ¨èå®è·µ</h3><ul><li>ä½¿ç”¨ <code>Navigation Component</code> å®ç°å¯¼èˆªé€»è¾‘ï¼Œç®€æ´å¯é ã€‚</li><li>éµå¾ª Material Design æŒ‡å—ï¼Œä¼˜åŒ–ç”¨æˆ·ä½“éªŒã€‚</li><li>æŠ½å±‰å†…èœå•ä¸å®œè¿‡å¤šï¼Œæ¨èä¸è¶…è¿‡ 6 é¡¹ã€‚</li><li>ä¸»ç•Œé¢å†…å®¹å»ºè®®ä½¿ç”¨ <code>Fragment</code> æ‰¿è½½ï¼Œä¾¿äºåç»­ç»´æŠ¤ã€‚</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“å¼€å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TiniListä½¿ç”¨è¯¦è§£</title>
      <link href="/2025/04/01/TiniList%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3/"/>
      <url>/2025/04/01/TiniList%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h1 id="TintList-ä½¿ç”¨æŠ€æœ¯æ–‡æ¡£"><a href="#TintList-ä½¿ç”¨æŠ€æœ¯æ–‡æ¡£" class="headerlink" title="TintList ä½¿ç”¨æŠ€æœ¯æ–‡æ¡£"></a>TintList ä½¿ç”¨æŠ€æœ¯æ–‡æ¡£</h1><p>æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç» Android å¼€å‘ä¸­ <code>TintList</code> çš„æ¦‚å¿µã€ä½œç”¨ä»¥åŠä½¿ç”¨æ–¹æ³•ï¼Œå¸®åŠ©å¼€å‘è€…æŒæ¡å¦‚ä½•åˆ©ç”¨ TintList åŠ¨æ€æ”¹å˜æ§ä»¶çš„é¢œè‰²ã€‚</p><hr><h2 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1. æ¦‚è¿°"></a>1. æ¦‚è¿°</h2><p>åœ¨ Android åº”ç”¨å¼€å‘ä¸­ï¼Œç»å¸¸éœ€è¦å¯¹æ§ä»¶çš„èƒŒæ™¯ã€å›¾æ ‡ç­‰å…ƒç´ è¿›è¡Œç€è‰²å¤„ç†ï¼Œä»¥ä¾¿å®ç°åŠ¨æ€ä¸»é¢˜ã€çŠ¶æ€å˜åŒ–åé¦ˆæˆ–ä¸åº”ç”¨æ•´ä½“é£æ ¼ä¿æŒä¸€è‡´ã€‚<code>ColorStateList</code> æ˜¯ Android ä¸­ä¸€ç§æè¿°é¢œè‰²çŠ¶æ€çš„å¯¹è±¡ï¼Œè€Œ <code>TintList</code> åˆ™é€šå¸¸æŒ‡æ§ä»¶çš„èƒŒæ™¯æˆ–å›¾æ ‡çš„â€œç€è‰²åˆ—è¡¨â€ï¼Œå…¶åº•å±‚å®ç°å°±æ˜¯ä½¿ç”¨ <code>ColorStateList</code> å¯¹æ§ä»¶è¿›è¡Œç€è‰²å¤„ç†ã€‚</p><p>ä¾‹å¦‚ï¼Œè®¸å¤šæ§ä»¶ï¼ˆå¦‚ Buttonã€ImageViewã€FloatingActionButton ç­‰ï¼‰æä¾›äº† <code>setBackgroundTintList()</code>ã€<code>setImageTintList()</code> ç­‰æ–¹æ³•ï¼Œä½¿å¾—å¼€å‘è€…å¯ä»¥è½»æ¾åœ°ä¸ºæ§ä»¶è®¾ç½®ä¸åŒçŠ¶æ€ä¸‹çš„é¢œè‰²ã€‚</p><hr><h2 id="2-ColorStateList-åŸºç¡€"><a href="#2-ColorStateList-åŸºç¡€" class="headerlink" title="2. ColorStateList åŸºç¡€"></a>2. ColorStateList åŸºç¡€</h2><p>å…·ä½“å¯çœ‹æˆ‘çš„å¦ä¸€ç¯‡æ–‡ç« <a href="https://goshenc.github.io/2025/04/01/ColorStateList%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3/">ColorStateListä½¿ç”¨è¯¦è§£ | GoshenC</a></p><h3 id="2-1-ä»€ä¹ˆæ˜¯-ColorStateList"><a href="#2-1-ä»€ä¹ˆæ˜¯-ColorStateList" class="headerlink" title="2.1 ä»€ä¹ˆæ˜¯ ColorStateList"></a>2.1 ä»€ä¹ˆæ˜¯ ColorStateList</h3><p><code>ColorStateList</code> æ˜¯ä¸€ä¸ªè¡¨ç¤ºé¢œè‰²åˆ—è¡¨çš„æ•°æ®ç»“æ„ï¼Œèƒ½å¤Ÿæ ¹æ®æ§ä»¶å½“å‰çš„çŠ¶æ€ï¼ˆå¦‚æŒ‰ä¸‹ã€èšç„¦ã€ç¦ç”¨ç­‰ï¼‰è¿”å›ä¸åŒçš„é¢œè‰²ã€‚<br> ä¾‹å¦‚ï¼Œå¯ä»¥å®šä¹‰å¦‚ä¸‹ XML æ–‡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;selector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;</span><br><span class="line">    &lt;!-- æŒ‰ä¸‹çŠ¶æ€ --&gt;</span><br><span class="line">    &lt;item android:state_pressed=&quot;true&quot; android:color=&quot;#FF0000&quot; /&gt;</span><br><span class="line">    &lt;!-- é»˜è®¤çŠ¶æ€ --&gt;</span><br><span class="line">    &lt;item android:color=&quot;#00FF00&quot; /&gt;</span><br><span class="line">&lt;/selector&gt;</span><br></pre></td></tr></table></figure><p>å½“æ§ä»¶å¤„äºæŒ‰ä¸‹çŠ¶æ€æ—¶ï¼Œå…¶é¢œè‰²ä¼šå˜ä¸ºçº¢è‰²ï¼Œå¦åˆ™ä¸ºç»¿è‰²ã€‚</p><h3 id="2-2-åŠ¨æ€åˆ›å»º-ColorStateList"><a href="#2-2-åŠ¨æ€åˆ›å»º-ColorStateList" class="headerlink" title="2.2 åŠ¨æ€åˆ›å»º ColorStateList"></a>2.2 åŠ¨æ€åˆ›å»º ColorStateList</h3><p>é™¤äº†åœ¨ XML ä¸­å®šä¹‰ï¼Œå¼€å‘è€…ä¹Ÿå¯ä»¥åœ¨ä»£ç ä¸­åŠ¨æ€åˆ›å»º ColorStateListï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">val colors = intArrayOf(Color.RED, Color.GREEN)</span><br><span class="line">val states = arrayOf(</span><br><span class="line">    intArrayOf(android.R.attr.state_pressed), // æŒ‰ä¸‹çŠ¶æ€</span><br><span class="line">    intArrayOf()                              // é»˜è®¤çŠ¶æ€</span><br><span class="line">)</span><br><span class="line">val colorStateList = ColorStateList(states, colors)</span><br></pre></td></tr></table></figure><hr><h2 id="3-TintList-çš„ä½¿ç”¨"><a href="#3-TintList-çš„ä½¿ç”¨" class="headerlink" title="3. TintList çš„ä½¿ç”¨"></a>3. TintList çš„ä½¿ç”¨</h2><p>åœ¨å¤§å¤šæ•°åœºæ™¯ä¸­ï¼Œâ€œtintListâ€ é€šå¸¸æŒ‡æ§ä»¶çš„ tint å±æ€§ï¼Œå³èƒŒæ™¯æˆ–å›¾æ ‡çš„ç€è‰²åˆ—è¡¨ã€‚ä»¥ä¸‹ä»¥èƒŒæ™¯ TintList ä¸ºä¾‹è¯´æ˜å…¶ä½¿ç”¨æ–¹æ³•ã€‚</p><h3 id="3-1-æ§ä»¶èƒŒæ™¯ç€è‰²"><a href="#3-1-æ§ä»¶èƒŒæ™¯ç€è‰²" class="headerlink" title="3.1 æ§ä»¶èƒŒæ™¯ç€è‰²"></a>3.1 æ§ä»¶èƒŒæ™¯ç€è‰²</h3><p>è®¸å¤šæ§ä»¶éƒ½æ”¯æŒèƒŒæ™¯ tint è®¾ç½®ï¼Œè¿™æ ·å¯ä»¥å°†æ§ä»¶çš„èƒŒæ™¯é¢œè‰²é€šè¿‡ ColorStateList è¿›è¡ŒåŠ¨æ€æ§åˆ¶ã€‚ä¾‹å¦‚ï¼Œè®¾ç½® FloatingActionButton çš„èƒŒæ™¯ tintï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// å¼•å…¥å¿…è¦çš„åŒ…</span><br><span class="line">import android.content.res.ColorStateList</span><br><span class="line">import android.graphics.Color</span><br><span class="line">import com.google.android.material.floatingactionbutton.FloatingActionButton</span><br><span class="line"></span><br><span class="line">// å‡è®¾ fab ä¸º FloatingActionButton å®ä¾‹</span><br><span class="line">fab.backgroundTintList = ColorStateList.valueOf(Color.WHITE)</span><br></pre></td></tr></table></figure><p>ä¸Šä¾‹ä¸­ï¼Œ<code>ColorStateList.valueOf(Color.WHITE)</code> åˆ›å»ºäº†ä¸€ä¸ªåªæœ‰ç™½è‰²çš„é¢œè‰²çŠ¶æ€åˆ—è¡¨ï¼Œå¼ºåˆ¶å°†æ§ä»¶èƒŒæ™¯æ˜¾ç¤ºä¸ºç™½è‰²ã€‚</p><h3 id="3-2-å›¾æ ‡ç€è‰²"><a href="#3-2-å›¾æ ‡ç€è‰²" class="headerlink" title="3.2 å›¾æ ‡ç€è‰²"></a>3.2 å›¾æ ‡ç€è‰²</h3><p>ç±»ä¼¼åœ°ï¼ŒImageView å’Œå…¶ä»–æ”¯æŒ tint çš„æ§ä»¶ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>setImageTintList()</code> æ–¹æ³•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// å‡è®¾ imageView ä¸º ImageView å®ä¾‹</span><br><span class="line">imageView.imageTintList = ColorStateList.valueOf(Color.BLUE)</span><br></pre></td></tr></table></figure><p>è¿™æ ·ï¼ŒImageView ä¸­çš„å›¾ç‰‡å°†ä¼šåº”ç”¨è“è‰²ç€è‰²ã€‚</p><hr><h2 id="4-ä½¿ç”¨æ¡ˆä¾‹ï¼šè‡ªå®šä¹‰-Snackbar-èƒŒæ™¯å’Œæ–‡å­—é¢œè‰²"><a href="#4-ä½¿ç”¨æ¡ˆä¾‹ï¼šè‡ªå®šä¹‰-Snackbar-èƒŒæ™¯å’Œæ–‡å­—é¢œè‰²" class="headerlink" title="4. ä½¿ç”¨æ¡ˆä¾‹ï¼šè‡ªå®šä¹‰ Snackbar èƒŒæ™¯å’Œæ–‡å­—é¢œè‰²"></a>4. ä½¿ç”¨æ¡ˆä¾‹ï¼šè‡ªå®šä¹‰ Snackbar èƒŒæ™¯å’Œæ–‡å­—é¢œè‰²</h2><p>ä»¥ Snackbar ä¸ºä¾‹è¯´æ˜å¦‚ä½•ä½¿ç”¨ TintList ä¿®æ”¹å…¶èƒŒæ™¯é¢œè‰²ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒSnackbar çš„èƒŒæ™¯å’Œæ–‡å­—é¢œè‰²ç”± Material Design ä¸»é¢˜æ§åˆ¶ï¼Œä½†æœ‰æ—¶éœ€è¦è‡ªå®šä¹‰æ˜¾ç¤ºæ•ˆæœã€‚</p><h3 id="4-1-ç¤ºä¾‹ä»£ç "><a href="#4-1-ç¤ºä¾‹ä»£ç " class="headerlink" title="4.1 ç¤ºä¾‹ä»£ç "></a>4.1 ç¤ºä¾‹ä»£ç </h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">binding.fab.setOnClickListener &#123; view -&gt;</span><br><span class="line">    // åˆ›å»º Snackbar å¯¹è±¡</span><br><span class="line">    val snackbar = Snackbar.make(view, &quot;Data deleted&quot;, Snackbar.LENGTH_SHORT)</span><br><span class="line">        .setAction(&quot;Undo&quot;) &#123;</span><br><span class="line">            Toast.makeText(this, &quot;Data restored&quot;, Toast.LENGTH_SHORT).show()</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    // è·å– Snackbar çš„æ ¹å¸ƒå±€</span><br><span class="line">    val snackbarView = snackbar.view</span><br><span class="line"></span><br><span class="line">    // ä½¿ç”¨ TintList å¼ºåˆ¶è®¾ç½®èƒŒæ™¯ä¸ºç™½è‰²</span><br><span class="line">    snackbarView.backgroundTintList = ColorStateList.valueOf(Color.WHITE)</span><br><span class="line"></span><br><span class="line">    // ä¿®æ”¹æ¶ˆæ¯æ–‡æœ¬é¢œè‰²ä¸ºé»‘è‰²</span><br><span class="line">    val textView = snackbarView.findViewById&lt;TextView&gt;(com.google.android.material.R.id.snackbar_text)</span><br><span class="line">    textView?.setTextColor(Color.BLACK)</span><br><span class="line"></span><br><span class="line">    // ä¿®æ”¹ Action æŒ‰é’®æ–‡æœ¬é¢œè‰²ï¼ˆä¾‹å¦‚è“è‰²ï¼‰</span><br><span class="line">    val actionTextView = snackbarView.findViewById&lt;TextView&gt;(com.google.android.material.R.id.snackbar_action)</span><br><span class="line">    actionTextView?.setTextColor(Color.BLUE)</span><br><span class="line"></span><br><span class="line">    // æ˜¾ç¤º Snackbar</span><br><span class="line">    snackbar.show()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-2-ä»£ç è®²è§£"><a href="#4-2-ä»£ç è®²è§£" class="headerlink" title="4.2 ä»£ç è®²è§£"></a>4.2 ä»£ç è®²è§£</h3><ul><li><strong>åˆ›å»º Snackbarï¼š</strong><br> <code>Snackbar.make(view, &quot;Data deleted&quot;, Snackbar.LENGTH_SHORT)</code> åˆ›å»ºä¸€ä¸ª Snackbarï¼Œå…¶æç¤ºæ–‡æœ¬ä¸º â€œData deletedâ€ï¼ŒæŒç»­æ—¶é—´ä¸ºçŸ­æš‚æ˜¾ç¤ºï¼Œå¹¶é€šè¿‡ <code>setAction(&quot;Undo&quot;)</code> ä¸ºå…¶æ·»åŠ ä¸€ä¸ªæ“ä½œæŒ‰é’®ã€‚å½“ç‚¹å‡» â€œUndoâ€ æŒ‰é’®æ—¶ï¼Œå°†å¼¹å‡º Toastã€‚</li><li><strong>è·å–æ ¹å¸ƒå±€ï¼š</strong><br> <code>snackbar.view</code> è¿”å› Snackbar çš„æ ¹å¸ƒå±€ï¼ˆé€šå¸¸ä¸º Snackbar.SnackbarLayoutï¼‰ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥ä¿®æ”¹å…¶èƒŒæ™¯å’Œå†…éƒ¨æ§ä»¶çš„å±æ€§ã€‚</li><li><strong>è®¾ç½®èƒŒæ™¯ TintListï¼š</strong><br> <code>snackbarView.backgroundTintList = ColorStateList.valueOf(Color.WHITE)</code> ä½¿ç”¨ ColorStateList å°†èƒŒæ™¯é¢œè‰²å¼ºåˆ¶ç€è‰²ä¸ºç™½è‰²ã€‚<br> è¿™é‡Œçš„ <code>ColorStateList.valueOf(Color.WHITE)</code> ç”Ÿæˆäº†ä¸€ä¸ªåªåŒ…å«å•ä¸€é¢œè‰²çš„çŠ¶æ€åˆ—è¡¨ï¼Œæ— è®ºæ§ä»¶å¤„äºä½•ç§çŠ¶æ€éƒ½æ˜¾ç¤ºç™½è‰²ã€‚</li><li><strong>ä¿®æ”¹æ–‡æœ¬é¢œè‰²ï¼š</strong><br> é€šè¿‡ <code>findViewById</code> æ–¹æ³•åˆ†åˆ«è·å–ç”¨äºæ˜¾ç¤ºä¸»è¦æ¶ˆæ¯å’Œ Action æŒ‰é’®æ–‡æœ¬çš„ TextViewï¼Œå¹¶å°†å®ƒä»¬çš„æ–‡æœ¬é¢œè‰²åˆ†åˆ«è®¾ç½®ä¸ºé»‘è‰²å’Œè“è‰²ã€‚</li><li><strong>æ˜¾ç¤º Snackbarï¼š</strong><br> è°ƒç”¨ <code>snackbar.show()</code> æ˜¾ç¤º Snackbarã€‚</li></ul><hr><h2 id="5-TintList-çš„åº”ç”¨åœºæ™¯"><a href="#5-TintList-çš„åº”ç”¨åœºæ™¯" class="headerlink" title="5. TintList çš„åº”ç”¨åœºæ™¯"></a>5. TintList çš„åº”ç”¨åœºæ™¯</h2><ul><li><strong>åŠ¨æ€ä¸»é¢˜åˆ‡æ¢ï¼š</strong> æ ¹æ®ç”¨æˆ·é€‰æ‹©çš„ä¸»é¢˜åŠ¨æ€æ”¹å˜æ§ä»¶é¢œè‰²ã€‚</li><li><strong>çŠ¶æ€åé¦ˆï¼š</strong> æ ¹æ®æ§ä»¶çŠ¶æ€ï¼ˆå¦‚æŒ‰ä¸‹ã€ç¦ç”¨ç­‰ï¼‰æ˜¾ç¤ºä¸åŒé¢œè‰²åé¦ˆã€‚</li><li><strong>è‡ªå®šä¹‰æ§ä»¶ï¼š</strong> å¯¹äºè‡ªå®šä¹‰æ§ä»¶ï¼Œå¯ä»¥é€šè¿‡ TintList å®ç°é¢œè‰²çš„åŠ¨æ€æ›´æ–°ï¼Œè€Œæ— éœ€åˆ›å»ºå¤šä¸ªä¸åŒçš„èµ„æºæ–‡ä»¶ã€‚</li></ul><hr><h2 id="6-æ³¨æ„äº‹é¡¹"><a href="#6-æ³¨æ„äº‹é¡¹" class="headerlink" title="6. æ³¨æ„äº‹é¡¹"></a>6. æ³¨æ„äº‹é¡¹</h2><ul><li><strong>ä¸»é¢˜è¦†ç›–ï¼š</strong> åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œåº”ç”¨ä¸»é¢˜å¯èƒ½ä¼šè¦†ç›–ä»£ç ä¸­å¯¹ TintList çš„è®¾ç½®ã€‚å¦‚æœå‡ºç°è¿™ç§æƒ…å†µï¼Œè¯·æ£€æŸ¥åº”ç”¨çš„ä¸»é¢˜é…ç½®æˆ–é€šè¿‡æ ·å¼æ–‡ä»¶è‡ªå®šä¹‰ç›¸å…³æ§ä»¶çš„é»˜è®¤è¡Œä¸ºã€‚</li><li><strong>å…¼å®¹æ€§ï¼š</strong> å¤§å¤šæ•°æ”¯æŒ tint çš„æ§ä»¶éƒ½å¯ä»¥ä½¿ç”¨ TintListï¼Œä½†å¯¹æŸäº›è‡ªå®šä¹‰æ§ä»¶éœ€è¦ç¡®ä¿å®ƒä»¬æ­£ç¡®å®ç°äº† tint å±æ€§ã€‚</li><li><strong>èµ„æºç¼“å­˜ï¼š</strong> ä¿®æ”¹åå¯èƒ½éœ€è¦æ¸…ç†ç¼“å­˜æˆ–é‡å¯ IDE æ‰èƒ½çœ‹åˆ°æ•ˆæœã€‚</li></ul><hr><h2 id="7-æ€»ç»“"><a href="#7-æ€»ç»“" class="headerlink" title="7. æ€»ç»“"></a>7. æ€»ç»“</h2><p><code>TintList</code>ï¼ˆé€šè¿‡ ColorStateList å®ç°ï¼‰æ˜¯ Android åº”ç”¨å¼€å‘ä¸­ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œèƒ½å¤Ÿå¸®åŠ©å¼€å‘è€…æ ¹æ®æ§ä»¶çŠ¶æ€åŠ¨æ€ä¿®æ”¹é¢œè‰²ã€‚æ— è®ºæ˜¯èƒŒæ™¯ã€å›¾æ ‡è¿˜æ˜¯æ–‡æœ¬é¢œè‰²ï¼Œé€šè¿‡æ­£ç¡®ä½¿ç”¨ TintListï¼Œéƒ½å¯ä»¥ä½¿åº”ç”¨ UI æ›´åŠ çµæ´»å’Œå“åº”ç”¨æˆ·éœ€æ±‚ã€‚å¸Œæœ›æœ¬æŠ€æœ¯æ–‡æ¡£èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å¹¶åº”ç”¨ TintList æŠ€æœ¯ã€‚</p><h2 id="æˆ‘çš„å®é™…åº”ç”¨"><a href="#æˆ‘çš„å®é™…åº”ç”¨" class="headerlink" title="æˆ‘çš„å®é™…åº”ç”¨"></a>æˆ‘çš„å®é™…åº”ç”¨</h2><p>è¿™æ˜¯æˆ‘åœ¨ä¿®æ”¹snackbarä¸­ä½¿ç”¨åˆ°çš„TinitListï¼Œå› ä¸ºé»˜è®¤snackbarçš„æ˜¯é»‘åº•ç™½å­—ï¼Œæˆ‘æƒ³æ”¹æˆç™½åº•é»‘å­—ï¼Œåœ¨ä¿®æ”¹snackbarçš„èƒŒæ™¯é¢œè‰²å‘ç°å±…ç„¶ä¸€å®šå¾—ä½¿ç”¨TintListï¼Œå¦åˆ™ä¿®æ”¹ä¸äº†ï¼Œäºæ˜¯æˆ‘æœ‰æ„Ÿè€Œå‘ï¼Œå†™ä¸‹è¿™ç¯‡æ–‡ç« ã€‚ä»¥ä¸‹æ˜¯æˆ‘å½“æ—¶ä»£ç ä¸­å…³äºTinitListçš„éƒ¨åˆ†ï¼Œå¸Œæœ›èƒ½å¸®åŠ©ä½ ç†è§£ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">binding.fab.setOnClickListener &#123; view -&gt;</span><br><span class="line">    val snackbar = Snackbar.make(view, &quot;Data deleted&quot;, Snackbar.LENGTH_SHORT)</span><br><span class="line">        .setAction(&quot;Undo&quot;) &#123;</span><br><span class="line">            Toast.makeText(this, &quot;Data restored&quot;, Toast.LENGTH_SHORT).show()</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    //è·å– Snackbar çš„ View å¹¶è®¾ç½® tintList å¼ºåˆ¶èƒŒæ™¯ä¸ºç™½è‰².tiniListè¶…çº§è¶…çº§è¶…çº§çº§å‰å®³çš„ï¼Œèƒ½å¼ºåˆ¶ä¿®æ”¹é¢œè‰²ï¼Œ</span><br><span class="line">    //å¯ç”¨åœ¨button,ImageView,FloatingActionButton,ä½†ä¸èƒ½ç”¨åœ¨popupmenuä¸Šï¼Œä¿®æ”¹popupmenuéœ€è¦åœ¨valueä¸­å®šä¹‰styleï¼Œç„¶ååœ¨layoutä¸­ä½¿ç”¨è¿™ä¸ªstyle</span><br><span class="line">    val snackbarView = snackbar.view</span><br><span class="line">    snackbarView.backgroundTintList = ColorStateList.valueOf(Color.WHITE)</span><br><span class="line"></span><br><span class="line">    // è®¾ç½®æ–‡å­—ä¸ºé»‘è‰²</span><br><span class="line">    val textView = snackbarView.findViewById&lt;TextView&gt;(com.google.android.material.R.id.snackbar_text)</span><br><span class="line">    textView?.setTextColor(Color.BLACK)</span><br><span class="line"></span><br><span class="line">    // è®¾ç½® Action æŒ‰é’®çš„é¢œè‰²ï¼ˆè¿™é‡Œç¤ºä¾‹ç”¨é»‘è‰²ï¼Œä½ å¯ä»¥æ¢æˆå…¶å®ƒé¢œè‰²ï¼‰</span><br><span class="line">    val actionTextView = snackbarView.findViewById&lt;TextView&gt;(com.google.android.material.R.id.snackbar_action)</span><br><span class="line">    actionTextView?.setTextColor(Color.BLUE)</span><br><span class="line"></span><br><span class="line">    snackbar.show()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“çŸ¥è¯†ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ColorStateListä½¿ç”¨è¯¦è§£</title>
      <link href="/2025/04/01/ColorStateList%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3/"/>
      <url>/2025/04/01/ColorStateList%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h1 id="ColorStateList-ä½¿ç”¨è¯¦è§£"><a href="#ColorStateList-ä½¿ç”¨è¯¦è§£" class="headerlink" title="ColorStateList ä½¿ç”¨è¯¦è§£"></a><strong>ColorStateList ä½¿ç”¨è¯¦è§£</strong></h1><p><code>ColorStateList</code> æ˜¯ Android ä¸­ç”¨äºç®¡ç†ä¸åŒçŠ¶æ€ä¸‹é¢œè‰²å˜åŒ–çš„å·¥å…·ï¼Œå¸¸ç”¨äºæŒ‰é’®ã€æ–‡æœ¬ã€å›¾æ ‡ç­‰ UI ç»„ä»¶ã€‚æœ¬æ–‡è¯¦ç»†ä»‹ç» <code>ColorStateList</code> çš„å®šä¹‰æ–¹å¼ã€ä½¿ç”¨æ–¹æ³•ä»¥åŠé«˜çº§ç”¨æ³•ã€‚</p><hr><h2 id="1-ColorStateList-ç®€ä»‹"><a href="#1-ColorStateList-ç®€ä»‹" class="headerlink" title="1. ColorStateList ç®€ä»‹"></a><strong>1. ColorStateList ç®€ä»‹</strong></h2><p><code>ColorStateList</code> å…è®¸å¼€å‘è€…ä¸ºæ§ä»¶çš„ä¸åŒçŠ¶æ€æŒ‡å®šä¸åŒçš„é¢œè‰²ã€‚ä¾‹å¦‚ï¼š</p><ul><li>æŒ‰é’®è¢«æŒ‰ä¸‹æ—¶å˜æˆçº¢è‰²ï¼Œé»˜è®¤çŠ¶æ€ä¸‹æ˜¯ç»¿è‰²ã€‚</li><li>æ–‡æœ¬åœ¨è·å–ç„¦ç‚¹æ—¶å˜ä¸ºè“è‰²ï¼Œå¤±å»ç„¦ç‚¹æ¢å¤é»˜è®¤é¢œè‰²ã€‚</li><li>è‡ªå®šä¹‰ <code>Snackbar</code> èƒŒæ™¯é¢œè‰²ã€‚</li></ul><hr><h2 id="2-ColorStateList-çš„åˆ›å»ºæ–¹å¼"><a href="#2-ColorStateList-çš„åˆ›å»ºæ–¹å¼" class="headerlink" title="2. ColorStateList çš„åˆ›å»ºæ–¹å¼"></a><strong>2. ColorStateList çš„åˆ›å»ºæ–¹å¼</strong></h2><h3 id="2-1-åœ¨-XML-ä¸­å®šä¹‰-ColorStateList"><a href="#2-1-åœ¨-XML-ä¸­å®šä¹‰-ColorStateList" class="headerlink" title="2.1 åœ¨ XML ä¸­å®šä¹‰ ColorStateList"></a><strong>2.1 åœ¨ XML ä¸­å®šä¹‰ ColorStateList</strong></h3><p>å¯ä»¥åœ¨ <code>res/color/</code> ç›®å½•ä¸‹åˆ›å»º <code>.xml</code> æ–‡ä»¶æ¥å®šä¹‰ <code>ColorStateList</code>ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;selector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;</span><br><span class="line">    &lt;!-- æŒ‰ä¸‹çŠ¶æ€ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰ --&gt;</span><br><span class="line">    &lt;item android:state_pressed=&quot;true&quot; android:color=&quot;#FF0000&quot; /&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;!-- é€‰ä¸­çŠ¶æ€ --&gt;</span><br><span class="line">    &lt;item android:state_checked=&quot;true&quot; android:color=&quot;#00FF00&quot; /&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;!-- ç¦ç”¨çŠ¶æ€ --&gt;</span><br><span class="line">    &lt;item android:state_enabled=&quot;false&quot; android:color=&quot;#808080&quot; /&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;!-- é»˜è®¤çŠ¶æ€ï¼ˆå¿…é¡»æ”¾æœ€åï¼Œå¦åˆ™å¯èƒ½è¢«å‰é¢çš„çŠ¶æ€åŒ¹é…è¦†ç›–ï¼‰ --&gt;</span><br><span class="line">    &lt;item android:color=&quot;#000000&quot; /&gt;</span><br><span class="line">&lt;/selector&gt;</span><br></pre></td></tr></table></figure><p><strong>è¯´æ˜ï¼š</strong></p><ul><li><code>state_pressed=&quot;true&quot;</code>ï¼šæ§ä»¶è¢«æŒ‰ä¸‹æ—¶ï¼Œé¢œè‰²å˜ä¸º <code>#FF0000</code>ï¼ˆçº¢è‰²ï¼‰ã€‚</li><li><code>state_checked=&quot;true&quot;</code>ï¼šæ§ä»¶è¢«é€‰ä¸­æ—¶ï¼Œé¢œè‰²å˜ä¸º <code>#00FF00</code>ï¼ˆç»¿è‰²ï¼‰ã€‚</li><li><code>state_enabled=&quot;false&quot;</code>ï¼šæ§ä»¶è¢«ç¦ç”¨æ—¶ï¼Œé¢œè‰²å˜ä¸º <code>#808080</code>ï¼ˆç°è‰²ï¼‰ã€‚</li><li><strong>é»˜è®¤é¢œè‰²å¿…é¡»æ”¾åœ¨æœ€å</strong>ï¼Œå¦åˆ™å¯èƒ½ä¼šè¢«å‰é¢çŠ¶æ€è¦†ç›–ã€‚</li></ul><h3 id="2-2-ä»£ç åŠ¨æ€åˆ›å»º-ColorStateList"><a href="#2-2-ä»£ç åŠ¨æ€åˆ›å»º-ColorStateList" class="headerlink" title="2.2 ä»£ç åŠ¨æ€åˆ›å»º ColorStateList"></a><strong>2.2 ä»£ç åŠ¨æ€åˆ›å»º ColorStateList</strong></h3><p>å¦‚æœéœ€è¦åœ¨è¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆ <code>ColorStateList</code>ï¼Œå¯ä»¥ä½¿ç”¨ <code>ColorStateList()</code> æ„é€ æ–¹æ³•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">val states = arrayOf(</span><br><span class="line">    intArrayOf(android.R.attr.state_pressed),  // æŒ‰ä¸‹çŠ¶æ€</span><br><span class="line">    intArrayOf(android.R.attr.state_checked),  // é€‰ä¸­çŠ¶æ€</span><br><span class="line">    intArrayOf(-android.R.attr.state_enabled), // ç¦ç”¨çŠ¶æ€</span><br><span class="line">    intArrayOf()                               // é»˜è®¤çŠ¶æ€</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">val colors = intArrayOf(</span><br><span class="line">    Color.RED,      // æŒ‰ä¸‹æ—¶çº¢è‰²</span><br><span class="line">    Color.GREEN,    // é€‰ä¸­æ—¶ç»¿è‰²</span><br><span class="line">    Color.GRAY,     // ç¦ç”¨æ—¶ç°è‰²</span><br><span class="line">    Color.BLACK     // é»˜è®¤çŠ¶æ€é»‘è‰²</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">// åˆ›å»º ColorStateList å¯¹è±¡</span><br><span class="line">val colorStateList = ColorStateList(states, colors)</span><br></pre></td></tr></table></figure><p><strong>å‚æ•°è§£æï¼š</strong></p><ul><li><code>states</code>ï¼šå®šä¹‰ä¸åŒçŠ¶æ€çš„æ•°ç»„ï¼Œä½¿ç”¨ <code>intArrayOf</code> æ¥è¡¨ç¤ºä¸åŒçš„çŠ¶æ€ã€‚</li><li><code>colors</code>ï¼šä¸ <code>states</code> ä¸€ä¸€å¯¹åº”çš„é¢œè‰²æ•°ç»„ã€‚</li></ul><hr><h2 id="3-ColorStateList-çš„åº”ç”¨åœºæ™¯"><a href="#3-ColorStateList-çš„åº”ç”¨åœºæ™¯" class="headerlink" title="3. ColorStateList çš„åº”ç”¨åœºæ™¯"></a><strong>3. ColorStateList çš„åº”ç”¨åœºæ™¯</strong></h2><h3 id="3-1-è®¾ç½®æ–‡æœ¬é¢œè‰²"><a href="#3-1-è®¾ç½®æ–‡æœ¬é¢œè‰²" class="headerlink" title="3.1 è®¾ç½®æ–‡æœ¬é¢œè‰²"></a><strong>3.1 è®¾ç½®æ–‡æœ¬é¢œè‰²</strong></h3><p><code>TextView</code> åŠå…¶å­ç±»ï¼ˆå¦‚ <code>Button</code>ï¼‰å¯ä»¥ä½¿ç”¨ <code>setTextColor()</code> ç›´æ¥åº”ç”¨ <code>ColorStateList</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">textView.setTextColor(colorStateList)</span><br></pre></td></tr></table></figure><p>å¦‚æœåœ¨ XML ä¸­å®šä¹‰äº† <code>ColorStateList</code>ï¼ˆæ¯”å¦‚ <code>res/color/text_color.xml</code>ï¼‰ï¼Œå¯ä»¥ç›´æ¥åœ¨ XML ä¸­ä½¿ç”¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;TextView</span><br><span class="line">    android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">    android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">    android:text=&quot;Hello World&quot;</span><br><span class="line">    android:textColor=&quot;@color/text_color&quot;/&gt;</span><br></pre></td></tr></table></figure><p>æˆ–è€…åœ¨ä»£ç ä¸­åŠ è½½ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">val textColor = ContextCompat.getColorStateList(context, R.color.text_color)</span><br><span class="line">textView.setTextColor(textColor)</span><br></pre></td></tr></table></figure><hr><h3 id="3-2-è®¾ç½®èƒŒæ™¯é¢œè‰²ï¼ˆTintListï¼‰"><a href="#3-2-è®¾ç½®èƒŒæ™¯é¢œè‰²ï¼ˆTintListï¼‰" class="headerlink" title="3.2 è®¾ç½®èƒŒæ™¯é¢œè‰²ï¼ˆTintListï¼‰"></a><strong>3.2 è®¾ç½®èƒŒæ™¯é¢œè‰²ï¼ˆTintListï¼‰</strong></h3><p>æœ‰äº›æ§ä»¶ï¼ˆå¦‚ <code>FloatingActionButton</code>ã€<code>Button</code>ï¼‰æ”¯æŒ <code>backgroundTintList</code>ï¼Œå¯ç”¨äºæ”¹å˜èƒŒæ™¯é¢œè‰²ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fab.backgroundTintList = colorStateList</span><br><span class="line">button.backgroundTintList = colorStateList</span><br></pre></td></tr></table></figure><p>åœ¨ XML ä¸­å¯ä»¥ä½¿ç”¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">xmlå¤åˆ¶ç¼–è¾‘&lt;Button</span><br><span class="line">    android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">    android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">    android:text=&quot;Click Me&quot;</span><br><span class="line">    android:backgroundTint=&quot;@color/button_color&quot;/&gt;</span><br></pre></td></tr></table></figure><hr><h3 id="3-3-è®¾ç½®å›¾æ ‡é¢œè‰²ï¼ˆImageView-Drawableï¼‰"><a href="#3-3-è®¾ç½®å›¾æ ‡é¢œè‰²ï¼ˆImageView-Drawableï¼‰" class="headerlink" title="3.3 è®¾ç½®å›¾æ ‡é¢œè‰²ï¼ˆImageView &amp; Drawableï¼‰"></a><strong>3.3 è®¾ç½®å›¾æ ‡é¢œè‰²ï¼ˆImageView &amp; Drawableï¼‰</strong></h3><p>å¯¹äº <code>ImageView</code>ï¼Œå¯ä»¥ä½¿ç”¨ <code>setImageTintList()</code> è®¾ç½® Tint é¢œè‰²ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">imageView.imageTintList = colorStateList</span><br></pre></td></tr></table></figure><p>å¯¹äº <code>Drawable</code>ï¼Œå¯ä»¥ä½¿ç”¨ <code>setTintList()</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">val drawable = ContextCompat.getDrawable(context, R.drawable.ic_example)</span><br><span class="line">drawable?.setTintList(colorStateList)</span><br><span class="line">imageView.setImageDrawable(drawable)</span><br></pre></td></tr></table></figure><hr><h3 id="3-4-è®¾ç½®-Snackbar-èƒŒæ™¯é¢œè‰²"><a href="#3-4-è®¾ç½®-Snackbar-èƒŒæ™¯é¢œè‰²" class="headerlink" title="3.4 è®¾ç½® Snackbar èƒŒæ™¯é¢œè‰²"></a><strong>3.4 è®¾ç½® Snackbar èƒŒæ™¯é¢œè‰²</strong></h3><p>åœ¨ <code>Snackbar</code> ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>backgroundTintList</code> æ¥æ”¹å˜èƒŒæ™¯é¢œè‰²ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">val snackbar = Snackbar.make(view, &quot;Hello Snackbar&quot;, Snackbar.LENGTH_SHORT)</span><br><span class="line"></span><br><span class="line">// ä¿®æ”¹èƒŒæ™¯é¢œè‰²</span><br><span class="line">snackbar.view.backgroundTintList = colorStateList</span><br><span class="line"></span><br><span class="line">// ä¿®æ”¹æ–‡å­—é¢œè‰²</span><br><span class="line">val textView = snackbar.view.findViewById&lt;TextView&gt;(com.google.android.material.R.id.snackbar_text)</span><br><span class="line">textView.setTextColor(Color.BLACK)</span><br><span class="line"></span><br><span class="line">snackbar.show()</span><br></pre></td></tr></table></figure><hr><h3 id="3-5-è®¾ç½®-PopupMenu-é¢œè‰²"><a href="#3-5-è®¾ç½®-PopupMenu-é¢œè‰²" class="headerlink" title="3.5 è®¾ç½® PopupMenu é¢œè‰²"></a><strong>3.5 è®¾ç½® PopupMenu é¢œè‰²</strong></h3><p><code>PopupMenu</code> é»˜è®¤é¢œè‰²å— Material Design ä¸»é¢˜å½±å“ï¼Œå¯ä»¥ç”¨ <code>ColorStateList</code> ä¿®æ”¹ <code>MenuItem</code> é¢œè‰²ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">val popupMenu = PopupMenu(this, view)</span><br><span class="line">popupMenu.menuInflater.inflate(R.menu.popup_menu, popupMenu.menu)</span><br><span class="line"></span><br><span class="line">// è·å– PopupMenu çš„ MenuItem å¹¶è®¾ç½® TextColor</span><br><span class="line">for (i in 0 until popupMenu.menu.size()) &#123;</span><br><span class="line">    val item = popupMenu.menu.getItem(i)</span><br><span class="line">    val spannable = SpannableString(item.title)</span><br><span class="line">    spannable.setSpan(ForegroundColorSpan(Color.RED), 0, spannable.length, 0)</span><br><span class="line">    item.title = spannable</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">popupMenu.show()</span><br></pre></td></tr></table></figure><hr><h2 id="4-é«˜çº§ç”¨æ³•"><a href="#4-é«˜çº§ç”¨æ³•" class="headerlink" title="4. é«˜çº§ç”¨æ³•"></a><strong>4. é«˜çº§ç”¨æ³•</strong></h2><h3 id="4-1-ä½¿ç”¨-withAlpha-æ”¹å˜é€æ˜åº¦"><a href="#4-1-ä½¿ç”¨-withAlpha-æ”¹å˜é€æ˜åº¦" class="headerlink" title="4.1 ä½¿ç”¨ withAlpha() æ”¹å˜é€æ˜åº¦"></a><strong>4.1 ä½¿ç”¨ withAlpha() æ”¹å˜é€æ˜åº¦</strong></h3><p><code>ColorStateList.valueOf(Color.RED).withAlpha(128)</code> å¯ä»¥ä¸ºé¢œè‰²å¢åŠ é€æ˜åº¦ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">val colorStateList = ColorStateList.valueOf(Color.RED).withAlpha(128)</span><br><span class="line">textView.setTextColor(colorStateList)</span><br></pre></td></tr></table></figure><hr><h3 id="4-2-ç»“åˆ-Material-Theme-é€‚é…æš—é»‘æ¨¡å¼"><a href="#4-2-ç»“åˆ-Material-Theme-é€‚é…æš—é»‘æ¨¡å¼" class="headerlink" title="4.2 ç»“åˆ Material Theme é€‚é…æš—é»‘æ¨¡å¼"></a><strong>4.2 ç»“åˆ Material Theme é€‚é…æš—é»‘æ¨¡å¼</strong></h3><p>åœ¨ <code>res/color/</code> ç›®å½•ä¸‹åˆ›å»º <code>color.xml</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;selector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;</span><br><span class="line">    &lt;item android:color=&quot;?attr/colorPrimary&quot; /&gt;</span><br><span class="line">&lt;/selector&gt;</span><br></pre></td></tr></table></figure><p>è¿™æ · <code>ColorStateList</code> ä¼šè‡ªåŠ¨é€‚é… Material Theme é¢œè‰²ã€‚</p><hr><h2 id="5-æ€»ç»“"><a href="#5-æ€»ç»“" class="headerlink" title="5. æ€»ç»“"></a><strong>5. æ€»ç»“</strong></h2><ol><li><code>ColorStateList</code> å…è®¸ä¸ºæ§ä»¶çš„ä¸åŒçŠ¶æ€æŒ‡å®šä¸åŒé¢œè‰²ï¼Œæ”¯æŒ XML å’Œä»£ç åˆ›å»ºã€‚</li><li>å¸¸ç”¨äº <code>TextView</code>ã€<code>Button</code>ã€<code>ImageView</code>ã€<code>Snackbar</code>ã€<code>PopupMenu</code> ç­‰æ§ä»¶çš„é¢œè‰²æ§åˆ¶ã€‚</li><li>ç»“åˆ <code>TintList</code> å¯ä»¥æ”¹å˜èƒŒæ™¯ã€å›¾æ ‡ã€Drawable é¢œè‰²ã€‚</li><li>é€šè¿‡ <code>withAlpha()</code> å¯ä»¥è°ƒæ•´é€æ˜åº¦ï¼Œç»“åˆ Material Theme å¯é€‚é…æš—é»‘æ¨¡å¼ã€‚</li></ol><p>æŒæ¡ <code>ColorStateList</code> å’Œ <code>TintList</code>ï¼Œå¯ä»¥è®© UI é¢œè‰²æ§åˆ¶æ›´åŠ çµæ´»ï¼</p><h1 id="æˆ‘çš„å®è·µ-å®ç°ä¸€ä¸ªæŒ‰é’®æŒ‰ä¸‹æ—¶å˜æˆçº¢è‰²ï¼Œé»˜è®¤çŠ¶æ€ä¸‹æ˜¯ç»¿è‰²"><a href="#æˆ‘çš„å®è·µ-å®ç°ä¸€ä¸ªæŒ‰é’®æŒ‰ä¸‹æ—¶å˜æˆçº¢è‰²ï¼Œé»˜è®¤çŠ¶æ€ä¸‹æ˜¯ç»¿è‰²" class="headerlink" title="æˆ‘çš„å®è·µ å®ç°ä¸€ä¸ªæŒ‰é’®æŒ‰ä¸‹æ—¶å˜æˆçº¢è‰²ï¼Œé»˜è®¤çŠ¶æ€ä¸‹æ˜¯ç»¿è‰²"></a>æˆ‘çš„å®è·µ å®ç°ä¸€ä¸ªæŒ‰é’®æŒ‰ä¸‹æ—¶å˜æˆçº¢è‰²ï¼Œé»˜è®¤çŠ¶æ€ä¸‹æ˜¯ç»¿è‰²</h1><p>è¦å®ç°â€œæŒ‰é’®è¢«æŒ‰ä¸‹æ—¶å˜æˆçº¢è‰²ï¼Œé»˜è®¤çŠ¶æ€ä¸‹æ˜¯ç»¿è‰²â€ï¼Œå¯ä»¥ä½¿ç”¨ <code>ColorStateList</code> ç»“åˆ <code>backgroundTintList</code> æˆ– <code>textColor</code>ã€‚ä¸‹é¢æ˜¯å…·ä½“çš„ XML å’Œ Kotlin ä»£ç ç¤ºä¾‹ã€‚</p><hr><h2 id="æ–¹å¼-1ï¼šä½¿ç”¨-XML-å®šä¹‰-ColorStateList"><a href="#æ–¹å¼-1ï¼šä½¿ç”¨-XML-å®šä¹‰-ColorStateList" class="headerlink" title="æ–¹å¼ 1ï¼šä½¿ç”¨ XML å®šä¹‰ ColorStateList"></a><strong>æ–¹å¼ 1ï¼šä½¿ç”¨ XML å®šä¹‰ ColorStateList</strong></h2><h3 id="1-1-åˆ›å»ºæŒ‰é’®é¢œè‰²çŠ¶æ€åˆ—è¡¨"><a href="#1-1-åˆ›å»ºæŒ‰é’®é¢œè‰²çŠ¶æ€åˆ—è¡¨" class="headerlink" title="1.1 åˆ›å»ºæŒ‰é’®é¢œè‰²çŠ¶æ€åˆ—è¡¨"></a><strong>1.1 åˆ›å»ºæŒ‰é’®é¢œè‰²çŠ¶æ€åˆ—è¡¨</strong></h3><p>åœ¨ <code>res/color/</code> ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª <code>button_color.xml</code> æ–‡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;selector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;</span><br><span class="line">    &lt;!-- æŒ‰ä¸‹çŠ¶æ€ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰ --&gt;</span><br><span class="line">    &lt;item android:state_pressed=&quot;true&quot; android:color=&quot;#FF0000&quot; /&gt; &lt;!-- çº¢è‰² --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- é»˜è®¤çŠ¶æ€ï¼ˆæœ€åå®šä¹‰ï¼‰ --&gt;</span><br><span class="line">    &lt;item android:color=&quot;#00FF00&quot; /&gt; &lt;!-- ç»¿è‰² --&gt;</span><br><span class="line">&lt;/selector&gt;</span><br></pre></td></tr></table></figure><hr><h3 id="1-2-åœ¨-XML-å¸ƒå±€ä¸­åº”ç”¨"><a href="#1-2-åœ¨-XML-å¸ƒå±€ä¸­åº”ç”¨" class="headerlink" title="1.2 åœ¨ XML å¸ƒå±€ä¸­åº”ç”¨"></a><strong>1.2 åœ¨ XML å¸ƒå±€ä¸­åº”ç”¨</strong></h3><p>åœ¨ <code>activity_main.xml</code> ä¸­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;Button</span><br><span class="line">    android:id=&quot;@+id/myButton&quot;</span><br><span class="line">    android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">    android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">    android:text=&quot;Click Me&quot;</span><br><span class="line">    android:textColor=&quot;@android:color/white&quot;</span><br><span class="line">    android:backgroundTint=&quot;@color/button_color&quot;/&gt;</span><br></pre></td></tr></table></figure><p><strong>è§£é‡Šï¼š</strong></p><ul><li>è¿™ä¸ª <code>Button</code> çš„èƒŒæ™¯é¢œè‰²ç”± <code>button_color.xml</code> æ§åˆ¶ã€‚</li><li>å½“ <code>state_pressed=&quot;true&quot;</code>ï¼ˆå³æŒ‰é’®è¢«æŒ‰ä¸‹æ—¶ï¼‰ï¼ŒèƒŒæ™¯å˜ä¸º <code>#FF0000</code>ï¼ˆçº¢è‰²ï¼‰ã€‚</li><li>å…¶ä»–æƒ…å†µä¸‹ï¼ŒèƒŒæ™¯ä¿æŒ <code>#00FF00</code>ï¼ˆç»¿è‰²ï¼‰ã€‚</li></ul><hr><h2 id="æ–¹å¼-2ï¼šåœ¨ä»£ç ä¸­åŠ¨æ€åˆ›å»º-ColorStateList"><a href="#æ–¹å¼-2ï¼šåœ¨ä»£ç ä¸­åŠ¨æ€åˆ›å»º-ColorStateList" class="headerlink" title="æ–¹å¼ 2ï¼šåœ¨ä»£ç ä¸­åŠ¨æ€åˆ›å»º ColorStateList"></a><strong>æ–¹å¼ 2ï¼šåœ¨ä»£ç ä¸­åŠ¨æ€åˆ›å»º ColorStateList</strong></h2><p>å¦‚æœä¸æƒ³ä½¿ç”¨ XMLï¼Œå¯ä»¥ç›´æ¥åœ¨ Kotlin ä»£ç ä¸­åŠ¨æ€åˆ›å»º <code>ColorStateList</code>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import android.content.res.ColorStateList</span><br><span class="line">import android.graphics.Color</span><br><span class="line">import android.os.Bundle</span><br><span class="line">import android.widget.Button</span><br><span class="line">import androidx.appcompat.app.AppCompatActivity</span><br><span class="line"></span><br><span class="line">class MainActivity : AppCompatActivity() &#123;</span><br><span class="line">    override fun onCreate(savedInstanceState: Bundle?) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line"></span><br><span class="line">        val myButton: Button = findViewById(R.id.myButton)</span><br><span class="line"></span><br><span class="line">        // å®šä¹‰æŒ‰é’®ä¸åŒçŠ¶æ€çš„é¢œè‰²</span><br><span class="line">        val states = arrayOf(</span><br><span class="line">            intArrayOf(android.R.attr.state_pressed),  // æŒ‰ä¸‹çŠ¶æ€</span><br><span class="line">            intArrayOf()  // é»˜è®¤çŠ¶æ€</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        val colors = intArrayOf(</span><br><span class="line">            Color.RED,    // æŒ‰ä¸‹æ—¶çº¢è‰²</span><br><span class="line">            Color.GREEN   // é»˜è®¤çŠ¶æ€ç»¿è‰²</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        // åˆ›å»º ColorStateList å¹¶åº”ç”¨åˆ°æŒ‰é’®èƒŒæ™¯</span><br><span class="line">        val colorStateList = ColorStateList(states, colors)</span><br><span class="line">        myButton.backgroundTintList = colorStateList</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è§£é‡Šï¼š</strong></p><ul><li><code>states</code> å®šä¹‰äº†ä¸¤ç§çŠ¶æ€ï¼š<ul><li><code>android.R.attr.state_pressed</code>ï¼ˆæŒ‰é’®è¢«æŒ‰ä¸‹ï¼‰ã€‚</li><li><code>intArrayOf()</code> ä»£è¡¨é»˜è®¤çŠ¶æ€ã€‚</li></ul></li><li><code>colors</code> å®šä¹‰äº†å¯¹åº”çŠ¶æ€çš„é¢œè‰²ï¼š<ul><li>æŒ‰ä¸‹æ—¶ï¼ˆ<code>state_pressed</code>ï¼‰æ˜¯çº¢è‰² (<code>Color.RED</code>)ã€‚</li><li>é»˜è®¤çŠ¶æ€æ˜¯ç»¿è‰² (<code>Color.GREEN</code>)ã€‚</li></ul></li><li><code>myButton.backgroundTintList = colorStateList</code> åº”ç”¨ <code>ColorStateList</code>ã€‚</li></ul><hr><h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a><strong>æ•ˆæœ</strong></h2><ol><li>æŒ‰é’®é»˜è®¤æƒ…å†µä¸‹æ˜¯ç»¿è‰²ã€‚</li><li>å½“ç”¨æˆ·æŒ‰ä¸‹æŒ‰é’®æ—¶ï¼ŒæŒ‰é’®å˜ä¸ºçº¢è‰²ã€‚</li><li>æ¾å¼€åæ¢å¤ä¸ºç»¿è‰²ã€‚</li></ol><p>è¿™æ ·ï¼Œä½ å°±æˆåŠŸè®©æŒ‰é’®æŒ‰ä¸‹å˜çº¢ï¼Œæ¾å¼€å˜ç»¿äº†ï¼ğŸš€</p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“çŸ¥è¯†ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android Material3 èµ„æºç®¡ç†å…¨è§£æ:Color,String,Style,Dimen,Array</title>
      <link href="/2025/03/31/Android%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E5%85%A8%E8%A7%A3%E6%9E%90-Color-String-Style-Dimen-Array/"/>
      <url>/2025/03/31/Android%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E5%85%A8%E8%A7%A3%E6%9E%90-Color-String-Style-Dimen-Array/</url>
      
        <content type="html"><![CDATA[<h1 id="Android-èµ„æºç®¡ç†å…¨è§£æï¼šColorã€Stringã€Styleã€Dimenã€Array"><a href="#Android-èµ„æºç®¡ç†å…¨è§£æï¼šColorã€Stringã€Styleã€Dimenã€Array" class="headerlink" title="Android èµ„æºç®¡ç†å…¨è§£æï¼šColorã€Stringã€Styleã€Dimenã€Array"></a>Android èµ„æºç®¡ç†å…¨è§£æï¼šColorã€Stringã€Styleã€Dimenã€Array</h1><h2 id="1-èµ„æºï¼ˆResourceï¼‰æ¦‚è¿°"><a href="#1-èµ„æºï¼ˆResourceï¼‰æ¦‚è¿°" class="headerlink" title="1. èµ„æºï¼ˆResourceï¼‰æ¦‚è¿°"></a>1. èµ„æºï¼ˆResourceï¼‰æ¦‚è¿°</h2><p>åœ¨ Android å¼€å‘ä¸­ï¼Œèµ„æºæ–‡ä»¶ï¼ˆres&#x2F;values ç›®å½•ï¼‰ç”¨äºå­˜å‚¨ <strong>é¢œè‰²ã€æ–‡æœ¬ã€æ ·å¼ã€å°ºå¯¸ã€æ•°ç»„</strong> ç­‰ <strong>éä»£ç </strong> å†…å®¹ï¼Œä¾¿äºï¼š</p><ul><li>ç»Ÿä¸€ç®¡ç† UI é£æ ¼ï¼Œå¢å¼ºå¯ç»´æŠ¤æ€§</li><li>æ”¯æŒ <strong>å¤šè¯­è¨€ï¼ˆå›½é™…åŒ–ï¼‰</strong></li><li>é€‚é… <strong>ä¸åŒå±å¹•å¯†åº¦ã€å°ºå¯¸ã€æ¨¡å¼ï¼ˆå¤œé—´æ¨¡å¼ç­‰ï¼‰</strong></li><li>æé«˜åº”ç”¨çš„ <strong>å¤ç”¨æ€§å’Œçµæ´»æ€§</strong></li></ul><hr><h2 id="2-é¢œè‰²èµ„æºï¼ˆColorï¼‰"><a href="#2-é¢œè‰²èµ„æºï¼ˆColorï¼‰" class="headerlink" title="2. é¢œè‰²èµ„æºï¼ˆColorï¼‰"></a>2. é¢œè‰²èµ„æºï¼ˆColorï¼‰</h2><h3 id="2-1-å®šä¹‰é¢œè‰²ï¼ˆcolors-xmlï¼‰"><a href="#2-1-å®šä¹‰é¢œè‰²ï¼ˆcolors-xmlï¼‰" class="headerlink" title="2.1 å®šä¹‰é¢œè‰²ï¼ˆcolors.xmlï¼‰"></a>2.1 å®šä¹‰é¢œè‰²ï¼ˆcolors.xmlï¼‰</h3><p>é¢œè‰²èµ„æºç”¨äº <strong>å®šä¹‰ UI ç»„ä»¶çš„é¢œè‰²</strong>ï¼Œå¯å­˜å‚¨åœ¨ <code>res/values/colors.xml</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;resources&gt;</span><br><span class="line">    &lt;!-- åŸºç¡€é¢œè‰² --&gt;</span><br><span class="line">    &lt;color name=&quot;black&quot;&gt;#000000&lt;/color&gt;</span><br><span class="line">    &lt;color name=&quot;white&quot;&gt;#FFFFFF&lt;/color&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- ä¸»é¢˜é¢œè‰² --&gt;</span><br><span class="line">    &lt;color name=&quot;primary&quot;&gt;#6200EE&lt;/color&gt;</span><br><span class="line">    &lt;color name=&quot;primaryVariant&quot;&gt;#3700B3&lt;/color&gt;</span><br><span class="line">    &lt;color name=&quot;secondary&quot;&gt;#03DAC6&lt;/color&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- è‡ªå®šä¹‰åŠ¨æ€è‰²å½© --&gt;</span><br><span class="line">    &lt;color name=&quot;md_theme_light_primary&quot;&gt;#6750A4&lt;/color&gt;</span><br><span class="line">    &lt;color name=&quot;md_theme_dark_primary&quot;&gt;#D0BCFF&lt;/color&gt;</span><br><span class="line">&lt;/resources&gt;</span><br></pre></td></tr></table></figure><h3 id="2-2-é¢œè‰²çš„å¼•ç”¨"><a href="#2-2-é¢œè‰²çš„å¼•ç”¨" class="headerlink" title="2.2 é¢œè‰²çš„å¼•ç”¨"></a>2.2 é¢œè‰²çš„å¼•ç”¨</h3><h4 id="1-åœ¨-XML-å¸ƒå±€ä¸­"><a href="#1-åœ¨-XML-å¸ƒå±€ä¸­" class="headerlink" title="(1) åœ¨ XML å¸ƒå±€ä¸­"></a><strong>(1) åœ¨ XML å¸ƒå±€ä¸­</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;TextView</span><br><span class="line">    android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">    android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">    android:textColor=&quot;@color/primary&quot; /&gt;</span><br></pre></td></tr></table></figure><h4 id="2-åœ¨-styles-xml"><a href="#2-åœ¨-styles-xml" class="headerlink" title="(2) åœ¨ styles.xml"></a><strong>(2) åœ¨ styles.xml</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;item name=&quot;android:textColor&quot;&gt;@color/primary&lt;/item&gt;</span><br></pre></td></tr></table></figure><h4 id="3-åœ¨-Kotlin-ä»£ç ä¸­"><a href="#3-åœ¨-Kotlin-ä»£ç ä¸­" class="headerlink" title="(3) åœ¨ Kotlin ä»£ç ä¸­"></a><strong>(3) åœ¨ Kotlin ä»£ç ä¸­</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">val color = ContextCompat.getColor(context, R.color.primary)</span><br><span class="line">textView.setTextColor(color)</span><br></pre></td></tr></table></figure><h3 id="2-3-é€‚é…å¤œé—´æ¨¡å¼ï¼ˆvalues-night-colors-xmlï¼‰"><a href="#2-3-é€‚é…å¤œé—´æ¨¡å¼ï¼ˆvalues-night-colors-xmlï¼‰" class="headerlink" title="2.3 é€‚é…å¤œé—´æ¨¡å¼ï¼ˆvalues-night&#x2F;colors.xmlï¼‰"></a>2.3 é€‚é…å¤œé—´æ¨¡å¼ï¼ˆvalues-night&#x2F;colors.xmlï¼‰</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;resources&gt;</span><br><span class="line">    &lt;color name=&quot;primary&quot;&gt;#BB86FC&lt;/color&gt; &lt;!-- å¤œé—´æ¨¡å¼é¢œè‰² --&gt;</span><br><span class="line">&lt;/resources&gt;</span><br></pre></td></tr></table></figure><hr><h2 id="3-å­—ç¬¦ä¸²èµ„æºï¼ˆStringï¼‰"><a href="#3-å­—ç¬¦ä¸²èµ„æºï¼ˆStringï¼‰" class="headerlink" title="3. å­—ç¬¦ä¸²èµ„æºï¼ˆStringï¼‰"></a>3. å­—ç¬¦ä¸²èµ„æºï¼ˆStringï¼‰</h2><h3 id="3-1-å®šä¹‰å­—ç¬¦ä¸²ï¼ˆstrings-xmlï¼‰"><a href="#3-1-å®šä¹‰å­—ç¬¦ä¸²ï¼ˆstrings-xmlï¼‰" class="headerlink" title="3.1 å®šä¹‰å­—ç¬¦ä¸²ï¼ˆstrings.xmlï¼‰"></a>3.1 å®šä¹‰å­—ç¬¦ä¸²ï¼ˆstrings.xmlï¼‰</h3><p>å­—ç¬¦ä¸²èµ„æºå­˜æ”¾åœ¨ <code>res/values/strings.xml</code>ï¼Œç”¨äº <strong>æ–‡æœ¬å›½é™…åŒ–ã€å¤šè¯­è¨€é€‚é…</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;resources&gt;</span><br><span class="line">    &lt;string name=&quot;app_name&quot;&gt;My Material3 App&lt;/string&gt;</span><br><span class="line">    &lt;string name=&quot;hello_world&quot;&gt;Hello, Material3!&lt;/string&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- å¸¦æ ¼å¼å‚æ•° --&gt;</span><br><span class="line">    &lt;string name=&quot;welcome_message&quot;&gt;Welcome, %1$s!&lt;/string&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- HTML å¯Œæ–‡æœ¬ --&gt;</span><br><span class="line">    &lt;string name=&quot;html_text&quot;&gt;&lt;![CDATA[&lt;b&gt;Bold Text&lt;/b&gt;]]&gt;&lt;/string&gt;</span><br><span class="line">&lt;/resources&gt;</span><br></pre></td></tr></table></figure><h3 id="3-2-å­—ç¬¦ä¸²çš„å¼•ç”¨"><a href="#3-2-å­—ç¬¦ä¸²çš„å¼•ç”¨" class="headerlink" title="3.2 å­—ç¬¦ä¸²çš„å¼•ç”¨"></a>3.2 å­—ç¬¦ä¸²çš„å¼•ç”¨</h3><h4 id="1-åœ¨-XML-å¸ƒå±€ä¸­-1"><a href="#1-åœ¨-XML-å¸ƒå±€ä¸­-1" class="headerlink" title="(1) åœ¨ XML å¸ƒå±€ä¸­"></a><strong>(1) åœ¨ XML å¸ƒå±€ä¸­</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xmlå¤åˆ¶ç¼–è¾‘&lt;TextView</span><br><span class="line">    android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">    android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">    android:text=&quot;@string/hello_world&quot; /&gt;</span><br></pre></td></tr></table></figure><h4 id="2-åœ¨-Kotlin-ä»£ç ä¸­"><a href="#2-åœ¨-Kotlin-ä»£ç ä¸­" class="headerlink" title="(2) åœ¨ Kotlin ä»£ç ä¸­"></a><strong>(2) åœ¨ Kotlin ä»£ç ä¸­</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val welcome = getString(R.string.welcome_message, &quot;Alice&quot;)</span><br></pre></td></tr></table></figure><h4 id="3-æ”¯æŒå¤šè¯­è¨€"><a href="#3-æ”¯æŒå¤šè¯­è¨€" class="headerlink" title="(3) æ”¯æŒå¤šè¯­è¨€"></a><strong>(3) æ”¯æŒå¤šè¯­è¨€</strong></h4><p>åœ¨ <code>res/values-es/strings.xml</code> å®šä¹‰è¥¿ç­ç‰™è¯­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;resources&gt;</span><br><span class="line">    &lt;string name=&quot;hello_world&quot;&gt;Â¡Hola, Material3!&lt;/string&gt;</span><br><span class="line">&lt;/resources&gt;</span><br></pre></td></tr></table></figure><hr><h2 id="4-æ ·å¼èµ„æºï¼ˆStyleï¼‰"><a href="#4-æ ·å¼èµ„æºï¼ˆStyleï¼‰" class="headerlink" title="4. æ ·å¼èµ„æºï¼ˆStyleï¼‰"></a>4. æ ·å¼èµ„æºï¼ˆStyleï¼‰</h2><h3 id="4-1-å®šä¹‰æ ·å¼ï¼ˆstyles-xmlï¼‰"><a href="#4-1-å®šä¹‰æ ·å¼ï¼ˆstyles-xmlï¼‰" class="headerlink" title="4.1 å®šä¹‰æ ·å¼ï¼ˆstyles.xmlï¼‰"></a>4.1 å®šä¹‰æ ·å¼ï¼ˆstyles.xmlï¼‰</h3><p><code>styles.xml</code> å…è®¸ <strong>å¤ç”¨ UI å±æ€§</strong>ï¼Œå‡å°‘ä»£ç å†—ä½™ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;resources&gt;</span><br><span class="line">    &lt;!-- è‡ªå®šä¹‰æŒ‰é’®æ ·å¼ --&gt;</span><br><span class="line">    &lt;style name=&quot;CustomButton&quot; parent=&quot;Widget.Material3.Button&quot;&gt;</span><br><span class="line">        &lt;item name=&quot;android:backgroundTint&quot;&gt;@color/primary&lt;/item&gt;</span><br><span class="line">        &lt;item name=&quot;android:textColor&quot;&gt;@color/white&lt;/item&gt;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/resources&gt;</span><br></pre></td></tr></table></figure><h3 id="4-2-æ ·å¼çš„å¼•ç”¨"><a href="#4-2-æ ·å¼çš„å¼•ç”¨" class="headerlink" title="4.2 æ ·å¼çš„å¼•ç”¨"></a>4.2 æ ·å¼çš„å¼•ç”¨</h3><h4 id="1-åœ¨-XML-å¸ƒå±€ä¸­-2"><a href="#1-åœ¨-XML-å¸ƒå±€ä¸­-2" class="headerlink" title="(1) åœ¨ XML å¸ƒå±€ä¸­"></a><strong>(1) åœ¨ XML å¸ƒå±€ä¸­</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;Button</span><br><span class="line">    style=&quot;@style/CustomButton&quot;</span><br><span class="line">    android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">    android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">    android:text=&quot;Click Me&quot; /&gt;</span><br></pre></td></tr></table></figure><h4 id="2-ä¸»é¢˜ï¼ˆThemeï¼‰"><a href="#2-ä¸»é¢˜ï¼ˆThemeï¼‰" class="headerlink" title="(2) ä¸»é¢˜ï¼ˆThemeï¼‰"></a><strong>(2) ä¸»é¢˜ï¼ˆThemeï¼‰</strong></h4><p><code>themes.xml</code> è®¾å®šå…¨å±€ä¸»é¢˜ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;style name=&quot;Theme.MaterialTest&quot; parent=&quot;Theme.Material3.Light.NoActionBar&quot;&gt;</span><br><span class="line">    &lt;item name=&quot;colorPrimary&quot;&gt;@color/primary&lt;/item&gt;</span><br><span class="line">    &lt;item name=&quot;android:buttonStyle&quot;&gt;@style/CustomButton&lt;/item&gt;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h4 id="3-åœ¨ä»£ç ä¸­åº”ç”¨"><a href="#3-åœ¨ä»£ç ä¸­åº”ç”¨" class="headerlink" title="(3) åœ¨ä»£ç ä¸­åº”ç”¨"></a><strong>(3) åœ¨ä»£ç ä¸­åº”ç”¨</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">button.setTextAppearance(R.style.CustomButton)</span><br></pre></td></tr></table></figure><hr><h2 id="5-å°ºå¯¸èµ„æºï¼ˆDimenï¼‰"><a href="#5-å°ºå¯¸èµ„æºï¼ˆDimenï¼‰" class="headerlink" title="5. å°ºå¯¸èµ„æºï¼ˆDimenï¼‰"></a>5. å°ºå¯¸èµ„æºï¼ˆDimenï¼‰</h2><h3 id="5-1-å®šä¹‰å°ºå¯¸ï¼ˆdimens-xmlï¼‰"><a href="#5-1-å®šä¹‰å°ºå¯¸ï¼ˆdimens-xmlï¼‰" class="headerlink" title="5.1 å®šä¹‰å°ºå¯¸ï¼ˆdimens.xmlï¼‰"></a>5.1 å®šä¹‰å°ºå¯¸ï¼ˆdimens.xmlï¼‰</h3><p><code>dimens.xml</code> ç”¨äºå®šä¹‰ <strong>åƒç´ ã€dpã€spã€pt ç­‰å°ºå¯¸</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;resources&gt;</span><br><span class="line">    &lt;dimen name=&quot;padding_small&quot;&gt;8dp&lt;/dimen&gt;</span><br><span class="line">    &lt;dimen name=&quot;padding_medium&quot;&gt;16dp&lt;/dimen&gt;</span><br><span class="line">    &lt;dimen name=&quot;text_size_large&quot;&gt;24sp&lt;/dimen&gt;</span><br><span class="line">&lt;/resources&gt;</span><br></pre></td></tr></table></figure><h3 id="5-2-å°ºå¯¸çš„å¼•ç”¨"><a href="#5-2-å°ºå¯¸çš„å¼•ç”¨" class="headerlink" title="5.2 å°ºå¯¸çš„å¼•ç”¨"></a>5.2 å°ºå¯¸çš„å¼•ç”¨</h3><h4 id="1-åœ¨-XML-å¸ƒå±€ä¸­-3"><a href="#1-åœ¨-XML-å¸ƒå±€ä¸­-3" class="headerlink" title="(1) åœ¨ XML å¸ƒå±€ä¸­"></a><strong>(1) åœ¨ XML å¸ƒå±€ä¸­</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;TextView</span><br><span class="line">    android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">    android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">    android:textSize=&quot;@dimen/text_size_large&quot;</span><br><span class="line">    android:padding=&quot;@dimen/padding_medium&quot; /&gt;</span><br></pre></td></tr></table></figure><h4 id="2-åœ¨-Kotlin-ä»£ç ä¸­-1"><a href="#2-åœ¨-Kotlin-ä»£ç ä¸­-1" class="headerlink" title="(2) åœ¨ Kotlin ä»£ç ä¸­"></a><strong>(2) åœ¨ Kotlin ä»£ç ä¸­</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">val padding = resources.getDimension(R.dimen.padding_small)</span><br><span class="line">textView.setPadding(padding.toInt(), padding.toInt(), padding.toInt(), padding.toInt())</span><br></pre></td></tr></table></figure><h3 id="5-3-é€‚é…ä¸åŒå±å¹•å¯†åº¦"><a href="#5-3-é€‚é…ä¸åŒå±å¹•å¯†åº¦" class="headerlink" title="5.3 é€‚é…ä¸åŒå±å¹•å¯†åº¦"></a>5.3 é€‚é…ä¸åŒå±å¹•å¯†åº¦</h3><ul><li><code>values-sw600dp/dimens.xml</code>ï¼šé€‚é… <strong>å¤§å±</strong></li><li><code>values-land/dimens.xml</code>ï¼šé€‚é… <strong>æ¨ªå±</strong></li></ul><hr><h2 id="6-æ•°ç»„èµ„æºï¼ˆArrayï¼‰"><a href="#6-æ•°ç»„èµ„æºï¼ˆArrayï¼‰" class="headerlink" title="6. æ•°ç»„èµ„æºï¼ˆArrayï¼‰"></a>6. æ•°ç»„èµ„æºï¼ˆArrayï¼‰</h2><h3 id="6-1-å®šä¹‰æ•°ç»„ï¼ˆarrays-xmlï¼‰"><a href="#6-1-å®šä¹‰æ•°ç»„ï¼ˆarrays-xmlï¼‰" class="headerlink" title="6.1 å®šä¹‰æ•°ç»„ï¼ˆarrays.xmlï¼‰"></a>6.1 å®šä¹‰æ•°ç»„ï¼ˆarrays.xmlï¼‰</h3><p><code>arrays.xml</code> ç”¨äºå­˜å‚¨ <strong>å­—ç¬¦ä¸²ã€é¢œè‰²æˆ–æ•´æ•°æ•°ç»„</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;resources&gt;</span><br><span class="line">    &lt;!-- å­—ç¬¦ä¸²æ•°ç»„ --&gt;</span><br><span class="line">    &lt;string-array name=&quot;fruit_array&quot;&gt;</span><br><span class="line">        &lt;item&gt;Apple&lt;/item&gt;</span><br><span class="line">        &lt;item&gt;Banana&lt;/item&gt;</span><br><span class="line">        &lt;item&gt;Cherry&lt;/item&gt;</span><br><span class="line">    &lt;/string-array&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- é¢œè‰²æ•°ç»„ --&gt;</span><br><span class="line">    &lt;array name=&quot;color_array&quot;&gt;</span><br><span class="line">        &lt;item&gt;@color/primary&lt;/item&gt;</span><br><span class="line">        &lt;item&gt;@color/secondary&lt;/item&gt;</span><br><span class="line">    &lt;/array&gt;</span><br><span class="line">&lt;/resources&gt;</span><br></pre></td></tr></table></figure><h3 id="6-2-æ•°ç»„çš„å¼•ç”¨"><a href="#6-2-æ•°ç»„çš„å¼•ç”¨" class="headerlink" title="6.2 æ•°ç»„çš„å¼•ç”¨"></a>6.2 æ•°ç»„çš„å¼•ç”¨</h3><h4 id="1-åœ¨-Kotlin-ä»£ç ä¸­"><a href="#1-åœ¨-Kotlin-ä»£ç ä¸­" class="headerlink" title="(1) åœ¨ Kotlin ä»£ç ä¸­"></a><strong>(1) åœ¨ Kotlin ä»£ç ä¸­</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å¤åˆ¶ç¼–è¾‘val fruits = resources.getStringArray(R.array.fruit_array)</span><br><span class="line">val colors = resources.obtainTypedArray(R.array.color_array)</span><br></pre></td></tr></table></figure><h4 id="2-åœ¨-Spinner-ä¸­"><a href="#2-åœ¨-Spinner-ä¸­" class="headerlink" title="(2) åœ¨ Spinner ä¸­"></a><strong>(2) åœ¨ Spinner ä¸­</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;Spinner</span><br><span class="line">    android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">    android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">    android:entries=&quot;@array/fruit_array&quot; /&gt;</span><br></pre></td></tr></table></figure><hr><h2 id="7-æ€»ç»“ä¸ä¼˜åŒ–å»ºè®®"><a href="#7-æ€»ç»“ä¸ä¼˜åŒ–å»ºè®®" class="headerlink" title="7. æ€»ç»“ä¸ä¼˜åŒ–å»ºè®®"></a>7. æ€»ç»“ä¸ä¼˜åŒ–å»ºè®®</h2><ul><li><strong>Color</strong>ï¼šå®šä¹‰åœ¨ <code>colors.xml</code>ï¼Œé…åˆ <strong>å¤œé—´æ¨¡å¼</strong> ä½¿ç”¨ <code>values-night/colors.xml</code></li><li><strong>String</strong>ï¼šæ‰€æœ‰æ–‡æœ¬é›†ä¸­ç®¡ç†ï¼Œæ”¯æŒå¤šè¯­è¨€</li><li><strong>Style</strong>ï¼šæé«˜ UI å¤ç”¨æ€§ï¼Œé¿å…é‡å¤ä»£ç </li><li><strong>Dimen</strong>ï¼šç»Ÿä¸€ç®¡ç†å°ºå¯¸ï¼Œæ”¯æŒä¸åŒå±å¹•é€‚é…</li><li><strong>Array</strong>ï¼šç”¨äºå­˜å‚¨åˆ—è¡¨æ•°æ®ï¼Œå¦‚ Spinner ä¸‹æ‹‰é¡¹</li></ul><hr><p>æŒæ¡ <code>colorã€stringã€styleã€dimenã€array</code> èµ„æºç®¡ç†ï¼Œè®©ä½ çš„ Android ä»£ç æ›´æ•´æ´ã€æ˜“ç»´æŠ¤ï¼Œå¹¶æ”¯æŒ Material3 æœ€æ–°ç‰¹æ€§ï¼ ğŸš€</p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“çŸ¥è¯†ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vector Assetçš„ä½¿ç”¨ç¤ºä¾‹</title>
      <link href="/2025/03/31/Vector-Asset%E7%9A%84%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B/"/>
      <url>/2025/03/31/Vector-Asset%E7%9A%84%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="Android-ä½¿ç”¨-Vector-Asset-çš„æŠ€æœ¯è§£æ"><a href="#Android-ä½¿ç”¨-Vector-Asset-çš„æŠ€æœ¯è§£æ" class="headerlink" title="Android ä½¿ç”¨ Vector Asset çš„æŠ€æœ¯è§£æ"></a>Android ä½¿ç”¨ Vector Asset çš„æŠ€æœ¯è§£æ</h1><p>åœ¨ Android å¼€å‘ä¸­ï¼Œå›¾å½¢èµ„æºä¸€ç›´æ˜¯ç”¨æˆ·ä½“éªŒçš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚ä¼ ç»Ÿä¸Šï¼Œå¼€å‘è€…å¸¸å¸¸ä¾èµ–ä½å›¾ï¼ˆBitmapï¼‰èµ„æºï¼Œä½†éšç€å¤šç§å±å¹•åˆ†è¾¨ç‡çš„è®¾å¤‡ä¸æ–­æ¶Œç°ï¼Œä½å›¾èµ„æºåœ¨æ‰©å±•æ€§å’Œå­˜å‚¨æ•ˆç‡ä¸Šé€æ¸æš´éœ²å‡ºä¸è¶³ã€‚ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼ŒGoogle å¼•å…¥äº† <strong>Vector Assetï¼ˆçŸ¢é‡èµ„æºï¼‰</strong>ï¼Œå®ƒèƒ½å¤Ÿä»¥è¾ƒå°çš„ä½“ç§¯æä¾›é«˜è´¨é‡ä¸”å¯ä¼¸ç¼©çš„å›¾å½¢è¡¨ç°ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç» Android ä¸­ Vector Asset çš„ä½¿ç”¨æ–¹æ³•ã€ä¼˜åŠ¿ã€æ³¨æ„äº‹é¡¹ä»¥åŠæœ€ä½³å®è·µã€‚</p><hr><h2 id="1-ä»€ä¹ˆæ˜¯-Vector-Assetï¼Ÿ"><a href="#1-ä»€ä¹ˆæ˜¯-Vector-Assetï¼Ÿ" class="headerlink" title="1. ä»€ä¹ˆæ˜¯ Vector Assetï¼Ÿ"></a>1. ä»€ä¹ˆæ˜¯ Vector Assetï¼Ÿ</h2><p>Vector Asset æ˜¯åŸºäº XML å®šä¹‰çš„çŸ¢é‡å›¾å½¢èµ„æºï¼Œä¸åŒäºä½å›¾èµ„æºï¼Œå®ƒé€šè¿‡æ•°å­¦å…¬å¼æ¥æè¿°å›¾å½¢çš„è½®å»“å’Œé¢œè‰²ï¼Œä»è€Œå®ç°æ— é™æ”¾å¤§è€Œä¸ä¼šå¤±çœŸã€‚ä¸»è¦ä¼˜ç‚¹åŒ…æ‹¬ï¼š</p><ul><li><strong>æ— å¤±çœŸç¼©æ”¾ï¼š</strong> æ— è®ºåœ¨ä½•ç§åˆ†è¾¨ç‡ä¸‹ï¼ŒçŸ¢é‡å›¾å½¢éƒ½èƒ½ä¿æŒæ¸…æ™°çš„æ˜¾ç¤ºæ•ˆæœã€‚</li><li><strong>æ–‡ä»¶ä½“ç§¯å°ï¼š</strong> ç›¸å¯¹äºåŒç­‰è´¨é‡çš„ä½å›¾èµ„æºï¼ŒçŸ¢é‡å›¾é€šå¸¸å ç”¨æ›´å°‘çš„å­˜å‚¨ç©ºé—´ã€‚</li><li><strong>çµæ´»çš„é¢œè‰²å’Œå°ºå¯¸è°ƒæ•´ï¼š</strong> å¯åœ¨è¿è¡Œæ—¶åŠ¨æ€ä¿®æ”¹é¢œè‰²å’Œå¤§å°ï¼Œé€‚åº”ä¸åŒçš„ä¸»é¢˜å’Œå¸ƒå±€éœ€æ±‚ã€‚</li></ul><hr><h2 id="2-Android-Studio-ä¸­å¯¼å…¥-Vector-Asset"><a href="#2-Android-Studio-ä¸­å¯¼å…¥-Vector-Asset" class="headerlink" title="2. Android Studio ä¸­å¯¼å…¥ Vector Asset"></a>2. Android Studio ä¸­å¯¼å…¥ Vector Asset</h2><p>Android Studio æä¾›äº†ç›´è§‚çš„å·¥å…·æ¥å¯¼å…¥å’Œç®¡ç† Vector Assetï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p><h3 id="2-1-é€šè¿‡-Vector-Asset-Studio-å¯¼å…¥"><a href="#2-1-é€šè¿‡-Vector-Asset-Studio-å¯¼å…¥" class="headerlink" title="2.1 é€šè¿‡ Vector Asset Studio å¯¼å…¥"></a>2.1 é€šè¿‡ Vector Asset Studio å¯¼å…¥</h3><ol><li><strong>æ‰“å¼€ Vector Asset Studioï¼š</strong><br> åœ¨é¡¹ç›®çš„ <code>res</code> ç›®å½•ä¸‹ï¼Œå³é”®ç‚¹å‡» <code>drawable</code> æ–‡ä»¶å¤¹ï¼Œé€‰æ‹© <strong>New â†’ Vector Asset</strong>ã€‚</li><li><strong>é€‰æ‹©å›¾æ ‡æˆ–å¯¼å…¥ SVGï¼š</strong><ul><li>å¯ä»¥åœ¨å†…ç½®çš„ Material å›¾æ ‡åº“ä¸­é€‰æ‹©éœ€è¦çš„å›¾æ ‡ï¼›</li><li>æˆ–è€…ç‚¹å‡» <strong>Local file (SVG, PSD)</strong> æŒ‰é’®å¯¼å…¥è‡ªå®šä¹‰çš„ SVG æ–‡ä»¶ã€‚</li></ul></li><li><strong>é…ç½®èµ„æºå±æ€§ï¼š</strong><ul><li>åœ¨é¢„è§ˆçª—å£ä¸­ç¡®è®¤å›¾æ ‡æ˜¾ç¤ºæ•ˆæœï¼›</li><li>ä¿®æ”¹å›¾æ ‡åç§°ã€å°ºå¯¸ä»¥åŠå¡«å……è‰²ï¼ˆå¯æ ¹æ®ä¸»é¢˜è¿›è¡ŒåŠ¨æ€è°ƒæ•´ï¼‰ï¼›</li><li>ç‚¹å‡» <strong>Next</strong> å’Œ <strong>Finish</strong> å®Œæˆå¯¼å…¥ã€‚</li></ul></li></ol><h3 id="2-2-ç¼–è¾‘-XML-æ–‡ä»¶"><a href="#2-2-ç¼–è¾‘-XML-æ–‡ä»¶" class="headerlink" title="2.2 ç¼–è¾‘ XML æ–‡ä»¶"></a>2.2 ç¼–è¾‘ XML æ–‡ä»¶</h3><p>å¯¼å…¥åçš„ Vector Asset ä¼šåœ¨ <code>drawable</code> æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆä¸€ä¸ª XML æ–‡ä»¶ï¼Œç±»ä¼¼ä¸‹é¢çš„ç»“æ„ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;vector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    android:width=&quot;24dp&quot;</span><br><span class="line">    android:height=&quot;24dp&quot;</span><br><span class="line">    android:viewportWidth=&quot;24&quot;</span><br><span class="line">    android:viewportHeight=&quot;24&quot;&gt;</span><br><span class="line">    &lt;path</span><br><span class="line">        android:fillColor=&quot;#FF000000&quot;</span><br><span class="line">        android:pathData=&quot;M12,2L2,22h20L12,2z&quot;/&gt;</span><br><span class="line">&lt;/vector&gt;</span><br></pre></td></tr></table></figure><p>åœ¨è¯¥æ–‡ä»¶ä¸­ï¼š</p><ul><li><code>android:width</code> å’Œ <code>android:height</code> å®šä¹‰äº†é»˜è®¤å°ºå¯¸ã€‚</li><li><code>android:viewportWidth</code> ä¸ <code>android:viewportHeight</code> å®šä¹‰äº†å†…éƒ¨åæ ‡ç³»ç»Ÿã€‚</li><li><code>&lt;path&gt;</code> æ ‡ç­¾æè¿°äº†å…·ä½“çš„ç»˜åˆ¶è·¯å¾„åŠå¡«å……è‰²ã€‚</li></ul><p>é€šè¿‡ä¿®æ”¹è¿™äº›å±æ€§ï¼Œå¯ä»¥å®ç°å¯¹å›¾æ ‡çš„ä¸ªæ€§åŒ–å®šåˆ¶å’Œä¸»é¢˜é€‚é…ã€‚</p><hr><h2 id="3-åœ¨é¡¹ç›®ä¸­ä½¿ç”¨-Vector-Asset"><a href="#3-åœ¨é¡¹ç›®ä¸­ä½¿ç”¨-Vector-Asset" class="headerlink" title="3. åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ Vector Asset"></a>3. åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ Vector Asset</h2><h3 id="3-1-å¸ƒå±€æ–‡ä»¶ä¸­å¼•ç”¨"><a href="#3-1-å¸ƒå±€æ–‡ä»¶ä¸­å¼•ç”¨" class="headerlink" title="3.1 å¸ƒå±€æ–‡ä»¶ä¸­å¼•ç”¨"></a>3.1 å¸ƒå±€æ–‡ä»¶ä¸­å¼•ç”¨</h3><p>ä½¿ç”¨çŸ¢é‡èµ„æºä¸å¼•ç”¨ä½å›¾èµ„æºç±»ä¼¼ï¼Œä¾‹å¦‚åœ¨ <code>ImageView</code> ä¸­ç›´æ¥è®¾ç½® <code>src</code> å±æ€§ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;ImageView</span><br><span class="line">    android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">    android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">    android:src=&quot;@drawable/ic_vector_example&quot; /&gt;</span><br></pre></td></tr></table></figure><h3 id="3-2-åŠ¨æ€è®¾ç½®"><a href="#3-2-åŠ¨æ€è®¾ç½®" class="headerlink" title="3.2 åŠ¨æ€è®¾ç½®"></a>3.2 åŠ¨æ€è®¾ç½®</h3><p>åœ¨ä»£ç ä¸­ï¼Œå¯ä»¥é€šè¿‡ <code>setImageResource()</code> æˆ–ä½¿ç”¨ <code>AppCompatImageView</code> æ¥åŠ è½½çŸ¢é‡èµ„æºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">val imageView: ImageView = findViewById(R.id.myImageView)</span><br><span class="line">imageView.setImageResource(R.drawable.ic_vector_example)</span><br></pre></td></tr></table></figure><p>å¯¹äºæ›´é«˜çº§çš„åŠ¨æ€æ“ä½œï¼ˆä¾‹å¦‚é¢œè‰²å˜åŒ–ï¼‰ï¼Œå¯ä»¥é€šè¿‡ <code>DrawableCompat</code> æ¥åŒ…è£…å¹¶ä¿®æ”¹çŸ¢é‡èµ„æºçš„å±æ€§ã€‚</p><hr><h2 id="4-å…¼å®¹æ€§æ³¨æ„äº‹é¡¹"><a href="#4-å…¼å®¹æ€§æ³¨æ„äº‹é¡¹" class="headerlink" title="4. å…¼å®¹æ€§æ³¨æ„äº‹é¡¹"></a>4. å…¼å®¹æ€§æ³¨æ„äº‹é¡¹</h2><p>è™½ç„¶ Android ä» Lollipop (API 21) å¼€å§‹åŸç”Ÿæ”¯æŒçŸ¢é‡èµ„æºï¼Œä½†å¯¹äºä½ç‰ˆæœ¬è®¾å¤‡ï¼ˆAPI 19 åŠä»¥ä¸‹ï¼‰ä»éœ€æ³¨æ„å…¼å®¹æ€§é—®é¢˜ã€‚ä¸ºæ­¤ï¼ŒGoogle æä¾›äº† <strong>VectorDrawableCompat</strong>ï¼Œä»¥åŠåœ¨ <code>build.gradle</code> æ–‡ä»¶ä¸­é…ç½®ç›¸å…³é€‰é¡¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">    defaultConfig &#123;</span><br><span class="line">        vectorDrawables.useSupportLibrary = true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒæ—¶ï¼Œå»ºè®®åœ¨ä»£ç ä¸­ä½¿ç”¨ <code>AppCompatImageView</code> æˆ–åœ¨ XML å¸ƒå±€ä¸­æ·»åŠ  <code>app:srcCompat</code> å±æ€§æ¥ç¡®ä¿å…¼å®¹æ€§ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;androidx.appcompat.widget.AppCompatImageView</span><br><span class="line">    android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">    android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">    app:srcCompat=&quot;@drawable/ic_vector_example&quot; /&gt;</span><br></pre></td></tr></table></figure><hr><h2 id="5-æœ€ä½³å®è·µ"><a href="#5-æœ€ä½³å®è·µ" class="headerlink" title="5. æœ€ä½³å®è·µ"></a>5. æœ€ä½³å®è·µ</h2><h3 id="5-1-å°½é‡ä½¿ç”¨å†…ç½®å›¾æ ‡"><a href="#5-1-å°½é‡ä½¿ç”¨å†…ç½®å›¾æ ‡" class="headerlink" title="5.1 å°½é‡ä½¿ç”¨å†…ç½®å›¾æ ‡"></a>5.1 å°½é‡ä½¿ç”¨å†…ç½®å›¾æ ‡</h3><p>Google æä¾›äº†ä¸°å¯Œçš„ Material Design å›¾æ ‡ï¼Œå»ºè®®ä¼˜å…ˆä½¿ç”¨è¿™äº›ç»è¿‡ä¼˜åŒ–çš„å›¾æ ‡åº“ï¼Œæ—¢èƒ½ä¿è¯ä¸€è‡´æ€§ï¼Œåˆèƒ½å‡å°‘é¢å¤–èµ„æºå¯¼å…¥ã€‚</p><h3 id="5-2-ä¿æŒ-SVG-æ–‡ä»¶ç®€æ´"><a href="#5-2-ä¿æŒ-SVG-æ–‡ä»¶ç®€æ´" class="headerlink" title="5.2 ä¿æŒ SVG æ–‡ä»¶ç®€æ´"></a>5.2 ä¿æŒ SVG æ–‡ä»¶ç®€æ´</h3><p>åœ¨å¯¼å…¥è‡ªå®šä¹‰ SVG æ–‡ä»¶å‰ï¼Œå¯ä»¥å€ŸåŠ©å·¥å…·ï¼ˆå¦‚ <a href="https://github.com/svg/svgo">SVGO</a>ï¼‰å¯¹æ–‡ä»¶è¿›è¡Œä¼˜åŒ–ï¼Œå»é™¤ä¸å¿…è¦çš„å±æ€§å’Œå†—ä½™æ•°æ®ï¼Œç¡®ä¿ç”Ÿæˆçš„ Vector Asset æ–‡ä»¶ä¿æŒè½»é‡é«˜æ•ˆã€‚</p><h3 id="5-3-åŠ¨æ€é€‚é…ä¸»é¢˜"><a href="#5-3-åŠ¨æ€é€‚é…ä¸»é¢˜" class="headerlink" title="5.3 åŠ¨æ€é€‚é…ä¸»é¢˜"></a>5.3 åŠ¨æ€é€‚é…ä¸»é¢˜</h3><p>åˆ©ç”¨ Android çš„ä¸»é¢˜ç³»ç»Ÿï¼Œå¯ä»¥åœ¨ Vector Asset ä¸­é€šè¿‡å±æ€§å¼•ç”¨æ¥å®ç°åŠ¨æ€é€‚é…ã€‚ä¾‹å¦‚ï¼Œå°† <code>fillColor</code> è®¾ç½®ä¸ºå±æ€§å¼•ç”¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;path</span><br><span class="line">    android:fillColor=&quot;?attr/colorControlNormal&quot;</span><br><span class="line">    android:pathData=&quot;...&quot; /&gt;</span><br></pre></td></tr></table></figure><p>è¿™æ ·å¯ä»¥éšç€ä¸»é¢˜å˜åŒ–è‡ªåŠ¨è°ƒæ•´å›¾æ ‡é¢œè‰²ï¼Œæé«˜ UI çš„ä¸€è‡´æ€§ã€‚</p><hr><h2 id="6-æ€»ç»“"><a href="#6-æ€»ç»“" class="headerlink" title="6. æ€»ç»“"></a>6. æ€»ç»“</h2><p>ä½¿ç”¨ Vector Asset æ˜¯åº”å¯¹å¤šåˆ†è¾¨ç‡è®¾å¤‡å’Œå¤æ‚ UI éœ€æ±‚çš„é«˜æ•ˆè§£å†³æ–¹æ¡ˆã€‚å®ƒä¸ä»…èƒ½ç¡®ä¿å›¾å½¢åœ¨å„ç§è®¾å¤‡ä¸Šæ— å¤±çœŸæ˜¾ç¤ºï¼Œè¿˜èƒ½å¤§å¹…é™ä½ APK æ–‡ä»¶çš„ä½“ç§¯ã€‚é€šè¿‡ Android Studio çš„å†…ç½®å·¥å…·ã€å…¼å®¹æ€§é…ç½®å’Œæœ€ä½³å®è·µï¼Œå¼€å‘è€…å¯ä»¥è½»æ¾å¼•å…¥å¹¶ç®¡ç†çŸ¢é‡èµ„æºï¼Œä»è€Œæå‡å¼€å‘æ•ˆç‡å’Œç”¨æˆ·ä½“éªŒã€‚</p><p>éšç€ Android å¹³å°çš„ä¸æ–­è¿›æ­¥ï¼ŒVector Asset çš„ä½¿ç”¨æ–¹æ³•å’Œç›¸å…³å·¥å…·ä¹Ÿåœ¨ä¸æ–­æ›´æ–°ï¼Œä½†å…¶æ ¸å¿ƒä¼˜åŠ¿å§‹ç»ˆä¸å˜â€”â€”é«˜æ•ˆã€çµæ´»ä¸”æ˜“äºç»´æŠ¤ã€‚å¸Œæœ›æœ¬æ–‡èƒ½ä¸ºä½ åœ¨é¡¹ç›®ä¸­æ›´å¥½åœ°åº”ç”¨çŸ¢é‡å›¾èµ„æºæä¾›å¸®åŠ©ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“çŸ¥è¯†ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kotlinçš„åç¨‹</title>
      <link href="/2025/03/30/Kotlin%E7%9A%84%E5%8D%8F%E7%A8%8B/"/>
      <url>/2025/03/30/Kotlin%E7%9A%84%E5%8D%8F%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="Kotlin-åç¨‹æŠ€æœ¯æ–‡æ¡£"><a href="#Kotlin-åç¨‹æŠ€æœ¯æ–‡æ¡£" class="headerlink" title="Kotlin åç¨‹æŠ€æœ¯æ–‡æ¡£"></a>Kotlin åç¨‹æŠ€æœ¯æ–‡æ¡£</h1><hr><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>Kotlin åç¨‹æ˜¯ Kotlin å®˜æ–¹æä¾›çš„ä¸€ç§ç”¨äºç®€åŒ–å¼‚æ­¥ç¼–ç¨‹å’Œå¹¶å‘ä»»åŠ¡å¤„ç†çš„å·¥å…·ã€‚å®ƒèƒ½å¤Ÿè®©ä½ ç”¨åŒæ­¥çš„å†™æ³•å®ç°å¼‚æ­¥ä»£ç ï¼Œå¤§å¤§ç®€åŒ–äº†å›è°ƒåœ°ç‹±ï¼ˆcallback hellï¼‰é—®é¢˜ï¼Œæé«˜äº†ä»£ç çš„å¯è¯»æ€§å’Œç»´æŠ¤æ€§ã€‚åç¨‹åœ¨ Android å¼€å‘ã€æœåŠ¡å™¨å¼€å‘ç­‰åœºæ™¯ä¸­éƒ½æœ‰å¹¿æ³›åº”ç”¨ã€‚</p><hr><h2 id="åç¨‹åŸºæœ¬æ¦‚å¿µ"><a href="#åç¨‹åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åç¨‹åŸºæœ¬æ¦‚å¿µ"></a>åç¨‹åŸºæœ¬æ¦‚å¿µ</h2><h3 id="ä»€ä¹ˆæ˜¯åç¨‹"><a href="#ä»€ä¹ˆæ˜¯åç¨‹" class="headerlink" title="ä»€ä¹ˆæ˜¯åç¨‹"></a>ä»€ä¹ˆæ˜¯åç¨‹</h3><p>åç¨‹æ˜¯ä¸€ç§è½»é‡çº§çš„çº¿ç¨‹ï¼Œèƒ½å¤Ÿåœ¨å•ä¸ªçº¿ç¨‹å†…å¹¶å‘æ‰§è¡Œå¤šä¸ªä»»åŠ¡ã€‚å®ƒåŸºäºæŒ‚èµ·ï¼ˆsuspendingï¼‰å’Œæ¢å¤ï¼ˆresumingï¼‰æœºåˆ¶ï¼Œåœ¨ä»»åŠ¡é‡åˆ°è€—æ—¶æ“ä½œï¼ˆå¦‚ IOã€ç½‘ç»œè¯·æ±‚ï¼‰æ—¶æŒ‚èµ·æ‰§è¡Œï¼Œä¸é˜»å¡çº¿ç¨‹ï¼Œå¾…æ¡ä»¶æ»¡è¶³åæ¢å¤æ‰§è¡Œã€‚</p><h3 id="åç¨‹ä¸çº¿ç¨‹çš„å¯¹æ¯”"><a href="#åç¨‹ä¸çº¿ç¨‹çš„å¯¹æ¯”" class="headerlink" title="åç¨‹ä¸çº¿ç¨‹çš„å¯¹æ¯”"></a>åç¨‹ä¸çº¿ç¨‹çš„å¯¹æ¯”</h3><ul><li><strong>è½»é‡æ€§</strong>ï¼šåç¨‹æ¯”çº¿ç¨‹æ›´åŠ è½»é‡ï¼Œä¸€ä¸ªåº”ç”¨å¯ä»¥åŒæ—¶å¯åŠ¨æˆåƒä¸Šä¸‡ä¸ªåç¨‹ï¼Œè€Œçº¿ç¨‹æ•°é‡é€šå¸¸å—é™äºç³»ç»Ÿèµ„æºã€‚</li><li><strong>è°ƒåº¦æ¨¡å‹</strong>ï¼šåç¨‹ç”±è°ƒåº¦å™¨ï¼ˆDispatchersï¼‰ç®¡ç†ï¼Œå¯ä»¥åœ¨å¤šä¸ªçº¿ç¨‹é—´çµæ´»è°ƒåº¦ï¼Œè€Œçº¿ç¨‹è°ƒåº¦ä¾èµ–äºæ“ä½œç³»ç»Ÿã€‚</li><li><strong>åˆ‡æ¢æˆæœ¬</strong>ï¼šåç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢æˆæœ¬è¿œä½äºçº¿ç¨‹åˆ‡æ¢ï¼Œæ€§èƒ½å¼€é”€è¾ƒå°ã€‚</li><li><strong>ç¼–ç¨‹æ¨¡å‹</strong>ï¼šåç¨‹å¯ä»¥ç”¨é¡ºåºåŒ–çš„ä»£ç ç¼–å†™å¼‚æ­¥é€»è¾‘ï¼Œé¿å…å›è°ƒåµŒå¥—ï¼Œä½¿ä»£ç æ›´ç›´è§‚ã€‚</li></ul><hr><h2 id="åç¨‹æ„å»ºå—"><a href="#åç¨‹æ„å»ºå—" class="headerlink" title="åç¨‹æ„å»ºå—"></a>åç¨‹æ„å»ºå—</h2><h3 id="CoroutineScope"><a href="#CoroutineScope" class="headerlink" title="CoroutineScope"></a>CoroutineScope</h3><ul><li><strong>å®šä¹‰</strong>ï¼š<code>CoroutineScope</code> è¡¨ç¤ºä¸€ä¸ªåç¨‹ä½œç”¨åŸŸï¼Œå®ƒé™å®šäº†åç¨‹çš„ç”Ÿå‘½å‘¨æœŸã€‚æ‰€æœ‰åœ¨è¯¥ä½œç”¨åŸŸå†…å¯åŠ¨çš„åç¨‹éƒ½éµå¾ªåŒä¸€ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œä¾¿äºé›†ä¸­ç®¡ç†ã€‚</li><li><strong>åˆ›å»º</strong>ï¼šå¯ä»¥é€šè¿‡ <code>GlobalScope</code>ï¼ˆä¸æ¨èä½¿ç”¨ï¼‰ã€<code>CoroutineScope(Job())</code> æˆ– Android çš„ <code>viewModelScope</code>ã€<code>lifecycleScope</code> æ¥åˆ›å»ºä½œç”¨åŸŸã€‚</li></ul><p>ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// è‡ªå®šä¹‰ CoroutineScope</span><br><span class="line">val myScope = CoroutineScope(Dispatchers.Main + Job())</span><br></pre></td></tr></table></figure><h3 id="å¯åŠ¨åç¨‹ï¼šlaunch-ä¸-async"><a href="#å¯åŠ¨åç¨‹ï¼šlaunch-ä¸-async" class="headerlink" title="å¯åŠ¨åç¨‹ï¼šlaunch ä¸ async"></a>å¯åŠ¨åç¨‹ï¼šlaunch ä¸ async</h3><ul><li><p><strong>launch</strong><br> ç”¨äºå¯åŠ¨ä¸€ä¸ªä¸éœ€è¦è¿”å›ç»“æœçš„åç¨‹ï¼Œè¿”å›ä¸€ä¸ª <code>Job</code> å¯¹è±¡ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">myScope.launch &#123;</span><br><span class="line">    // åœ¨åç¨‹ä¸­æ‰§è¡Œè€—æ—¶æ“ä½œ</span><br><span class="line">    delay(1000)</span><br><span class="line">    println(&quot;Hello from launch!&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>async</strong><br> ç”¨äºå¯åŠ¨ä¸€ä¸ªåç¨‹å¹¶è¿”å›ä¸€ä¸ª <code>Deferred</code> å¯¹è±¡ï¼Œè¡¨ç¤ºæœªæ¥å¯èƒ½è¿”å›çš„ç»“æœã€‚å¸¸ç”¨äºå¹¶è¡Œè®¡ç®—ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">val deferredResult = myScope.async &#123;</span><br><span class="line">    // æ‰§è¡Œè®¡ç®—å¹¶è¿”å›ç»“æœ</span><br><span class="line">    delay(500)</span><br><span class="line">    return@async 42</span><br><span class="line">&#125;</span><br><span class="line">// è·å–ç»“æœï¼Œæ³¨æ„ï¼šawait() æ˜¯æŒ‚èµ·å‡½æ•°</span><br><span class="line">val result = deferredResult.await()</span><br></pre></td></tr></table></figure></li></ul><h3 id="Job-ä¸-Deferred"><a href="#Job-ä¸-Deferred" class="headerlink" title="Job ä¸ Deferred"></a>Job ä¸ Deferred</h3><ul><li><strong>Job</strong>ï¼šè¡¨ç¤ºä¸€ä¸ªåç¨‹ä»»åŠ¡ï¼Œä¸»è¦ç”¨äºç®¡ç†åç¨‹çš„ç”Ÿå‘½å‘¨æœŸï¼ˆå¦‚å–æ¶ˆåç¨‹ï¼‰ã€‚</li><li><strong>Deferred</strong>ï¼šç»§æ‰¿è‡ª Jobï¼Œè¡¨ç¤ºä¸€ä¸ªå¸¦æœ‰è¿”å›å€¼çš„ä»»åŠ¡ï¼Œä½¿ç”¨ <code>await()</code> æ–¹æ³•å¯ä»¥æŒ‚èµ·åç¨‹ç­‰å¾…ç»“æœã€‚</li></ul><hr><h2 id="è°ƒåº¦å™¨-Dispatchers"><a href="#è°ƒåº¦å™¨-Dispatchers" class="headerlink" title="è°ƒåº¦å™¨ (Dispatchers)"></a>è°ƒåº¦å™¨ (Dispatchers)</h2><p>è°ƒåº¦å™¨å†³å®šåç¨‹åœ¨å“ªä¸ªçº¿ç¨‹æˆ–çº¿ç¨‹æ± ä¸Šè¿è¡Œã€‚å¸¸ç”¨çš„è°ƒåº¦å™¨åŒ…æ‹¬ï¼š</p><h3 id="å¸¸è§è°ƒåº¦å™¨"><a href="#å¸¸è§è°ƒåº¦å™¨" class="headerlink" title="å¸¸è§è°ƒåº¦å™¨"></a>å¸¸è§è°ƒåº¦å™¨</h3><ul><li><strong>Dispatchers.Main</strong><br> ç”¨äºæ›´æ–° UI çš„ä¸»çº¿ç¨‹ï¼Œé€‚ç”¨äº Android ä¸­ä¸ UI ç›¸å…³çš„æ“ä½œã€‚</li><li><strong>Dispatchers.IO</strong><br> ç”¨äºæ‰§è¡Œ IO å¯†é›†å‹ä»»åŠ¡ï¼Œå¦‚ç½‘ç»œè¯·æ±‚ã€ç£ç›˜æ“ä½œç­‰ã€‚</li><li><strong>Dispatchers.Default</strong><br> ç”¨äºæ‰§è¡Œ CPU å¯†é›†å‹ä»»åŠ¡ï¼Œå¦‚å¤æ‚è®¡ç®—ã€‚</li><li><strong>Dispatchers.Unconfined</strong><br> ä¸å—é™äºç‰¹å®šçº¿ç¨‹ï¼Œç«‹å³åœ¨å½“å‰çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œé€šå¸¸ç”¨äºæµ‹è¯•æˆ–ç‰¹æ®Šåœºæ™¯ã€‚</li></ul><p>ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// åœ¨ IO çº¿ç¨‹ä¸­æ‰§è¡Œç½‘ç»œè¯·æ±‚</span><br><span class="line">CoroutineScope(Dispatchers.IO).launch &#123;</span><br><span class="line">    val data = fetchDataFromNetwork()</span><br><span class="line">    // åˆ‡æ¢å›ä¸»çº¿ç¨‹æ›´æ–° UI</span><br><span class="line">    withContext(Dispatchers.Main) &#123;</span><br><span class="line">        updateUI(data)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è‡ªå®šä¹‰è°ƒåº¦å™¨"><a href="#è‡ªå®šä¹‰è°ƒåº¦å™¨" class="headerlink" title="è‡ªå®šä¹‰è°ƒåº¦å™¨"></a>è‡ªå®šä¹‰è°ƒåº¦å™¨</h3><p>å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰çº¿ç¨‹æ± ï¼Œå¹¶ç”¨ <code>asCoroutineDispatcher()</code> æ–¹æ³•è½¬æ¢ä¸ºåç¨‹è°ƒåº¦å™¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">val myExecutor = Executors.newFixedThreadPool(4)</span><br><span class="line">val myDispatcher = myExecutor.asCoroutineDispatcher()</span><br></pre></td></tr></table></figure><hr><h2 id="withContext-çš„ä½¿ç”¨"><a href="#withContext-çš„ä½¿ç”¨" class="headerlink" title="withContext() çš„ä½¿ç”¨"></a><code>withContext()</code> çš„ä½¿ç”¨</h2><p><code>withContext()</code> æ˜¯ Kotlin åç¨‹ä¸­çš„ <strong>æŒ‚èµ·å‡½æ•°</strong>ï¼Œç”¨äº <strong>åœ¨åç¨‹ä¸­åˆ‡æ¢æ‰§è¡Œçš„è°ƒåº¦å™¨</strong>ã€‚å®ƒä¸ä¼šåˆ›å»ºæ–°çš„åç¨‹ï¼Œè€Œæ˜¯æŒ‚èµ·å½“å‰åç¨‹å¹¶åœ¨æŒ‡å®šçš„è°ƒåº¦å™¨ä¸Šæ‰§è¡Œä»£ç å—ï¼Œæ‰§è¡Œå®Œæˆåæ¢å¤åˆ°åŸæ¥çš„è°ƒåº¦å™¨ã€‚</p><p><code>withContext()</code> <strong>ä¼šæŒ‚èµ·å¤–éƒ¨åç¨‹ï¼Œç›´åˆ°å†…éƒ¨ä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œæ‰ç»§ç»­æ‰§è¡Œå¤–éƒ¨åç¨‹çš„åç»­ä»£ç </strong>ï¼Œä½†<strong>ä¸ä¼šé˜»å¡çº¿ç¨‹</strong>ã€‚</p><hr><h3 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a><strong>åŸºæœ¬ç”¨æ³•</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import kotlinx.coroutines.*</span><br><span class="line"></span><br><span class="line">fun main() = runBlocking &#123;</span><br><span class="line">    println(&quot;Start: $&#123;Thread.currentThread().name&#125;&quot;)</span><br><span class="line"></span><br><span class="line">    withContext(Dispatchers.IO) &#123;</span><br><span class="line">        println(&quot;Switch to IO: $&#123;Thread.currentThread().name&#125;&quot;)</span><br><span class="line">        delay(1000) // æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    println(&quot;Back to main: $&#123;Thread.currentThread().name&#125;&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ‰§è¡Œè¿‡ç¨‹"><a href="#æ‰§è¡Œè¿‡ç¨‹" class="headerlink" title="æ‰§è¡Œè¿‡ç¨‹"></a><strong>æ‰§è¡Œè¿‡ç¨‹</strong></h3><ol><li><code>runBlocking</code> åœ¨ <strong>ä¸»çº¿ç¨‹</strong> ä¸­è¿è¡Œã€‚</li><li><code>withContext(Dispatchers.IO)</code> åˆ‡æ¢åˆ° <strong>IO çº¿ç¨‹æ± </strong> å¹¶æ‰§è¡Œä»£ç å—ã€‚</li><li><code>delay(1000)</code> è®©åç¨‹æŒ‚èµ· <strong>1 ç§’</strong>ï¼Œä½†ä¸ä¼šé˜»å¡çº¿ç¨‹ã€‚</li><li><code>withContext</code> æ‰§è¡Œå®Œæ¯•ï¼Œæ¢å¤åˆ° <strong>åŸæ¥çš„è°ƒåº¦å™¨ï¼ˆä¸»çº¿ç¨‹ï¼‰</strong>ã€‚</li></ol><hr><h3 id="å¸¸è§ç”¨é€”"><a href="#å¸¸è§ç”¨é€”" class="headerlink" title="å¸¸è§ç”¨é€”"></a><strong>å¸¸è§ç”¨é€”</strong></h3><h4 id="1-åœ¨-Dispatchers-Main-æ‰§è¡Œ-UI-æ›´æ–°"><a href="#1-åœ¨-Dispatchers-Main-æ‰§è¡Œ-UI-æ›´æ–°" class="headerlink" title="1. åœ¨ Dispatchers.Main æ‰§è¡Œ UI æ›´æ–°"></a><strong>1. åœ¨ <code>Dispatchers.Main</code> æ‰§è¡Œ UI æ›´æ–°</strong></h4><p>é€‚ç”¨äº <strong>Android å¼€å‘</strong>ï¼Œç”¨äº <strong>åœ¨åå°çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼Œå¹¶å›åˆ°ä¸»çº¿ç¨‹æ›´æ–° UI</strong>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">class MainActivity : AppCompatActivity() &#123;</span><br><span class="line">    override fun onCreate(savedInstanceState: Bundle?) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState)</span><br><span class="line"></span><br><span class="line">        lifecycleScope.launch &#123;</span><br><span class="line">            val data = withContext(Dispatchers.IO) &#123; fetchData() &#125;</span><br><span class="line">            textView.text = data // å›åˆ°ä¸»çº¿ç¨‹æ›´æ–° UI</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private suspend fun fetchData(): String &#123;</span><br><span class="line">        delay(2000) // æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚</span><br><span class="line">        return &quot;Data from server&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ğŸ”¹ <code>fetchData()</code> åœ¨ <strong>IO çº¿ç¨‹æ‰§è¡Œ</strong>ï¼Œè·å–æ•°æ®å <code>withContext</code> è‡ªåŠ¨ <strong>å›åˆ°ä¸»çº¿ç¨‹</strong> æ›´æ–° <code>textView</code>ã€‚</p><hr><h4 id="2-è®¡ç®—å¯†é›†å‹ä»»åŠ¡-Dispatchers-Default"><a href="#2-è®¡ç®—å¯†é›†å‹ä»»åŠ¡-Dispatchers-Default" class="headerlink" title="2. è®¡ç®—å¯†é›†å‹ä»»åŠ¡ (Dispatchers.Default)"></a><strong>2. è®¡ç®—å¯†é›†å‹ä»»åŠ¡ (<code>Dispatchers.Default</code>)</strong></h4><p>é€‚ç”¨äº <strong>CPU å¯†é›†å‹è®¡ç®—</strong>ï¼ˆå¦‚æ’åºã€åŠ å¯†ã€æ•°æ®å¤„ç†ï¼‰ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">suspend fun heavyComputation() &#123;</span><br><span class="line">    withContext(Dispatchers.Default) &#123;</span><br><span class="line">        val result = (1..1_000_000).sum()</span><br><span class="line">        println(&quot;Computation result: $result&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ğŸ”¹ è®¡ç®—ä»»åŠ¡ä¼šåœ¨ <strong>é»˜è®¤çº¿ç¨‹æ± </strong>ï¼ˆ<code>Default</code>ï¼‰è¿è¡Œï¼Œä¸ä¼šé˜»å¡ UIã€‚</p><hr><h4 id="3-è¯»å–æœ¬åœ°æ–‡ä»¶ï¼ˆIO-çº¿ç¨‹ï¼‰"><a href="#3-è¯»å–æœ¬åœ°æ–‡ä»¶ï¼ˆIO-çº¿ç¨‹ï¼‰" class="headerlink" title="3. è¯»å–æœ¬åœ°æ–‡ä»¶ï¼ˆIO çº¿ç¨‹ï¼‰"></a><strong>3. è¯»å–æœ¬åœ°æ–‡ä»¶ï¼ˆIO çº¿ç¨‹ï¼‰</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">suspend fun readFile(): String &#123;</span><br><span class="line">    return withContext(Dispatchers.IO) &#123;</span><br><span class="line">        File(&quot;data.txt&quot;).readText()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ğŸ”¹ <strong>é¿å…ä¸»çº¿ç¨‹é˜»å¡</strong>ï¼Œæ–‡ä»¶è¯»å–åœ¨ <strong>IO çº¿ç¨‹</strong> å®Œæˆã€‚</p><hr><h3 id="âš ï¸-æ³¨æ„äº‹é¡¹"><a href="#âš ï¸-æ³¨æ„äº‹é¡¹" class="headerlink" title="âš ï¸ æ³¨æ„äº‹é¡¹"></a><strong>âš ï¸ æ³¨æ„äº‹é¡¹</strong></h3><ol><li><strong><code>withContext()</code> ä¸ä¼šåˆ›å»ºæ–°çš„åç¨‹</strong>ï¼Œåªæ˜¯åˆ‡æ¢æ‰§è¡Œç¯å¢ƒã€‚</li><li><strong><code>withContext()</code> é€‚åˆæ‰§è¡Œä¸€ä¸ªéœ€è¦è¿”å›ç»“æœçš„ä»»åŠ¡</strong>ï¼Œå¦‚æœè¦ <strong>åŒæ—¶è¿è¡Œå¤šä¸ªä»»åŠ¡</strong>ï¼Œç”¨ <code>launch</code> æˆ– <code>async</code>ã€‚</li><li><strong>ä¸è¦åœ¨ <code>Dispatchers.Main</code> ä¸­ä½¿ç”¨ <code>withContext(Dispatchers.Main)</code></strong>ï¼Œä¼šå¯¼è‡´ <strong>é¢å¤–çš„è°ƒåº¦å¼€é”€</strong>ã€‚</li></ol><hr><h3 id="ğŸš€-æ€»ç»“"><a href="#ğŸš€-æ€»ç»“" class="headerlink" title="ğŸš€ æ€»ç»“"></a><strong>ğŸš€ æ€»ç»“</strong></h3><ul><li><code>withContext()</code> ç”¨äº <strong>åˆ‡æ¢çº¿ç¨‹å¹¶æ‰§è¡Œä»£ç </strong>ï¼Œæ‰§è¡Œå®Œè‡ªåŠ¨å›åˆ°åŸæ¥çš„çº¿ç¨‹ã€‚</li><li><strong>é€‚ç”¨äº</strong> IO æ“ä½œã€è®¡ç®—ä»»åŠ¡ã€UI æ›´æ–°ç­‰åœºæ™¯ã€‚</li><li><strong>ä¸ä¼šåˆ›å»ºæ–°åç¨‹</strong>ï¼Œè€Œæ˜¯ <strong>æŒ‚èµ·å½“å‰åç¨‹</strong> å¹¶åˆ‡æ¢è°ƒåº¦å™¨ã€‚</li></ul><p>ğŸ’¡ <strong>é€‚ç”¨åœºæ™¯</strong>ï¼š âœ… <strong>ç½‘ç»œè¯·æ±‚</strong>ï¼ˆ<code>Dispatchers.IO</code>ï¼‰<br> âœ… <strong>æ•°æ®åº“æ“ä½œ</strong>ï¼ˆ<code>Dispatchers.IO</code>ï¼‰<br> âœ… <strong>è®¡ç®—å¯†é›†å‹ä»»åŠ¡</strong>ï¼ˆ<code>Dispatchers.Default</code>ï¼‰<br> âœ… <strong>UI æ›´æ–°</strong>ï¼ˆ<code>Dispatchers.Main</code>ï¼‰</p><h2 id="ç»“æ„åŒ–å¹¶å‘"><a href="#ç»“æ„åŒ–å¹¶å‘" class="headerlink" title="ç»“æ„åŒ–å¹¶å‘"></a>ç»“æ„åŒ–å¹¶å‘</h2><h3 id="ä½œç”¨åŸŸä¸åç¨‹å±‚çº§å…³ç³»"><a href="#ä½œç”¨åŸŸä¸åç¨‹å±‚çº§å…³ç³»" class="headerlink" title="ä½œç”¨åŸŸä¸åç¨‹å±‚çº§å…³ç³»"></a>ä½œç”¨åŸŸä¸åç¨‹å±‚çº§å…³ç³»</h3><p>ç»“æ„åŒ–å¹¶å‘ï¼ˆStructured Concurrencyï¼‰è¦æ±‚åç¨‹åœ¨å±‚æ¬¡åŒ–çš„ä½œç”¨åŸŸå†…å¯åŠ¨ï¼Œç¡®ä¿çˆ¶åç¨‹ç®¡ç†å­åç¨‹çš„ç”Ÿå‘½å‘¨æœŸï¼Œé¿å…å‡ºç°æœªç®¡ç†çš„å­¤å„¿åç¨‹ã€‚è¿™æ ·å¯ä»¥ä¿è¯èµ„æºçš„åŠæ—¶é‡Šæ”¾ä¸é”™è¯¯çš„ç»Ÿä¸€å¤„ç†ã€‚</p><h3 id="CoroutineScope-ä¸-supervisorScope"><a href="#CoroutineScope-ä¸-supervisorScope" class="headerlink" title="CoroutineScope ä¸ supervisorScope"></a>CoroutineScope ä¸ supervisorScope</h3><ul><li><p><strong>CoroutineScope</strong><br> é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœå­åç¨‹å‘ç”Ÿå¼‚å¸¸ï¼Œä¼šå–æ¶ˆæ•´ä¸ªä½œç”¨åŸŸå†…æ‰€æœ‰åç¨‹ã€‚</p></li><li><p><strong>supervisorScope</strong><br> åœ¨ <code>supervisorScope</code> å†…ï¼Œä¸€ä¸ªå­åç¨‹çš„å¼‚å¸¸ä¸ä¼šä¼ æ’­åˆ°å…¶ä»–å­åç¨‹ï¼Œå¯ä»¥å®ç°éƒ¨åˆ†ä»»åŠ¡å¤±è´¥è€Œä¸å½±å“æ•´ä½“æµç¨‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">supervisorScope &#123;</span><br><span class="line">    val job1 = launch &#123;</span><br><span class="line">        // å­ä»»åŠ¡ 1</span><br><span class="line">    &#125;</span><br><span class="line">    val job2 = launch &#123;</span><br><span class="line">        // å­ä»»åŠ¡ 2</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><hr><h2 id="åç¨‹å–æ¶ˆä¸è¶…æ—¶æ§åˆ¶"><a href="#åç¨‹å–æ¶ˆä¸è¶…æ—¶æ§åˆ¶" class="headerlink" title="åç¨‹å–æ¶ˆä¸è¶…æ—¶æ§åˆ¶"></a>åç¨‹å–æ¶ˆä¸è¶…æ—¶æ§åˆ¶</h2><h3 id="å–æ¶ˆåç¨‹"><a href="#å–æ¶ˆåç¨‹" class="headerlink" title="å–æ¶ˆåç¨‹"></a>å–æ¶ˆåç¨‹</h3><p>åç¨‹å–æ¶ˆæ˜¯ä¸€ç§åä½œæœºåˆ¶ï¼Œè¢«å–æ¶ˆçš„åç¨‹éœ€è¦åœ¨åˆé€‚çš„åœ°æ–¹æ£€æµ‹å–æ¶ˆçŠ¶æ€ã€‚å¸¸ç”¨æ–¹æ³•åŒ…æ‹¬ï¼š</p><ul><li><strong>è°ƒç”¨ <code>job.cancel()</code></strong>ï¼šå–æ¶ˆå½“å‰ Job ä»¥åŠå…¶æ‰€æœ‰å­åç¨‹ã€‚</li><li><strong>æŒ‚èµ·ç‚¹æ£€æµ‹</strong>ï¼šä¾‹å¦‚ <code>delay()</code>ã€<code>withContext()</code> éƒ½ä¼šæ£€æŸ¥å–æ¶ˆçŠ¶æ€ã€‚</li></ul><p>ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">val job = myScope.launch &#123;</span><br><span class="line">    repeat(1000) &#123; i -&gt;</span><br><span class="line">        if (!isActive) return@launch // æ£€æŸ¥åç¨‹æ˜¯å¦è¢«å–æ¶ˆ</span><br><span class="line">        println(&quot;Processing $i&quot;)</span><br><span class="line">        delay(100)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">// å–æ¶ˆåç¨‹</span><br><span class="line">job.cancel()</span><br></pre></td></tr></table></figure><h3 id="withTimeout-ä¸-withTimeoutOrNull"><a href="#withTimeout-ä¸-withTimeoutOrNull" class="headerlink" title="withTimeout ä¸ withTimeoutOrNull"></a>withTimeout ä¸ withTimeoutOrNull</h3><ul><li><p><strong>withTimeout</strong><br> è§„å®šä¸€æ®µæ—¶é—´å†…æœªå®Œæˆä»»åŠ¡ï¼Œåˆ™æŠ›å‡º <code>TimeoutCancellationException</code>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line">    withTimeout(3000) &#123;</span><br><span class="line">        // å¦‚æœ 3 ç§’å†…æ²¡æœ‰å®Œæˆï¼Œåˆ™å¼‚å¸¸é€€å‡º</span><br><span class="line">        performLongRunningTask()</span><br><span class="line">    &#125;</span><br><span class="line">&#125; catch (e: TimeoutCancellationException) &#123;</span><br><span class="line">    println(&quot;ä»»åŠ¡è¶…æ—¶&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>withTimeoutOrNull</strong><br> è¶…æ—¶è¿”å› <code>null</code>ï¼Œä¸ä¼šæŠ›å¼‚å¸¸ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">val result = withTimeoutOrNull(3000) &#123;</span><br><span class="line">    performLongRunningTask()</span><br><span class="line">&#125;</span><br><span class="line">if (result == null) &#123;</span><br><span class="line">    println(&quot;ä»»åŠ¡è¶…æ—¶&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><hr><h2 id="å¼‚å¸¸å¤„ç†"><a href="#å¼‚å¸¸å¤„ç†" class="headerlink" title="å¼‚å¸¸å¤„ç†"></a>å¼‚å¸¸å¤„ç†</h2><h3 id="CoroutineExceptionHandler"><a href="#CoroutineExceptionHandler" class="headerlink" title="CoroutineExceptionHandler"></a>CoroutineExceptionHandler</h3><p>ç”¨äºå…¨å±€æ•è·åç¨‹æœªå¤„ç†çš„å¼‚å¸¸ã€‚é€šè¿‡åœ¨åç¨‹ä¸Šä¸‹æ–‡ä¸­æ·»åŠ  <code>CoroutineExceptionHandler</code>ï¼Œå¯ä»¥ç»Ÿä¸€å¤„ç†å¼‚å¸¸ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">val handler = CoroutineExceptionHandler &#123; _, exception -&gt;</span><br><span class="line">    println(&quot;æ•è·åˆ°å¼‚å¸¸ï¼š$&#123;exception.message&#125;&quot;)</span><br><span class="line">&#125;</span><br><span class="line">myScope.launch(handler) &#123;</span><br><span class="line">    throw RuntimeException(&quot;æµ‹è¯•å¼‚å¸¸&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="try-catch-åœ¨åç¨‹ä¸­çš„ä½¿ç”¨"><a href="#try-catch-åœ¨åç¨‹ä¸­çš„ä½¿ç”¨" class="headerlink" title="try&#x2F;catch åœ¨åç¨‹ä¸­çš„ä½¿ç”¨"></a>try&#x2F;catch åœ¨åç¨‹ä¸­çš„ä½¿ç”¨</h3><p>åœ¨æŒ‚èµ·å‡½æ•°å†…éƒ¨ï¼ŒåŒæ­¥ä»£ç ä¸­çš„ <code>try/catch</code> åŒæ ·é€‚ç”¨ï¼Œç”¨äºæ•è·ç‰¹å®šçš„å¼‚å¸¸ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">myScope.launch &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        val result = performRiskOperation()</span><br><span class="line">        println(&quot;ç»“æœï¼š$result&quot;)</span><br><span class="line">    &#125; catch (e: Exception) &#123;</span><br><span class="line">        println(&quot;é”™è¯¯ï¼š$&#123;e.message&#125;&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="åç¨‹é€šä¿¡ä¸åŒæ­¥"><a href="#åç¨‹é€šä¿¡ä¸åŒæ­¥" class="headerlink" title="åç¨‹é€šä¿¡ä¸åŒæ­¥"></a>åç¨‹é€šä¿¡ä¸åŒæ­¥</h2><h3 id="Channel"><a href="#Channel" class="headerlink" title="Channel"></a>Channel</h3><p>Channel æä¾›äº†ä¸€ç§åœ¨åç¨‹ä¹‹é—´è¿›è¡Œé€šä¿¡çš„æ–¹å¼ï¼Œç±»ä¼¼äºé˜»å¡é˜Ÿåˆ—ã€‚é€šè¿‡ Channelï¼Œå¯ä»¥å®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹ã€‚</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import kotlinx.coroutines.channels.Channel</span><br><span class="line"></span><br><span class="line">val channel = Channel&lt;Int&gt;()</span><br><span class="line">// ç”Ÿäº§è€…åç¨‹</span><br><span class="line">launch &#123;</span><br><span class="line">    for (i in 1..5) &#123;</span><br><span class="line">        channel.send(i)</span><br><span class="line">    &#125;</span><br><span class="line">    channel.close() // å…³é—­ Channel</span><br><span class="line">&#125;</span><br><span class="line">// æ¶ˆè´¹è€…åç¨‹</span><br><span class="line">launch &#123;</span><br><span class="line">    for (number in channel) &#123;</span><br><span class="line">        println(&quot;æ¥æ”¶æ•°æ®: $number&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Flow"><a href="#Flow" class="headerlink" title="Flow"></a>Flow</h3><p>Flow æ˜¯ Kotlin åç¨‹ä¸­çš„å“åº”å¼æµï¼Œç”¨äºå¤„ç†å¼‚æ­¥æ•°æ®æµå’ŒèƒŒå‹æ§åˆ¶ã€‚</p><ul><li><strong>å®šä¹‰ Flow</strong>ï¼šä½¿ç”¨ <code>flow &#123;&#125;</code> æ„å»ºæ•°æ®æµ</li><li><strong>æ”¶é›†æ•°æ®</strong>ï¼šä½¿ç”¨ <code>collect &#123;&#125;</code> å¤„ç†æ•°æ®</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import kotlinx.coroutines.flow.*</span><br><span class="line"></span><br><span class="line">fun simpleFlow(): Flow&lt;Int&gt; = flow &#123;</span><br><span class="line">    for (i in 1..3) &#123;</span><br><span class="line">        delay(100)</span><br><span class="line">        emit(i) // å‘å°„æ•°æ®</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">launch &#123;</span><br><span class="line">    simpleFlow().collect &#123; value -&gt;</span><br><span class="line">        println(&quot;æ”¶åˆ°ï¼š$value&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="ä¸-Android-é›†æˆ"><a href="#ä¸-Android-é›†æˆ" class="headerlink" title="ä¸ Android é›†æˆ"></a>ä¸ Android é›†æˆ</h2><p>åœ¨ Android å¼€å‘ä¸­ï¼Œåç¨‹å¯ä»¥å¾ˆå¥½åœ°è§£å†³å¼‚æ­¥ä»»åŠ¡å’Œ UI æ›´æ–°é—®é¢˜ã€‚å¸¸è§çš„é›†æˆæ–¹å¼åŒ…æ‹¬ï¼š</p><h3 id="åœ¨-UI-çº¿ç¨‹ä¸­å¯åŠ¨åç¨‹"><a href="#åœ¨-UI-çº¿ç¨‹ä¸­å¯åŠ¨åç¨‹" class="headerlink" title="åœ¨ UI çº¿ç¨‹ä¸­å¯åŠ¨åç¨‹"></a>åœ¨ UI çº¿ç¨‹ä¸­å¯åŠ¨åç¨‹</h3><p>åˆ©ç”¨ <code>Dispatchers.Main</code> åœ¨ä¸»çº¿ç¨‹ä¸­æ›´æ–° UIï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CoroutineScope(Dispatchers.Main).launch &#123;</span><br><span class="line">    val data = withContext(Dispatchers.IO) &#123; fetchDataFromNetwork() &#125;</span><br><span class="line">    textView.text = data</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨-ViewModelScope-å’Œ-LifecycleScope"><a href="#ä½¿ç”¨-ViewModelScope-å’Œ-LifecycleScope" class="headerlink" title="ä½¿ç”¨ ViewModelScope å’Œ LifecycleScope"></a>ä½¿ç”¨ ViewModelScope å’Œ LifecycleScope</h3><ul><li><p><strong>viewModelScope</strong><br> é€‚ç”¨äº ViewModel ä¸­å¯åŠ¨åç¨‹ï¼Œä¸ ViewModel ç”Ÿå‘½å‘¨æœŸç»‘å®šï¼Œé¿å…å†…å­˜æ³„æ¼ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class MyViewModel : ViewModel() &#123;</span><br><span class="line">    init &#123;</span><br><span class="line">        viewModelScope.launch &#123;</span><br><span class="line">            // æ‰§è¡Œç½‘ç»œè¯·æ±‚æˆ–æ•°æ®åŠ è½½</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>lifecycleScope</strong><br> é€‚ç”¨äº Activity æˆ– Fragmentï¼Œè‡ªåŠ¨ç®¡ç†åç¨‹ç”Ÿå‘½å‘¨æœŸã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">class MainActivity : AppCompatActivity() &#123;</span><br><span class="line">    override fun onCreate(savedInstanceState: Bundle?) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState)</span><br><span class="line">        lifecycleScope.launch &#123;</span><br><span class="line">            // æ‰§è¡Œä¸ UI ç›¸å…³çš„åç¨‹æ“ä½œ</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><hr><h2 id="æœ€ä½³å®è·µä¸å¸¸è§é—®é¢˜"><a href="#æœ€ä½³å®è·µä¸å¸¸è§é—®é¢˜" class="headerlink" title="æœ€ä½³å®è·µä¸å¸¸è§é—®é¢˜"></a>æœ€ä½³å®è·µä¸å¸¸è§é—®é¢˜</h2><h3 id="æœ€ä½³å®è·µ"><a href="#æœ€ä½³å®è·µ" class="headerlink" title="æœ€ä½³å®è·µ"></a>æœ€ä½³å®è·µ</h3><ol><li><strong>é¿å…ä½¿ç”¨ GlobalScope</strong><br> å…¨å±€ä½œç”¨åŸŸå®¹æ˜“å¯¼è‡´åç¨‹æ³„æ¼ï¼Œå»ºè®®ä½¿ç”¨ç»“æ„åŒ–å¹¶å‘çš„ CoroutineScopeã€‚</li><li><strong>é€‰æ‹©åˆé€‚çš„è°ƒåº¦å™¨</strong><br> æ ¹æ®ä»»åŠ¡ç±»å‹ï¼ˆIOã€CPUã€UIï¼‰é€‰æ‹©å¯¹åº”çš„è°ƒåº¦å™¨ã€‚</li><li><strong>åˆç†ä½¿ç”¨è¶…æ—¶ä¸å–æ¶ˆ</strong><br> å¯¹é•¿æ—¶é—´ç­‰å¾…çš„ä»»åŠ¡ä½¿ç”¨ withTimeout&#x2F;withTimeoutOrNullï¼Œç¡®ä¿åç¨‹åŠæ—¶å–æ¶ˆã€‚</li><li><strong>å¼‚å¸¸æ•è·</strong><br> åœ¨å…³é”®ä¸šåŠ¡é€»è¾‘ä¸­ä½¿ç”¨ try&#x2F;catchï¼ŒåŒæ—¶é…ç½® CoroutineExceptionHandler æ•è·å…¨å±€å¼‚å¸¸ã€‚</li><li><strong>æ•´æ´ä»£ç </strong><br> å°†åç¨‹ç›¸å…³ä»£ç æ”¾å…¥ä¸“é—¨çš„ Repository æˆ– UseCase å±‚ï¼Œåˆ†ç¦» UI å±‚é€»è¾‘ã€‚</li></ol><h3 id="å¸¸è§é—®é¢˜"><a href="#å¸¸è§é—®é¢˜" class="headerlink" title="å¸¸è§é—®é¢˜"></a>å¸¸è§é—®é¢˜</h3><ul><li><strong>åç¨‹æ³„æ¼</strong><br> æœªå–æ¶ˆçš„åç¨‹ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ã€‚ç¡®ä¿åœ¨åˆé€‚æ—¶æœºè°ƒç”¨ cancel() æˆ–ä½¿ç”¨ç»‘å®šç”Ÿå‘½å‘¨æœŸçš„ Scopeã€‚</li><li><strong>å¼‚å¸¸æœªæ•è·</strong><br> å­åç¨‹å¼‚å¸¸å¯èƒ½ä¸ä¼šä¼ é€’ç»™çˆ¶åç¨‹ï¼Œä½¿ç”¨ supervisorScope æˆ–è€…åˆé€‚çš„å¼‚å¸¸å¤„ç†å™¨æ¥ä¿è¯å¼‚å¸¸å¤„ç†ä¸€è‡´æ€§ã€‚</li><li><strong>çº¿ç¨‹åˆ‡æ¢é—®é¢˜</strong><br> åç¨‹ä¸­çš„ä¸Šä¸‹æ–‡åˆ‡æ¢éœ€è¦æ˜¾å¼æŒ‡å®š withContextï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´ UI é˜»å¡æˆ–åå°çº¿ç¨‹æ“ä½œ UIã€‚</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Kotlin </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§£æJSONæ ¼å¼æ•°æ®ç¤ºä¾‹</title>
      <link href="/2025/03/30/%E8%A7%A3%E6%9E%90JSON%E6%A0%BC%E5%BC%8F%E6%95%B0%E6%8D%AE%E7%A4%BA%E4%BE%8B/"/>
      <url>/2025/03/30/%E8%A7%A3%E6%9E%90JSON%E6%A0%BC%E5%BC%8F%E6%95%B0%E6%8D%AE%E7%A4%BA%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<p>ä¹¦ä¸ŠP444è®²çš„æ›´å¥½</p><h2 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1. æ¦‚è¿°"></a>1. æ¦‚è¿°</h2><p>JSONï¼ˆJavaScript Object Notationï¼‰æ˜¯ä¸€ç§è½»é‡çº§çš„æ•°æ®äº¤æ¢æ ¼å¼ï¼Œå¸¸ç”¨äº Web API äº¤äº’ã€‚Kotlin æä¾›äº†å¤šç§è§£æ JSON æ•°æ®çš„æ–¹æ³•ï¼Œå…¶ä¸­ <code>org.json.JSONObject</code> å’Œ <code>Gson</code> æ˜¯å¸¸è§çš„é€‰æ‹©ã€‚</p><h2 id="2-é€‚ç”¨åœºæ™¯"><a href="#2-é€‚ç”¨åœºæ™¯" class="headerlink" title="2. é€‚ç”¨åœºæ™¯"></a>2. é€‚ç”¨åœºæ™¯</h2><ul><li><strong>è§£æç½‘ç»œè¯·æ±‚è¿”å›çš„ JSON æ•°æ®</strong></li><li><strong>å­˜å‚¨å’Œè¯»å–æœ¬åœ° JSON é…ç½®æ–‡ä»¶</strong></li><li><strong>åºåˆ—åŒ–&#x2F;ååºåˆ—åŒ– Kotlin æ•°æ®ç±»</strong></li></ul><h2 id="3-JSON-ç¤ºä¾‹"><a href="#3-JSON-ç¤ºä¾‹" class="headerlink" title="3. JSON ç¤ºä¾‹"></a>3. JSON ç¤ºä¾‹</h2><p>å‡è®¾æœ‰å¦‚ä¸‹ JSON æ•°æ® <code>sample.json</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;apps&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;id&quot;: 1,</span><br><span class="line">      &quot;name&quot;: &quot;MyApp&quot;,</span><br><span class="line">      &quot;version&quot;: &quot;1.0.0&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;id&quot;: 2,</span><br><span class="line">      &quot;name&quot;: &quot;AnotherApp&quot;,</span><br><span class="line">      &quot;version&quot;: &quot;2.3.4&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-è§£ææ–¹å¼"><a href="#4-è§£ææ–¹å¼" class="headerlink" title="4. è§£ææ–¹å¼"></a>4. è§£ææ–¹å¼</h2><h3 id="4-1-ä½¿ç”¨-org-json-è§£æ-JSON"><a href="#4-1-ä½¿ç”¨-org-json-è§£æ-JSON" class="headerlink" title="4.1 ä½¿ç”¨ org.json è§£æ JSON"></a><strong>4.1 ä½¿ç”¨ org.json è§£æ JSON</strong></h3><p>Kotlin å¯ä»¥ä½¿ç”¨ <code>org.json.JSONObject</code> å’Œ <code>org.json.JSONArray</code> è§£æ JSONã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import org.json.JSONObject</span><br><span class="line"></span><br><span class="line">fun parseJson(jsonData: String) &#123;</span><br><span class="line">    val jsonObject = JSONObject(jsonData)</span><br><span class="line">    val appsArray = jsonObject.getJSONArray(&quot;apps&quot;)</span><br><span class="line">    </span><br><span class="line">    for (i in 0 until appsArray.length()) &#123;</span><br><span class="line">        val appObject = appsArray.getJSONObject(i)</span><br><span class="line">        val id = appObject.getInt(&quot;id&quot;)</span><br><span class="line">        val name = appObject.getString(&quot;name&quot;)</span><br><span class="line">        val version = appObject.getString(&quot;version&quot;)</span><br><span class="line">        </span><br><span class="line">        println(&quot;App ID: $id, Name: $name, Version: $version&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-2-ä½¿ç”¨-Gson-è§£æ-JSON"><a href="#4-2-ä½¿ç”¨-Gson-è§£æ-JSON" class="headerlink" title="4.2 ä½¿ç”¨ Gson è§£æ JSON"></a><strong>4.2 ä½¿ç”¨ Gson è§£æ JSON</strong></h3><p><code>Gson</code> æ˜¯ Google æä¾›çš„ JSON åº“ï¼Œå¯ç”¨äºå¯¹è±¡ä¸ JSON ä¹‹é—´çš„è½¬æ¢ã€‚</p><p><strong>æ·»åŠ ä¾èµ–ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    implementation(&quot;com.google.code.gson:gson:2.8.9&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å®šä¹‰æ•°æ®ç±»å¹¶è§£æ JSONï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import com.google.gson.Gson</span><br><span class="line">import com.google.gson.annotations.SerializedName</span><br><span class="line"></span><br><span class="line">// å®šä¹‰æ•°æ®ç±»</span><br><span class="line">data class App(</span><br><span class="line">    val id: Int,</span><br><span class="line">    val name: String,</span><br><span class="line">    val version: String</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">data class AppList(</span><br><span class="line">    @SerializedName(&quot;apps&quot;) val apps: List&lt;App&gt;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">fun parseJsonWithGson(jsonData: String) &#123;</span><br><span class="line">    val gson = Gson()</span><br><span class="line">    val appList = gson.fromJson(jsonData, AppList::class.java)</span><br><span class="line">    </span><br><span class="line">    appList.apps.forEach &#123;</span><br><span class="line">        println(&quot;App ID: $&#123;it.id&#125;, Name: $&#123;it.name&#125;, Version: $&#123;it.version&#125;&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="5-è§£ææµç¨‹"><a href="#5-è§£ææµç¨‹" class="headerlink" title="5. è§£ææµç¨‹"></a>5. è§£ææµç¨‹</h2><ol><li><strong>é€‰æ‹©è§£ææ–¹å¼</strong>ï¼ˆ<code>org.json</code> æˆ– <code>Gson</code>ï¼‰ã€‚</li><li><strong>è§£æ JSON æ•°æ®</strong>ï¼ˆå¯¹è±¡æ˜ å°„æˆ–æ‰‹åŠ¨è§£æï¼‰ã€‚</li><li><strong>å¤„ç†æ•°æ®</strong>ï¼ˆå­˜å‚¨ã€å±•ç¤ºæˆ–æ“ä½œï¼‰ã€‚</li></ol><h2 id="6-é€‚ç”¨åœºæ™¯å¯¹æ¯”"><a href="#6-é€‚ç”¨åœºæ™¯å¯¹æ¯”" class="headerlink" title="6. é€‚ç”¨åœºæ™¯å¯¹æ¯”"></a>6. é€‚ç”¨åœºæ™¯å¯¹æ¯”</h2><table><thead><tr><th>è§£ææ–¹å¼</th><th>é€‚ç”¨åœºæ™¯</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td><code>org.json</code></td><td>ç®€å•è§£æ JSON</td><td>é€‚åˆä¸´æ—¶å¤„ç†ï¼Œæ€§èƒ½è¾ƒä½</td></tr><tr><td><code>Gson</code></td><td>è§£æ API å“åº”æˆ–æœ¬åœ° JSON æ–‡ä»¶</td><td>æ˜“ç”¨ï¼Œæ”¯æŒå¤æ‚å¯¹è±¡æ˜ å°„</td></tr></tbody></table><h2 id="7-ç»“è®º"><a href="#7-ç»“è®º" class="headerlink" title="7. ç»“è®º"></a>7. ç»“è®º</h2><p>å¯¹äº Kotlin å¼€å‘è€…ï¼Œ<strong>æ¨èä½¿ç”¨</strong> <code>**Gson**</code>ï¼Œå®ƒæä¾›äº†æ›´çµæ´»çš„æ•°æ®æ˜ å°„èƒ½åŠ›ï¼Œé€‚ç”¨äºå¤§å¤šæ•° JSON è§£æéœ€æ±‚ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“çŸ¥è¯†ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SAXè§£æXMLæ•°æ®ç”¨æ³•ç¤ºä¾‹</title>
      <link href="/2025/03/30/SAX%E8%A7%A3%E6%9E%90XML%E6%95%B0%E6%8D%AE%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B/"/>
      <url>/2025/03/30/SAX%E8%A7%A3%E6%9E%90XML%E6%95%B0%E6%8D%AE%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<p><strong>ä½¿ç”¨ SAX è§£æ XML æ•°æ®</strong></p><h2 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1. æ¦‚è¿°"></a>1. æ¦‚è¿°</h2><p>SAXï¼ˆSimple API for XMLï¼‰æ˜¯ä¸€ç§åŸºäºäº‹ä»¶é©±åŠ¨çš„ XML è§£ææ–¹å¼ï¼Œé€‚ç”¨äºå¤„ç†å¤§è§„æ¨¡ XML æ–‡æ¡£ã€‚SAX è§£æå™¨ä¸ä¼šå°†æ•´ä¸ª XML åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè€Œæ˜¯é€è¡Œè§£æï¼Œå› æ­¤åœ¨ <strong>æ€§èƒ½å’Œå†…å­˜å ç”¨æ–¹é¢ä¼˜äº DOM è§£æ</strong>ã€‚</p><h2 id="2-é€‚ç”¨åœºæ™¯"><a href="#2-é€‚ç”¨åœºæ™¯" class="headerlink" title="2. é€‚ç”¨åœºæ™¯"></a>2. é€‚ç”¨åœºæ™¯</h2><ul><li><strong>å¤„ç†å¤§ XML æ–‡ä»¶</strong>ï¼ˆå¦‚ RSS è®¢é˜…ã€æ—¥å¿—æ–‡ä»¶ï¼‰</li><li><strong>æµå¼è§£æ</strong>ï¼ˆèŠ‚çœå†…å­˜ï¼‰</li><li><strong>åªéœ€è¯»å–æ•°æ®</strong>ï¼ˆæ— éœ€ä¿®æ”¹ XML ç»“æ„ï¼‰</li></ul><h2 id="3-XML-ç¤ºä¾‹"><a href="#3-XML-ç¤ºä¾‹" class="headerlink" title="3. XML ç¤ºä¾‹"></a>3. XML ç¤ºä¾‹</h2><p>å‡è®¾æœ‰å¦‚ä¸‹ XML æ•°æ® <code>sample.xml</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;apps&gt;</span><br><span class="line">    &lt;app id=&quot;1&quot;&gt;</span><br><span class="line">        &lt;name&gt;MyApp&lt;/name&gt;</span><br><span class="line">        &lt;version&gt;1.0.0&lt;/version&gt;</span><br><span class="line">    &lt;/app&gt;</span><br><span class="line">    &lt;app id=&quot;2&quot;&gt;</span><br><span class="line">        &lt;name&gt;AnotherApp&lt;/name&gt;</span><br><span class="line">        &lt;version&gt;2.3.4&lt;/version&gt;</span><br><span class="line">    &lt;/app&gt;</span><br><span class="line">&lt;/apps&gt;</span><br></pre></td></tr></table></figure><h2 id="4-SAX-è§£ææ­¥éª¤"><a href="#4-SAX-è§£ææ­¥éª¤" class="headerlink" title="4. SAX è§£ææ­¥éª¤"></a>4. SAX è§£ææ­¥éª¤</h2><h3 id="4-1-åˆ›å»º-ContentHandler-å¤„ç†-XML"><a href="#4-1-åˆ›å»º-ContentHandler-å¤„ç†-XML" class="headerlink" title="4.1 åˆ›å»º ContentHandler å¤„ç† XML"></a><strong>4.1 åˆ›å»º ContentHandler å¤„ç† XML</strong></h3><p>SAX è§£æåŸºäº <code>ContentHandler</code> å¤„ç† XML è§£æäº‹ä»¶ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">import android.util.Log</span><br><span class="line">import org.xml.sax.Attributes</span><br><span class="line">import org.xml.sax.helpers.DefaultHandler</span><br><span class="line"></span><br><span class="line">class AppContentHandler : DefaultHandler() &#123;</span><br><span class="line">    private var nodeName = &quot;&quot;</span><br><span class="line">    private lateinit var id: StringBuilder</span><br><span class="line">    private lateinit var name: StringBuilder</span><br><span class="line">    private lateinit var version: StringBuilder</span><br><span class="line"></span><br><span class="line">    override fun startDocument() &#123;</span><br><span class="line">        id = StringBuilder()</span><br><span class="line">        name = StringBuilder()</span><br><span class="line">        version = StringBuilder()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override fun startElement(uri: String?, localName: String?, qName: String?, attributes: Attributes?) &#123;</span><br><span class="line">        nodeName = localName ?: &quot;&quot;</span><br><span class="line">        if (localName == &quot;app&quot; &amp;&amp; attributes != null) &#123;</span><br><span class="line">            Log.d(&quot;AppContentHandler&quot;, &quot;App ID: $&#123;attributes.getValue(&quot;id&quot;)&#125;&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override fun characters(ch: CharArray?, start: Int, length: Int) &#123;</span><br><span class="line">        when (nodeName) &#123;</span><br><span class="line">            &quot;name&quot; -&gt; name.append(ch, start, length)</span><br><span class="line">            &quot;version&quot; -&gt; version.append(ch, start, length)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override fun endElement(uri: String?, localName: String?, qName: String?) &#123;</span><br><span class="line">        if (localName == &quot;app&quot;) &#123;</span><br><span class="line">            Log.d(&quot;AppContentHandler&quot;, &quot;App Name: $&#123;name.toString().trim()&#125;&quot;)</span><br><span class="line">            Log.d(&quot;AppContentHandler&quot;, &quot;App Version: $&#123;version.toString().trim()&#125;&quot;)</span><br><span class="line">            name.setLength(0)</span><br><span class="line">            version.setLength(0)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-2-åœ¨-Activity-æˆ–-Service-ä¸­ä½¿ç”¨-SAX-è§£æ-XML"><a href="#4-2-åœ¨-Activity-æˆ–-Service-ä¸­ä½¿ç”¨-SAX-è§£æ-XML" class="headerlink" title="4.2 åœ¨ Activity æˆ– Service ä¸­ä½¿ç”¨ SAX è§£æ XML"></a><strong>4.2 åœ¨ Activity æˆ– Service ä¸­ä½¿ç”¨ SAX è§£æ XML</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import org.xml.sax.InputSource</span><br><span class="line">import java.io.StringReader</span><br><span class="line">import javax.xml.parsers.SAXParserFactory</span><br><span class="line"></span><br><span class="line">fun parseXml(xmlData: String) &#123;</span><br><span class="line">    val factory = SAXParserFactory.newInstance()</span><br><span class="line">    val parser = factory.newSAXParser()</span><br><span class="line">    val xmlReader = parser.xmlReader</span><br><span class="line">    xmlReader.contentHandler = AppContentHandler()</span><br><span class="line">    xmlReader.parse(InputSource(StringReader(xmlData)))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-3-è°ƒç”¨è§£æå‡½æ•°"><a href="#4-3-è°ƒç”¨è§£æå‡½æ•°" class="headerlink" title="4.3 è°ƒç”¨è§£æå‡½æ•°"></a><strong>4.3 è°ƒç”¨è§£æå‡½æ•°</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">val xmlData = &quot;&quot;&quot;</span><br><span class="line">&lt;apps&gt;</span><br><span class="line">    &lt;app id=&quot;1&quot;&gt;</span><br><span class="line">        &lt;name&gt;MyApp&lt;/name&gt;</span><br><span class="line">        &lt;version&gt;1.0.0&lt;/version&gt;</span><br><span class="line">    &lt;/app&gt;</span><br><span class="line">    &lt;app id=&quot;2&quot;&gt;</span><br><span class="line">        &lt;name&gt;AnotherApp&lt;/name&gt;</span><br><span class="line">        &lt;version&gt;2.3.4&lt;/version&gt;</span><br><span class="line">    &lt;/app&gt;</span><br><span class="line">&lt;/apps&gt;</span><br><span class="line">&quot;&quot;&quot;.trimIndent()</span><br><span class="line"></span><br><span class="line">parseXml(xmlData)</span><br></pre></td></tr></table></figure><h2 id="5-è§£ææµç¨‹"><a href="#5-è§£ææµç¨‹" class="headerlink" title="5. è§£ææµç¨‹"></a>5. è§£ææµç¨‹</h2><ol><li><code>startDocument()</code> åˆå§‹åŒ–å˜é‡ã€‚</li><li><code>startElement()</code> è¯»å– <strong>æ ‡ç­¾åç§°</strong> å’Œ <strong>å±æ€§</strong>ã€‚</li><li><code>characters()</code> è¯»å– <strong>æ ‡ç­¾å†…æ–‡æœ¬</strong>ã€‚</li><li><code>endElement()</code> å¤„ç† <strong>æ•°æ®å­˜å‚¨å’Œè¾“å‡º</strong>ã€‚</li></ol><h2 id="6-ä¼˜åŠ¿ä¸å±€é™æ€§"><a href="#6-ä¼˜åŠ¿ä¸å±€é™æ€§" class="headerlink" title="6. ä¼˜åŠ¿ä¸å±€é™æ€§"></a>6. ä¼˜åŠ¿ä¸å±€é™æ€§</h2><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a><strong>ä¼˜ç‚¹</strong></h3><p>âœ” <strong>å†…å­˜å ç”¨ä½</strong>ï¼ˆé€‚åˆå¤§ XML æ–‡ä»¶ï¼‰ âœ” <strong>è§£æé€Ÿåº¦å¿«</strong>ï¼ˆåŸºäºæµå¼å¤„ç†ï¼‰ âœ” <strong>å®˜æ–¹æ¨è</strong>ï¼ˆAndroid å†…ç½®æ”¯æŒï¼‰</p><h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a><strong>ç¼ºç‚¹</strong></h3><p>âœ˜ <strong>ä¸æ”¯æŒéšæœºè®¿é—®</strong>ï¼ˆåªèƒ½é¡ºåºè§£æï¼‰ âœ˜ <strong>ä¸é€‚åˆä¿®æ”¹ XML ç»“æ„</strong>ï¼ˆä»…é€‚ç”¨äºè¯»å–æ•°æ®ï¼‰</p><h2 id="7-é€‚ç”¨åœºæ™¯"><a href="#7-é€‚ç”¨åœºæ™¯" class="headerlink" title="7. é€‚ç”¨åœºæ™¯"></a>7. é€‚ç”¨åœºæ™¯</h2><ul><li><strong>è§£æç½‘ç»œè¯·æ±‚è¿”å›çš„ XML</strong></li><li><strong>å¤„ç† RSS è®¢é˜…æ•°æ®</strong></li><li><strong>è§£æé…ç½®æ–‡ä»¶</strong>ï¼ˆå¦‚ <code>AndroidManifest.xml</code>ï¼‰</li></ul><h2 id="8-ç»“è®º"><a href="#8-ç»“è®º" class="headerlink" title="8. ç»“è®º"></a>8. ç»“è®º</h2><p>SAX è§£ææ˜¯ä¸€ç§ <strong>é«˜æ•ˆä¸”è½»é‡</strong> çš„ XML å¤„ç†æ–¹å¼ï¼Œé€‚ç”¨äº Android å¼€å‘ï¼Œå°¤å…¶æ˜¯éœ€è¦è§£æå¤§ XML æ•°æ®æ—¶ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“çŸ¥è¯†ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨XmlPullParserè§£æXMLæ ¼å¼æ•°æ®çš„ç”¨æ³•ç¤ºä¾‹</title>
      <link href="/2025/03/30/%E4%BD%BF%E7%94%A8XmlPullParser%E8%A7%A3%E6%9E%90XML%E6%A0%BC%E5%BC%8F%E6%95%B0%E6%8D%AE%E7%9A%84%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B/"/>
      <url>/2025/03/30/%E4%BD%BF%E7%94%A8XmlPullParser%E8%A7%A3%E6%9E%90XML%E6%A0%BC%E5%BC%8F%E6%95%B0%E6%8D%AE%E7%9A%84%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<p><strong>ä½¿ç”¨ XmlPullParser è§£æ XML æ ¼å¼æ•°æ®ï¼ˆKotlin ç‰ˆï¼‰</strong></p><p>ä¹¦ä¸ŠP438è®²çš„å¾ˆå¥½ï¼Œçœ‹ä¹¦æˆ‘è§‰å¾—æ›´å¥½</p><h2 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1. æ¦‚è¿°"></a>1. æ¦‚è¿°</h2><p>XmlPullParser æ˜¯ Android å®˜æ–¹æä¾›çš„è½»é‡çº§ XML è§£æå™¨ï¼Œé€‚ç”¨äºèµ„æºå—é™çš„ç§»åŠ¨è®¾å¤‡ã€‚å®ƒåŸºäºæµå¼è§£æï¼Œä¸ä¼šå°†æ•´ä¸ª XML åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå› æ­¤é€‚ç”¨äºå¤§æ•°æ®é‡çš„ XML è§£æã€‚</p><p><strong>é¢å¤–çŸ¥è¯†â€”é€‰æ‹©åˆé€‚çš„è§£ææ–¹å¼ï¼š</strong></p><table><thead><tr><th>æ–¹å¼</th><th>é€‚ç”¨åœºæ™¯</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td>SAX</td><td>å¤§å‹ XMLï¼Œé€è¡Œè§£æ</td><td>ä½å†…å­˜å ç”¨</td><td>ç¼–ç å¤æ‚</td></tr><tr><td>DOM</td><td>å°å‹ XMLï¼Œéœ€è¦ä¿®æ”¹</td><td>æ˜“ç”¨</td><td>å†…å­˜å ç”¨å¤§</td></tr><tr><td>XmlPullParser</td><td>è½»é‡ XML è§£æ</td><td>æ€§èƒ½é«˜</td><td>æ‰‹å†™è§£æä»£ç </td></tr><tr><td>Simple XML</td><td>å¤æ‚ XMLï¼Œæ˜ å°„å¯¹è±¡</td><td>ä»£ç æ¸…æ™°</td><td>ä¾èµ–ç¬¬ä¸‰æ–¹åº“</td></tr></tbody></table><p>å¦‚æœä½ å¤„ç†çš„æ˜¯ Android ç«¯ XML è§£æï¼Œå»ºè®®ä¼˜å…ˆä½¿ç”¨ <strong>XmlPullParser</strong>ï¼Œå¦‚æœ XML ç»“æ„å¤æ‚ä¸”éœ€è¦æ˜ å°„å¯¹è±¡ï¼Œå¯ä»¥è€ƒè™‘ <strong>Simple XML</strong>ã€‚</p><h2 id="2-ä½¿ç”¨æ­¥éª¤"><a href="#2-ä½¿ç”¨æ­¥éª¤" class="headerlink" title="2. ä½¿ç”¨æ­¥éª¤"></a>2. ä½¿ç”¨æ­¥éª¤</h2><h3 id="2-1-æ·»åŠ ä¾èµ–"><a href="#2-1-æ·»åŠ ä¾èµ–" class="headerlink" title="2.1 æ·»åŠ ä¾èµ–"></a>2.1 æ·»åŠ ä¾èµ–</h3><p>XmlPullParser æ˜¯ Android è‡ªå¸¦çš„ APIï¼Œå› æ­¤æ— éœ€é¢å¤–æ·»åŠ ä¾èµ–ã€‚</p><h3 id="2-2-XML-ç¤ºä¾‹æ•°æ®"><a href="#2-2-XML-ç¤ºä¾‹æ•°æ®" class="headerlink" title="2.2 XML ç¤ºä¾‹æ•°æ®"></a>2.2 XML ç¤ºä¾‹æ•°æ®</h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª XML æ–‡ä»¶ <code>sample.xml</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;catalog&gt;</span><br><span class="line">    &lt;book id=&quot;1&quot;&gt;</span><br><span class="line">        &lt;title&gt;Android Development&lt;/title&gt;</span><br><span class="line">        &lt;author&gt;John Doe&lt;/author&gt;</span><br><span class="line">        &lt;price&gt;29.99&lt;/price&gt;</span><br><span class="line">    &lt;/book&gt;</span><br><span class="line">    &lt;book id=&quot;2&quot;&gt;</span><br><span class="line">        &lt;title&gt;Kotlin for Beginners&lt;/title&gt;</span><br><span class="line">        &lt;author&gt;Jane Smith&lt;/author&gt;</span><br><span class="line">        &lt;price&gt;35.50&lt;/price&gt;</span><br><span class="line">    &lt;/book&gt;</span><br><span class="line">&lt;/catalog&gt;</span><br></pre></td></tr></table></figure><h3 id="2-3-è§£æ-XML-æ•°æ®"><a href="#2-3-è§£æ-XML-æ•°æ®" class="headerlink" title="2.3 è§£æ XML æ•°æ®"></a>2.3 è§£æ XML æ•°æ®</h3><h4 id="2-3-1-åˆ›å»º-XmlPullParser-å¯¹è±¡"><a href="#2-3-1-åˆ›å»º-XmlPullParser-å¯¹è±¡" class="headerlink" title="2.3.1 åˆ›å»º XmlPullParser å¯¹è±¡"></a>2.3.1 åˆ›å»º XmlPullParser å¯¹è±¡</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">val factory = XmlPullParserFactory.newInstance()</span><br><span class="line">val parser = factory.newPullParser()</span><br><span class="line">parser.setInput(xmlData.reader())</span><br></pre></td></tr></table></figure><h4 id="2-3-2-è§£æ-XML"><a href="#2-3-2-è§£æ-XML" class="headerlink" title="2.3.2 è§£æ XML"></a>2.3.2 è§£æ XML</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">var eventType = parser.eventType</span><br><span class="line">var tagName: String?</span><br><span class="line">var title = &quot;&quot;</span><br><span class="line">var author = &quot;&quot;</span><br><span class="line">var price = &quot;&quot;</span><br><span class="line"></span><br><span class="line">while (eventType != XmlPullParser.END_DOCUMENT) &#123;</span><br><span class="line">    when (eventType) &#123;</span><br><span class="line">        XmlPullParser.START_TAG -&gt; &#123;</span><br><span class="line">            tagName = parser.name</span><br><span class="line">            when (tagName) &#123;</span><br><span class="line">                &quot;title&quot; -&gt; title = parser.nextText()</span><br><span class="line">                &quot;author&quot; -&gt; author = parser.nextText()</span><br><span class="line">                &quot;price&quot; -&gt; price = parser.nextText()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    eventType = parser.next()</span><br><span class="line">    </span><br><span class="line">    // è¾“å‡ºè§£æç»“æœ</span><br><span class="line">    if (title.isNotEmpty() &amp;&amp; author.isNotEmpty() &amp;&amp; price.isNotEmpty()) &#123;</span><br><span class="line">        println(&quot;Book: $title, Author: $author, Price: $price&quot;)</span><br><span class="line">        title = &quot;&quot;</span><br><span class="line">        author = &quot;&quot;</span><br><span class="line">        price = &quot;&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-è§£ææµç¨‹è§£æ"><a href="#3-è§£ææµç¨‹è§£æ" class="headerlink" title="3. è§£ææµç¨‹è§£æ"></a>3. è§£ææµç¨‹è§£æ</h2><ul><li><code>XmlPullParser.START_TAG</code>ï¼šæ£€æµ‹åˆ° XML å…ƒç´ å¼€å§‹æ ‡ç­¾æ—¶ï¼Œè·å–æ ‡ç­¾åã€‚</li><li><code>parser.nextText()</code>ï¼šæå–æ ‡ç­¾çš„æ–‡æœ¬å†…å®¹ã€‚</li><li><code>XmlPullParser.END_DOCUMENT</code>ï¼šè§£æç»“æŸã€‚</li></ul><h2 id="4-ä¼˜åŠ¿"><a href="#4-ä¼˜åŠ¿" class="headerlink" title="4. ä¼˜åŠ¿"></a>4. ä¼˜åŠ¿</h2><ul><li><strong>å†…å­˜å ç”¨ä½</strong>ï¼šé€‚ç”¨äºå¤§æ–‡ä»¶è§£æã€‚</li><li><strong>é€Ÿåº¦å¿«</strong>ï¼šåªéå†ä¸€æ¬¡ XMLã€‚</li><li><strong>åŸç”Ÿæ”¯æŒ</strong>ï¼šæ— éœ€é¢å¤–ä¾èµ–ã€‚</li></ul><h2 id="5-é€‚ç”¨åœºæ™¯"><a href="#5-é€‚ç”¨åœºæ™¯" class="headerlink" title="5. é€‚ç”¨åœºæ™¯"></a>5. é€‚ç”¨åœºæ™¯</h2><ul><li>è§£æé…ç½®æ–‡ä»¶ï¼ˆå¦‚ <code>AndroidManifest.xml</code>ï¼‰ã€‚</li><li>è§£æç½‘ç»œè¿”å›çš„ XML æ•°æ®ã€‚</li><li>è§£æ RSS è®¢é˜…æ•°æ®ã€‚</li></ul><h2 id="6-æ€»ç»“"><a href="#6-æ€»ç»“" class="headerlink" title="6. æ€»ç»“"></a>6. æ€»ç»“</h2><p>XmlPullParser æ˜¯ Android æ¨èçš„ XML è§£ææ–¹å¼ï¼Œé€‚ç”¨äºç§»åŠ¨ç«¯é«˜æ•ˆå¤„ç† XML æ•°æ®ã€‚é€šè¿‡æµå¼è§£æï¼Œå¯ä»¥æ˜¾è‘—é™ä½å†…å­˜å ç”¨ï¼Œæé«˜åº”ç”¨æ€§èƒ½ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“çŸ¥è¯†ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OkHttpçš„ç”¨æ³•ç¤ºä¾‹</title>
      <link href="/2025/03/29/OkHttp%E7%9A%84%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B/"/>
      <url>/2025/03/29/OkHttp%E7%9A%84%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<p>OkHttp æ˜¯ä¸€ä¸ªé«˜æ•ˆã€çµæ´»çš„ HTTP å®¢æˆ·ç«¯åº“ï¼Œåœ¨ Android å¼€å‘ä¸­éå¸¸å¸¸ç”¨ã€‚ä¸‹é¢ä»‹ç»å¦‚ä½•åœ¨ Android ä¸­ä½¿ç”¨ OkHttpï¼Œå¹¶é™„ä¸Šå¸¸è§çš„ GET å’Œ POST è¯·æ±‚ç¤ºä¾‹ã€‚</p><h2 id="1-æ·»åŠ -OkHttp-ä¾èµ–"><a href="#1-æ·»åŠ -OkHttp-ä¾èµ–" class="headerlink" title="1. æ·»åŠ  OkHttp ä¾èµ–"></a><strong>1. æ·»åŠ  <code>OkHttp</code> ä¾èµ–</strong></h2><p>å¦‚æœä½ è¿˜æ²¡æœ‰æ·»åŠ  <code>OkHttp</code>ï¼Œéœ€è¦åœ¨ <code>build.gradle.kts</code> æ·»åŠ ä¾èµ–ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    implementation(&quot;com.squareup.okhttp3:okhttp:4.12.0&quot;) // æœ€æ–°ç‰ˆ</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ ç”¨çš„æ˜¯ <code>build.gradle</code>ï¼ˆGroovy è¯­æ³•ï¼‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    implementation &#x27;com.squareup.okhttp3:okhttp:4.12.0&#x27;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="2-åŸºæœ¬çš„-GET-è¯·æ±‚-åŒæ­¥"><a href="#2-åŸºæœ¬çš„-GET-è¯·æ±‚-åŒæ­¥" class="headerlink" title="2. åŸºæœ¬çš„ GET è¯·æ±‚(åŒæ­¥)"></a><strong>2. åŸºæœ¬çš„ GET è¯·æ±‚(åŒæ­¥)</strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import okhttp3.OkHttpClient</span><br><span class="line">import okhttp3.Request</span><br><span class="line">import okhttp3.Response</span><br><span class="line">import java.io.IOException</span><br><span class="line"></span><br><span class="line">fun sendGetRequest(): String? &#123;</span><br><span class="line">    val client = OkHttpClient() // åˆ›å»º OkHttpClient å®ä¾‹</span><br><span class="line"></span><br><span class="line">    val request = Request.Builder()</span><br><span class="line">        .url(&quot;https://api.example.com/data&quot;) // ç›®æ ‡ URL</span><br><span class="line">        .get() // GET è¯·æ±‚</span><br><span class="line">        .build()</span><br><span class="line"></span><br><span class="line">    return try &#123;</span><br><span class="line">        val response: Response = client.newCall(request).execute() // æ‰§è¡Œè¯·æ±‚ï¼ˆåŒæ­¥ï¼‰</span><br><span class="line">        if (response.isSuccessful) response.body?.string() else null</span><br><span class="line">    &#125; catch (e: IOException) &#123;</span><br><span class="line">        e.printStackTrace()</span><br><span class="line">        null</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a><strong>è¯´æ˜</strong></h3><ul><li><code>OkHttpClient</code>ï¼šåˆ›å»º HTTP å®¢æˆ·ç«¯å®ä¾‹ã€‚</li><li><code>Request.Builder()</code>ï¼šæ„å»º HTTP è¯·æ±‚ã€‚</li><li><code>.execute()</code>ï¼šæ‰§è¡Œ <strong>åŒæ­¥è¯·æ±‚</strong>ï¼ˆä¼šé˜»å¡çº¿ç¨‹ï¼‰ã€‚</li><li><code>response.body?.string()</code>ï¼šè·å–æœåŠ¡å™¨è¿”å›çš„å­—ç¬¦ä¸²ã€‚</li></ul><hr><h2 id="3-GET-è¯·æ±‚ï¼ˆå¼‚æ­¥ï¼‰"><a href="#3-GET-è¯·æ±‚ï¼ˆå¼‚æ­¥ï¼‰" class="headerlink" title="3. GET è¯·æ±‚ï¼ˆå¼‚æ­¥ï¼‰"></a><strong>3. GET è¯·æ±‚ï¼ˆå¼‚æ­¥ï¼‰</strong></h2><p>å¦‚æœä½ ä¸æƒ³é˜»å¡ä¸»çº¿ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨ <strong>å¼‚æ­¥è¯·æ±‚</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">import okhttp3.*</span><br><span class="line">import java.io.IOException</span><br><span class="line">//callback å˜é‡æœ€ç»ˆæ˜¯ç”¨æ¥å°†ç»“æœä¼ é€’åˆ°æœ€ä¸‹é¢çš„å›è°ƒå‡½æ•°é‡Œçš„ï¼Œè¿™ä¸ª å›è°ƒå‡½æ•° é‡Œçš„ result å°±æ˜¯ callback ä¼ é€’çš„å€¼</span><br><span class="line">fun sendGetRequestAsync(callback: (String?) -&gt; Unit) &#123;</span><br><span class="line">    val client = OkHttpClient()</span><br><span class="line">    val request = Request.Builder().url(&quot;https://api.example.com/data&quot;).build()</span><br><span class="line"></span><br><span class="line">    client.newCall(request).enqueue(object : Callback &#123;</span><br><span class="line">        override fun onFailure(call: Call, e: IOException) &#123;</span><br><span class="line">            callback(null) // å‘ç”Ÿé”™è¯¯ï¼Œè¿”å› nullåˆ°ä¸‹é¢å›è°ƒå‡½æ•°çš„resultä¸­</span><br><span class="line">        &#125;</span><br><span class="line">        override fun onResponse(call: Call, response: Response) &#123;</span><br><span class="line">            callback(response.body?.string()) // è¯·æ±‚æˆåŠŸï¼ŒæŠŠè¿”å›çš„æ•°æ®ä¼ é€’ç»™å›è°ƒå‡½æ•°ä¸­çš„result</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// è°ƒç”¨ç¤ºä¾‹</span><br><span class="line">fun main() &#123;</span><br><span class="line">    sendGetRequestAsync &#123; result -&gt;</span><br><span class="line">        if (result != null) &#123;</span><br><span class="line">            println(&quot;æœåŠ¡å™¨è¿”å›æ•°æ®ï¼š$result&quot;)</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            println(&quot;è¯·æ±‚å¤±è´¥&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>è¯´æ˜</strong></p><ul><li><code>.enqueue()</code>ï¼šä½¿ç”¨å¼‚æ­¥è¯·æ±‚ï¼Œä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹ã€‚</li><li><strong>onFailure</strong>ï¼šè¯·æ±‚å¤±è´¥æ—¶å›è°ƒã€‚</li><li><strong>onResponse</strong>ï¼šè¯·æ±‚æˆåŠŸæ—¶å›è°ƒï¼Œå¹¶è¿”å›æ•°æ®ã€‚</li></ul><hr><h2 id="4-POST-è¯·æ±‚ï¼ˆJSON-æ•°æ®ï¼‰"><a href="#4-POST-è¯·æ±‚ï¼ˆJSON-æ•°æ®ï¼‰" class="headerlink" title="4. POST è¯·æ±‚ï¼ˆJSON æ•°æ®ï¼‰"></a><strong>4. POST è¯·æ±‚ï¼ˆJSON æ•°æ®ï¼‰</strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import okhttp3.MediaType.Companion.toMediaTypeOrNull</span><br><span class="line">import okhttp3.OkHttpClient</span><br><span class="line">import okhttp3.Request</span><br><span class="line">import okhttp3.RequestBody</span><br><span class="line">import okhttp3.Response</span><br><span class="line"></span><br><span class="line">fun sendPostRequest(json: String): String? &#123;</span><br><span class="line">    val client = OkHttpClient()</span><br><span class="line"></span><br><span class="line">    val requestBody = RequestBody.create(&quot;application/json&quot;.toMediaTypeOrNull(), json)//è¿™é‡Œçš„jsonæ˜¯ä¼ å…¥çš„å‚æ•°</span><br><span class="line"></span><br><span class="line">    val request = Request.Builder()</span><br><span class="line">        .url(&quot;https://api.example.com/login&quot;)</span><br><span class="line">        .post(requestBody)</span><br><span class="line">        .build()</span><br><span class="line"></span><br><span class="line">    return try &#123;</span><br><span class="line">        val response: Response = client.newCall(request).execute()</span><br><span class="line">        if (response.isSuccessful) response.body?.string() else null</span><br><span class="line">    &#125; catch (e: IOException) &#123;</span><br><span class="line">        e.printStackTrace()</span><br><span class="line">        null</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a><strong>ä½¿ç”¨</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">val jsonData = &quot;&quot;&quot;&#123;&quot;username&quot;:&quot;test&quot;,&quot;password&quot;:&quot;123456&quot;&#125;&quot;&quot;&quot;</span><br><span class="line">val response = sendPostRequest(jsonData)</span><br><span class="line">println(&quot;æœåŠ¡å™¨è¿”å›: $response&quot;)</span><br></pre></td></tr></table></figure><h3 id="å¼‚æ­¥ç‰ˆæœ¬POSTè¯·æ±‚"><a href="#å¼‚æ­¥ç‰ˆæœ¬POSTè¯·æ±‚" class="headerlink" title="å¼‚æ­¥ç‰ˆæœ¬POSTè¯·æ±‚"></a>å¼‚æ­¥ç‰ˆæœ¬POSTè¯·æ±‚</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">import okhttp3.*</span><br><span class="line">import java.io.IOException</span><br><span class="line"></span><br><span class="line">fun sendPostRequestAsync(json: String, callback: (String?) -&gt; Unit) &#123;</span><br><span class="line">    val client = OkHttpClient()</span><br><span class="line"></span><br><span class="line">    // åˆ›å»ºè¯·æ±‚ä½“</span><br><span class="line">    val requestBody = RequestBody.create(&quot;application/json&quot;.toMediaTypeOrNull(), json)</span><br><span class="line"></span><br><span class="line">    // åˆ›å»ºè¯·æ±‚</span><br><span class="line">    val request = Request.Builder()</span><br><span class="line">        .url(&quot;https://api.example.com/login&quot;)</span><br><span class="line">        .post(requestBody)</span><br><span class="line">        .build()</span><br><span class="line"></span><br><span class="line">    // å¼‚æ­¥è¯·æ±‚ï¼Œä½¿ç”¨ enqueue å‘é€è¯·æ±‚</span><br><span class="line">    client.newCall(request).enqueue(object : Callback &#123;</span><br><span class="line">        override fun onFailure(call: Call, e: IOException) &#123;</span><br><span class="line">            callback(null)  // è¯·æ±‚å¤±è´¥ï¼Œä¼ é€’ null ç»™å›è°ƒ</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        override fun onResponse(call: Call, response: Response) &#123;</span><br><span class="line">            // è¯·æ±‚æˆåŠŸæ—¶ï¼Œæ£€æŸ¥å“åº”çŠ¶æ€</span><br><span class="line">            if (response.isSuccessful) &#123;</span><br><span class="line">                callback(response.body?.string())  // è¯·æ±‚æˆåŠŸï¼Œä¼ é€’å“åº”å†…å®¹ç»™å›è°ƒ</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                callback(null)  // å¦‚æœè¯·æ±‚ä¸æˆåŠŸï¼Œä¼ é€’ null</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//å¦‚ä½•ä½¿ç”¨å¦‚ä¸‹æ‰€ç¤º</span><br><span class="line">fun main() &#123;</span><br><span class="line">    val json = &quot;&quot;&quot;&#123;&quot;username&quot;:&quot;test&quot;, &quot;password&quot;:&quot;123456&quot;&#125;&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">    sendPostRequestAsync(json) &#123; result -&gt;</span><br><span class="line">        if (result != null) &#123;</span><br><span class="line">            println(&quot;è¯·æ±‚æˆåŠŸï¼Œè¿”å›æ•°æ®ï¼š$result&quot;)</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            println(&quot;è¯·æ±‚å¤±è´¥&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h2 id="5-åœ¨-Android-é‡Œä½¿ç”¨ï¼ˆç»“åˆåç¨‹ï¼‰"><a href="#5-åœ¨-Android-é‡Œä½¿ç”¨ï¼ˆç»“åˆåç¨‹ï¼‰" class="headerlink" title="5. åœ¨ Android é‡Œä½¿ç”¨ï¼ˆç»“åˆåç¨‹ï¼‰"></a><strong>5. åœ¨ Android é‡Œä½¿ç”¨ï¼ˆç»“åˆåç¨‹ï¼‰</strong></h2><p>åœ¨ Android å¼€å‘ä¸­ï¼Œæ¨è <strong>åç¨‹+OkHttp</strong>ï¼Œé¿å…é˜»å¡ UI çº¿ç¨‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">suspend fun fetchData(): String? &#123;</span><br><span class="line">    return withContext(Dispatchers.IO) &#123;</span><br><span class="line">        val client = OkHttpClient()</span><br><span class="line">        val request = Request.Builder()</span><br><span class="line">            .url(&quot;https://api.example.com/data&quot;)</span><br><span class="line">            .get()</span><br><span class="line">            .build()</span><br><span class="line"></span><br><span class="line">        try &#123;</span><br><span class="line">            val response = client.newCall(request).execute()</span><br><span class="line">            if (response.isSuccessful) response.body?.string() else null</span><br><span class="line">        &#125; catch (e: IOException) &#123;</span><br><span class="line">            e.printStackTrace()</span><br><span class="line">            null</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åœ¨-Activity-ä¸­è°ƒç”¨"><a href="#åœ¨-Activity-ä¸­è°ƒç”¨" class="headerlink" title="åœ¨ Activity ä¸­è°ƒç”¨"></a><strong>åœ¨ <code>Activity</code> ä¸­è°ƒç”¨</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">lifecycleScope.launch &#123;</span><br><span class="line">    val data = fetchData()</span><br><span class="line">    textView.text = data // æ›´æ–° UI</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h2><table><thead><tr><th>è¯·æ±‚æ–¹å¼</th><th>æ–¹æ³•</th><th>æ˜¯å¦é˜»å¡çº¿ç¨‹</th></tr></thead><tbody><tr><td><strong>GET</strong></td><td><code>execute()</code></td><td>âœ… <strong>åŒæ­¥ï¼ˆä¼šé˜»å¡ï¼‰</strong></td></tr><tr><td><strong>GETï¼ˆå¼‚æ­¥ï¼‰</strong></td><td><code>enqueue()</code></td><td>âŒ <strong>å¼‚æ­¥ï¼ˆä¸ä¼šé˜»å¡ï¼‰</strong></td></tr><tr><td><strong>POST</strong></td><td><code>execute()</code></td><td>âœ… <strong>åŒæ­¥ï¼ˆä¼šé˜»å¡ï¼‰</strong></td></tr><tr><td><strong>POSTï¼ˆåç¨‹ï¼‰</strong></td><td><code>withContext(Dispatchers.IO)</code></td><td>âœ… <strong>æ¨èï¼ˆä¸ä¼šé˜»å¡ï¼‰</strong></td></tr></tbody></table><ul><li><strong>åœ¨ Android é‡Œï¼Œæ¨èä½¿ç”¨</strong>ï¼š<ul><li><strong><code>enqueue()</code></strong>ï¼ˆå¼‚æ­¥å›è°ƒï¼‰</li><li><strong><code>withContext(Dispatchers.IO)</code></strong>ï¼ˆåç¨‹ï¼‰</li></ul></li><li><strong>é¿å…åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œ <code>execute()</code>ï¼Œå¦åˆ™ä¼šå¯¼è‡´ ANRï¼ˆåº”ç”¨æ— å“åº”ï¼‰</strong>ã€‚</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“çŸ¥è¯†ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HttpURLConnectionçš„ç”¨æ³•ç¤ºä¾‹</title>
      <link href="/2025/03/29/HttpURLConnection%E7%9A%84%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B/"/>
      <url>/2025/03/29/HttpURLConnection%E7%9A%84%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<p><code>HttpURLConnection</code> æ˜¯ Android è¿›è¡Œç½‘ç»œè¯·æ±‚çš„ä¸€ä¸ªè½»é‡çº§ HTTP å®¢æˆ·ç«¯ï¼Œé€‚ç”¨äºç®€å•çš„ GET å’Œ POST è¯·æ±‚ã€‚ä»¥ä¸‹æ˜¯ <code>HttpURLConnection</code> çš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•ã€‚</p><hr><h2 id="ä½¿ç”¨æ­¥éª¤"><a href="#ä½¿ç”¨æ­¥éª¤" class="headerlink" title="ä½¿ç”¨æ­¥éª¤"></a><strong>ä½¿ç”¨æ­¥éª¤</strong></h2><ol><li><strong>åˆ›å»º URL å¯¹è±¡</strong></li><li><strong>æ‰“å¼€è¿æ¥å¹¶é…ç½®è¯·æ±‚</strong></li><li><strong>å‘é€è¯·æ±‚</strong></li><li><strong>è¯»å–å“åº”</strong></li><li><strong>å…³é—­è¿æ¥</strong></li></ol><hr><h2 id="ç¤ºä¾‹ä»£ç "><a href="#ç¤ºä¾‹ä»£ç " class="headerlink" title="ç¤ºä¾‹ä»£ç "></a><strong>ç¤ºä¾‹ä»£ç </strong></h2><h3 id="1-GET-è¯·æ±‚"><a href="#1-GET-è¯·æ±‚" class="headerlink" title="1. GET è¯·æ±‚"></a><strong>1. GET è¯·æ±‚</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import java.net.HttpURLConnection</span><br><span class="line">import java.net.URL</span><br><span class="line"></span><br><span class="line">fun sendGetRequest(urlString: String): String? &#123;</span><br><span class="line">    var connection: HttpURLConnection? = null</span><br><span class="line">    try &#123;</span><br><span class="line">        val url = URL(urlString)</span><br><span class="line">        connection = url.openConnection() as HttpURLConnection</span><br><span class="line">        connection.requestMethod = &quot;GET&quot;</span><br><span class="line">        connection.connectTimeout = 5000  // è¶…æ—¶æ—¶é—´</span><br><span class="line">        connection.readTimeout = 5000</span><br><span class="line">        connection.doInput = true  // å…è®¸è¾“å…¥æµ</span><br><span class="line"></span><br><span class="line">        if (connection.responseCode == HttpURLConnection.HTTP_OK) &#123;</span><br><span class="line">            return connection.inputStream.bufferedReader().use &#123; it.readText() &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; catch (e: Exception) &#123;</span><br><span class="line">        e.printStackTrace()</span><br><span class="line">    &#125; finally &#123;</span><br><span class="line">        connection?.disconnect()  // æ–­å¼€è¿æ¥</span><br><span class="line">    &#125;</span><br><span class="line">    return null</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// ä½¿ç”¨</span><br><span class="line">val response = sendGetRequest(&quot;https://api.example.com/data&quot;)</span><br><span class="line">println(response)</span><br></pre></td></tr></table></figure><hr><h3 id="2-POST-è¯·æ±‚"><a href="#2-POST-è¯·æ±‚" class="headerlink" title="2. POST è¯·æ±‚"></a><strong>2. POST è¯·æ±‚</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">import java.io.OutputStream</span><br><span class="line">import java.net.HttpURLConnection</span><br><span class="line">import java.net.URL</span><br><span class="line"></span><br><span class="line">fun sendPostRequest(urlString: String, postData: String): String? &#123;</span><br><span class="line">    var connection: HttpURLConnection? = null</span><br><span class="line">    try &#123;</span><br><span class="line">        val url = URL(urlString)</span><br><span class="line">        connection = url.openConnection() as HttpURLConnection</span><br><span class="line">        connection.requestMethod = &quot;POST&quot;</span><br><span class="line">        connection.connectTimeout = 5000</span><br><span class="line">        connection.readTimeout = 5000</span><br><span class="line">        connection.doOutput = true  // å…è®¸è¾“å‡ºæµ</span><br><span class="line">        connection.setRequestProperty(&quot;Content-Type&quot;, &quot;application/json&quot;) // å‘é€ JSON æ•°æ®</span><br><span class="line"></span><br><span class="line">        // å‘é€æ•°æ®</span><br><span class="line">        connection.outputStream.use &#123; os: OutputStream -&gt;</span><br><span class="line">            os.write(postData.toByteArray())</span><br><span class="line">            os.flush()</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if (connection.responseCode == HttpURLConnection.HTTP_OK) &#123;</span><br><span class="line">            return connection.inputStream.bufferedReader().use &#123; it.readText() &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; catch (e: Exception) &#123;</span><br><span class="line">        e.printStackTrace()</span><br><span class="line">    &#125; finally &#123;</span><br><span class="line">        connection?.disconnect()</span><br><span class="line">    &#125;</span><br><span class="line">    return null</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// ä½¿ç”¨</span><br><span class="line">val jsonBody = &quot;&quot;&quot;&#123;&quot;username&quot;:&quot;test&quot;,&quot;password&quot;:&quot;123456&quot;&#125;&quot;&quot;&quot;</span><br><span class="line">val postResponse = sendPostRequest(&quot;https://api.example.com/login&quot;, jsonBody)</span><br><span class="line">println(postResponse)</span><br></pre></td></tr></table></figure><hr><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a><strong>æ³¨æ„äº‹é¡¹</strong></h2><ol><li><p><strong>ç½‘ç»œè¯·æ±‚å¿…é¡»åœ¨å­çº¿ç¨‹æ‰§è¡Œ</strong></p><ul><li>åœ¨ Android 9 åŠä»¥ä¸Šï¼Œä¸»çº¿ç¨‹è®¿é—®ç½‘ç»œä¼šæŠ›å‡º <code>NetworkOnMainThreadException</code>ã€‚</li><li>å¯ä»¥ä½¿ç”¨ <code>Coroutine</code> æˆ– <code>Thread</code> å¤„ç†ã€‚</li></ul><p><strong>ä½¿ç”¨ <code>Coroutine</code> è¿›è¡Œç½‘ç»œè¯·æ±‚</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">kotlinx.coroutines.Dispatchers</span><br><span class="line">import kotlinx.coroutines.withContext</span><br><span class="line"></span><br><span class="line">suspend fun fetchData(): String? &#123;</span><br><span class="line">    return withContext(Dispatchers.IO) &#123; </span><br><span class="line">        sendGetRequest(&quot;https://api.example.com/data&quot;) </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨ <code>fetchData()</code></strong></p><p><strong>ä¸èƒ½åœ¨ä¸»çº¿ç¨‹ç›´æ¥è°ƒç”¨ <code>fetchData()</code>ï¼Œéœ€è¦åœ¨åç¨‹ä¸­è°ƒç”¨ï¼Œä¾‹å¦‚ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import kotlinx.coroutines.*</span><br><span class="line"></span><br><span class="line">fun main() &#123;</span><br><span class="line">    GlobalScope.launch &#123;</span><br><span class="line">        val result = fetchData()</span><br><span class="line">        println(result)</span><br><span class="line">    &#125;</span><br><span class="line">    Thread.sleep(6000) // ç­‰å¾…åç¨‹æ‰§è¡Œï¼ˆä»…ç¤ºä¾‹ç”¨ï¼Œå®é™…å¼€å‘ä¸æ¨èï¼‰</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>æƒé™</strong></p><ul><li>åœ¨ <code>AndroidManifest.xml</code> ä¸­æ·»åŠ æƒé™ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;uses-permission android:name=&quot;android.permission.INTERNET&quot;/&gt;</span><br></pre></td></tr></table></figure></li><li><p><strong>è¶…æ—¶è®¾ç½®</strong></p><ul><li><code>connectTimeout</code> å’Œ <code>readTimeout</code> é˜²æ­¢è¯·æ±‚é•¿æ—¶é—´æŒ‚èµ·ã€‚</li></ul></li></ol><hr><h2 id="æ›¿ä»£æ–¹æ¡ˆ"><a href="#æ›¿ä»£æ–¹æ¡ˆ" class="headerlink" title="æ›¿ä»£æ–¹æ¡ˆ"></a><strong>æ›¿ä»£æ–¹æ¡ˆ</strong></h2><p>åœ¨ Android ç°ä»£å¼€å‘ä¸­ï¼Œå»ºè®®ä½¿ç”¨ <code>OkHttp</code> æˆ– <code>Retrofit</code> è¿›è¡Œç½‘ç»œè¯·æ±‚ï¼Œ<code>HttpURLConnection</code> é€‚ç”¨äºè½»é‡çº§è¯·æ±‚æˆ–å¯¹åº“ä¾èµ–è¦æ±‚è¾ƒé«˜çš„é¡¹ç›®ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“çŸ¥è¯†ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Serviceç”¨æ³•ç¤ºä¾‹</title>
      <link href="/2025/03/28/Service%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B/"/>
      <url>/2025/03/28/Service%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h1><h2 id="Service-æ˜¯ä»€ä¹ˆ"><a href="#Service-æ˜¯ä»€ä¹ˆ" class="headerlink" title="Service æ˜¯ä»€ä¹ˆ"></a>Service æ˜¯ä»€ä¹ˆ</h2><p>Service æ˜¯ Android ä¸­å®ç°ç¨‹åºåå°è¿è¡Œçš„è§£å†³æ–¹æ¡ˆï¼Œå®ƒéå¸¸é€‚åˆæ‰§è¡Œé‚£äº›ä¸éœ€è¦å’Œç”¨æˆ·äº¤äº’è€Œ ä¸”è¿˜è¦æ±‚é•¿æœŸè¿è¡Œçš„ä»»åŠ¡ã€‚Service çš„è¿è¡Œä¸ä¾èµ–äºä»»ä½•ç”¨æˆ·ç•Œé¢ï¼Œå³ä½¿ç¨‹åºè¢«åˆ‡æ¢åˆ°åå°ï¼Œæˆ– è€…ç”¨æˆ·æ‰“å¼€äº†å¦å¤–ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼ŒService ä»ç„¶èƒ½å¤Ÿä¿æŒæ­£å¸¸è¿è¡Œã€‚</p><p>ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒService å¹¶ä¸æ˜¯è¿è¡Œåœ¨ä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹å½“ä¸­çš„ï¼Œè€Œæ˜¯ä¾èµ–äºåˆ›å»º Service æ—¶ æ‰€åœ¨çš„åº”ç”¨ç¨‹åºè¿›ç¨‹ã€‚å½“æŸä¸ªåº”ç”¨ç¨‹åºè¿›ç¨‹è¢«æ€æ‰æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºè¯¥è¿›ç¨‹çš„ Service ä¹Ÿä¼šåœæ­¢è¿è¡Œã€‚</p><p>å¦å¤–ï¼Œä¹Ÿä¸è¦è¢« Service çš„åå°æ¦‚å¿µæ‰€è¿·æƒ‘ï¼Œå®é™…ä¸Š Service å¹¶ä¸ä¼šè‡ªåŠ¨å¼€å¯çº¿ç¨‹ï¼Œæ‰€æœ‰çš„ä»£ç éƒ½æ˜¯é»˜è®¤è¿è¡Œåœ¨ä¸»çº¿ç¨‹å½“ä¸­çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ Service çš„å†…éƒ¨æ‰‹åŠ¨åˆ›å»ºå­çº¿ç¨‹ï¼Œå¹¶åœ¨è¿™é‡Œæ‰§è¡Œå…·ä½“çš„ä»»åŠ¡ï¼Œå¦åˆ™å°±æœ‰å¯èƒ½å‡ºç°ä¸»çº¿ç¨‹è¢«é˜»å¡çš„æƒ…å†µã€‚</p><h2 id="Android-å¤šçº¿ç¨‹ç¼–ç¨‹"><a href="#Android-å¤šçº¿ç¨‹ç¼–ç¨‹" class="headerlink" title="Android å¤šçº¿ç¨‹ç¼–ç¨‹"></a>Android å¤šçº¿ç¨‹ç¼–ç¨‹</h2><p>å½“æˆ‘ä»¬éœ€è¦æ‰§è¡Œä¸€äº›è€—æ—¶æ“ä½œï¼Œæ¯”å¦‚å‘ èµ·ä¸€æ¡ç½‘ç»œè¯·æ±‚æ—¶ï¼Œè€ƒè™‘åˆ°ç½‘é€Ÿç­‰å…¶ä»–åŸå› ï¼ŒæœåŠ¡å™¨æœªå¿…èƒ½å¤Ÿç«‹åˆ»å“åº”æˆ‘ä»¬çš„è¯·æ±‚ï¼Œå¦‚æœä¸å°† è¿™ç±»æ“ä½œæ”¾åœ¨å­çº¿ç¨‹é‡Œè¿è¡Œï¼Œå°±ä¼šå¯¼è‡´ä¸»çº¿ç¨‹è¢«é˜»å¡ï¼Œä»è€Œå½±å“ç”¨æˆ·å¯¹è½¯ä»¶çš„æ­£å¸¸ä½¿ç”¨ã€‚</p><h3 id="çº¿ç¨‹çš„åŸºæœ¬ç”¨æ³•"><a href="#çº¿ç¨‹çš„åŸºæœ¬ç”¨æ³•" class="headerlink" title="çº¿ç¨‹çš„åŸºæœ¬ç”¨æ³•"></a>çº¿ç¨‹çš„åŸºæœ¬ç”¨æ³•</h3><p>ä¹‰ä¸€ ä¸ªçº¿ç¨‹åªéœ€è¦æ–°å»ºä¸€ä¸ªç±»ç»§æ‰¿è‡ª Threadï¼Œç„¶åé‡å†™çˆ¶ç±»çš„ run () æ–¹æ³•ï¼Œå¹¶åœ¨é‡Œé¢ç¼–å†™è€—æ—¶é€»è¾‘ å³å¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">class MyThread : Thread()&#123;</span><br><span class="line">    override fun run()&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆè¯¥å¦‚ä½•å¯åŠ¨è¿™ä¸ªçº¿ç¨‹å‘¢ï¼Ÿå…¶å®å¾ˆç®€å•ï¼Œåªéœ€è¦åˆ›å»º MyThread çš„å®ä¾‹ï¼Œç„¶åè°ƒç”¨å®ƒçš„ start () æ–¹æ³•å³å¯ï¼Œè¿™æ · run () æ–¹æ³•ä¸­çš„ä»£ç å°±ä¼šåœ¨å­çº¿ç¨‹å½“ä¸­è¿è¡Œäº†ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MyThread().start()</span><br></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œä½¿ç”¨ç»§æ‰¿çš„æ–¹å¼è€¦åˆæ€§æœ‰ç‚¹é«˜ï¼Œæˆ‘ä»¬ä¼šæ›´å¤šåœ°é€‰æ‹©ä½¿ç”¨å®ç° Runnable æ¥å£çš„æ–¹å¼æ¥å®šä¹‰ ä¸€ä¸ªçº¿ç¨‹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">class MyThread : Runnable &#123; </span><br><span class="line">     override fun run() &#123; </span><br><span class="line">        // ç¼–å†™å…·ä½“çš„é€»è¾‘ </span><br><span class="line">     &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœä½¿ç”¨äº†è¿™ç§å†™æ³•ï¼Œå¯åŠ¨çº¿ç¨‹çš„æ–¹æ³•ä¹Ÿéœ€è¦è¿›è¡Œç›¸åº”çš„æ”¹å˜ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">val myThread = MyThread() </span><br><span class="line">Thread(myThread).start() </span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼ŒThread çš„æ„é€ å‡½æ•°æ¥æ”¶ä¸€ä¸ª Runnable å‚æ•°ï¼Œè€Œæˆ‘ä»¬åˆ›å»ºçš„ MyThread å®ä¾‹æ­£æ˜¯ä¸€ ä¸ªå®ç°äº† Runnable æ¥å£çš„å¯¹è±¡ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥å°†å®ƒä¼ å…¥ Thread çš„æ„é€ å‡½æ•°é‡Œã€‚æ¥ç€è°ƒç”¨ Thread çš„ start () æ–¹æ³•ï¼Œrun () æ–¹æ³•ä¸­çš„ä»£ç å°±ä¼šåœ¨å­çº¿ç¨‹å½“ä¸­è¿è¡Œäº†ã€‚</p><p>å½“ç„¶ï¼Œå¦‚æœä½ ä¸æƒ³ä¸“é—¨å†å®šä¹‰ä¸€ä¸ªç±»å»å®ç° Runnable æ¥å£ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ Lambda çš„æ–¹å¼ï¼Œè¿™ç§ å†™æ³•æ›´ä¸ºå¸¸è§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Thread &#123; </span><br><span class="line"> // ç¼–å†™å…·ä½“çš„é€»è¾‘ </span><br><span class="line">&#125;.start()</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šå‡ ç§çº¿ç¨‹çš„ä½¿ç”¨æ–¹å¼ä½ åº”è¯¥ä¸ä¼šæ„Ÿåˆ°é™Œç”Ÿï¼Œå› ä¸ºåœ¨ Java ä¸­åˆ›å»ºå’Œå¯åŠ¨çº¿ç¨‹ä¹Ÿæ˜¯ä½¿ç”¨åŒæ ·çš„ æ–¹å¼ã€‚è€Œ Kotlin è¿˜ç»™æˆ‘ä»¬æä¾›äº†ä¸€ç§æ›´åŠ ç®€å•çš„å¼€å¯çº¿ç¨‹çš„æ–¹å¼ï¼Œå†™æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">thread &#123; </span><br><span class="line"> // ç¼–å†™å…·ä½“çš„é€»è¾‘ </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„ thread æ˜¯ä¸€ä¸ª Kotlin å†…ç½®çš„é¡¶å±‚å‡½æ•°ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ Lambda è¡¨è¾¾å¼ä¸­ç¼–å†™å…·ä½“çš„é€»è¾‘ å°±å¯ä»¥äº†ï¼Œè¿ start () æ–¹æ³•éƒ½ä¸ç”¨è°ƒç”¨ï¼Œthread å‡½æ•°åœ¨å†…éƒ¨å¸®æˆ‘ä»¬å…¨éƒ¨éƒ½å¤„ç†å¥½äº†ã€‚</p><h3 id="åœ¨å­çº¿ç¨‹ä¸­æ›´æ–°-UI"><a href="#åœ¨å­çº¿ç¨‹ä¸­æ›´æ–°-UI" class="headerlink" title="åœ¨å­çº¿ç¨‹ä¸­æ›´æ–° UI"></a>åœ¨å­çº¿ç¨‹ä¸­æ›´æ–° UI</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">class MainActivity : AppCompatActivity()&#123;</span><br><span class="line">    val updateText = 1</span><br><span class="line">    lateinit var textView : TextView</span><br><span class="line">    </span><br><span class="line">    val handle = object : Handler(Looper.getMainLooper())&#123;</span><br><span class="line">        override fun handleMessage(msg:Message)&#123;</span><br><span class="line">            when(msg.what)&#123;</span><br><span class="line">                updateText -&gt; textView.text = &quot;Nice to meet you&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    override fun onCreate(savedInstanceState : Bundle?)&#123;</span><br><span class="line">        super.onCreate(savedInstanceState)</span><br><span class="line">        val binding = ActivityMainBinding.inflate(layoutInflater)</span><br><span class="line">        setContentView(binding.root)</span><br><span class="line">        textView = binding.textView</span><br><span class="line">        val changeTextBtn = binding.changeTextBtn</span><br><span class="line">        changeTextBtn.setOnClickListener&#123;</span><br><span class="line">            thread&#123;</span><br><span class="line">                val msg = Message()</span><br><span class="line">                mag.what = updateText</span><br><span class="line">                handle.sendMessage(msg)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è§£æå¼‚æ­¥æ¶ˆæ¯å¤„ç†æœºåˆ¶"><a href="#è§£æå¼‚æ­¥æ¶ˆæ¯å¤„ç†æœºåˆ¶" class="headerlink" title="è§£æå¼‚æ­¥æ¶ˆæ¯å¤„ç†æœºåˆ¶"></a>è§£æå¼‚æ­¥æ¶ˆæ¯å¤„ç†æœºåˆ¶</h3><p>Android ä¸­çš„å¼‚æ­¥æ¶ˆæ¯å¤„ç†ä¸»è¦ç”± 4 ä¸ªéƒ¨åˆ†ç»„æˆï¼šMessageã€Handlerã€MessageQueue å’Œ Looperã€‚</p><ul><li><p>Message</p><p>Message æ˜¯åœ¨çº¿ç¨‹ä¹‹é—´ä¼ é€’çš„æ¶ˆæ¯ï¼Œå®ƒå¯ä»¥åœ¨å†…éƒ¨æºå¸¦å°‘é‡çš„æ¶ˆæ¯ï¼Œç”¨äºåœ¨ä¸åŒçº¿ç¨‹ä¹‹é—´ä¼ é€’æ•°æ®ã€‚</p></li><li><p>Handler</p><p>Handler ä¸»è¦æ˜¯ç”¨äºå‘é€å’Œå¤„ç†æ¶ˆæ¯çš„ï¼Œå‘å‡ºçš„æ¶ˆæ¯ç»è¿‡ä¸€ç³»åˆ—åœ°è¾—è½¬å¤„ç†åï¼Œæœ€ç»ˆä¼šä¼ é€’åˆ° Handler çš„ handleMessage () æ–¹æ³•ä¸­</p></li><li><p>MessageQueue</p><p>MessageQueue æ˜¯æ¶ˆæ¯é˜Ÿåˆ—çš„æ„æ€ï¼Œå®ƒä¸»è¦ç”¨äºå­˜æ”¾æ‰€æœ‰é€šè¿‡ Handler å‘é€çš„æ¶ˆæ¯ã€‚è¿™éƒ¨åˆ†æ¶ˆæ¯ä¼šä¸€ç›´å­˜åœ¨äºæ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…è¢«å¤„ç†ã€‚æ¯ä¸ªçº¿ç¨‹ä¸­åªæœ‰ä¸€ä¸ª MessageQueue å¯¹è±¡ã€‚</p></li><li><p>Looper</p><p>Looper æ˜¯æ¯ä¸ªçº¿ç¨‹ä¸­çš„ MessageQueue çš„ç®¡å®¶ï¼Œè°ƒç”¨ Looper çš„ loop () æ–¹æ³•åï¼Œå°±ä¼šè¿›å…¥ä¸€ä¸ªæ— é™å¾ªç¯å½“ä¸­ï¼Œç„¶åæ¯å½“å‘ç° MessageQueue ä¸­å­˜åœ¨ä¸€æ¡æ¶ˆæ¯æ—¶ï¼Œå°±ä¼šå°†å®ƒå–å‡ºï¼Œå¹¶ä¼ é€’åˆ° Handler çš„ handleMessage () æ–¹æ³•ä¸­ã€‚æ¯ä¸ªçº¿ç¨‹ä¸­åªä¼šæœ‰ä¸€ä¸ª Looper å¯¹è±¡</p></li></ul><h4 id="å¼‚æ­¥æ¶ˆæ¯å¤„ç†æµç¨‹"><a href="#å¼‚æ­¥æ¶ˆæ¯å¤„ç†æµç¨‹" class="headerlink" title="å¼‚æ­¥æ¶ˆæ¯å¤„ç†æµç¨‹"></a>å¼‚æ­¥æ¶ˆæ¯å¤„ç†æµç¨‹</h4><p>é¦–å…ˆéœ€è¦åœ¨ä¸»çº¿ç¨‹å½“ä¸­åˆ›å»ºä¸€ä¸ª Handler å¯¹è±¡ï¼Œå¹¶é‡å†™ handleMessage () æ–¹æ³•ã€‚ç„¶åå½“å­çº¿ç¨‹ä¸­å›½éœ€è¦è¿›è¡Œ UI æ“ä½œæ—¶ï¼Œå°±åˆ›å»ºä¸€ä¸ª Message å¯¹è±¡ï¼Œå¹¶é€šè¿‡ Handler å°†è¿™æ¡æ¶ˆæ¯å‘é€å‡ºå»ã€‚ä¹‹åè¿™æ¡æ¶ˆæ¯å°±ä¼šè¢«æ·»åŠ åˆ° MessageQueue çš„é˜Ÿåˆ—ä¸­ç­‰å¾…è¢«å¤„ç†ï¼Œè€Œ Looper åˆ™ä¼šä¸€ç›´å°è¯•ä» MessageQueue ä¸­å–å‡ºå¾…å¤„ç†æ¶ˆæ¯ï¼Œæœ€ååˆ†å‘å› Handler çš„ handleMessage () æ–¹æ³•ä¸­ã€‚ç”±äº Handle çš„æ„é€ å‡½æ•°ä¸­æˆ‘ä»¬ä¼ å…¥äº† Looper.getMainLooper ()ï¼Œæ‰€ä»¥æ­¤æ—¶ handleMessage () æ–¹æ³•ä¸­çš„ä»£ç ä¹Ÿä¼šåœ¨ä¸»çº¿ç¨‹ä¸­è¿è¡Œ</p><h3 id="ä½¿ç”¨-AsyncTask"><a href="#ä½¿ç”¨-AsyncTask" class="headerlink" title="ä½¿ç”¨ AsyncTask"></a>ä½¿ç”¨ AsyncTask</h3><p>é¦–å…ˆæ¥çœ‹ä¸€ä¸‹ AsyncTask çš„åŸºæœ¬ç”¨æ³•ã€‚ç”±äº AsyncTask æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬æƒ³ä½¿ç”¨ å®ƒï¼Œå°±å¿…é¡»åˆ›å»ºä¸€ä¸ªå­ç±»å»ç»§æ‰¿å®ƒã€‚åœ¨ç»§æ‰¿æ—¶æˆ‘ä»¬å¯ä»¥ä¸º AsyncTask ç±»æŒ‡å®š 3 ä¸ªæ³›å‹å‚æ•°ï¼Œè¿™ 3 ä¸ªå‚æ•°çš„ç”¨é€”å¦‚ä¸‹ã€‚</p><ul><li>Paramsã€‚åœ¨æ‰§è¡Œ AsyncTask æ—¶éœ€è¦ä¼ å…¥çš„å‚æ•°ï¼Œå¯ç”¨äºåœ¨åå°ä»»åŠ¡ä¸­ä½¿ç”¨ã€‚</li><li>Progressã€‚åœ¨åå°ä»»åŠ¡æ‰§è¡Œæ—¶ï¼Œå¦‚æœéœ€è¦åœ¨ç•Œé¢ä¸Šæ˜¾ç¤ºå½“å‰çš„è¿›åº¦ï¼Œåˆ™ä½¿ç”¨è¿™é‡ŒæŒ‡å®šçš„æ³›å‹ä½œä¸ºå•ä½è¿›åº¦</li><li>Resultã€‚å½“ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œå¦‚æœéœ€è¦å¯¹ç»“æœè¿›è¡Œè¿”å›ï¼Œåˆ™ä½¿ç”¨è¿™é‡ŒæŒ‡å®šçš„æ³›å‹ä½œä¸ºè¿”å›å€¼ç±»å‹</li></ul><p>å› æ­¤ï¼Œä¸€ä¸ªæœ€ç®€å•çš„è‡ªå®šä¹‰ AsyncTask å°±å¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">class DownloadTask : AsyncTask&lt;Unit, Int, Boolean&gt;() &#123; </span><br><span class="line"> ... </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬æŠŠ AsyncTask çš„ç¬¬ä¸€ä¸ªæ³›å‹å‚æ•°æŒ‡å®šä¸º Unitï¼Œè¡¨ç¤ºåœ¨æ‰§è¡Œ AsyncTask çš„æ—¶å€™ä¸éœ€è¦ä¼  å…¥å‚æ•°ç»™åå°ä»»åŠ¡ã€‚ç¬¬äºŒä¸ªæ³›å‹å‚æ•°æŒ‡å®šä¸º Intï¼Œè¡¨ç¤ºä½¿ç”¨æ•´å‹æ•°æ®æ¥ä½œä¸ºè¿›åº¦æ˜¾ç¤ºå•ä½ã€‚ç¬¬ä¸‰ ä¸ªæ³›å‹å‚æ•°æŒ‡å®šä¸º Booleanï¼Œåˆ™è¡¨ç¤ºä½¿ç”¨å¸ƒå°”å‹æ•°æ®æ¥åé¦ˆæ‰§è¡Œç»“æœã€‚</p><p>å½“ç„¶ï¼Œç›®å‰æˆ‘ä»¬è‡ªå®šä¹‰çš„ DownloadTask è¿˜æ˜¯ä¸€ä¸ªç©ºä»»åŠ¡ï¼Œå¹¶ä¸èƒ½è¿›è¡Œä»»ä½•å®é™…çš„æ“ä½œï¼Œæˆ‘ä»¬ è¿˜éœ€è¦é‡å†™ AsyncTask ä¸­çš„å‡ ä¸ªæ–¹æ³•æ‰èƒ½å®Œæˆå¯¹ä»»åŠ¡çš„å®šåˆ¶ã€‚ç»å¸¸éœ€è¦é‡å†™çš„æ–¹æ³•æœ‰ä»¥ä¸‹ 4 ä¸ªã€‚</p><ul><li><p>onPreExecute()</p><p>è¿™ä¸ªæ–¹æ³•å›åœ¨åå°ä»»åŠ¡å¼€å§‹æ‰§è¡Œä¹‹å‰è°ƒç”¨ï¼Œç”¨äºè¿›è¡Œä¸€äº›ç•Œé¢ä¸Šçš„åˆå§‹åŒ–æ“ä½œï¼Œæ¯”å¦‚æ˜¾ç¤ºä¸€ä¸ªè¿›åº¦æ¡å¯¹è¯æ¡†ç­‰</p></li><li><p>doInBackground(Paramsâ€¦)</p><p>è¿™ä¸ªæ–¹æ³•ä¸­çš„æ‰€æœ‰ä»£ç éƒ½ä¼šåœ¨å­çº¿ç¨‹ä¸­è¿è¡Œï¼Œæˆ‘ä»¬åº”è¯¥åœ¨è¿™é‡Œå»å¤„ç†æ‰€æœ‰çš„è€—æ—¶ä»»åŠ¡ã€‚ä»»åŠ¡ä¸€æ—¦å®Œæˆï¼Œå°±å¯ä»¥é€šè¿‡ return è¯­å¥å°†ä»»åŠ¡çš„æ‰§è¡Œç»“æœè¿”å›ï¼Œå¦‚æœ AsyncTask çš„ç¬¬ä¸‰ä¸ªæ³›å‹å‚æ•°æŒ‡å®šçš„æ˜¯ Unitï¼Œå°±å¯ä»¥ä¸è¿”å›ä»»åŠ¡æ‰§è¡Œçš„ç»“æœæ³¨æ„ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•ä¸­æ˜¯ä¸å¯ä»¥è¿›è¡Œ UI æ“ä½œçš„ï¼Œå¦‚æœéœ€è¦æ›´æ–° UI å…ƒç´ ï¼Œæ¯”å¦‚è¯´åé¦ˆå½“å‰ä»»åŠ¡çš„æ‰§è¡Œè¿›åº¦ï¼Œå¯ä»¥è°ƒç”¨ publishProgress (Progressâ€¦) æ–¹æ³•æ¥å®Œæˆã€‚</p></li><li><p>onProgressUpdate(Progressâ€¦)</p><p>å½“åœ¨åå°ä»»åŠ¡ä¸­è°ƒç”¨äº† publishProgress (Progressâ€¦) æ–¹æ³•åï¼Œ onProgressUpdate (Progressâ€¦) æ–¹æ³•å°±ä¼šå¾ˆå¿«è¢«è°ƒç”¨ï¼Œè¯¥æ–¹æ³•ä¸­æºå¸¦çš„å‚æ•°å°±æ˜¯ åœ¨åå°ä»»åŠ¡ä¸­ä¼ é€’è¿‡æ¥çš„ã€‚åœ¨è¿™ä¸ªæ–¹æ³•ä¸­å¯ä»¥å¯¹ UI è¿›è¡Œæ“ä½œï¼Œåˆ©ç”¨å‚æ•°ä¸­çš„æ•°å€¼å°±å¯ä»¥å¯¹ ç•Œé¢å…ƒç´ è¿›è¡Œç›¸åº”çš„æ›´æ–°ã€‚</p></li><li><p>onPostExecute(Result)</p><p>å½“åå°ä»»åŠ¡æ‰§è¡Œå®Œæ¯•å¹¶é€šè¿‡ return è¯­å¥è¿›è¡Œè¿”å›æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•å°±å¾ˆå¿«ä¼šè¢«è°ƒç”¨ã€‚è¿”å›çš„æ•° æ®ä¼šä½œä¸ºå‚æ•°ä¼ é€’åˆ°æ­¤æ–¹æ³•ä¸­ï¼Œå¯ä»¥åˆ©ç”¨è¿”å›çš„æ•°æ®è¿›è¡Œä¸€äº› UI æ“ä½œï¼Œæ¯”å¦‚è¯´æé†’ä»»åŠ¡æ‰§ è¡Œçš„ç»“æœï¼Œä»¥åŠå…³é—­è¿›åº¦æ¡å¯¹è¯æ¡†ç­‰ã€‚</p></li></ul><h2 id="Service-çš„åŸºæœ¬ç”¨æ³•"><a href="#Service-çš„åŸºæœ¬ç”¨æ³•" class="headerlink" title="Service çš„åŸºæœ¬ç”¨æ³•"></a>Service çš„åŸºæœ¬ç”¨æ³•</h2><h3 id="å®šä¹‰ä¸€ä¸ª-Service"><a href="#å®šä¹‰ä¸€ä¸ª-Service" class="headerlink" title="å®šä¹‰ä¸€ä¸ª Service"></a>å®šä¹‰ä¸€ä¸ª Service</h3><p>é¦–å…ˆçœ‹ä¸€ä¸‹å¦‚ä½•åœ¨é¡¹ç›®ä¸­å®šä¹‰ä¸€ä¸ª Serviceã€‚æ–°å»ºä¸€ä¸ª ServiceTest é¡¹ç›®ï¼Œç„¶åå³å‡» com.example.servicetestâ†’Newâ†’Serviceâ†’Serviceï¼Œ</p><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œæˆ‘ä»¬å°†ç±»åå®šä¹‰æˆ MyServiceï¼ŒExported å±æ€§è¡¨ç¤ºæ˜¯å¦å°†è¿™ä¸ª Service æš´éœ²ç»™ å¤–éƒ¨å…¶ä»–ç¨‹åºè®¿é—®ï¼ŒEnabled å±æ€§è¡¨ç¤ºæ˜¯å¦å¯ç”¨è¿™ä¸ª Serviceã€‚å°†ä¸¤ä¸ªå±æ€§éƒ½å‹¾ä¸­ï¼Œç‚¹ å‡» â€œFinishâ€ å®Œæˆåˆ›å»ºã€‚</p><p>ç°åœ¨è§‚å¯Ÿ MyService ä¸­çš„ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class MyService : Service() &#123; </span><br><span class="line"> </span><br><span class="line"> override fun onBind(intent: Intent): IBinder &#123; </span><br><span class="line">     TODO(&quot;Return the communication channel to the service.&quot;) </span><br><span class="line">     &#125; </span><br><span class="line"> </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼ŒMyService æ˜¯ç»§æ‰¿è‡ªç³»ç»Ÿçš„ Service ç±»çš„ã€‚ç›®å‰ MyService ä¸­å¯ä»¥ç®—æ˜¯ç©ºç©ºå¦‚ä¹Ÿï¼Œ ä½†æœ‰ä¸€ä¸ª onBind () æ–¹æ³•ç‰¹åˆ«é†’ç›®ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯ Service ä¸­å”¯ä¸€çš„æŠ½è±¡æ–¹æ³•ï¼Œæ‰€ä»¥å¿…é¡»åœ¨å­ç±»é‡Œ å®ç°ã€‚æˆ‘ä»¬ä¼šåœ¨åé¢çš„å°èŠ‚ä¸­ä½¿ç”¨åˆ° onBind () æ–¹æ³•ï¼Œç›®å‰å¯ä»¥æš‚æ—¶å°†å®ƒå¿½ç•¥ã€‚ æ—¢ç„¶æ˜¯å®šä¹‰ä¸€ä¸ª Serviceï¼Œè‡ªç„¶åº”è¯¥åœ¨ Service ä¸­å¤„ç†ä¸€äº›äº‹æƒ…äº†ï¼Œé‚£å¤„ç†äº‹æƒ…çš„é€»è¾‘åº”è¯¥å†™åœ¨ å“ªé‡Œå‘¢ï¼Ÿè¿™æ—¶å°±å¯ä»¥é‡å†™ Service ä¸­çš„å¦å¤–ä¸€äº›æ–¹æ³•äº†ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">class MyService : Service() &#123; </span><br><span class="line"> ... </span><br><span class="line"> override fun onCreate() &#123; </span><br><span class="line"> super.onCreate() </span><br><span class="line"> &#125; </span><br><span class="line"> </span><br><span class="line"> override fun onStartCommand(intent: Intent, flags: Int, startId: Int): Int &#123; </span><br><span class="line"> return super.onStartCommand(intent, flags, startId) </span><br><span class="line"> &#125; </span><br><span class="line"> </span><br><span class="line"> override fun onDestroy() &#123; </span><br><span class="line"> super.onDestroy() </span><br><span class="line"> &#125; </span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œæˆ‘ä»¬åˆé‡å†™äº† onCreate ()ã€onStartCommand () å’Œ onDestroy () è¿™ 3 ä¸ªæ–¹ æ³•ï¼Œå®ƒä»¬æ˜¯æ¯ä¸ª Service ä¸­æœ€å¸¸ç”¨åˆ°çš„ 3 ä¸ªæ–¹æ³•äº†ã€‚å…¶ä¸­ onCreate () æ–¹æ³•ä¼šåœ¨ Service åˆ›å»ºçš„ æ—¶å€™è°ƒç”¨ï¼ŒonStartCommand () æ–¹æ³•ä¼šåœ¨æ¯æ¬¡ Service å¯åŠ¨çš„æ—¶å€™è°ƒç”¨ï¼ŒonDestroy () æ–¹æ³• ä¼šåœ¨ Service é”€æ¯çš„æ—¶å€™è°ƒç”¨ã€‚</p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ› Service ä¸€æ—¦å¯åŠ¨å°±ç«‹åˆ»å»æ‰§è¡ŒæŸä¸ªåŠ¨ä½œï¼Œå°±å¯ä»¥å°†é€»è¾‘å†™åœ¨ onStartCommand () æ–¹æ³•é‡Œã€‚è€Œå½“ Service é”€æ¯æ—¶ï¼Œæˆ‘ä»¬åˆåº”è¯¥åœ¨ onDestroy () æ–¹æ³•ä¸­å›æ”¶ é‚£äº›ä¸å†ä½¿ç”¨çš„èµ„æºã€‚</p><h3 id="å¯åŠ¨å’Œåœæ­¢-Service"><a href="#å¯åŠ¨å’Œåœæ­¢-Service" class="headerlink" title="å¯åŠ¨å’Œåœæ­¢ Service"></a>å¯åŠ¨å’Œåœæ­¢ Service</h3><p>å®šä¹‰å¥½äº† Service ä¹‹åï¼Œæ¥ä¸‹æ¥å°±åº”è¯¥è€ƒè™‘å¦‚ä½•å¯åŠ¨ä»¥åŠåœæ­¢è¿™ä¸ª Serviceã€‚å¯åŠ¨å’Œåœæ­¢çš„æ–¹æ³• å½“ç„¶ä½ ä¹Ÿä¸ä¼šé™Œç”Ÿï¼Œä¸»è¦æ˜¯å€ŸåŠ© Intent æ¥å®ç°çš„ã€‚ä¸‹é¢å°±è®©æˆ‘ä»¬åœ¨ ServiceTest é¡¹ç›®ä¸­å°è¯•å¯åŠ¨ ä»¥åŠåœæ­¢ MyServiceã€‚</p><p>ä¿®æ”¹ MainActivity ä¸­çš„ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">class MainActivity : AppCompatActivity()&#123;</span><br><span class="line">    override fun onCreate(savedInstanceState : Bundle?)&#123;</span><br><span class="line">        super.onCreate(savedInstanceState)</span><br><span class="line">        val binding = ActivityMainBinding.inflate(layoutInflater)</span><br><span class="line">        setContentView(binding.root)</span><br><span class="line">        val startServiceBtn = binding.startServiceBtn</span><br><span class="line">        val stopServiceBtn = binding.stopServiceBtn</span><br><span class="line">        startServiceBtn.setOnClickListener&#123;</span><br><span class="line">            val intent = Intent(this,MyService::class.java)</span><br><span class="line">            startService(intent)</span><br><span class="line">        &#125;</span><br><span class="line">        stioServiceBtn.setOnCLickListener&#123;</span><br><span class="line">            val intent = Intent(this,Myservice::class.java)</span><br><span class="line">            stopService(intent)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="OnCreate-æ–¹æ³•å’Œ-onStartCommand-æ–¹æ³•åŒºåˆ«"><a href="#OnCreate-æ–¹æ³•å’Œ-onStartCommand-æ–¹æ³•åŒºåˆ«" class="headerlink" title="OnCreate () æ–¹æ³•å’Œ onStartCommand () æ–¹æ³•åŒºåˆ«"></a>OnCreate () æ–¹æ³•å’Œ onStartCommand () æ–¹æ³•åŒºåˆ«</h4><p>onCreate () æ–¹æ³•æ˜¯åœ¨ Service ç¬¬ä¸€æ¬¡åˆ›å»ºçš„æ—¶å€™è°ƒç”¨çš„ï¼Œè€Œ onStartCommand () æ–¹æ³•åˆ™ åœ¨æ¯æ¬¡å¯åŠ¨ Service çš„æ—¶å€™éƒ½ä¼šè°ƒç”¨ã€‚ç”±äºåˆšæ‰æˆ‘ä»¬æ˜¯ç¬¬ä¸€æ¬¡ç‚¹å‡» â€œStart Serviceâ€ æŒ‰é’®ï¼Œ Service æ­¤æ—¶è¿˜æœªåˆ›å»ºè¿‡ï¼Œæ‰€ä»¥ä¸¤ä¸ªæ–¹æ³•éƒ½ä¼šæ‰§è¡Œï¼Œä¹‹åå¦‚æœä½ å†è¿ç»­å¤šç‚¹å‡»å‡ æ¬¡ â€œStart Serviceâ€ æŒ‰é’®ï¼Œä½ å°±ä¼šå‘ç°åªæœ‰ onStartCommand () æ–¹æ³•å¯ä»¥å¾—åˆ°æ‰§è¡Œäº†ã€‚</p><h3 id="Activity-å’Œ-Service-è¿›è¡Œé€šä¿¡"><a href="#Activity-å’Œ-Service-è¿›è¡Œé€šä¿¡" class="headerlink" title="Activity å’Œ Service è¿›è¡Œé€šä¿¡"></a>Activity å’Œ Service è¿›è¡Œé€šä¿¡</h3><p>ä½¿ç”¨ onBind () æ–¹æ³•</p><p>æ¯”å¦‚è¯´ï¼Œç›®å‰æˆ‘ä»¬å¸Œæœ›åœ¨ MyService é‡Œæä¾›ä¸€ä¸ªä¸‹è½½åŠŸèƒ½ï¼Œç„¶ååœ¨ Activity ä¸­å¯ä»¥å†³å®šä½•æ—¶å¼€å§‹ ä¸‹è½½ï¼Œä»¥åŠéšæ—¶æŸ¥çœ‹ä¸‹è½½è¿›åº¦ã€‚å®ç°è¿™ä¸ªåŠŸèƒ½çš„æ€è·¯æ˜¯åˆ›å»ºä¸€ä¸ªä¸“é—¨çš„ Binder å¯¹è±¡æ¥å¯¹ä¸‹è½½åŠŸ èƒ½è¿›è¡Œç®¡ç†ã€‚ä¿®æ”¹ MyService ä¸­çš„ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">class MyService : Service() &#123;</span><br><span class="line">    private val mBinder = DownloadBinder()</span><br><span class="line">    </span><br><span class="line">    class DownloadBinder : Binder()&#123;</span><br><span class="line">        </span><br><span class="line">        fun startDownload()&#123;</span><br><span class="line">            Log.d(&quot;MyService&quot;,&quot;startDownload executed&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        fun getProgress() : Int &#123;</span><br><span class="line">            Log.d(&quot;MyService&quot;,&quot;getProgress executed&quot;)</span><br><span class="line">            return 0</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    override fun onBind(intent:Intent) : IBinder&#123;</span><br><span class="line">        return mBinder</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œæˆ‘ä»¬æ–°å»ºäº†ä¸€ä¸ª DownloadBinder ç±»ï¼Œå¹¶è®©å®ƒç»§æ‰¿è‡ª Binderï¼Œç„¶ååœ¨å®ƒçš„å†… éƒ¨æä¾›äº†å¼€å§‹ä¸‹è½½ä»¥åŠæŸ¥çœ‹ä¸‹è½½è¿›åº¦çš„æ–¹æ³•ã€‚å½“ç„¶è¿™åªæ˜¯ä¸¤ä¸ªæ¨¡æ‹Ÿæ–¹æ³•ï¼Œå¹¶æ²¡æœ‰å®ç°çœŸæ­£çš„åŠŸ èƒ½ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸¤ä¸ªæ–¹æ³•ä¸­åˆ†åˆ«æ‰“å°äº†ä¸€è¡Œæ—¥å¿—ã€‚</p><p>æ¥ç€ï¼Œåœ¨ MyService ä¸­åˆ›å»ºäº† DownloadBinder çš„å®ä¾‹ï¼Œç„¶ååœ¨ onBind () æ–¹æ³•é‡Œè¿”å›äº†è¿™ä¸ª å®ä¾‹ï¼Œè¿™æ · MyService ä¸­çš„å·¥ä½œå°±å…¨éƒ¨å®Œæˆäº†ã€‚</p><p>ä¸‹é¢å°±è¦çœ‹ä¸€çœ‹åœ¨ Activity ä¸­å¦‚ä½•è°ƒç”¨ Service é‡Œçš„è¿™äº›æ–¹æ³•äº†ã€‚é¦–å…ˆéœ€è¦åœ¨å¸ƒå±€æ–‡ä»¶é‡Œæ–°å¢ä¸¤ ä¸ªæŒ‰é’®ï¼Œä¿®æ”¹ activity_main.xml ä¸­çš„ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; </span><br><span class="line">     android:orientation=&quot;vertical&quot; </span><br><span class="line">     android:layout_width=&quot;match_parent&quot; </span><br><span class="line">     android:layout_height=&quot;match_parent&quot;&gt; </span><br><span class="line"></span><br><span class="line">         ... </span><br><span class="line"></span><br><span class="line">             &lt;Button </span><br><span class="line">                 android:id=&quot;@+id/bindServiceBtn&quot; </span><br><span class="line">                 android:layout_width=&quot;match_parent&quot; </span><br><span class="line">                 android:layout_height=&quot;wrap_content&quot; </span><br><span class="line">                 android:text=&quot;Bind Service&quot; /&gt; </span><br><span class="line"></span><br><span class="line">             &lt;Button </span><br><span class="line">                 android:id=&quot;@+id/unbindServiceBtn&quot; </span><br><span class="line">                 android:layout_width=&quot;match_parent&quot; </span><br><span class="line">                 android:layout_height=&quot;wrap_content&quot; </span><br><span class="line">                 android:text=&quot;Unbind Service&quot; /&gt; </span><br><span class="line"></span><br><span class="line">&lt;/LinearLayout&gt;</span><br></pre></td></tr></table></figure><p>è¿™ä¸¤ä¸ªæŒ‰é’®åˆ†åˆ«æ˜¯ç”¨äºç»‘å®šå’Œå–æ¶ˆç»‘å®š Service çš„ï¼Œé‚£åˆ°åº•è°éœ€è¦å’Œ Service ç»‘å®šå‘¢ï¼Ÿå½“ç„¶å°±æ˜¯ Activity äº†ã€‚å½“ä¸€ä¸ª Activity å’Œ Service ç»‘å®šäº†ä¹‹åï¼Œå°±å¯ä»¥è°ƒç”¨è¯¥ Service é‡Œçš„ Binder æä¾›çš„ æ–¹æ³•äº†ã€‚ä¿®æ”¹ MainActivity ä¸­çš„ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">class MainActivity : AppCompatActivity()&#123;</span><br><span class="line">    lateinit var downloadBinder : MyService.DownloadBinder</span><br><span class="line">    </span><br><span class="line">    private val connection = object : ServiceConnection&#123;</span><br><span class="line">        override fun onServiceConnected(name:ComponentName,service:IBinder)&#123;</span><br><span class="line">            downloadBinder = service as MyService.DownloadBinder</span><br><span class="line">            downloadBinder.startDownload()</span><br><span class="line">            downloadBinder.getProgress()</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        override fun onServiceDisconnected(name : ComponentName)&#123;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    override fun onCreate(savedInstanceState: Bundle?)&#123;</span><br><span class="line">        ã€ã€ã€</span><br><span class="line">        bindServiceBtn.setOnClickListener&#123;</span><br><span class="line">            val intent = Intent(this, MyService::class.java)</span><br><span class="line">            bindService(intent,connection,Context.BIND_AUTO_CREATE)</span><br><span class="line">        &#125;</span><br><span class="line">        unbindServiceBtn.setOnClickListener&#123;</span><br><span class="line">            unbindService(connection)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Service-çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#Service-çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Service çš„ç”Ÿå‘½å‘¨æœŸ"></a>Service çš„ç”Ÿå‘½å‘¨æœŸ</h2><p>ä¸€æ—¦åœ¨é¡¹ç›®çš„ä»»ä½•ä½ç½®è°ƒç”¨äº† Context çš„ startService() æ–¹æ³•ï¼Œç›¸åº”çš„ Service å°±ä¼šå¯åŠ¨ï¼Œ å¹¶å›è°ƒ onStartCommand () æ–¹æ³•ã€‚å¦‚æœè¿™ä¸ª Service ä¹‹å‰è¿˜æ²¡æœ‰åˆ›å»ºè¿‡ï¼ŒonCreate () æ–¹æ³•ä¼š å…ˆäº onStartCommand () æ–¹æ³•æ‰§è¡Œã€‚Service å¯åŠ¨äº†ä¹‹åä¼šä¸€ç›´ä¿æŒè¿è¡ŒçŠ¶æ€ï¼Œç›´åˆ° stopService() æˆ– stopSelf () æ–¹æ³•è¢«è°ƒç”¨ï¼Œæˆ–è€…è¢«ç³»ç»Ÿå›æ”¶ã€‚æ³¨æ„ï¼Œè™½ç„¶æ¯è°ƒç”¨ä¸€æ¬¡ startService() æ–¹æ³•ï¼ŒonStartCommand () å°±ä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œä½†å®é™…ä¸Šæ¯ä¸ª Service åªä¼šå­˜åœ¨ ä¸€ä¸ªå®ä¾‹ã€‚æ‰€ä»¥ä¸ç®¡ä½ è°ƒç”¨äº†å¤šå°‘æ¬¡ startService() æ–¹æ³•ï¼Œåªéœ€è°ƒç”¨ä¸€æ¬¡ stopService() æˆ– stopSelf () æ–¹æ³•ï¼ŒService å°±ä¼šåœæ­¢ã€‚ å¦å¤–ï¼Œè¿˜å¯ä»¥è°ƒç”¨ Context çš„ bindService() æ¥è·å–ä¸€ä¸ª Service çš„æŒä¹…è¿æ¥ï¼Œè¿™æ—¶å°±ä¼šå›è°ƒ Service ä¸­çš„ onBind () æ–¹æ³•ã€‚ç±»ä¼¼åœ°ï¼Œå¦‚æœè¿™ä¸ª Service ä¹‹å‰è¿˜æ²¡æœ‰åˆ›å»ºè¿‡ï¼ŒonCreate () æ–¹ æ³•ä¼šå…ˆäº onBind () æ–¹æ³•æ‰§è¡Œã€‚ä¹‹åï¼Œè°ƒç”¨æ–¹å¯ä»¥è·å–åˆ° onBind () æ–¹æ³•é‡Œè¿”å›çš„ IBinder å¯¹è±¡ çš„å®ä¾‹ï¼Œè¿™æ ·å°±èƒ½è‡ªç”±åœ°å’Œ Service è¿›è¡Œé€šä¿¡äº†ã€‚åªè¦è°ƒç”¨æ–¹å’Œ Service ä¹‹é—´çš„è¿æ¥æ²¡æœ‰æ–­å¼€ï¼Œ Service å°±ä¼šä¸€ç›´ä¿æŒè¿è¡ŒçŠ¶æ€ï¼Œç›´åˆ°è¢«ç³»ç»Ÿå›æ”¶ã€‚ å½“è°ƒç”¨äº† startService() æ–¹æ³•åï¼Œå†å»è°ƒç”¨ stopService() æ–¹æ³•ã€‚è¿™æ—¶ Service ä¸­çš„ onDestroy () æ–¹æ³•å°±ä¼šæ‰§è¡Œï¼Œè¡¨ç¤º Service å·²ç»é”€æ¯äº†ã€‚ç±»ä¼¼åœ°ï¼Œå½“è°ƒç”¨äº† bindService() æ–¹æ³•åï¼Œå†å»è°ƒç”¨ unbindService() æ–¹æ³•ï¼ŒonDestroy () æ–¹æ³•ä¹Ÿä¼šæ‰§è¡Œï¼Œè¿™ä¸¤ç§æƒ…å†µéƒ½å¾ˆå¥½ ç†è§£ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„ï¼Œæˆ‘ä»¬æ˜¯å®Œå…¨æœ‰å¯èƒ½å¯¹ä¸€ä¸ª Service æ—¢è°ƒç”¨äº† startService() æ–¹æ³•ï¼Œåˆ è°ƒç”¨äº† bindService() æ–¹æ³•çš„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹è¯¥å¦‚ä½•è®© Service é”€æ¯å‘¢ï¼Ÿæ ¹æ® Android ç³»ç»Ÿçš„ æœºåˆ¶ï¼Œä¸€ä¸ª Service åªè¦è¢«å¯åŠ¨æˆ–è€…è¢«ç»‘å®šäº†ä¹‹åï¼Œå°±ä¼šå¤„äºè¿è¡ŒçŠ¶æ€ï¼Œå¿…é¡»è¦è®©ä»¥ä¸Šä¸¤ç§æ¡ä»¶ åŒæ—¶ä¸æ»¡è¶³ï¼ŒService æ‰èƒ½è¢«é”€æ¯ã€‚æ‰€ä»¥ï¼Œè¿™ç§æƒ…å†µä¸‹è¦åŒæ—¶è°ƒç”¨ stopService() å’Œ unbindService() æ–¹æ³•ï¼ŒonDestroy () æ–¹æ³•æ‰ä¼šæ‰§è¡Œã€‚ è¿™æ ·ä½ å°±æŠŠ Service çš„ç”Ÿå‘½å‘¨æœŸå®Œæ•´åœ°èµ°äº†ä¸€éã€‚</p><h2 id="Service-çš„æ›´å¤šæŠ€å·§"><a href="#Service-çš„æ›´å¤šæŠ€å·§" class="headerlink" title="Service çš„æ›´å¤šæŠ€å·§"></a>Service çš„æ›´å¤šæŠ€å·§</h2><h3 id="ä½¿ç”¨å‰å°-Service"><a href="#ä½¿ç”¨å‰å°-Service" class="headerlink" title="ä½¿ç”¨å‰å° Service"></a>ä½¿ç”¨å‰å° Service</h3><p>ä¿®æ”¹ MyService ä¸­çš„ä»£ ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">class MyService : Service()&#123;</span><br><span class="line">    ã€ã€ã€</span><br><span class="line">    override fun onCreate()&#123;</span><br><span class="line">        super.onCreate()</span><br><span class="line">        Log.d(&quot;MyService&quot;,&quot;onCreate executed&quot;)</span><br><span class="line">        val manager = getSystemService(Context.NOTIFICATION_SERVICE) as NotificationManager</span><br><span class="line">        if(Build.VERSION.SDK_INT &gt;= Build&gt;VERSION_CODES.0)&#123;</span><br><span class="line">            val channel = NotoficationManager(&quot;my_service&quot;,&quot;å‰å°Serviceé€šçŸ¥&quot;,NotificationManager.IMPORTANCE_DEFAULT)</span><br><span class="line">            manager.createNotificationChannel(channel)</span><br><span class="line">        &#125;</span><br><span class="line">        val intent = Intent(this, MainActivity::class.java)</span><br><span class="line">        val pi = PendingIntent.getActivity(this,0,intent,0)</span><br><span class="line">        val notification = NotificationCompat.Builder(this,&quot;my_service&quot;)</span><br><span class="line">        .setContextTitle(&quot;This is content text&quot;)</span><br><span class="line">        .setSmallIcon(R.drawable.small_icon)</span><br><span class="line">        .setLargeIcon(BitmapFactory.decodeResource(resoruces,R.drabable.large_icon))</span><br><span class="line">        .setContentIntent(pi)</span><br><span class="line">        .build()</span><br><span class="line">        startForeground(1,notification)  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨ startForeground () æ–¹æ³•åå°±ä¼šè®© MyService å˜æˆä¸€ä¸ªå‰ å° Serviceï¼Œå¹¶åœ¨ç³»ç»ŸçŠ¶æ€æ æ˜¾ç¤ºå‡ºæ¥ã€‚</p><p>å¦å¤–ï¼Œä» Android 9.0 ç³»ç»Ÿå¼€å§‹ï¼Œä½¿ç”¨å‰å° Service å¿…é¡»åœ¨ AndroidManifest.xml æ–‡ä»¶ä¸­è¿›è¡Œæƒ é™å£°æ˜æ‰è¡Œï¼Œè€Œä¸”å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; </span><br><span class="line"> package=&quot;com.example.servicetest&quot;&gt; </span><br><span class="line">     &lt;uses-permission android:name=&quot;android.permission.FOREGROUND_SERVICE&quot; /&gt;æ·»åŠ è¿™ä¸ª</span><br><span class="line">     &lt;uses-permission android:name=&quot;android.permission.FOREGROUND_SERVICE_DATA_SYNC&quot;/&gt;/*æ·»åŠ è¿™ä¸ªï¼Œå¯¹åº”android:foregroundServiceType=&quot;dataSync&quot;æ‰€éœ€è¦çš„æƒé™*/</span><br><span class="line">         ... </span><br><span class="line">        &lt;service</span><br><span class="line">            android:name=&quot;.MyService&quot;</span><br><span class="line">            android:enabled=&quot;true&quot;</span><br><span class="line">            android:exported=&quot;false&quot;</span><br><span class="line">            android:foregroundServiceType=&quot;dataSync&quot;/&gt;/*æ·»åŠ è¿™ä¸ªå±æ€§ï¼Œå‰å°serviceä¸€å®šè¦çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯mediaPlaybackç­‰ï¼Œä½†è¦æ·»åŠ ç›¸åº”çš„æƒé™*/</span><br><span class="line">            ...</span><br><span class="line">&lt;/manifest&gt; </span><br></pre></td></tr></table></figure><p>ç°åœ¨å³ä½¿ä½ é€€å‡ºåº”ç”¨ç¨‹åºï¼ŒMyService ä¹Ÿä¼šä¸€ç›´å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œè€Œä¸”ä¸ç”¨æ‹…å¿ƒä¼šè¢«ç³»ç»Ÿå›æ”¶ã€‚ å½“ç„¶ï¼ŒMyService æ‰€å¯¹åº”çš„é€šçŸ¥ä¹Ÿä¼šä¸€ç›´æ˜¾ç¤ºåœ¨çŠ¶æ€æ ä¸Šé¢ã€‚å¦‚æœç”¨æˆ·ä¸å¸Œæœ›æˆ‘ä»¬çš„ç¨‹åºä¸€ç›´ è¿è¡Œï¼Œä¹Ÿå¯ä»¥é€‰æ‹©æ‰‹åŠ¨æ€æ‰åº”ç”¨ï¼Œè¿™æ · MyService å°±ä¼šè·Ÿç€ä¸€èµ·åœæ­¢è¿è¡Œäº†ã€‚</p><h3 id="ä½¿ç”¨-IntentService"><a href="#ä½¿ç”¨-IntentService" class="headerlink" title="ä½¿ç”¨ IntentService"></a>ä½¿ç”¨ IntentService</h3><p>Android ä¸“é—¨æä¾›äº†ä¸€ä¸ª IntentService ç±»ï¼Œè¿™ä¸ªç±»å°±å¾ˆå¥½åœ°è§£å†³äº†å‰é¢æ‰€æåˆ°çš„ä¸¤ç§å°´å°¬ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥çœ‹ä¸€ä¸‹å®ƒçš„ç”¨æ³•ã€‚</p><p>æ–°å»ºä¸€ä¸ª MyIntentService ç±»ç»§æ‰¿è‡ª IntentServiceï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">class MyIntentService : IntentService(&quot;MyIntentService&quot;)&#123;</span><br><span class="line">    override fun onHandleIntent(intent:Intent?)&#123;</span><br><span class="line">        //æ‰“å°å½“å‰çº¿ç¨‹çš„id</span><br><span class="line">        Log.d(&quot;MyIntentService&quot;, &quot;Thread id is $&#123;Thread.currentThread().name&#125;&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    override fun onDestroy()&#123;</span><br><span class="line">        super.onDestroy()</span><br><span class="line">        Log.d(&quot;MyIntentService&quot;,&quot;onDestroy executed&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ä¿®æ”¹ activity_main.xml ä¸­çš„ä»£ç ï¼ŒåŠ å…¥ä¸€ä¸ªç”¨äºå¯åŠ¨ MyIntentService çš„æŒ‰é’®ï¼Œå¦‚ä¸‹ æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; </span><br><span class="line"> android:orientation=&quot;vertical&quot; </span><br><span class="line"> android:layout_width=&quot;match_parent&quot; </span><br><span class="line"> android:layout_height=&quot;match_parent&quot;&gt; </span><br><span class="line"> </span><br><span class="line">     ... </span><br><span class="line"></span><br><span class="line">     &lt;Button </span><br><span class="line">         android:id=&quot;@+id/startIntentServiceBtn&quot; </span><br><span class="line">         android:layout_width=&quot;match_parent&quot; </span><br><span class="line">         android:layout_height=&quot;wrap_content&quot; </span><br><span class="line">         android:text=&quot;Start IntentService&quot; /&gt; </span><br><span class="line"></span><br><span class="line">&lt;/LinearLayout&gt; </span><br></pre></td></tr></table></figure><p>ç„¶åä¿®æ”¹ MainActivity ä¸­çš„ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">class MainActivity : AppCompatActivity()&#123;</span><br><span class="line">    ã€ã€ã€</span><br><span class="line">    override fun onCreate(savedInstanceState:Bundle?)&#123;</span><br><span class="line">        ã€ã€ã€</span><br><span class="line">        startIntentServiceBtn.setOnClickListener&#123;</span><br><span class="line">            //æ‰“å°ä¸»çº¿ç¨‹çš„id</span><br><span class="line">            Log.d(&quot;MainActivity&quot;,&quot;Thread id is $&#123;Thread.currentThread().name&#125;&quot;)</span><br><span class="line">            val intent = Intent(this,MyIntentService::class.java)</span><br><span class="line">            startService(intent)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åœ¨ â€œStart IntentServiceâ€ æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶é‡Œå¯åŠ¨äº† MyIntentServiceï¼Œå¹¶åœ¨è¿™ é‡Œæ‰“å°äº†ä¸€ä¸‹ä¸»çº¿ç¨‹åï¼Œç¨åç”¨äºå’Œ IntentService è¿›è¡Œæ¯”å¯¹ã€‚ä½ ä¼šå‘ç°ï¼Œå…¶å® IntentService çš„å¯åŠ¨æ–¹å¼å’Œæ™®é€šçš„ Service æ²¡ä»€ä¹ˆä¸¤æ ·</p><p>æœ€åä¸è¦å¿˜è®°ï¼ŒService éƒ½æ˜¯éœ€è¦åœ¨ AndroidManifest.xml é‡Œæ³¨å†Œçš„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ã€ã€ã€</span><br><span class="line">&lt;service</span><br><span class="line">         android:name=&quot;MyIntentService&quot;</span><br><span class="line">         android:enabled=&quot;true&quot;</span><br><span class="line">         android:exported=&quot;true&quot;</span><br><span class="line">         /&gt;</span><br><span class="line">ã€ã€ã€</span><br></pre></td></tr></table></figure><h2 id="Kotlin-è¯¾å ‚ï¼šæ³›å‹çš„é«˜çº§ç‰¹æ€§"><a href="#Kotlin-è¯¾å ‚ï¼šæ³›å‹çš„é«˜çº§ç‰¹æ€§" class="headerlink" title="Kotlin è¯¾å ‚ï¼šæ³›å‹çš„é«˜çº§ç‰¹æ€§"></a>Kotlin è¯¾å ‚ï¼šæ³›å‹çš„é«˜çº§ç‰¹æ€§</h2><h3 id="å¯¹æ³›å‹è¿›è¡Œå®åŒ–"><a href="#å¯¹æ³›å‹è¿›è¡Œå®åŒ–" class="headerlink" title="å¯¹æ³›å‹è¿›è¡Œå®åŒ–"></a>å¯¹æ³›å‹è¿›è¡Œå®åŒ–</h3><p>é‚£ä¹ˆå…·ä½“è¯¥æ€ä¹ˆå†™æ‰èƒ½å°†æ³›å‹å®åŒ–å‘¢ï¼Ÿé¦–å…ˆï¼Œè¯¥å‡½æ•°å¿…é¡»æ˜¯å†…è”å‡½æ•°æ‰è¡Œï¼Œä¹Ÿå°±æ˜¯è¦ç”¨ inline å…³é”®å­—æ¥ä¿®é¥°è¯¥å‡½æ•°ã€‚å…¶æ¬¡ï¼Œåœ¨å£°æ˜æ³›å‹çš„åœ°æ–¹å¿…é¡»åŠ ä¸Š reified å…³é”®å­—æ¥è¡¨ç¤ºè¯¥æ³›å‹è¦è¿›è¡Œ å®åŒ–ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">inline fun &lt;reified T&gt; getGenericType() &#123; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°å‡½æ•°ä¸­çš„æ³›å‹ T å°±æ˜¯ä¸€ä¸ªè¢«å®åŒ–çš„æ³›å‹ï¼Œå› ä¸ºå®ƒæ»¡è¶³äº†å†…è”å‡½æ•°å’Œ reified å…³é”®å­—è¿™ä¸¤ä¸ªå‰ ææ¡ä»¶ã€‚é‚£ä¹ˆå€ŸåŠ©æ³›å‹å®åŒ–ï¼Œåˆ°åº•å¯ä»¥å®ç°ä»€ä¹ˆæ ·çš„æ•ˆæœå‘¢ï¼Ÿä»å‡½æ•°åå°±å¯ä»¥çœ‹å‡ºæ¥äº†ï¼Œè¿™é‡Œ æˆ‘ä»¬å‡†å¤‡å®ç°ä¸€ä¸ªè·å–æ³›å‹å®é™…ç±»å‹çš„åŠŸèƒ½ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">inline fun &lt;reified T&gt; getGenericType() = T::class.java </span><br></pre></td></tr></table></figure><p>è™½ç„¶åªæœ‰ä¸€è¡Œä»£ç ï¼Œä½†æ˜¯è¿™é‡Œå´å®ç°äº†ä¸€ä¸ª Java ä¸­å®Œå…¨ä¸å¯èƒ½å®ç°çš„åŠŸèƒ½ï¼š getGenericType () å‡½æ•°ç›´æ¥è¿”å›äº†å½“å‰æŒ‡å®šæ³›å‹çš„å®é™…ç±»å‹ã€‚T.class è¿™æ ·çš„è¯­æ³•åœ¨ Java ä¸­æ˜¯ä¸åˆæ³•çš„ï¼Œè€Œåœ¨ Kotlin ä¸­ï¼Œå€ŸåŠ©æ³›å‹å®åŒ–åŠŸèƒ½å°±å¯ä»¥ä½¿ç”¨ T::class.java è¿™æ ·çš„è¯­æ³•äº†</p><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç å¯¹ getGenericType () å‡½æ•°è¿›è¡Œæµ‹è¯•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">fun main() &#123; </span><br><span class="line">     val result1 = getGenericType&lt;String&gt;() </span><br><span class="line">     val result2 = getGenericType&lt;Int&gt;() </span><br><span class="line">     println(&quot;result1 is $result1&quot;) </span><br><span class="line">     println(&quot;result2 is $result2&quot;) </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ³›å‹å®åŒ–çš„åº”ç”¨"><a href="#æ³›å‹å®åŒ–çš„åº”ç”¨" class="headerlink" title="æ³›å‹å®åŒ–çš„åº”ç”¨"></a>æ³›å‹å®åŒ–çš„åº”ç”¨</h3><p>æ–°å»ºä¸€ä¸ª reiï¬ed.kt æ–‡ä»¶ï¼Œç„¶ååœ¨é‡Œé¢ç¼–å†™å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">inline fun &lt;reified T&gt; startActivity(context: Context) &#123; </span><br><span class="line">     val intent = Intent(context, T::class.java) </span><br><span class="line">     context.startActivity(intent) </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª startActivity () å‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥æ”¶ä¸€ä¸ª Context å‚æ•°ï¼Œå¹¶åŒæ—¶ä½¿ç”¨ inline å’Œ reified å…³é”®å­—è®©æ³›å‹ T æˆä¸ºäº†ä¸€ä¸ªè¢«å®åŒ–çš„æ³›å‹ã€‚æ¥ä¸‹æ¥å°±æ˜¯ç¥å¥‡çš„åœ°æ–¹äº†ï¼Œ Intent æ¥æ”¶çš„ç¬¬äºŒä¸ªå‚æ•°æœ¬æ¥åº”è¯¥æ˜¯ä¸€ä¸ªå…·ä½“ Activity çš„ Class ç±»å‹ï¼Œä½†ç”±äºç°åœ¨ T å·²ç»æ˜¯ä¸€ä¸ª è¢«å®åŒ–çš„æ³›å‹äº†ï¼Œå› æ­¤è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä¼ å…¥ T::class.javaã€‚æœ€åè°ƒç”¨ Context çš„ startActivity () æ–¹æ³•æ¥å®Œæˆ Activity çš„å¯åŠ¨</p><p>ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦å¯åŠ¨ TestActivityï¼Œåªéœ€è¦è¿™æ ·å†™å°±å¯ä»¥äº†ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">startActivity&lt;TestActivity&gt;(context) </span><br></pre></td></tr></table></figure><p>æ·»åŠ ä¸€ä¸ªæ–°çš„ startActivity () å‡½æ•°é‡è½½ï¼Œå¦‚ä¸‹æ‰€ç¤º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">inline fun &lt;reified T&gt; startActivity(context: Context, block: Intent.() -&gt; Unit) &#123; </span><br><span class="line">     val intent = Intent(context, T::class.java) </span><br><span class="line">     intent.block() </span><br><span class="line">     context.startActivity(intent) </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ¬¡çš„ startActivity () å‡½æ•°ä¸­å¢åŠ äº†ä¸€ä¸ªå‡½æ•°ç±»å‹å‚æ•°ï¼Œå¹¶ä¸”å®ƒçš„å‡½æ•°ç±»å‹æ˜¯ å®šä¹‰åœ¨ Intent ç±»å½“ä¸­çš„ã€‚åœ¨åˆ›å»ºå®Œ Intent çš„å®ä¾‹ä¹‹åï¼Œéšå³è°ƒç”¨è¯¥å‡½æ•°ç±»å‹å‚æ•°ï¼Œå¹¶æŠŠ Intent çš„ å®ä¾‹ä¼ å…¥ï¼Œè¿™æ ·è°ƒç”¨ startActivity () å‡½æ•°çš„æ—¶å€™å°±å¯ä»¥åœ¨ Lambda è¡¨è¾¾å¼ä¸­ä¸º Intent ä¼ é€’ å‚æ•°äº†ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">startActivity&lt;TestActivity&gt;(context) &#123; </span><br><span class="line">     putExtra(&quot;param1&quot;, &quot;data&quot;) </span><br><span class="line">     putExtra(&quot;param2&quot;, 123) </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“çŸ¥è¯†ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WorkManagerç”¨æ³•ç¤ºä¾‹</title>
      <link href="/2025/03/28/WorkManager%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B/"/>
      <url>/2025/03/28/WorkManager%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="WorkManager-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#WorkManager-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="WorkManager æ˜¯ä»€ä¹ˆï¼Ÿ"></a><strong>WorkManager æ˜¯ä»€ä¹ˆï¼Ÿ</strong></h2><p>WorkManager æ˜¯ Android ç”¨æ¥æ‰§è¡Œ<strong>åå°ä»»åŠ¡</strong>çš„å·¥å…·ï¼Œé€‚ç”¨äºï¼š</p><ul><li><strong>æ‰§è¡Œä¸€æ¬¡</strong>çš„ä»»åŠ¡ï¼ˆæ¯”å¦‚ï¼šä¸Šä¼ æ—¥å¿—ã€å¤‡ä»½æ•°æ®ï¼‰ã€‚</li><li><strong>å®šæœŸæ‰§è¡Œ</strong>çš„ä»»åŠ¡ï¼ˆæ¯”å¦‚ï¼šæ¯ 15 åˆ†é’ŸåŒæ­¥æ•°æ®ï¼‰ã€‚</li><li><strong>å³ä½¿åº”ç”¨å…³é—­ã€è®¾å¤‡é‡å¯åä¹Ÿèƒ½æ‰§è¡Œ</strong>çš„ä»»åŠ¡ã€‚</li></ul><hr><h2 id="1-å¼•å…¥-WorkManager"><a href="#1-å¼•å…¥-WorkManager" class="headerlink" title="1. å¼•å…¥ WorkManager"></a><strong>1. å¼•å…¥ WorkManager</strong></h2><p>å…ˆåœ¨ <code>build.gradle.kts</code>ï¼ˆæ¨¡å—çº§ï¼‰ä¸­æ·»åŠ ä¾èµ–ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    implementation(&quot;androidx.work:work-runtime-ktx:2.9.0&quot;) // WorkManager æœ€æ–°ç‰ˆ</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶å <strong>åŒæ­¥ Gradle</strong>ï¼ˆç‚¹å‡»â€œSync Nowâ€ï¼‰ã€‚</p><hr><h2 id="2-åˆ›å»º-Worker"><a href="#2-åˆ›å»º-Worker" class="headerlink" title="2. åˆ›å»º Worker"></a><strong>2. åˆ›å»º Worker</strong></h2><p>Worker æ˜¯ WorkManager æ‰§è¡Œä»»åŠ¡çš„åœ°æ–¹ã€‚æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªç±»ï¼Œç»§æ‰¿ <code>Worker</code> æˆ– <code>CoroutineWorker</code>ï¼ˆæ¨èï¼‰ã€‚</p><h3 id="ç®€å•ä»»åŠ¡ç¤ºä¾‹"><a href="#ç®€å•ä»»åŠ¡ç¤ºä¾‹" class="headerlink" title="ç®€å•ä»»åŠ¡ç¤ºä¾‹"></a><strong>ç®€å•ä»»åŠ¡ç¤ºä¾‹</strong></h3><p>æ–°å»ºä¸€ä¸ª <code>MyWorker.kt</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import android.content.Context</span><br><span class="line">import android.util.Log</span><br><span class="line">import androidx.work.Worker</span><br><span class="line">import androidx.work.WorkerParameters</span><br><span class="line"></span><br><span class="line">class MyWorker(context: Context, workerParams: WorkerParameters) : Worker(context, workerParams) &#123;</span><br><span class="line">    override fun doWork(): Result &#123;</span><br><span class="line">        Log.d(&quot;MyWorker&quot;, &quot;åå°ä»»åŠ¡æ­£åœ¨æ‰§è¡Œ...&quot;)</span><br><span class="line"></span><br><span class="line">        // å‡è®¾ä»»åŠ¡æ‰§è¡ŒæˆåŠŸ</span><br><span class="line">        return Result.success()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="3-åœ¨åº”ç”¨ä¸­å¯åŠ¨-WorkManager"><a href="#3-åœ¨åº”ç”¨ä¸­å¯åŠ¨-WorkManager" class="headerlink" title="3. åœ¨åº”ç”¨ä¸­å¯åŠ¨ WorkManager"></a><strong>3. åœ¨åº”ç”¨ä¸­å¯åŠ¨ WorkManager</strong></h2><p>åœ¨ <code>MainActivity.kt</code> é‡Œå¯åŠ¨è¿™ä¸ªä»»åŠ¡ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import android.os.Bundle</span><br><span class="line">import androidx.appcompat.app.AppCompatActivity</span><br><span class="line">import androidx.work.OneTimeWorkRequest</span><br><span class="line">import androidx.work.WorkManager</span><br><span class="line"></span><br><span class="line">class MainActivity : AppCompatActivity() &#123;</span><br><span class="line">    override fun onCreate(savedInstanceState: Bundle?) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState)</span><br><span class="line"></span><br><span class="line">        // åˆ›å»ºä¸€ä¸ªä»»åŠ¡</span><br><span class="line">        val workRequest = OneTimeWorkRequest.Builder(MyWorker::class.java).build()</span><br><span class="line"></span><br><span class="line">        // å¯åŠ¨ä»»åŠ¡</span><br><span class="line">        WorkManager.getInstance(this).enqueue(workRequest)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·ï¼Œæ¯æ¬¡å¯åŠ¨åº”ç”¨ï¼ŒWorkManager å°±ä¼šæ‰§è¡Œ <code>MyWorker</code> é‡Œçš„ä»£ç ã€‚</p><hr><h2 id="4-ä¼ é€’å‚æ•°"><a href="#4-ä¼ é€’å‚æ•°" class="headerlink" title="4. ä¼ é€’å‚æ•°"></a><strong>4. ä¼ é€’å‚æ•°</strong></h2><p>å¦‚æœ Worker éœ€è¦å‚æ•°ï¼Œæ¯”å¦‚<strong>ä¸‹è½½æ–‡ä»¶çš„ URL</strong>ï¼Œå¯ä»¥è¿™æ ·ä¼ é€’ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import androidx.work.Data</span><br><span class="line"></span><br><span class="line">val data = Data.Builder()</span><br><span class="line">    .putString(&quot;url&quot;, &quot;https://example.com/file.jpg&quot;)</span><br><span class="line">    .build()</span><br><span class="line"></span><br><span class="line">val workRequest = OneTimeWorkRequest.Builder(MyWorker::class.java)</span><br><span class="line">    .setInputData(data) // ä¼ é€’å‚æ•°</span><br><span class="line">    .build()</span><br><span class="line"></span><br><span class="line">WorkManager.getInstance(this).enqueue(workRequest)</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨ <code>MyWorker</code> é‡Œæ¥æ”¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">override fun doWork(): Result &#123;</span><br><span class="line">    val url = inputData.getString(&quot;url&quot;) ?: &quot;æœªæä¾› URL&quot;</span><br><span class="line">    Log.d(&quot;MyWorker&quot;, &quot;ä¸‹è½½æ–‡ä»¶ï¼š$url&quot;)</span><br><span class="line"></span><br><span class="line">    return Result.success()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="5-å‘¨æœŸæ€§ä»»åŠ¡"><a href="#5-å‘¨æœŸæ€§ä»»åŠ¡" class="headerlink" title="5. å‘¨æœŸæ€§ä»»åŠ¡"></a><strong>5. å‘¨æœŸæ€§ä»»åŠ¡</strong></h2><p>å¦‚æœä»»åŠ¡éœ€è¦<strong>å®šæœŸæ‰§è¡Œ</strong>ï¼ˆæ¯”å¦‚æ¯ 15 åˆ†é’Ÿå¤‡ä»½æ•°æ®ï¼‰ï¼Œå¯ä»¥ç”¨ <code>PeriodicWorkRequest</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import androidx.work.PeriodicWorkRequest</span><br><span class="line">import java.util.concurrent.TimeUnit</span><br><span class="line"></span><br><span class="line">val periodicWorkRequest = PeriodicWorkRequest.Builder(MyWorker::class.java, 15, TimeUnit.MINUTES)</span><br><span class="line">    .build()</span><br><span class="line"></span><br><span class="line">WorkManager.getInstance(this).enqueue(periodicWorkRequest)</span><br></pre></td></tr></table></figure><p>âš ï¸ <strong>æ³¨æ„</strong>ï¼šæœ€å°é—´éš”æ˜¯ <strong>15 åˆ†é’Ÿ</strong>ï¼Œä¸èƒ½æ›´çŸ­ï¼</p><hr><h2 id="6-ä»»åŠ¡çº¦æŸï¼ˆä¾‹å¦‚ä»…åœ¨-WiFi-ä¸‹è¿è¡Œï¼‰"><a href="#6-ä»»åŠ¡çº¦æŸï¼ˆä¾‹å¦‚ä»…åœ¨-WiFi-ä¸‹è¿è¡Œï¼‰" class="headerlink" title="6. ä»»åŠ¡çº¦æŸï¼ˆä¾‹å¦‚ä»…åœ¨ WiFi ä¸‹è¿è¡Œï¼‰"></a><strong>6. ä»»åŠ¡çº¦æŸï¼ˆä¾‹å¦‚ä»…åœ¨ WiFi ä¸‹è¿è¡Œï¼‰</strong></h2><p>å¯ä»¥åŠ ä¸€äº›æ¡ä»¶ï¼Œæ¯”å¦‚ï¼š</p><ul><li>åªæœ‰åœ¨ <strong>WiFi è¿æ¥</strong> æ—¶è¿è¡Œã€‚</li><li>åªæœ‰åœ¨ <strong>å……ç”µçŠ¶æ€</strong> æ—¶è¿è¡Œã€‚</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import androidx.work.Constraints</span><br><span class="line">import androidx.work.NetworkType</span><br><span class="line"></span><br><span class="line">val constraints = Constraints.Builder()</span><br><span class="line">    .setRequiredNetworkType(NetworkType.UNMETERED) // WiFi æ‰æ‰§è¡Œ</span><br><span class="line">    .setRequiresCharging(true) // å……ç”µæ—¶æ‰æ‰§è¡Œ</span><br><span class="line">    .build()</span><br><span class="line"></span><br><span class="line">val workRequest = OneTimeWorkRequest.Builder(MyWorker::class.java)</span><br><span class="line">    .setConstraints(constraints)</span><br><span class="line">    .build()</span><br><span class="line"></span><br><span class="line">WorkManager.getInstance(this).enqueue(workRequest)</span><br></pre></td></tr></table></figure><hr><h2 id="7-ç›‘å¬ä»»åŠ¡çŠ¶æ€"><a href="#7-ç›‘å¬ä»»åŠ¡çŠ¶æ€" class="headerlink" title="7. ç›‘å¬ä»»åŠ¡çŠ¶æ€"></a><strong>7. ç›‘å¬ä»»åŠ¡çŠ¶æ€</strong></h2><p>å¦‚æœæƒ³çŸ¥é“ä»»åŠ¡æ˜¯å¦æ‰§è¡ŒæˆåŠŸï¼Œå¯ä»¥è¿™æ ·ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">val workManager = WorkManager.getInstance(this)</span><br><span class="line">workManager.getWorkInfoByIdLiveData(workRequest.id).observe(this) &#123; workInfo -&gt;</span><br><span class="line">    if (workInfo != null) &#123;</span><br><span class="line">        when (workInfo.state) &#123;</span><br><span class="line">            WorkInfo.State.ENQUEUED -&gt; Log.d(&quot;MyWorker&quot;, &quot;ä»»åŠ¡ç­‰å¾…ä¸­&quot;)</span><br><span class="line">            WorkInfo.State.RUNNING -&gt; Log.d(&quot;MyWorker&quot;, &quot;ä»»åŠ¡æ‰§è¡Œä¸­&quot;)</span><br><span class="line">            WorkInfo.State.SUCCEEDED -&gt; Log.d(&quot;MyWorker&quot;, &quot;ä»»åŠ¡æˆåŠŸ&quot;)</span><br><span class="line">            WorkInfo.State.FAILED -&gt; Log.d(&quot;MyWorker&quot;, &quot;ä»»åŠ¡å¤±è´¥&quot;)</span><br><span class="line">            WorkInfo.State.CANCELLED -&gt; Log.d(&quot;MyWorker&quot;, &quot;ä»»åŠ¡å·²å–æ¶ˆ&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="8-å–æ¶ˆä»»åŠ¡"><a href="#8-å–æ¶ˆä»»åŠ¡" class="headerlink" title="8. å–æ¶ˆä»»åŠ¡"></a><strong>8. å–æ¶ˆä»»åŠ¡</strong></h2><p>å¯ä»¥éšæ—¶å–æ¶ˆä»»åŠ¡ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">WorkManager.getInstance(this).cancelWorkById(workRequest.id) // å–æ¶ˆæŸä¸ªä»»åŠ¡</span><br><span class="line">WorkManager.getInstance(this).cancelAllWork() // å–æ¶ˆæ‰€æœ‰ä»»åŠ¡</span><br></pre></td></tr></table></figure><hr><h2 id="9-é“¾å¼ä»»åŠ¡ï¼ˆChained-Workï¼‰"><a href="#9-é“¾å¼ä»»åŠ¡ï¼ˆChained-Workï¼‰" class="headerlink" title="9. é“¾å¼ä»»åŠ¡ï¼ˆChained Workï¼‰"></a>9. é“¾å¼ä»»åŠ¡ï¼ˆChained Workï¼‰</h2><ul><li><p><strong>ä½œç”¨ï¼š</strong> å¦‚æœæœ‰å¤šä¸ªä»»åŠ¡éœ€è¦ä¾æ¬¡æ‰§è¡Œï¼Œæ¯”å¦‚å…ˆä¸‹è½½æ•°æ®å†å¤„ç†æ•°æ®ï¼Œå¯ä»¥æŠŠå®ƒä»¬é“¾æ¥èµ·æ¥ã€‚</p></li><li><p><strong>ç®€å•ä¾‹å­ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">val workA = OneTimeWorkRequestBuilder&lt;WorkerA&gt;().build()</span><br><span class="line">val workB = OneTimeWorkRequestBuilder&lt;WorkerB&gt;().build()</span><br><span class="line">val workC = OneTimeWorkRequestBuilder&lt;WorkerC&gt;().build()</span><br><span class="line"></span><br><span class="line">WorkManager.getInstance(context)</span><br><span class="line">    .beginWith(workA)   // å…ˆæ‰§è¡Œ workA</span><br><span class="line">    .then(workB)        // workA æ‰§è¡Œå®Œåå†æ‰§è¡Œ workB</span><br><span class="line">    .then(workC)        // workB æ‰§è¡Œå®Œåå†æ‰§è¡Œ workC</span><br><span class="line">    .enqueue()          // æäº¤æ•´ä¸ªé“¾æ¡ä»»åŠ¡</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±èƒ½ä¿è¯ä»»åŠ¡æŒ‰ç…§ä½ è®¾å®šçš„é¡ºåºä¾æ¬¡å®Œæˆã€‚</p></li></ul><hr><h2 id="10-å”¯ä¸€ä»»åŠ¡ï¼ˆUnique-Workï¼‰"><a href="#10-å”¯ä¸€ä»»åŠ¡ï¼ˆUnique-Workï¼‰" class="headerlink" title="10. å”¯ä¸€ä»»åŠ¡ï¼ˆUnique Workï¼‰"></a>10. å”¯ä¸€ä»»åŠ¡ï¼ˆUnique Workï¼‰</h2><ul><li><p><strong>ä½œç”¨ï¼š</strong> é˜²æ­¢åŒæ ·çš„ä»»åŠ¡é‡å¤æ‰§è¡Œã€‚æ¯”å¦‚ä¸å¸Œæœ›åŒæ—¶æœ‰ä¸¤ä¸ªç›¸åŒçš„ä»»åŠ¡åœ¨è¿è¡Œã€‚</p></li><li><p><strong>ç®€å•ä¾‹å­ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">val uniqueWorkRequest = OneTimeWorkRequestBuilder&lt;MyWorker&gt;().build()</span><br><span class="line"></span><br><span class="line">WorkManager.getInstance(context).enqueueUniqueWork(</span><br><span class="line">    &quot;uniqueTask&quot;,                  // ç»™ä»»åŠ¡èµ·ä¸€ä¸ªå”¯ä¸€çš„åå­—</span><br><span class="line">    ExistingWorkPolicy.REPLACE,    // å¦‚æœå·²æœ‰åŒåä»»åŠ¡ï¼Œæ›¿æ¢æ‰æ—§çš„ä»»åŠ¡</span><br><span class="line">    uniqueWorkRequest</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å”¯ä¸€ä»»åŠ¡å¯ä»¥ç¡®ä¿åŒä¸€æ—¶åˆ»ä¸ä¼šæœ‰å¤šä¸ªç›¸åŒä»»åŠ¡é‡å¤è¿è¡Œã€‚</p></li></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h2><table><thead><tr><th>åŠŸèƒ½</th><th>ä»£ç </th></tr></thead><tbody><tr><td><strong>ä¸€æ¬¡æ€§ä»»åŠ¡</strong></td><td><code>OneTimeWorkRequest.Builder(MyWorker::class.java).build()</code></td></tr><tr><td><strong>å‘¨æœŸæ€§ä»»åŠ¡</strong></td><td><code>PeriodicWorkRequest.Builder(MyWorker::class.java, 15, TimeUnit.MINUTES).build()</code></td></tr><tr><td><strong>ä¼ é€’å‚æ•°</strong></td><td><code>Data.Builder().putString(&quot;key&quot;, &quot;value&quot;).build()</code></td></tr><tr><td><strong>æ·»åŠ çº¦æŸ</strong></td><td><code>Constraints.Builder().setRequiredNetworkType(NetworkType.UNMETERED).build()</code></td></tr><tr><td><strong>ç›‘å¬ä»»åŠ¡çŠ¶æ€</strong></td><td><code>workManager.getWorkInfoByIdLiveData(id).observe(...)</code></td></tr><tr><td><strong>å–æ¶ˆä»»åŠ¡</strong></td><td><code>WorkManager.getInstance(this).cancelWorkById(id)</code></td></tr></tbody></table><hr><h2 id="é€‚ç”¨åœºæ™¯"><a href="#é€‚ç”¨åœºæ™¯" class="headerlink" title="é€‚ç”¨åœºæ™¯"></a><strong>é€‚ç”¨åœºæ™¯</strong></h2><ul><li><strong>ä¸€æ¬¡æ€§ä»»åŠ¡</strong>ï¼ˆå¦‚ï¼šä¸Šä¼ æ—¥å¿—ã€å¤‡ä»½æ•°æ®åº“ï¼‰ã€‚</li><li><strong>å®šæœŸä»»åŠ¡</strong>ï¼ˆå¦‚ï¼šè‡ªåŠ¨åŒæ­¥æ•°æ®ï¼Œæ¯å¤©ä¸Šä¼ ä¸€æ¬¡ï¼‰ã€‚</li><li><strong>åå°ä»»åŠ¡</strong>ï¼ˆå¦‚ï¼šä¸‹è½½å¤§æ–‡ä»¶ï¼‰ã€‚</li><li><strong>ä»»åŠ¡å¯ä»¥åº”ç”¨é€€å‡ºåæ‰§è¡Œ</strong>ï¼ˆå¦‚ï¼šåº”ç”¨å…³é—­åä»ç»§ç»­å¤‡ä»½æ•°æ®ï¼‰ã€‚</li></ul><p><strong>âŒ WorkManager ä¸èƒ½åšçš„äº‹æƒ…</strong></p><ul><li><strong>å®šæ—¶ç²¾å‡†ä»»åŠ¡</strong>ï¼ˆæ¯”å¦‚å®šç‚¹ 3:00AM è¿è¡Œï¼Œæ¨èç”¨ <code>AlarmManager</code>ï¼‰ã€‚</li><li><strong>å³æ—¶ä»»åŠ¡</strong>ï¼ˆå¦‚æœä»»åŠ¡å¿…é¡»ç«‹åˆ»å®Œæˆï¼Œå»ºè®®ç”¨ <code>ForegroundService</code>ï¼‰ã€‚</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“çŸ¥è¯†ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AsyncTaskçš„ç”¨æ³•ç¤ºä¾‹</title>
      <link href="/2025/03/27/AsyncTask%E7%9A%84%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B/"/>
      <url>/2025/03/27/AsyncTask%E7%9A%84%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="Kotlin-ä¸­-AsyncTask-çš„ä½¿ç”¨æ•™ç¨‹"><a href="#Kotlin-ä¸­-AsyncTask-çš„ä½¿ç”¨æ•™ç¨‹" class="headerlink" title="Kotlin ä¸­ AsyncTask çš„ä½¿ç”¨æ•™ç¨‹"></a>Kotlin ä¸­ AsyncTask çš„ä½¿ç”¨æ•™ç¨‹</h1><p>AsyncTask ç”¨äºå°†è€—æ—¶æ“ä½œæ”¾åˆ°åå°çº¿ç¨‹æ‰§è¡Œï¼ŒåŒæ—¶åœ¨ä»»åŠ¡å¼€å§‹å’Œç»“æŸæ—¶åœ¨ä¸»çº¿ç¨‹æ›´æ–° UIã€‚æœ¬æ–‡å°†é€æ­¥è®²è§£å…¶åŸºæœ¬æ¦‚å¿µã€ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œå¹¶æä¾›ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ä»£ç ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ ä» Android 11 å¼€å§‹ï¼ŒAsyncTask å·²è¢«å¼ƒç”¨ï¼Œå»ºè®®åœ¨æ–°é¡¹ç›®ä¸­ä½¿ç”¨ Kotlin åç¨‹ã€WorkManager æˆ–å…¶ä»–å¼‚æ­¥æ–¹æ¡ˆï¼Œæœ¬æ–‡ä»…åšå­¦ä¹ è®°å½•ä½¿ç”¨ï¼Œè€Œä¸”ç¬¬ä¸€è¡Œä»£ç P396 10.2.4è®²çš„æ›´è¯¦ç»†æ›´å¥½ã€‚</p><hr><h2 id="1-AsyncTask-çš„åŸºæœ¬æ¦‚å¿µ"><a href="#1-AsyncTask-çš„åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="1. AsyncTask çš„åŸºæœ¬æ¦‚å¿µ"></a>1. AsyncTask çš„åŸºæœ¬æ¦‚å¿µ</h2><p>AsyncTask ä½¿ç”¨ä¸‰ä¸ªæ³›å‹å‚æ•°æ¥ç¡®å®šä»»åŠ¡çš„è¾“å…¥ã€è¿›åº¦å’Œç»“æœç±»å‹ï¼š</p><ul><li><strong>Params</strong>ï¼šä¼ é€’ç»™ä»»åŠ¡çš„å‚æ•°ç±»å‹ã€‚</li><li><strong>Progress</strong>ï¼šä»»åŠ¡æ‰§è¡Œä¸­æ›´æ–°è¿›åº¦æ—¶ä½¿ç”¨çš„æ•°æ®ç±»å‹ã€‚</li><li><strong>Result</strong>ï¼šä»»åŠ¡æ‰§è¡Œå®Œæ¯•åè¿”å›çš„ç»“æœç±»å‹ã€‚</li></ul><p>ä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">class MyTask : AsyncTask&lt;Void, Int, String&gt;() &#123; ... &#125;</span><br></pre></td></tr></table></figure><p>è¡¨ç¤ºè¯¥ä»»åŠ¡ä¸éœ€è¦è¾“å…¥å‚æ•°ï¼ˆVoidï¼‰ã€è¿›åº¦ä¸º Int ç±»å‹ã€æœ€ç»ˆç»“æœä¸º Stringã€‚</p><hr><h2 id="2-AsyncTask-çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•"><a href="#2-AsyncTask-çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•" class="headerlink" title="2. AsyncTask çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•"></a>2. AsyncTask çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•</h2><p>AsyncTask å®šä¹‰äº†å¤šä¸ªå›è°ƒæ–¹æ³•ï¼Œæ¯ä¸ªæ–¹æ³•åœ¨ä»»åŠ¡æ‰§è¡Œçš„ä¸åŒé˜¶æ®µè¢«è°ƒç”¨ï¼š</p><ul><li><strong>onPreExecute()</strong><br> åœ¨ä»»åŠ¡å¼€å§‹å‰è°ƒç”¨ï¼Œé€šå¸¸ç”¨äºåˆå§‹åŒ– UIï¼ˆä¾‹å¦‚æ˜¾ç¤ºè¿›åº¦æ¡ï¼‰ã€‚</li><li><strong>doInBackground(vararg params: Params)</strong><br> åœ¨åå°çº¿ç¨‹ä¸­æ‰§è¡Œè€—æ—¶æ“ä½œã€‚æ­¤æ–¹æ³•ä¸èƒ½ç›´æ¥æ›´æ–° UIï¼Œä½†å¯ä»¥è°ƒç”¨ <code>publishProgress()</code> è§¦å‘è¿›åº¦æ›´æ–°ã€‚</li><li><strong>onProgressUpdate(vararg values: Progress)</strong><br> å½“è°ƒç”¨ <code>publishProgress()</code> æ—¶åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œç”¨äºæ›´æ–° UI ä¸­çš„è¿›åº¦æ˜¾ç¤ºã€‚</li><li><strong>onPostExecute(result: Result)</strong><br> åœ¨åå°ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åè°ƒç”¨ï¼Œè¿è¡Œåœ¨ä¸»çº¿ç¨‹ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä»»åŠ¡è¿”å›çš„ç»“æœæ›´æ–° UIã€‚</li><li><strong>onCancelled()</strong><br> å½“ä»»åŠ¡è¢«å–æ¶ˆæ—¶è°ƒç”¨ï¼Œå¯ç”¨äºæ¸…ç†æ“ä½œã€‚</li></ul><hr><h2 id="3-Kotlin-ç¤ºä¾‹ä»£ç "><a href="#3-Kotlin-ç¤ºä¾‹ä»£ç " class="headerlink" title="3. Kotlin ç¤ºä¾‹ä»£ç "></a>3. Kotlin ç¤ºä¾‹ä»£ç </h2><p>ä¸‹é¢çš„ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ AsyncTask åœ¨åå°æ¨¡æ‹Ÿä¸€ä¸ªè€—æ—¶ä»»åŠ¡ï¼ˆä¾‹å¦‚è®¡æ•°æ“ä½œï¼‰ï¼Œå¹¶åœ¨ UI ä¸Šæ›´æ–°è¿›åº¦å’Œæ˜¾ç¤ºç»“æœã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">import android.os.AsyncTask</span><br><span class="line">import android.os.Bundle</span><br><span class="line">import android.widget.ProgressBar</span><br><span class="line">import android.widget.TextView</span><br><span class="line">import androidx.appcompat.app.AppCompatActivity</span><br><span class="line"></span><br><span class="line">class MainActivity : AppCompatActivity() &#123;</span><br><span class="line"></span><br><span class="line">    private lateinit var progressBar: ProgressBar</span><br><span class="line">    private lateinit var textView: TextView</span><br><span class="line"></span><br><span class="line">    override fun onCreate(savedInstanceState: Bundle?) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line"></span><br><span class="line">        progressBar = findViewById(R.id.progressBar)</span><br><span class="line">        textView = findViewById(R.id.textView)</span><br><span class="line"></span><br><span class="line">        // ä¼ å…¥ä¸€ä¸ªæ•´æ•°å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°ä¼šè¢«ä¼ é€’åˆ°doInBackground()æ–¹æ³•å½“ä¸­ï¼Œä¾‹å¦‚ï¼š10</span><br><span class="line">        MyTask().execute(10)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // MyTask ç±»ç»§æ‰¿è‡ª AsyncTask&lt;Int, Int, String&gt;</span><br><span class="line">    private inner class MyTask : AsyncTask&lt;Int, Int, String&gt;() &#123;</span><br><span class="line"></span><br><span class="line">        // åœ¨ä»»åŠ¡å¼€å§‹å‰è°ƒç”¨ï¼Œé€šå¸¸ç”¨äºåˆå§‹åŒ–ç•Œé¢ï¼Œæ¯”å¦‚æ˜¾ç¤ºè¿›åº¦æ¡</span><br><span class="line">        override fun onPreExecute() &#123;</span><br><span class="line">            super.onPreExecute()</span><br><span class="line">            progressBar.progress = 0</span><br><span class="line">            textView.text = &quot;ä»»åŠ¡å¼€å§‹...&quot;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // åœ¨åå°çº¿ç¨‹ä¸­æ‰§è¡Œè€—æ—¶æ“ä½œ</span><br><span class="line">        // params æ•°ç»„ä¸­åŒ…å« execute() æ–¹æ³•ä¼ å…¥çš„å‚æ•°ï¼Œè¿™é‡Œæˆ‘ä»¬åªä¼ å…¥ä¸€ä¸ª Int ç±»å‹çš„å‚æ•°</span><br><span class="line">        override fun doInBackground(vararg params: Int?): String &#123;</span><br><span class="line">            // è·å–ä¼ å…¥çš„å‚æ•°å€¼ï¼Œå‡è®¾å®ƒè¡¨ç¤ºä»»åŠ¡æ€»æ­¥æ•°</span><br><span class="line">            val totalSteps = params.firstOrNull() ?: 0</span><br><span class="line">            for (i in 1..totalSteps) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    // æ¨¡æ‹Ÿè€—æ—¶æ“ä½œï¼Œä¾‹å¦‚ç¡çœ  1 ç§’</span><br><span class="line">                    Thread.sleep(1000)</span><br><span class="line">                &#125; catch (e: InterruptedException) &#123;</span><br><span class="line">                    e.printStackTrace()</span><br><span class="line">                &#125;</span><br><span class="line">                // è°ƒç”¨ publishProgress() æ›´æ–°è¿›åº¦ï¼Œè§¦å‘ onProgressUpdate()</span><br><span class="line">                publishProgress(i)</span><br><span class="line">            &#125;</span><br><span class="line">            // è¿”å›ä»»åŠ¡å®Œæˆåçš„ç»“æœ</span><br><span class="line">            return &quot;ä»»åŠ¡å®Œæˆï¼Œå…±è®¡ $totalSteps ç§’&quot;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // åœ¨ä¸»çº¿ç¨‹ä¸­æ¥æ”¶å¹¶æ›´æ–°ä»»åŠ¡è¿›åº¦</span><br><span class="line">        override fun onProgressUpdate(vararg values: Int?) &#123;</span><br><span class="line">            super.onProgressUpdate(*values)</span><br><span class="line">            // æ›´æ–° ProgressBar å’Œ TextView æ˜¾ç¤ºå½“å‰è¿›åº¦</span><br><span class="line">            values.firstOrNull()?.let &#123; progress -&gt;</span><br><span class="line">                progressBar.progress = progress * 100 / (intent.getIntExtra(&quot;TOTAL_STEPS&quot;, 10))</span><br><span class="line">                textView.text = &quot;å½“å‰è¿›åº¦: $progress/$&#123;intent.getIntExtra(&quot;TOTAL_STEPS&quot;, 10)&#125;&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // åœ¨ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åè°ƒç”¨ï¼Œä¼ å…¥ doInBackground() è¿”å›çš„ç»“æœ</span><br><span class="line">        override fun onPostExecute(result: String?) &#123;</span><br><span class="line">            super.onPostExecute(result)</span><br><span class="line">            textView.text = result</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // å¯é€‰ï¼šä»»åŠ¡å–æ¶ˆæ—¶è°ƒç”¨</span><br><span class="line">        override fun onCancelled() &#123;</span><br><span class="line">            super.onCancelled()</span><br><span class="line">            textView.text = &quot;ä»»åŠ¡å–æ¶ˆ&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ä»£ç è¯´æ˜"><a href="#ä»£ç è¯´æ˜" class="headerlink" title="ä»£ç è¯´æ˜"></a>ä»£ç è¯´æ˜</h3><ul><li><strong>onPreExecute()</strong><br> åˆå§‹åŒ– ProgressBar å’Œ TextView çš„æ˜¾ç¤ºçŠ¶æ€ã€‚</li><li><strong>doInBackground()</strong><br> åœ¨åå°æ‰§è¡Œä¸€ä¸ªç®€å•çš„å¾ªç¯æ“ä½œï¼Œæ¯æ¬¡å¾ªç¯æš‚åœ 50 æ¯«ç§’ï¼Œå¹¶è°ƒç”¨ <code>publishProgress()</code> æ›´æ–° UI çš„è¿›åº¦ã€‚</li><li><strong>onProgressUpdate()</strong><br> æ¥æ”¶åˆ°è¿›åº¦åï¼Œåœ¨ä¸»çº¿ç¨‹æ›´æ–° ProgressBar å’Œ TextViewã€‚</li><li><strong>onPostExecute()</strong><br> å½“ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œæ˜¾ç¤ºå®Œæˆæ¶ˆæ¯ã€‚</li></ul><hr><h2 id="4-æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ"><a href="#4-æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ" class="headerlink" title="4. æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ"></a>4. æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ</h2><ul><li><strong>å†…å­˜æ³„æ¼é—®é¢˜</strong><br> å¦‚æœ AsyncTask æ˜¯ä½œä¸º Activity çš„å†…éƒ¨ç±»å­˜åœ¨ï¼Œå½“ Activity è¢«é”€æ¯æ—¶å¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼ã€‚å»ºè®®å°† AsyncTask å®šä¹‰ä¸ºé™æ€å†…éƒ¨ç±»ï¼Œå¹¶é€šè¿‡ WeakReference æŒæœ‰ Activity çš„å¼•ç”¨ã€‚</li><li><strong>æ‰§è¡Œç­–ç•¥</strong><br> åœ¨ API 11ï¼ˆAndroid 3.0ï¼‰åŠä»¥ä¸Šç‰ˆæœ¬ï¼ŒAsyncTask é»˜è®¤ä¸²è¡Œæ‰§è¡Œã€‚å¦‚æœéœ€è¦å¹¶è¡Œæ‰§è¡Œï¼Œå¯ä»¥ä½¿ç”¨ <code>executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR)</code>ã€‚</li><li><strong>å·²å¼ƒç”¨æé†’</strong><br> ä» Android 11 å¼€å§‹ï¼ŒAsyncTask å·²è¢«å¼ƒç”¨ï¼Œå»ºè®®åœ¨æ–°é¡¹ç›®ä¸­ä½¿ç”¨ Kotlin åç¨‹ã€WorkManager æˆ–å…¶ä»–å¼‚æ­¥æ–¹æ¡ˆã€‚</li></ul><hr><h2 id="5-ä¸ºä»€ä¹ˆæ¨è-Kotlin-åç¨‹ï¼Ÿ"><a href="#5-ä¸ºä»€ä¹ˆæ¨è-Kotlin-åç¨‹ï¼Ÿ" class="headerlink" title="5. ä¸ºä»€ä¹ˆæ¨è Kotlin åç¨‹ï¼Ÿ"></a>5. ä¸ºä»€ä¹ˆæ¨è Kotlin åç¨‹ï¼Ÿ</h2><ul><li><strong>ä»£ç ç®€æ´</strong><br> Kotlin åç¨‹å¯ä»¥è®©å¼‚æ­¥ä»£ç å†™å¾—åƒåŒæ­¥ä»£ç ï¼Œå‡å°‘å›è°ƒå±‚çº§å’Œä»£ç å†—ä½™ã€‚</li><li><strong>æ›´å¥½çš„é”™è¯¯å¤„ç†ä¸å–æ¶ˆæœºåˆ¶</strong><br> åç¨‹å†…ç½®äº†ç»“æ„åŒ–å¹¶å‘ï¼Œä¾¿äºç®¡ç†ä»»åŠ¡ç”Ÿå‘½å‘¨æœŸå’Œå¼‚å¸¸å¤„ç†ã€‚</li><li><strong>å®˜æ–¹æ”¯æŒ</strong><br> è°·æ­Œå’Œ JetBrains éƒ½æ¨èåœ¨ Android é¡¹ç›®ä¸­ä½¿ç”¨ Kotlin åç¨‹æ¥å¤„ç†å¼‚æ­¥ä»»åŠ¡ã€‚</li></ul><hr><h2 id="6-æ€»ç»“"><a href="#6-æ€»ç»“" class="headerlink" title="6. æ€»ç»“"></a>6. æ€»ç»“</h2><p>æœ¬æ–‡è¯¦ç»†ä»‹ç»äº†åœ¨ Kotlin ä¸­ä½¿ç”¨ AsyncTask çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬å„ä¸ªç”Ÿå‘½å‘¨æœŸå›è°ƒçš„ä½œç”¨å’Œç¤ºä¾‹ä»£ç ã€‚è™½ç„¶ AsyncTask æ›¾ç»ä¸º Android å¼‚æ­¥å¤„ç†æä¾›äº†ç®€åŒ–æ–¹æ¡ˆï¼Œä½†éšç€æŠ€æœ¯çš„å‘å±•ï¼ŒKotlin åç¨‹å·²æˆä¸ºæ›´æ¨èçš„é€‰æ‹©ã€‚åœ¨å­¦ä¹  AsyncTask çš„åŒæ—¶ï¼Œå»ºè®®å¤§å®¶å°½å¿«ç†Ÿæ‚‰å¹¶å°è¯•ä½¿ç”¨ Kotlin åç¨‹ä»¥æå‡ä»£ç çš„ç®€æ´æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“çŸ¥è¯†ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>infixç”¨æ³•ç¤ºä¾‹</title>
      <link href="/2025/03/26/inflix%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B/"/>
      <url>/2025/03/26/inflix%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<h3 id="ä»€ä¹ˆæ˜¯-infix-å‡½æ•°ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-infix-å‡½æ•°ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ infix å‡½æ•°ï¼Ÿ"></a><strong>ä»€ä¹ˆæ˜¯ <code>infix</code> å‡½æ•°ï¼Ÿ</strong></h3><p><code>infix</code> å…³é”®å­—å¯ä»¥è®© <strong>å•å‚æ•°çš„å‡½æ•°</strong> ä»¥ <strong>æ›´è‡ªç„¶çš„è¯­æ³•</strong> ä¹¦å†™ï¼Œä½¿ä»£ç æ›´æ˜“è¯»ã€‚<br> ä½ å¯ä»¥æŠŠå®ƒç†è§£ä¸º <strong>ä¸€ç§ç‰¹æ®Šçš„è°ƒç”¨æ–¹å¼</strong>ï¼Œä¸éœ€è¦ <code>.</code> å’Œ <code>()</code>ï¼Œè®©ä»£ç åƒ <strong>è‡ªç„¶è¯­è¨€</strong> ä¸€æ ·æµç•…ã€‚</p><p>è¦ä½¿ç”¨ <code>infix</code>ï¼Œéœ€è¦æ»¡è¶³ <strong>ä¸‰ä¸ªæ¡ä»¶</strong>ï¼š</p><ol><li><strong>å¿…é¡»æ˜¯æˆå‘˜å‡½æ•°æˆ–æ‰©å±•å‡½æ•°</strong>ï¼ˆå®ƒå¿…é¡»å±äºæŸä¸ªç±»æˆ–æŸç§ç±»å‹ï¼‰ã€‚</li><li><strong>å¿…é¡»åªæœ‰ä¸”åªèƒ½æœ‰ä¸€ä¸ªå‚æ•°</strong>ï¼ˆå¦‚æœæœ‰å¤šä¸ªå‚æ•°ï¼Œå°±ä¸èƒ½ç”¨ <code>infix</code>ï¼‰ã€‚</li><li>â­â­â­â­â­â­<strong>è°ƒç”¨æ—¶å¯ä»¥çœç•¥ <code>.</code> å’Œ <code>()</code></strong>ï¼ˆä½†ä»ç„¶å¯ä»¥ç”¨ <code>.</code> è°ƒç”¨ï¼‰ã€‚</li></ol><hr><h3 id="ç®€å•ç¤ºä¾‹-1ï¼šæ•°å­—æ¯”è¾ƒ"><a href="#ç®€å•ç¤ºä¾‹-1ï¼šæ•°å­—æ¯”è¾ƒ" class="headerlink" title="ç®€å•ç¤ºä¾‹ 1ï¼šæ•°å­—æ¯”è¾ƒ"></a><strong>ç®€å•ç¤ºä¾‹ 1ï¼šæ•°å­—æ¯”è¾ƒ</strong></h3><h4 id="ä¸ä½¿ç”¨-infix"><a href="#ä¸ä½¿ç”¨-infix" class="headerlink" title="ä¸ä½¿ç”¨ infix"></a><strong>ä¸ä½¿ç”¨ <code>infix</code></strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">fun isBigger(a: Int, b: Int): Boolean &#123;</span><br><span class="line">    return a &gt; b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun main() &#123;</span><br><span class="line">    println(isBigger(10, 5)) // è¾“å‡ºï¼štrue</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå‡½æ•° <code>isBigger(10, 5)</code> å¯è¯»æ€§ä¸€èˆ¬ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ <code>infix</code> æ”¹å†™å®ƒã€‚</p><hr><h4 id="ä½¿ç”¨-infix"><a href="#ä½¿ç”¨-infix" class="headerlink" title="ä½¿ç”¨ infix"></a><strong>ä½¿ç”¨ <code>infix</code></strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">infix fun Int.isBiggerThan(other: Int): Boolean &#123;</span><br><span class="line">    return this &gt; other</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun main() &#123;</span><br><span class="line">    println(10 isBiggerThan 5) // è¾“å‡ºï¼štrue</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>âœ… <code>10 isBiggerThan 5</code> è¯»èµ·æ¥å°±åƒ <strong>è‡ªç„¶è¯­è¨€</strong>ï¼Œæ¯” <code>isBigger(10, 5)</code> æ›´æ˜“æ‡‚ã€‚</p><hr><h3 id="ç®€å•ç¤ºä¾‹-2ï¼šåˆ›å»º-â€œåå­—-å€¼â€-å¯¹"><a href="#ç®€å•ç¤ºä¾‹-2ï¼šåˆ›å»º-â€œåå­—-å€¼â€-å¯¹" class="headerlink" title="ç®€å•ç¤ºä¾‹ 2ï¼šåˆ›å»º â€œåå­—-å€¼â€ å¯¹"></a><strong>ç®€å•ç¤ºä¾‹ 2ï¼šåˆ›å»º â€œåå­—-å€¼â€ å¯¹</strong></h3><h4 id="æ™®é€šæ–¹å¼"><a href="#æ™®é€šæ–¹å¼" class="headerlink" title="æ™®é€šæ–¹å¼"></a><strong>æ™®é€šæ–¹å¼</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">fun pair(key: String, value: String): Pair&lt;String, String&gt; &#123;</span><br><span class="line">    return Pair(key, value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun main() &#123;</span><br><span class="line">    val result = pair(&quot;name&quot;, &quot;Alice&quot;)</span><br><span class="line">    println(result) // è¾“å‡ºï¼š (name, Alice)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h4 id="ä½¿ç”¨-infix-1"><a href="#ä½¿ç”¨-infix-1" class="headerlink" title="ä½¿ç”¨ infix"></a><strong>ä½¿ç”¨ <code>infix</code></strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">infix fun String.with(value: String): Pair&lt;String, String&gt; &#123;</span><br><span class="line">    return Pair(this, value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun main() &#123;</span><br><span class="line">    val result = &quot;name&quot; with &quot;Alice&quot;</span><br><span class="line">    println(result) // è¾“å‡ºï¼š (name, Alice)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>âœ… <code>&quot;name&quot; with &quot;Alice&quot;</code> è¯»èµ·æ¥æ›´åƒ <strong>è‡ªç„¶è¯­è¨€</strong>ï¼Œæ¯” <code>pair(&quot;name&quot;, &quot;Alice&quot;)</code> æ›´ç›´è§‚ã€‚</p><hr><h3 id="ç®€å•ç¤ºä¾‹-3ï¼šè‡ªå®šä¹‰æ•°å­¦è¿ç®—"><a href="#ç®€å•ç¤ºä¾‹-3ï¼šè‡ªå®šä¹‰æ•°å­¦è¿ç®—" class="headerlink" title="ç®€å•ç¤ºä¾‹ 3ï¼šè‡ªå®šä¹‰æ•°å­¦è¿ç®—"></a><strong>ç®€å•ç¤ºä¾‹ 3ï¼šè‡ªå®šä¹‰æ•°å­¦è¿ç®—</strong></h3><h4 id="æ™®é€šåŠ æ³•"><a href="#æ™®é€šåŠ æ³•" class="headerlink" title="æ™®é€šåŠ æ³•"></a><strong>æ™®é€šåŠ æ³•</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">class Point(val x: Int, val y: Int) &#123;</span><br><span class="line">    fun add(other: Point): Point &#123;</span><br><span class="line">        return Point(this.x + other.x, this.y + other.y)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun main() &#123;</span><br><span class="line">    val p1 = Point(2, 3)</span><br><span class="line">    val p2 = Point(4, 5)</span><br><span class="line">    val result = p1.add(p2)</span><br><span class="line"></span><br><span class="line">    println(&quot;($&#123;result.x&#125;, $&#123;result.y&#125;)&quot;) // è¾“å‡ºï¼š(6, 8)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h4 id="ä½¿ç”¨-infix-2"><a href="#ä½¿ç”¨-infix-2" class="headerlink" title="ä½¿ç”¨ infix"></a><strong>ä½¿ç”¨ <code>infix</code></strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">class Point(val x: Int, val y: Int) &#123;</span><br><span class="line">    infix fun add(other: Point): Point &#123;</span><br><span class="line">        return Point(this.x + other.x, this.y + other.y)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun main() &#123;</span><br><span class="line">    val p1 = Point(2, 3)</span><br><span class="line">    val p2 = Point(4, 5)</span><br><span class="line">    val result = p1 add p2  // ğŸ‘ˆ é‡ç‚¹ï¼šä¸éœ€è¦ `.` å’Œ `()` äº†ï¼</span><br><span class="line"></span><br><span class="line">    println(&quot;($&#123;result.x&#125;, $&#123;result.y&#125;)&quot;) // è¾“å‡ºï¼š(6, 8)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>âœ… <code>p1 add p2</code> <strong>æ¯” <code>p1.add(p2)</code> æ›´åƒæ•°å­¦å…¬å¼</strong>ï¼Œå¯è¯»æ€§æ›´å¼ºã€‚</p><h4 id="é”™è¯¯ç¤ºèŒƒ"><a href="#é”™è¯¯ç¤ºèŒƒ" class="headerlink" title="é”™è¯¯ç¤ºèŒƒ"></a>é”™è¯¯ç¤ºèŒƒ</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">class Point(val x: Int, val y: Int) &#123;</span><br><span class="line">    infix fun Point.add(other: Point): Point &#123; //å’Œæ­£ç¡®ä¾‹å­å”¯ä¸€å·®åˆ«å°±æ˜¯è¿™ä¸€è¡Œ</span><br><span class="line">        return Point(this.x + other.x, this.y + other.y)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun main() &#123;</span><br><span class="line">    val p1 = Point(2, 3)</span><br><span class="line">    val p2 = Point(4, 5)</span><br><span class="line">    val result = p1 add p2  // ğŸ‘ˆ é‡ç‚¹ï¼šä¸éœ€è¦ . å’Œ () äº†ï¼</span><br><span class="line"></span><br><span class="line">    println(&quot;($&#123;result.x&#125;, $&#123;result.y&#125;)&quot;) // è¾“å‡ºï¼š(6, 8)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> <strong>ä¸èƒ½ç¼–è¯‘</strong>ï¼Œæ˜¯å› ä¸º <strong>infix å‡½æ•°ä¸èƒ½åœ¨ç±»å†…éƒ¨å¯¹è‡ªèº«ç±»å‹ï¼ˆ<code>Point</code>ï¼‰æ‰©å±•</strong>ã€‚</p><hr><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h3><ol><li><strong><code>infix</code> è®©ä»£ç æ›´åƒè‡ªç„¶è¯­è¨€ï¼Œå¢å¼ºå¯è¯»æ€§</strong>ã€‚</li><li><strong>åªèƒ½ç”¨äº</strong>ï¼š<ul><li><strong>ç±»çš„æˆå‘˜å‡½æ•°</strong>ï¼ˆå¦‚ <code>Point</code> é‡Œçš„ <code>add</code>ï¼‰ã€‚</li><li><strong>æ‰©å±•å‡½æ•°</strong>ï¼ˆå¦‚ <code>String.with()</code>ï¼‰ã€‚</li><li><strong>ä¸”åªæ¥å—ä¸€ä¸ªå‚æ•°</strong>ã€‚</li></ul></li><li><strong>è°ƒç”¨æ—¶å¯ä»¥çœç•¥ <code>.</code> å’Œ <code>()</code></strong>ï¼Œè®©ä»£ç æ›´æµç•…ã€‚</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Kotlinè¯­æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Glideçš„åŸºæœ¬ç”¨æ³•</title>
      <link href="/2025/03/24/Glide%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95-%E4%B8%80/"/>
      <url>/2025/03/24/Glide%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95-%E4%B8%80/</url>
      
        <content type="html"><![CDATA[<p><a href="http://blog.csdn.net/guolin_blog/article/details/53759439">Glideç”¨æ³•ä¸€</a></p><p><a href="http://blog.csdn.net/guolin_blog/article/details/53939176">Glideç”¨æ³•äºŒ</a></p><p><a href="http://blog.csdn.net/guolin_blog/article/details/54895665">Glideç”¨æ³•ä¸‰</a></p><p><a href="http://blog.csdn.net/guolin_blog/article/details/70215985">Glideç”¨æ³•å››</a></p><p><a href="http://blog.csdn.net/guolin_blog/article/details/71524668">Glideç”¨æ³•äº”</a></p><p><a href="http://blog.csdn.net/guolin_blog/article/details/72866313">Glideç”¨æ³•å…­</a></p><p><a href="http://blog.csdn.net/guolin_blog/article/details/78357251">Glideç”¨æ³•ä¸ƒ</a></p><p><a href="http://blog.csdn.net/guolin_blog/article/details/78582548">Glideç”¨æ³•å…«</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“çŸ¥è¯†ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android Bitmap.createBitmap()ç”¨æ³•ç¤ºä¾‹</title>
      <link href="/2025/03/24/Android-Bitmap-createBitmap-%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B/"/>
      <url>/2025/03/24/Android-Bitmap-createBitmap-%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="Android-Bitmap-createBitmap-ç”¨æ³•å…¨è§£æ"><a href="#Android-Bitmap-createBitmap-ç”¨æ³•å…¨è§£æ" class="headerlink" title="Android Bitmap.createBitmap() ç”¨æ³•å…¨è§£æ"></a>Android Bitmap.createBitmap() ç”¨æ³•å…¨è§£æ</h1><p>åœ¨ Android å¼€å‘ä¸­ï¼Œ<code>Bitmap.createBitmap()</code> æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„æ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥ <strong>åˆ›å»ºæ–°çš„ä½å›¾</strong>ï¼Œå¹¶ä¸”å¯ä»¥ <strong>è¿›è¡Œæ—‹è½¬ã€ç¼©æ”¾ã€å¹³ç§»ã€é•œåƒç¿»è½¬ã€è£å‰ªç­‰æ“ä½œ</strong>ã€‚æœ¬ç¯‡æ–‡ç« å°†è¯¦ç»†ä»‹ç» <code>Bitmap.createBitmap()</code> çš„å„ç§ç”¨æ³•ã€‚</p><hr><h2 id="1-Bitmap-createBitmap-åŸºç¡€ç”¨æ³•"><a href="#1-Bitmap-createBitmap-åŸºç¡€ç”¨æ³•" class="headerlink" title="1. Bitmap.createBitmap() åŸºç¡€ç”¨æ³•"></a>1. <code>Bitmap.createBitmap()</code> åŸºç¡€ç”¨æ³•</h2><h3 id="1-1-åˆ›å»ºä¸€ä¸ªç©ºç™½-Bitmap"><a href="#1-1-åˆ›å»ºä¸€ä¸ªç©ºç™½-Bitmap" class="headerlink" title="1.1 åˆ›å»ºä¸€ä¸ªç©ºç™½ Bitmap"></a><strong>1.1 åˆ›å»ºä¸€ä¸ªç©ºç™½ Bitmap</strong></h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> bitmap = Bitmap.createBitmap(width, height, Bitmap.Config.ARGB_8888)</span><br></pre></td></tr></table></figure><ul><li><code>width</code>ï¼šBitmap çš„å®½åº¦ã€‚</li><li><code>height</code>ï¼šBitmap çš„é«˜åº¦ã€‚</li><li><code>Bitmap.Config.ARGB_8888</code>ï¼šåƒç´ æ ¼å¼ï¼Œæ”¯æŒé€æ˜åº¦ã€‚</li></ul><blockquote><p><strong>ç”¨é€”</strong>ï¼šç”¨äºåˆ›å»ºç©ºç™½çš„ <code>Bitmap</code>ï¼Œç„¶åé€šè¿‡ <code>Canvas</code> è¿›è¡Œç»˜åˆ¶ã€‚</p></blockquote><hr><h2 id="2-æ—‹è½¬ï¼ˆRotateï¼‰"><a href="#2-æ—‹è½¬ï¼ˆRotateï¼‰" class="headerlink" title="2. æ—‹è½¬ï¼ˆRotateï¼‰"></a>2. æ—‹è½¬ï¼ˆRotateï¼‰</h2><p>å¦‚æœæ‹ç…§åçš„å›¾ç‰‡æ–¹å‘ä¸æ­£ç¡®ï¼Œå¯ä»¥ä½¿ç”¨ <code>Matrix</code> è¿›è¡Œæ—‹è½¬ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">rotateBitmap</span><span class="params">(bitmap: <span class="type">Bitmap</span>, degree: <span class="type">Int</span>)</span></span>: Bitmap &#123;</span><br><span class="line">    <span class="keyword">val</span> matrix = Matrix()</span><br><span class="line">    matrix.postRotate(degree.toFloat()) <span class="comment">// æ—‹è½¬ degree åº¦</span></span><br><span class="line">    <span class="keyword">return</span> Bitmap.createBitmap(bitmap, <span class="number">0</span>, <span class="number">0</span>, bitmap.width, bitmap.height, matrix, <span class="literal">true</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>postRotate(degree)</code>ï¼šå°†å›¾ç‰‡æ—‹è½¬æŒ‡å®šè§’åº¦ã€‚</li></ul><p><strong>ç¤ºä¾‹ï¼šæ—‹è½¬ 90 åº¦</strong></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> rotatedBitmap = rotateBitmap(originalBitmap, <span class="number">90</span>)</span><br></pre></td></tr></table></figure><hr><h2 id="3-ç¼©æ”¾ï¼ˆScaleï¼‰"><a href="#3-ç¼©æ”¾ï¼ˆScaleï¼‰" class="headerlink" title="3. ç¼©æ”¾ï¼ˆScaleï¼‰"></a>3. ç¼©æ”¾ï¼ˆScaleï¼‰</h2><p>å¦‚æœæƒ³è¦è°ƒæ•´å›¾ç‰‡å¤§å°ï¼Œå¯ä»¥ä½¿ç”¨ <code>postScale()</code>ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">scaleBitmap</span><span class="params">(bitmap: <span class="type">Bitmap</span>, sx: <span class="type">Float</span>, sy: <span class="type">Float</span>)</span></span>: Bitmap &#123;</span><br><span class="line">    <span class="keyword">val</span> matrix = Matrix()</span><br><span class="line">    matrix.postScale(sx, sy) <span class="comment">// è®¾ç½®ç¼©æ”¾æ¯”ä¾‹</span></span><br><span class="line">    <span class="keyword">return</span> Bitmap.createBitmap(bitmap, <span class="number">0</span>, <span class="number">0</span>, bitmap.width, bitmap.height, matrix, <span class="literal">true</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ï¼šç¼©å° 50%</strong></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> scaledBitmap = scaleBitmap(originalBitmap, <span class="number">0.5f</span>, <span class="number">0.5f</span>)</span><br></pre></td></tr></table></figure><hr><h2 id="4-å¹³ç§»ï¼ˆTranslateï¼‰"><a href="#4-å¹³ç§»ï¼ˆTranslateï¼‰" class="headerlink" title="4. å¹³ç§»ï¼ˆTranslateï¼‰"></a>4. å¹³ç§»ï¼ˆTranslateï¼‰</h2><p>å¯ä»¥ä½¿ç”¨ <code>postTranslate()</code> æ¥ç§»åŠ¨ <code>Bitmap</code> ä½ç½®ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">translateBitmap</span><span class="params">(bitmap: <span class="type">Bitmap</span>, dx: <span class="type">Float</span>, dy: <span class="type">Float</span>)</span></span>: Bitmap &#123;</span><br><span class="line">    <span class="keyword">val</span> matrix = Matrix()</span><br><span class="line">    matrix.postTranslate(dx, dy) <span class="comment">// X æ–¹å‘å³ç§» dxï¼ŒY æ–¹å‘ä¸‹ç§» dy</span></span><br><span class="line">    <span class="keyword">return</span> Bitmap.createBitmap(bitmap, <span class="number">0</span>, <span class="number">0</span>, bitmap.width, bitmap.height, matrix, <span class="literal">true</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ï¼šå³ç§» 50pxï¼Œä¸‹ç§» 100px</strong></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> translatedBitmap = translateBitmap(originalBitmap, <span class="number">50f</span>, <span class="number">100f</span>)</span><br></pre></td></tr></table></figure><hr><h2 id="5-é•œåƒç¿»è½¬ï¼ˆFlipï¼‰"><a href="#5-é•œåƒç¿»è½¬ï¼ˆFlipï¼‰" class="headerlink" title="5. é•œåƒç¿»è½¬ï¼ˆFlipï¼‰"></a>5. é•œåƒç¿»è½¬ï¼ˆFlipï¼‰</h2><h3 id="5-1-å·¦å³ç¿»è½¬ï¼ˆæ°´å¹³é•œåƒï¼‰"><a href="#5-1-å·¦å³ç¿»è½¬ï¼ˆæ°´å¹³é•œåƒï¼‰" class="headerlink" title="5.1 å·¦å³ç¿»è½¬ï¼ˆæ°´å¹³é•œåƒï¼‰"></a><strong>5.1 å·¦å³ç¿»è½¬ï¼ˆæ°´å¹³é•œåƒï¼‰</strong></h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">flipHorizontal</span><span class="params">(bitmap: <span class="type">Bitmap</span>)</span></span>: Bitmap &#123;</span><br><span class="line">    <span class="keyword">val</span> matrix = Matrix()</span><br><span class="line">    matrix.postScale(-<span class="number">1f</span>, <span class="number">1f</span>) <span class="comment">// æ°´å¹³æ–¹å‘é•œåƒ</span></span><br><span class="line">    <span class="keyword">return</span> Bitmap.createBitmap(bitmap, <span class="number">0</span>, <span class="number">0</span>, bitmap.width, bitmap.height, matrix, <span class="literal">true</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-2-ä¸Šä¸‹ç¿»è½¬ï¼ˆå‚ç›´é•œåƒï¼‰"><a href="#5-2-ä¸Šä¸‹ç¿»è½¬ï¼ˆå‚ç›´é•œåƒï¼‰" class="headerlink" title="5.2 ä¸Šä¸‹ç¿»è½¬ï¼ˆå‚ç›´é•œåƒï¼‰"></a><strong>5.2 ä¸Šä¸‹ç¿»è½¬ï¼ˆå‚ç›´é•œåƒï¼‰</strong></h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">flipVertical</span><span class="params">(bitmap: <span class="type">Bitmap</span>)</span></span>: Bitmap &#123;</span><br><span class="line">    <span class="keyword">val</span> matrix = Matrix()</span><br><span class="line">    matrix.postScale(<span class="number">1f</span>, -<span class="number">1f</span>) <span class="comment">// å‚ç›´æ–¹å‘é•œåƒ</span></span><br><span class="line">    <span class="keyword">return</span> Bitmap.createBitmap(bitmap, <span class="number">0</span>, <span class="number">0</span>, bitmap.width, bitmap.height, matrix, <span class="literal">true</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ï¼šå·¦å³ç¿»è½¬</strong></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> flippedBitmap = flipHorizontal(originalBitmap)</span><br></pre></td></tr></table></figure><hr><h2 id="6-è£å‰ªï¼ˆCropï¼‰"><a href="#6-è£å‰ªï¼ˆCropï¼‰" class="headerlink" title="6. è£å‰ªï¼ˆCropï¼‰"></a>6. è£å‰ªï¼ˆCropï¼‰</h2><p>å¦‚æœåªæƒ³æˆªå– <code>Bitmap</code> çš„ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥ä½¿ç”¨ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">cropBitmap</span><span class="params">(bitmap: <span class="type">Bitmap</span>, x: <span class="type">Int</span>, y: <span class="type">Int</span>, width: <span class="type">Int</span>, height: <span class="type">Int</span>)</span></span>: Bitmap &#123;</span><br><span class="line">    <span class="keyword">return</span> Bitmap.createBitmap(bitmap, x, y, width, height)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ï¼šä» (50,50) å¼€å§‹ï¼Œè£å‰ª 200x200 åŒºåŸŸ</strong></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> croppedBitmap = cropBitmap(originalBitmap, <span class="number">50</span>, <span class="number">50</span>, <span class="number">200</span>, <span class="number">200</span>)</span><br></pre></td></tr></table></figure><hr><h2 id="7-ç»¼åˆå˜æ¢ï¼šæ—‹è½¬-ç¼©æ”¾-å¹³ç§»"><a href="#7-ç»¼åˆå˜æ¢ï¼šæ—‹è½¬-ç¼©æ”¾-å¹³ç§»" class="headerlink" title="7. ç»¼åˆå˜æ¢ï¼šæ—‹è½¬ + ç¼©æ”¾ + å¹³ç§»"></a>7. ç»¼åˆå˜æ¢ï¼šæ—‹è½¬ + ç¼©æ”¾ + å¹³ç§»</h2><p>å¯ä»¥ç»„åˆå¤šä¸ªå˜æ¢ï¼Œæ¯”å¦‚ <strong>å…ˆæ—‹è½¬ 45Â°ï¼Œå†ç¼©å° 80%ï¼Œç„¶åå¹³ç§»</strong>ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">transformBitmap</span><span class="params">(bitmap: <span class="type">Bitmap</span>)</span></span>: Bitmap &#123;</span><br><span class="line">    <span class="keyword">val</span> matrix = Matrix()</span><br><span class="line">    matrix.postRotate(<span class="number">45f</span>)      <span class="comment">// æ—‹è½¬ 45 åº¦</span></span><br><span class="line">    matrix.postScale(<span class="number">0.8f</span>, <span class="number">0.8f</span>) <span class="comment">// ç¼©å° 80%</span></span><br><span class="line">    matrix.postTranslate(<span class="number">100f</span>, <span class="number">50f</span>) <span class="comment">// å³ç§» 100ï¼Œä¸‹ç§» 50</span></span><br><span class="line">    <span class="keyword">return</span> Bitmap.createBitmap(bitmap, <span class="number">0</span>, <span class="number">0</span>, bitmap.width, bitmap.height, matrix, <span class="literal">true</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ï¼šåº”ç”¨ç»„åˆå˜æ¢</strong></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> transformedBitmap = transformBitmap(originalBitmap)</span><br></pre></td></tr></table></figure><hr><h2 id="8-æ€»ç»“"><a href="#8-æ€»ç»“" class="headerlink" title="8. æ€»ç»“"></a>8. æ€»ç»“</h2><table><thead><tr><th>æ“ä½œ</th><th>æ–¹æ³•</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><strong>åˆ›å»ºç©ºç™½ Bitmap</strong></td><td><code>Bitmap.createBitmap(width, height, config)</code></td><td><code>Bitmap.createBitmap(200, 200, Bitmap.Config.ARGB_8888)</code></td></tr><tr><td><strong>æ—‹è½¬</strong></td><td><code>postRotate(degree)</code></td><td><code>postRotate(90f)</code></td></tr><tr><td><strong>ç¼©æ”¾</strong></td><td><code>postScale(sx, sy)</code></td><td><code>postScale(0.5f, 0.5f)</code></td></tr><tr><td><strong>å¹³ç§»</strong></td><td><code>postTranslate(dx, dy)</code></td><td><code>postTranslate(50f, 100f)</code></td></tr><tr><td><strong>æ°´å¹³ç¿»è½¬</strong></td><td><code>postScale(-1f, 1f)</code></td><td><code>postScale(-1f, 1f)</code></td></tr><tr><td><strong>å‚ç›´ç¿»è½¬</strong></td><td><code>postScale(1f, -1f)</code></td><td><code>postScale(1f, -1f)</code></td></tr><tr><td><strong>è£å‰ª</strong></td><td><code>Bitmap.createBitmap(bitmap, x, y, w, h)</code></td><td><code>Bitmap.createBitmap(bitmap, 50, 50, 200, 200)</code></td></tr></tbody></table><h3 id="ğŸ“Œ-ç»“è®ºï¼š"><a href="#ğŸ“Œ-ç»“è®ºï¼š" class="headerlink" title="ğŸ“Œ ç»“è®ºï¼š"></a><strong>ğŸ“Œ ç»“è®ºï¼š</strong></h3><p><code>Bitmap.createBitmap()</code> <strong>ä¸ä»…èƒ½åˆ›å»º Bitmapï¼Œè¿˜èƒ½æ—‹è½¬ã€ç¼©æ”¾ã€å¹³ç§»ã€é•œåƒç¿»è½¬ã€è£å‰ªï¼Œå‡ ä¹æ‰€æœ‰å›¾ç‰‡å˜æ¢éƒ½å¯ä»¥æå®šï¼</strong> ğŸš€</p><p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®ä½ æ›´å¥½åœ°ç†è§£ <code>Bitmap.createBitmap()</code> çš„ä½¿ç”¨ï¼ ğŸ˜Š</p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“çŸ¥è¯†ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é€šçŸ¥çš„ç”¨æ³•ç¤ºä¾‹</title>
      <link href="/2025/03/24/%E9%80%9A%E7%9F%A5%E7%9A%84%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B/"/>
      <url>/2025/03/24/%E9%80%9A%E7%9F%A5%E7%9A%84%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="Android-é€šçŸ¥ï¼ˆNotificationï¼‰å®Œå…¨æŒ‡å—"><a href="#Android-é€šçŸ¥ï¼ˆNotificationï¼‰å®Œå…¨æŒ‡å—" class="headerlink" title="Android é€šçŸ¥ï¼ˆNotificationï¼‰å®Œå…¨æŒ‡å—"></a><strong>Android é€šçŸ¥ï¼ˆNotificationï¼‰å®Œå…¨æŒ‡å—</strong></h2><p><strong>è®°å¾—åœ¨æµ‹è¯•APPçš„é€šçŸ¥åŠŸèƒ½æ—¶ï¼Œè¦åœ¨æ‰‹æœºä¸ŠæŠŠå…³äºé€šçŸ¥çš„æƒé™æ‰“å¼€!!!</strong></p><h3 id="1-é€šçŸ¥çš„ä½œç”¨"><a href="#1-é€šçŸ¥çš„ä½œç”¨" class="headerlink" title="1. é€šçŸ¥çš„ä½œç”¨"></a><strong>1. é€šçŸ¥çš„ä½œç”¨</strong></h3><ul><li><strong>ç”¨æˆ·æç¤º</strong>ï¼šå‘ŠçŸ¥ç”¨æˆ·é‡è¦äº‹ä»¶ï¼Œå¦‚æ–°æ¶ˆæ¯ã€ä¸‹è½½è¿›åº¦ç­‰ã€‚</li><li><strong>äº¤äº’å…¥å£</strong>ï¼šç”¨æˆ·ç‚¹å‡»é€šçŸ¥å¯è·³è½¬è‡³åº”ç”¨çš„ç‰¹å®šé¡µé¢ã€‚</li><li><strong>æŒç»­å±•ç¤º</strong>ï¼šæŸäº›é€šçŸ¥éœ€è¦å¸¸é©»çŠ¶æ€æ ï¼Œå¦‚åå°ä»»åŠ¡æé†’ã€‚</li></ul><hr><h3 id="2-å…³é”®ç»„ä»¶"><a href="#2-å…³é”®ç»„ä»¶" class="headerlink" title="2. å…³é”®ç»„ä»¶"></a><strong>2. å…³é”®ç»„ä»¶</strong></h3><ul><li><strong>NotificationManager</strong>ï¼šç®¡ç†é€šçŸ¥çš„å‘å¸ƒã€æ›´æ–°ã€å–æ¶ˆã€‚</li><li><strong>NotificationCompat.Builder</strong>ï¼šæ„å»ºé€šçŸ¥ï¼Œç¡®ä¿å…¼å®¹ä½ç‰ˆæœ¬ Androidã€‚</li><li><strong>NotificationChannelï¼ˆAndroid 8.0+ï¼‰</strong>ï¼šç®¡ç†é€šçŸ¥çš„é‡è¦æ€§ã€å£°éŸ³ã€éœ‡åŠ¨ç­‰ã€‚</li><li><strong>PendingIntent</strong>ï¼šè®¾å®šç”¨æˆ·ç‚¹å‡»é€šçŸ¥åçš„æ“ä½œã€‚</li></ul><hr><h3 id="3-åˆ›å»ºé€šçŸ¥"><a href="#3-åˆ›å»ºé€šçŸ¥" class="headerlink" title="3. åˆ›å»ºé€šçŸ¥"></a><strong>3. åˆ›å»ºé€šçŸ¥</strong></h3><h4 id="3-0-æƒé™"><a href="#3-0-æƒé™" class="headerlink" title="3.0 æƒé™"></a><strong>3.0 æƒé™</strong></h4><p>åœ¨ <strong>AndroidManifest.xml</strong> æ·»åŠ æƒé™ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.POST_NOTIFICATIONS&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-1-åˆ›å»ºé€šçŸ¥é¢‘é“ï¼ˆAndroid-8-0-å¿…é¡»ï¼‰"><a href="#3-1-åˆ›å»ºé€šçŸ¥é¢‘é“ï¼ˆAndroid-8-0-å¿…é¡»ï¼‰" class="headerlink" title="3.1 åˆ›å»ºé€šçŸ¥é¢‘é“ï¼ˆAndroid 8.0+ å¿…é¡»ï¼‰"></a><strong>3.1 åˆ›å»ºé€šçŸ¥é¢‘é“ï¼ˆAndroid 8.0+ å¿…é¡»ï¼‰</strong></h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O) &#123;</span><br><span class="line">    <span class="keyword">val</span> channelId = <span class="string">&quot;channel_id_example&quot;</span></span><br><span class="line">    <span class="keyword">val</span> channelName = <span class="string">&quot;é€šçŸ¥é¢‘é“&quot;</span></span><br><span class="line">    <span class="keyword">val</span> importance = NotificationManager.IMPORTANCE_DEFAULT</span><br><span class="line">    <span class="keyword">val</span> channel = NotificationChannel(channelId, channelName, importance).apply &#123;</span><br><span class="line">        description = <span class="string">&quot;è¿™ä¸ªé¢‘é“ç”¨äºæ™®é€šé€šçŸ¥&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*val notificationManager = getSystemService(Context.NOTIFICATION_SERVICE) as NotificationManagerè¿™ä¸ªå†™æ³•å’Œä¸‹é¢ä¸€è¡Œæœ¬è´¨ä¸€æ ·çš„ï¼Œä¸‹é¢çš„æ›´ç®€æ´å®‰å…¨ï¼Œä¸Šé¢çš„èƒ½å…¼å®¹æ—§ç‰ˆæœ¬(é€‚ç”¨API22ä»¥åŠæ›´æ—©ç‰ˆæœ¬)*/</span></span><br><span class="line">    <span class="keyword">val</span> notificationManager = getSystemService(NotificationManager::<span class="keyword">class</span>.java)</span><br><span class="line">    notificationManager.createNotificationChannel(channel)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-2-å‘é€åŸºç¡€é€šçŸ¥"><a href="#3-2-å‘é€åŸºç¡€é€šçŸ¥" class="headerlink" title="3.2 å‘é€åŸºç¡€é€šçŸ¥"></a><strong>3.2 å‘é€åŸºç¡€é€šçŸ¥</strong></h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> channelId = <span class="string">&quot;channel_id_example&quot;</span></span><br><span class="line"><span class="keyword">val</span> builder = NotificationCompat.Builder(<span class="keyword">this</span>, channelId)</span><br><span class="line">    .setSmallIcon(R.drawable.ic_notification)</span><br><span class="line">    .setContentTitle(<span class="string">&quot;é€šçŸ¥æ ‡é¢˜&quot;</span>)</span><br><span class="line">    .setContentText(<span class="string">&quot;é€šçŸ¥å†…å®¹&quot;</span>)</span><br><span class="line">    .setPriority(NotificationCompat.PRIORITY_DEFAULT)</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> notificationManager = getSystemService(Context.NOTIFICATION_SERVICE) <span class="keyword">as</span> NotificationManager</span><br><span class="line">notificationManager.notify(<span class="number">1</span>, builder.build())<span class="comment">/*é€šè¿‡ NotificationManager æ˜¾ç¤ºé€šçŸ¥ã€‚1 ä½œä¸ºé€šçŸ¥çš„ å”¯ä¸€ IDï¼Œç”¨äºæ ‡è¯†å’Œæ›´æ–°/å–æ¶ˆç‰¹å®šé€šçŸ¥ã€‚builder.build() æ„å»ºé€šçŸ¥å¯¹è±¡ å¹¶å‘é€ã€‚*/</span></span><br></pre></td></tr></table></figure><hr><h3 id="4-æ·»åŠ äº¤äº’ï¼ˆPendingIntentï¼‰"><a href="#4-æ·»åŠ äº¤äº’ï¼ˆPendingIntentï¼‰" class="headerlink" title="4. æ·»åŠ äº¤äº’ï¼ˆPendingIntentï¼‰"></a><strong>4. æ·»åŠ äº¤äº’ï¼ˆPendingIntentï¼‰</strong></h3><h4 id="4-1-ç‚¹å‡»é€šçŸ¥è·³è½¬åˆ°-Activity"><a href="#4-1-ç‚¹å‡»é€šçŸ¥è·³è½¬åˆ°-Activity" class="headerlink" title="4.1 ç‚¹å‡»é€šçŸ¥è·³è½¬åˆ° Activity"></a><strong>4.1 ç‚¹å‡»é€šçŸ¥è·³è½¬åˆ° Activity</strong></h4><p>åˆ›å»ºä¸€ä¸ª <code>TargetActivity</code> ä½œä¸ºè·³è½¬ç›®æ ‡ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TargetActivity</span> : <span class="type">AppCompatActivity</span>() &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_target)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹é€šçŸ¥ä»£ç ï¼Œæ·»åŠ  <code>PendingIntent</code>ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> intent = Intent(<span class="keyword">this</span>, TargetActivity::<span class="keyword">class</span>.java)</span><br><span class="line"><span class="keyword">val</span> pendingIntent = PendingIntent.getActivity(</span><br><span class="line">    <span class="keyword">this</span>, <span class="number">0</span>, intent, PendingIntent.FLAG_UPDATE_CURRENT or PendingIntent.FLAG_IMMUTABLE</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> builder = NotificationCompat.Builder(<span class="keyword">this</span>, channelId)</span><br><span class="line">    .setSmallIcon(R.drawable.ic_notification)</span><br><span class="line">    .setContentTitle(<span class="string">&quot;ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…&quot;</span>)</span><br><span class="line">    .setContentText(<span class="string">&quot;ç‚¹å‡»æ­¤é€šçŸ¥è·³è½¬åˆ° TargetActivity&quot;</span>)</span><br><span class="line">    .setPriority(NotificationCompat.PRIORITY_DEFAULT)</span><br><span class="line">    .setContentIntent(pendingIntent)</span><br><span class="line">    .setAutoCancel(<span class="literal">true</span>) <span class="comment">// ç”¨æˆ·ç‚¹å‡»åè‡ªåŠ¨æ¸…é™¤é€šçŸ¥</span></span><br><span class="line"></span><br><span class="line">notificationManager.notify(<span class="number">2</span>, builder.build())</span><br></pre></td></tr></table></figure><hr><h3 id="5-ä¸°å¯Œé€šçŸ¥å†…å®¹ï¼ˆsetStyleï¼‰"><a href="#5-ä¸°å¯Œé€šçŸ¥å†…å®¹ï¼ˆsetStyleï¼‰" class="headerlink" title="5. ä¸°å¯Œé€šçŸ¥å†…å®¹ï¼ˆsetStyleï¼‰"></a><strong>5. ä¸°å¯Œé€šçŸ¥å†…å®¹ï¼ˆsetStyleï¼‰</strong></h3><h4 id="5-1-é•¿æ–‡æœ¬é€šçŸ¥ï¼ˆBigTextStyleï¼‰"><a href="#5-1-é•¿æ–‡æœ¬é€šçŸ¥ï¼ˆBigTextStyleï¼‰" class="headerlink" title="5.1 é•¿æ–‡æœ¬é€šçŸ¥ï¼ˆBigTextStyleï¼‰"></a><strong>5.1 é•¿æ–‡æœ¬é€šçŸ¥ï¼ˆBigTextStyleï¼‰</strong></h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">builder.setStyle(NotificationCompat.BigTextStyle()</span><br><span class="line">    .bigText(<span class="string">&quot;è¿™é‡Œæ˜¯è¯¦ç»†çš„é€šçŸ¥å†…å®¹ï¼Œé€‚åˆå±•ç¤ºæ›´å¤šçš„æ–‡å­—ä¿¡æ¯&quot;</span>))</span><br></pre></td></tr></table></figure><h4 id="5-2-å¤§å›¾é€šçŸ¥ï¼ˆBigPictureStyleï¼‰"><a href="#5-2-å¤§å›¾é€šçŸ¥ï¼ˆBigPictureStyleï¼‰" class="headerlink" title="5.2 å¤§å›¾é€šçŸ¥ï¼ˆBigPictureStyleï¼‰"></a><strong>5.2 å¤§å›¾é€šçŸ¥ï¼ˆBigPictureStyleï¼‰</strong></h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> bigPicture = BitmapFactory.decodeResource(resources, R.drawable.big_image)</span><br><span class="line">builder.setStyle(NotificationCompat.BigPictureStyle()</span><br><span class="line">    .bigPicture(bigPicture)</span><br><span class="line">    .setBigContentTitle(<span class="string">&quot;å¤§å›¾é€šçŸ¥&quot;</span>))</span><br></pre></td></tr></table></figure><h4 id="5-3-å¤šæ¡ä¿¡æ¯é€šçŸ¥ï¼ˆInboxStyleï¼‰"><a href="#5-3-å¤šæ¡ä¿¡æ¯é€šçŸ¥ï¼ˆInboxStyleï¼‰" class="headerlink" title="5.3 å¤šæ¡ä¿¡æ¯é€šçŸ¥ï¼ˆInboxStyleï¼‰"></a><strong>5.3 å¤šæ¡ä¿¡æ¯é€šçŸ¥ï¼ˆInboxStyleï¼‰</strong></h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">builder.setStyle(NotificationCompat.InboxStyle()</span><br><span class="line">    .addLine(<span class="string">&quot;ç¬¬ä¸€æ¡ä¿¡æ¯&quot;</span>)</span><br><span class="line">    .addLine(<span class="string">&quot;ç¬¬äºŒæ¡ä¿¡æ¯&quot;</span>)</span><br><span class="line">    .setSummaryText(<span class="string">&quot;å…±2æ¡ä¿¡æ¯&quot;</span>))</span><br></pre></td></tr></table></figure><hr><h3 id="6-é«˜çº§ç”¨æ³•"><a href="#6-é«˜çº§ç”¨æ³•" class="headerlink" title="6. é«˜çº§ç”¨æ³•"></a><strong>6. é«˜çº§ç”¨æ³•</strong></h3><ul><li><strong>è‡ªå®šä¹‰é€šçŸ¥å¸ƒå±€</strong>ï¼šä½¿ç”¨ <code>RemoteViews</code> åˆ›å»ºä¸ªæ€§åŒ–ç•Œé¢ã€‚</li><li><strong>å‰å°æœåŠ¡é€šçŸ¥</strong>ï¼šåå°ä»»åŠ¡è¿è¡Œæ—¶æ˜¾ç¤ºä¸å¯æ¸…é™¤çš„é€šçŸ¥ã€‚</li><li><strong>åˆ†ç»„é€šçŸ¥</strong>ï¼šåˆå¹¶å¤šä¸ªç›¸å…³é€šçŸ¥ï¼Œå‡å°‘å¹²æ‰°ã€‚</li></ul><hr><h3 id="7-é‡è¦æ³¨æ„äº‹é¡¹"><a href="#7-é‡è¦æ³¨æ„äº‹é¡¹" class="headerlink" title="7. é‡è¦æ³¨æ„äº‹é¡¹"></a><strong>7. é‡è¦æ³¨æ„äº‹é¡¹</strong></h3><ul><li><strong>Android 8.0+ å¿…é¡»ä½¿ç”¨ NotificationChannelï¼Œå¦åˆ™é€šçŸ¥ä¸ä¼šæ˜¾ç¤ºã€‚</strong></li><li><strong>ä½¿ç”¨ NotificationCompat ç¡®ä¿ä½ç‰ˆæœ¬ Android å…¼å®¹æ€§ã€‚</strong></li><li><strong>åˆç†ç®¡ç†é€šçŸ¥ï¼Œé¿å…é¢‘ç¹å¼¹å‡ºå½±å“ç”¨æˆ·ä½“éªŒã€‚</strong></li></ul><hr><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h3><p>é€šè¿‡ <strong>NotificationManager</strong> å‘é€é€šçŸ¥ï¼Œä½¿ç”¨ <strong>PendingIntent</strong> å“åº”ç‚¹å‡»æ“ä½œï¼Œå¹¶é€šè¿‡ <strong>setStyle</strong> å¢å¼ºé€šçŸ¥çš„å¯è¯»æ€§å’Œäº¤äº’æ€§ã€‚åœ¨ Android 8.0 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œå¿…é¡»åˆ›å»º <strong>NotificationChannel</strong>ï¼Œç¡®ä¿é€šçŸ¥æ­£å¸¸æ˜¾ç¤ºã€‚ç»“åˆè¿™äº›æŠ€å·§ï¼Œå¯ä»¥æ‰“é€ æ›´ä¼˜é›…ã€å®ç”¨çš„é€šçŸ¥ç³»ç»Ÿã€‚ ğŸš€</p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“çŸ¥è¯†ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ContentProvider+ContentResolver+UriMatcher+SQLiteçš„ç”¨æ³•ç¤ºä¾‹</title>
      <link href="/2025/03/19/ContentProvider-ContentResolver-UriMatcher%E7%9A%84%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B/"/>
      <url>/2025/03/19/ContentProvider-ContentResolver-UriMatcher%E7%9A%84%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="1-å¼•è¨€"><a href="#1-å¼•è¨€" class="headerlink" title="1. å¼•è¨€"></a>1. å¼•è¨€</h2><p>åœ¨ Android ä¸­ï¼Œæ•°æ®å…±äº«æ˜¯åº”ç”¨å¼€å‘ä¸­éå¸¸é‡è¦çš„ä¸€éƒ¨åˆ†ã€‚ä¸ºäº†åœ¨ä¸åŒåº”ç”¨ä¹‹é—´å…±äº«æ•°æ®ï¼ŒAndroid æä¾›äº† <strong>ContentProvider</strong> æœºåˆ¶ï¼Œé€šè¿‡è¯¥æœºåˆ¶ï¼Œåº”ç”¨èƒ½å¤Ÿè®¿é—®å…¶ä»–åº”ç”¨çš„æ•°æ®æˆ–å‘å…¶ä»–åº”ç”¨æä¾›è‡ªå·±çš„æ•°æ®ã€‚ç»“åˆ <strong>SQLite</strong> æ•°æ®åº“ã€<strong>ContentProvider</strong>ã€<strong>ContentResolver</strong> å’Œ <strong>UriMatcher</strong>ï¼Œæˆ‘ä»¬å¯ä»¥æ–¹ä¾¿åœ°å®ç°æ•°æ®çš„æŒä¹…åŒ–å­˜å‚¨ã€æŸ¥è¯¢ã€æ’å…¥ã€æ›´æ–°å’Œåˆ é™¤æ“ä½œï¼ŒåŒæ—¶è¿˜èƒ½å¤Ÿä¿è¯æ•°æ®è®¿é—®çš„å®‰å…¨æ€§ã€‚</p><p>æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•ç»“åˆ <strong>SQLite</strong> æ•°æ®åº“ã€<strong>ContentProvider</strong>ã€<strong>ContentResolver</strong> å’Œ <strong>UriMatcher</strong> å®ç°ä¸€ä¸ªå®Œæ•´çš„åº”ç”¨æ•°æ®å…±äº«ç³»ç»Ÿï¼Œå¹¶é€šè¿‡ä¸€ä¸ªå…·ä½“çš„ç¤ºä¾‹è¿›è¡Œè¯¦ç»†è¯´æ˜ã€‚</p><h2 id="2-åŸºæœ¬æ¦‚å¿µ"><a href="#2-åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="2. åŸºæœ¬æ¦‚å¿µ"></a>2. åŸºæœ¬æ¦‚å¿µ</h2><h3 id="2-1-SQLite-æ•°æ®åº“"><a href="#2-1-SQLite-æ•°æ®åº“" class="headerlink" title="2.1 SQLite æ•°æ®åº“"></a>2.1 SQLite æ•°æ®åº“</h3><p>SQLite æ˜¯ Android ä¸­æ¨èçš„æœ¬åœ°æ•°æ®åº“ï¼Œå®ƒæ˜¯ä¸€ä¸ªè½»é‡çº§çš„å…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€‚SQLite å¯ä»¥åµŒå…¥åˆ°åº”ç”¨ä¸­ï¼Œæ”¯æŒ SQL æŸ¥è¯¢ã€æ•°æ®æŒä¹…åŒ–å­˜å‚¨ã€‚</p><ul><li><strong>ä¼˜ç‚¹</strong>ï¼šå¼€é”€å°ã€æ— éœ€æœåŠ¡å™¨ï¼Œé€‚åˆå•æœºåº”ç”¨ã€‚</li><li><strong>ç¼ºç‚¹</strong>ï¼šåŠŸèƒ½ç›¸å¯¹è¾ƒç®€å•ï¼Œé€‚ç”¨äºå°å‹åº”ç”¨å’Œä¸­å°è§„æ¨¡çš„æ•°æ®å­˜å‚¨ã€‚</li></ul><h3 id="2-2-ContentProvider"><a href="#2-2-ContentProvider" class="headerlink" title="2.2 ContentProvider"></a>2.2 ContentProvider</h3><p>ContentProvider æ˜¯ä¸€ä¸ªæä¾›æ•°æ®å­˜å–æ¥å£çš„ç»„ä»¶ã€‚å®ƒå…è®¸ä¸åŒçš„åº”ç”¨å…±äº«æ•°æ®ï¼Œæ”¯æŒè·¨è¿›ç¨‹è°ƒç”¨å’Œè·¨åº”ç”¨è®¿é—®ã€‚ContentProvider é€šè¿‡ URIï¼ˆç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼‰æ¥æ ‡è¯†æ•°æ®èµ„æºï¼Œå¹¶é€šè¿‡ SQL æŸ¥è¯¢æ“ä½œæ¥å¤„ç†æ•°æ®ã€‚</p><ul><li><strong>æ–¹æ³•</strong>ï¼š<code>query()</code>ã€<code>insert()</code>ã€<code>update()</code>ã€<code>delete()</code>ã€<code>getType()</code> ç­‰ã€‚</li><li><strong>ä½œç”¨</strong>ï¼šæä¾›ç»Ÿä¸€çš„æ¥å£ï¼Œå…è®¸ä¸åŒåº”ç”¨ä¹‹é—´å…±äº«æ•°æ®ï¼Œé¿å…ç›´æ¥æš´éœ²å†…éƒ¨æ•°æ®åº“ç»“æ„ã€‚</li></ul><h3 id="2-3-ContentResolver"><a href="#2-3-ContentResolver" class="headerlink" title="2.3 ContentResolver"></a>2.3 ContentResolver</h3><p>ContentResolver æ˜¯ä¸€ä¸ªè®¿é—® ContentProvider çš„æ¥å£ã€‚é€šè¿‡ ContentResolverï¼Œæˆ‘ä»¬å¯ä»¥å‘ ContentProvider å‘èµ·æŸ¥è¯¢ã€æ’å…¥ã€æ›´æ–°å’Œåˆ é™¤æ“ä½œã€‚</p><ul><li><strong>æ–¹æ³•</strong>ï¼š<code>query()</code>ã€<code>insert()</code>ã€<code>update()</code>ã€<code>delete()</code> ç­‰ã€‚</li><li><strong>ä½œç”¨</strong>ï¼šé€šè¿‡ ContentResolverï¼Œåº”ç”¨å¯ä»¥æ“ä½œ ContentProvider ä¸­çš„æ•°æ®ï¼Œä¸éœ€è¦çŸ¥é“æ•°æ®å­˜å‚¨çš„å…·ä½“å®ç°ç»†èŠ‚ã€‚</li><li><a href="https://goshenc.github.io/2025/03/17/ContentResolver%E7%9A%84%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5%E6%96%B9%E6%B3%95%E7%A4%BA%E4%BE%8B/">ContentResolverçš„å¢åˆ æ”¹æŸ¥æ–¹æ³•ç¤ºä¾‹ | GoshenC</a></li></ul><h3 id="2-4-UriMatcher"><a href="#2-4-UriMatcher" class="headerlink" title="2.4 UriMatcher"></a>2.4 UriMatcher</h3><p>UriMatcher æ˜¯ä¸€ä¸ªå¸®åŠ© ContentProvider åŒ¹é… URI çš„å·¥å…·ï¼Œå®ƒæ ¹æ® URI çš„è·¯å¾„æ¥åˆ¤æ–­è¿›è¡Œæ“ä½œçš„æ•°æ®è¡¨æˆ–è€…æ•°æ®é¡¹ã€‚é€šè¿‡ UriMatcherï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ä¼ å…¥çš„ URI åˆ¤æ–­ç”¨æˆ·è¯·æ±‚çš„æ˜¯æ•´ä¸ªæ•°æ®è¡¨çš„æ•°æ®ï¼Œè¿˜æ˜¯æŸä¸€æ¡ç‰¹å®šçš„æ•°æ®è®°å½•ã€‚</p><ul><li><strong>ä½œç”¨</strong>ï¼šæ ¹æ® URI åŒ¹é…ä¸åŒçš„æ•°æ®å¤„ç†æ“ä½œï¼Œå¸®åŠ© ContentProvider åšå‡ºæ­£ç¡®çš„å“åº”ã€‚</li></ul><h3 id="2-5-æ¦‚å¿µåŠå®ƒä»¬ä¹‹é—´çš„å…³ç³»"><a href="#2-5-æ¦‚å¿µåŠå®ƒä»¬ä¹‹é—´çš„å…³ç³»" class="headerlink" title="2.5 æ¦‚å¿µåŠå®ƒä»¬ä¹‹é—´çš„å…³ç³»"></a>2.5 æ¦‚å¿µåŠå®ƒä»¬ä¹‹é—´çš„å…³ç³»</h3><ul><li><p><strong>ContentProvider</strong></p><ul><li><strong>ä½œç”¨</strong>ï¼šç”¨äºå¯¹å¤–æš´éœ²åº”ç”¨çš„æ•°æ®ï¼ˆä¾‹å¦‚ SQLite æ•°æ®åº“ã€æ–‡ä»¶ç­‰ï¼‰ï¼Œæ”¯æŒè·¨è¿›ç¨‹æˆ–è·¨åº”ç”¨æ•°æ®å…±äº«ã€‚</li><li><strong>å…³é”®æ–¹æ³•</strong>ï¼š<code>onCreate()</code>ï¼ˆåˆå§‹åŒ–ï¼‰ã€<code>query()</code>ã€<code>insert()</code>ã€<code>update()</code>ã€<code>delete()</code>ã€<code>getType()</code>ã€‚</li></ul></li><li><p><strong>UriMatcher</strong></p><ul><li><strong>ä½œç”¨</strong>ï¼šå¸®åŠ© ContentProvider æ ¹æ®ä¼ å…¥çš„ URI åˆ¤æ–­éœ€è¦æ“ä½œçš„æ•°æ®ç±»å‹æˆ–æ•°æ®é›†åˆã€‚</li><li><strong>å·¥ä½œåŸç†</strong>ï¼šé¢„å…ˆæ³¨å†Œä¸€ç³»åˆ— URI æ¨¡å¼ï¼Œæ¯ä¸ªæ¨¡å¼å¯¹åº”ä¸€ä¸ªæ•´æ•°ä»£ç ï¼›åœ¨è¯·æ±‚æ—¶æ ¹æ® URI è¿”å›ç›¸åº”ä»£ç ï¼Œä»¥ä¾¿åœ¨ä»£ç ä¸­è¿›è¡Œåˆ¤æ–­å’Œåˆ†æ”¯å¤„ç†ã€‚</li></ul></li><li><p><strong>ContentResolver</strong></p><ul><li><p><strong>ä½œç”¨</strong>ï¼šä½œä¸ºæ•°æ®è®¿é—®è€…ï¼Œç”±å¤–éƒ¨ï¼ˆæˆ–æœ¬åº”ç”¨å†…å…¶ä»–ç»„ä»¶ï¼‰è°ƒç”¨ï¼Œç”¨äºå‘ ContentProvider å‘é€æ•°æ®æ“ä½œè¯·æ±‚ï¼ˆå¦‚æŸ¥è¯¢ã€æ’å…¥ç­‰ï¼‰ã€‚</p></li><li><p>ä½¿ç”¨æ–¹å¼</p><p>ï¼šç›´æ¥åœ¨ Activityã€Service ç­‰ç»§æ‰¿äº† Context çš„ç»„ä»¶ä¸­è°ƒç”¨ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val cursor = contentResolver.query(uri, projection, selection, selectionArgs, sortOrder)</span><br></pre></td></tr></table></figure></li></ul></li></ul><p>è¿™ä¸‰è€…ä¸€èµ·å·¥ä½œï¼Œå®ç°äº†åº”ç”¨é—´ï¼ˆæˆ–åº”ç”¨å†…ï¼‰çš„æ•°æ®å…±äº«ï¼š</p><ol><li><strong>ContentResolver</strong> å‘èµ·è¯·æ±‚ï¼Œä¼ å…¥ä¸€ä¸ª URIã€‚</li><li><strong>ContentProvider</strong> é€šè¿‡å†…éƒ¨çš„ <strong>UriMatcher</strong> åŒ¹é… URIï¼Œåˆ¤æ–­è¯·æ±‚çš„æ•°æ®ç±»å‹ã€‚</li><li>æ ¹æ®åŒ¹é…ç»“æœï¼Œ<strong>ContentProvider</strong> è°ƒç”¨ç›¸åº”çš„æ•°æ®åº“æ“ä½œï¼Œå¹¶è¿”å›æ•°æ®ï¼ˆCursorã€Uriã€å½±å“è¡Œæ•°ç­‰ï¼‰ã€‚</li></ol><h2 id="3-ä½¿ç”¨-SQLite-ContentProvider-ContentResolver-UriMatcher-å®ç°æ•°æ®å…±äº«"><a href="#3-ä½¿ç”¨-SQLite-ContentProvider-ContentResolver-UriMatcher-å®ç°æ•°æ®å…±äº«" class="headerlink" title="3. ä½¿ç”¨ SQLite + ContentProvider + ContentResolver + UriMatcher å®ç°æ•°æ®å…±äº«"></a>3. ä½¿ç”¨ SQLite + ContentProvider + ContentResolver + UriMatcher å®ç°æ•°æ®å…±äº«</h2><h3 id="3-1-æ•°æ®åº“å®ç°"><a href="#3-1-æ•°æ®åº“å®ç°" class="headerlink" title="3.1 æ•°æ®åº“å®ç°"></a>3.1 æ•°æ®åº“å®ç°</h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª SQLite æ•°æ®åº“å¹¶å®šä¹‰æ•°æ®è¡¨ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ SQLiteOpenHelper ç±»ï¼Œå®ƒç®¡ç†ä¸€ä¸ªåä¸º <code>diary</code> çš„è¡¨ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">class DiaryDatabaseHelper(context: Context) : SQLiteOpenHelper(context, &quot;DiaryDB&quot;, null, 1) &#123;</span><br><span class="line"></span><br><span class="line">    override fun onCreate(db: SQLiteDatabase) &#123;</span><br><span class="line">        val createTableSQL = &quot;&quot;&quot;</span><br><span class="line">            CREATE TABLE diary (</span><br><span class="line">                id INTEGER PRIMARY KEY AUTOINCREMENT,</span><br><span class="line">                title TEXT,</span><br><span class="line">                date INTEGER,</span><br><span class="line">                content TEXT</span><br><span class="line">            )</span><br><span class="line">        &quot;&quot;&quot;.trimIndent()</span><br><span class="line">        db.execSQL(createTableSQL)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override fun onUpgrade(db: SQLiteDatabase, oldVersion: Int, newVersion: Int) &#123;</span><br><span class="line">        db.execSQL(&quot;DROP TABLE IF EXISTS diary&quot;)</span><br><span class="line">        onCreate(db)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªæ•°æ®åº“ä¸­ï¼Œ<code>diary</code> è¡¨åŒ…å« <code>id</code>ï¼ˆä¸»é”®ï¼‰ã€<code>title</code>ï¼ˆæ ‡é¢˜ï¼‰ã€<code>date</code>ï¼ˆæ—¥æœŸï¼‰å’Œ <code>content</code>ï¼ˆå†…å®¹ï¼‰ç­‰å­—æ®µã€‚</p><h3 id="3-2-ContentProvider-å®ç°"><a href="#3-2-ContentProvider-å®ç°" class="headerlink" title="3.2 ContentProvider å®ç°"></a>3.2 ContentProvider å®ç°</h3><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦å®ç°ä¸€ä¸ª ContentProviderï¼Œå®ƒå°†ä½¿ç”¨æˆ‘ä»¬åˆšåˆšå®šä¹‰çš„æ•°æ®åº“ã€‚é€šè¿‡ ContentProviderï¼Œå¤–éƒ¨åº”ç”¨å¯ä»¥é€šè¿‡ URI æ¥è®¿é—®æˆ‘ä»¬æä¾›çš„æ•°æ®ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">class DiaryProvider : ContentProvider() &#123;</span><br><span class="line"></span><br><span class="line">    companion object &#123;</span><br><span class="line">        const val AUTHORITY = &quot;com.example.providerdemo.diaryprovider&quot;</span><br><span class="line">        const val TABLE_DIARY = &quot;diary&quot;</span><br><span class="line">        val CONTENT_URI: Uri = Uri.parse(&quot;content://$AUTHORITY/$TABLE_DIARY&quot;)</span><br><span class="line">        const val DIARY_DIR = 1</span><br><span class="line">        const val DIARY_ITEM = 2</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private lateinit var dbHelper: DiaryDatabaseHelper</span><br><span class="line">    private val uriMatcher = UriMatcher(UriMatcher.NO_MATCH).apply &#123;</span><br><span class="line">        addURI(AUTHORITY, TABLE_DIARY, DIARY_DIR)</span><br><span class="line">        </span><br><span class="line">  /*DIARY_Diræ˜¯ä¸€ä¸ªæ•´æ•°å€¼ï¼Œç”¨æ¥æ ‡è¯†è¿™ä¸ª URI æ¨¡å¼å¯¹åº”çš„æ“ä½œã€‚åœ¨åé¢çš„ ContentProvider ä¸­ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨è¿™ä¸ªæ•´æ•°å€¼æ¥ç¡®å®šæ‰§è¡Œå“ªäº›æ“ä½œï¼ˆä¾‹å¦‚æŸ¥è¯¢ã€æ’å…¥ã€æ›´æ–°ã€åˆ é™¤ç­‰ï¼‰ã€‚DIARY_1Dir æ˜¯ä½ åœ¨ä»£ç ä¸­å®šä¹‰çš„å¸¸é‡ã€‚æ¯”å¦‚åé¢çš„return when (uriMatcher.match(uri)) &#123;</span><br><span class="line">            DIARY_DIR -&gt;...&#125;*/</span><br><span class="line">            </span><br><span class="line">        addURI(AUTHORITY, &quot;$TABLE_DIARY/#&quot;, DIARY_ITEM)</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override fun onCreate(): Boolean &#123;</span><br><span class="line">        dbHelper = DiaryDatabaseHelper(context!!)</span><br><span class="line">        return true</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override fun query(uri: Uri, projection: Array&lt;String&gt;?, selection: String?, selectionArgs: Array&lt;String&gt;?, sortOrder: String?): Cursor? &#123;</span><br><span class="line">        val db = dbHelper.readableDatabase</span><br><span class="line">        return when (uriMatcher.match(uri)) &#123;</span><br><span class="line">            DIARY_DIR -&gt; db.query(TABLE_DIARY, projection, selection, selectionArgs, null, null, sortOrder)</span><br><span class="line">            DIARY_ITEM -&gt; &#123;</span><br><span class="line">                val id = uri.lastPathSegment</span><br><span class="line">                db.query(TABLE_DIARY, projection, &quot;id=?&quot;, arrayOf(id), null, null, sortOrder)</span><br><span class="line">            &#125;</span><br><span class="line">            else -&gt; null</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override fun insert(uri: Uri, values: ContentValues?): Uri? &#123;</span><br><span class="line">        val db = dbHelper.writableDatabase</span><br><span class="line">        return when (uriMatcher.match(uri)) &#123;</span><br><span class="line">            DIARY_DIR -&gt; &#123;</span><br><span class="line">                val id = db.insert(TABLE_DIARY, null, values)</span><br><span class="line">                Uri.withAppendedPath(CONTENT_URI, id.toString())</span><br><span class="line">            &#125;</span><br><span class="line">            else -&gt; null</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override fun update(uri: Uri, values: ContentValues?, selection: String?, selectionArgs: Array&lt;String&gt;?): Int &#123;</span><br><span class="line">        val db = dbHelper.writableDatabase</span><br><span class="line">        return when (uriMatcher.match(uri)) &#123;</span><br><span class="line">            DIARY_DIR -&gt; db.update(TABLE_DIARY, values, selection, selectionArgs)</span><br><span class="line">            DIARY_ITEM -&gt; &#123;</span><br><span class="line">                val id = uri.lastPathSegment</span><br><span class="line">                db.update(TABLE_DIARY, values, &quot;id=?&quot;, arrayOf(id))</span><br><span class="line">            &#125;</span><br><span class="line">            else -&gt; 0</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override fun delete(uri: Uri, selection: String?, selectionArgs: Array&lt;String&gt;?): Int &#123;</span><br><span class="line">        val db = dbHelper.writableDatabase</span><br><span class="line">        return when (uriMatcher.match(uri)) &#123;</span><br><span class="line">            DIARY_DIR -&gt; db.delete(TABLE_DIARY, selection, selectionArgs)</span><br><span class="line">            DIARY_ITEM -&gt; &#123;</span><br><span class="line">                val id = uri.lastPathSegment</span><br><span class="line">                db.delete(TABLE_DIARY, &quot;id=?&quot;, arrayOf(id))</span><br><span class="line">            &#125;</span><br><span class="line">            else -&gt; 0</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override fun getType(uri: Uri): String? &#123;</span><br><span class="line">        return when (uriMatcher.match(uri)) &#123;</span><br><span class="line">            DIARY_DIR -&gt; &quot;vnd.android.cursor.dir/vnd.$AUTHORITY.$TABLE_DIARY&quot;</span><br><span class="line">            DIARY_ITEM -&gt; &quot;vnd.android.cursor.item/vnd.$AUTHORITY.$TABLE_DIARY&quot;</span><br><span class="line">            else -&gt; null</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-3-UriMatcher-é…ç½®"><a href="#3-3-UriMatcher-é…ç½®" class="headerlink" title="3.3 UriMatcher é…ç½®"></a>3.3 UriMatcher é…ç½®</h3><p>åœ¨ ContentProvider ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ UriMatcher æ¥åˆ¤æ–­ä¼ å…¥çš„ URI å±äºå“ªä¸ªç±»å‹ã€‚UriMatcher ä¼šåŒ¹é…è¡¨åï¼ˆ<code>diary</code>ï¼‰æˆ–è€…æŸä¸ªå…·ä½“çš„è®°å½•ï¼ˆé€šè¿‡ ID æ¥è¯†åˆ«ï¼‰ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">val uriMatcher = UriMatcher(UriMatcher.NO_MATCH).apply &#123;</span><br><span class="line">    addURI(AUTHORITY, TABLE_DIARY, DIARY_DIR) // åŒ¹é…æ•´ä¸ª diary è¡¨</span><br><span class="line">    addURI(AUTHORITY, &quot;$TABLE_DIARY/#&quot;, DIARY_ITEM) // åŒ¹é…å•æ¡ diary è®°å½•</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>DIARY_DIR</strong>ï¼šåŒ¹é…æ•´ä¸ªè¡¨çš„ URIã€‚</li><li><strong>DIARY_ITEM</strong>ï¼šåŒ¹é…å•æ¡æ•°æ®è®°å½•çš„ URIï¼Œå¸¦æœ‰ <code>#</code> é€šé…ç¬¦ï¼Œè¡¨ç¤ºè®°å½•çš„ IDã€‚</li></ul><h3 id="3-4-ContentResolver-çš„ä½¿ç”¨"><a href="#3-4-ContentResolver-çš„ä½¿ç”¨" class="headerlink" title="3.4 ContentResolver çš„ä½¿ç”¨"></a>3.4 ContentResolver çš„ä½¿ç”¨</h3><p>ContentResolver æ˜¯å¤–éƒ¨åº”ç”¨ç”¨æ¥è®¿é—® ContentProvider çš„æ¥å£ã€‚åœ¨å¤–éƒ¨åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ ContentResolver æ¥æ‰§è¡ŒæŸ¥è¯¢ã€æ’å…¥ã€æ›´æ–°å’Œåˆ é™¤æ“ä½œã€‚ä¾‹å¦‚ï¼ŒæŸ¥è¯¢æ‰€æœ‰æ ‡é¢˜åŒ…å«â€œå¿ƒæƒ…â€çš„æ—¥è®°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">//æ„é€  content:// å¼€å¤´çš„ Uriï¼Œå®ƒç”¨äºæ ‡è¯†æ•°æ®åº“ä¸­çš„æŸæ¡æ•°æ®ã€‚</span><br><span class="line">val uri = Uri.parse(&quot;content://com.example.providerdemo.diaryprovider/diary&quot;)</span><br><span class="line">val projection = arrayOf(&quot;id&quot;, &quot;title&quot;, &quot;date&quot;, &quot;content&quot;)</span><br><span class="line">val selection = &quot;title LIKE ?&quot;</span><br><span class="line">val selectionArgs = arrayOf(&quot;%å¿ƒæƒ…%&quot;)</span><br><span class="line">val sortOrder = &quot;date DESC&quot;</span><br><span class="line"></span><br><span class="line">// æŸ¥è¯¢æ“ä½œ</span><br><span class="line">val cursor = contentResolver.query(uri, projection, selection, selectionArgs, sortOrder)</span><br><span class="line">cursor?.use &#123;</span><br><span class="line">    while (it.moveToNext()) &#123;</span><br><span class="line">        val id = it.getInt(it.getColumnIndexOrThrow(&quot;id&quot;))</span><br><span class="line">        val title = it.getString(it.getColumnIndexOrThrow(&quot;title&quot;))</span><br><span class="line">        val date = it.getLong(it.getColumnIndexOrThrow(&quot;date&quot;))</span><br><span class="line">        val content = it.getString(it.getColumnIndexOrThrow(&quot;content&quot;))</span><br><span class="line">        println(&quot;ID: $id, Title: $title, Date: $date, Content: $content&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-æ€»ç»“"><a href="#4-æ€»ç»“" class="headerlink" title="4. æ€»ç»“"></a>4. æ€»ç»“</h2><p>é€šè¿‡ç»“åˆ <strong>SQLite</strong> æ•°æ®åº“ã€<strong>ContentProvider</strong>ã€<strong>ContentResolver</strong> å’Œ <strong>UriMatcher</strong>ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ªå®Œæ•´çš„è·¨åº”ç”¨æ•°æ®å…±äº«æœºåˆ¶ã€‚ContentProvider ä½œä¸ºæ•°æ®æä¾›è€…ï¼Œå‘å¤–éƒ¨åº”ç”¨æä¾›è®¿é—®æ¥å£ï¼ŒContentResolver åˆ™å……å½“è¯·æ±‚è€…çš„è§’è‰²ï¼Œå‘èµ·æŸ¥è¯¢ã€æ’å…¥ã€æ›´æ–°å’Œåˆ é™¤ç­‰æ“ä½œï¼ŒUriMatcher åˆ™å¸®åŠ©æˆ‘ä»¬æ ¹æ® URI åŒ¹é…å…·ä½“çš„æ•°æ®æ“ä½œã€‚</p><p>è¿™ç§æ¶æ„ä¸ä»…ä¿è¯äº†æ•°æ®å…±äº«çš„é«˜æ•ˆæ€§å’Œå®‰å…¨æ€§ï¼ŒåŒæ—¶è¿˜ä½¿å¾—åº”ç”¨å†…éƒ¨æ•°æ®ç®¡ç†å˜å¾—æ›´åŠ æ¸…æ™°å’Œè§„èŒƒã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“çŸ¥è¯†ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RecycleViewä½¿ç”¨ç¤ºä¾‹</title>
      <link href="/2025/03/17/RecycleView%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B/"/>
      <url>/2025/03/17/RecycleView%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="ğŸš€-RecyclerView-è¿›é˜¶ä¼˜åŒ–æŒ‡å—"><a href="#ğŸš€-RecyclerView-è¿›é˜¶ä¼˜åŒ–æŒ‡å—" class="headerlink" title="ğŸš€ RecyclerView è¿›é˜¶ä¼˜åŒ–æŒ‡å—"></a><strong>ğŸš€ RecyclerView è¿›é˜¶ä¼˜åŒ–æŒ‡å—</strong></h1><p>ç›¸æ¯”ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œè¿™æ¬¡çš„æ”¹è¿›åŒ…æ‹¬ï¼š</p><ul><li>âœ… <strong>ä½¿ç”¨ <code>DiffUtil</code> ä¼˜åŒ–æ•°æ®æ›´æ–°</strong>ï¼ˆé¿å… <code>notifyDataSetChanged()</code>ï¼‰</li><li>âœ… <strong>ä½¿ç”¨ <code>ViewBinding</code> ç®€åŒ– <code>ViewHolder</code> ä»£ç </strong></li><li>âœ… <strong>å°è£… <code>Adapter</code> æ”¯æŒ <code>MutableList</code>ï¼ˆæ”¯æŒå¢åˆ æ”¹æŸ¥ï¼‰</strong></li><li>âœ… <strong>ä¼˜åŒ– <code>onClick</code> äº‹ä»¶ï¼Œè®© <code>RecyclerView</code> æ›´æ˜“æ‰©å±•</strong></li><li>âœ… <strong>æ”¯æŒ Grid&#x2F;ç€‘å¸ƒæµ&#x2F;çº¿æ€§å¸ƒå±€</strong></li></ul><hr><h2 id="1ï¸âƒ£-æ·»åŠ -RecyclerView-ä¾èµ–"><a href="#1ï¸âƒ£-æ·»åŠ -RecyclerView-ä¾èµ–" class="headerlink" title="1ï¸âƒ£ æ·»åŠ  RecyclerView ä¾èµ–"></a><strong>1ï¸âƒ£ æ·»åŠ  RecyclerView ä¾èµ–</strong></h2><p>ç¡®ä¿ä½ çš„ <code>build.gradle</code> æ·»åŠ äº†ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    implementation &#x27;androidx.recyclerview:recyclerview:1.3.2&#x27;</span><br><span class="line">    implementation &#x27;androidx.viewbinding:viewbinding:7.3.1&#x27; // ä½¿ç”¨ ViewBinding</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="2ï¸âƒ£-åœ¨-activity-main-xml-ä¸­æ·»åŠ -RecyclerView"><a href="#2ï¸âƒ£-åœ¨-activity-main-xml-ä¸­æ·»åŠ -RecyclerView" class="headerlink" title="2ï¸âƒ£ åœ¨ activity_main.xml ä¸­æ·»åŠ  RecyclerView"></a><strong>2ï¸âƒ£ åœ¨ <code>activity_main.xml</code> ä¸­æ·»åŠ  <code>RecyclerView</code></strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;androidx.recyclerview.widget.RecyclerView</span><br><span class="line">    android:id=&quot;@+id/recyclerView&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;</span><br><span class="line">    android:padding=&quot;10dp&quot;/&gt;</span><br></pre></td></tr></table></figure><hr><h2 id="3ï¸âƒ£-åˆ›å»ºæ•°æ®æ¨¡å‹"><a href="#3ï¸âƒ£-åˆ›å»ºæ•°æ®æ¨¡å‹" class="headerlink" title="3ï¸âƒ£ åˆ›å»ºæ•°æ®æ¨¡å‹"></a><strong>3ï¸âƒ£ åˆ›å»ºæ•°æ®æ¨¡å‹</strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">data class Diary(</span><br><span class="line">    val id: Int,         // æ–¹ä¾¿æ›´æ–°å’Œåˆ é™¤</span><br><span class="line">    val title: String,  </span><br><span class="line">    val content: String, </span><br><span class="line">    val date: String</span><br><span class="line">)</span><br></pre></td></tr></table></figure><hr><h2 id="4ï¸âƒ£-ä½¿ç”¨-DiffUtil-ä¼˜åŒ–-Adapter"><a href="#4ï¸âƒ£-ä½¿ç”¨-DiffUtil-ä¼˜åŒ–-Adapter" class="headerlink" title="4ï¸âƒ£ ä½¿ç”¨ DiffUtil ä¼˜åŒ– Adapter"></a><strong>4ï¸âƒ£ ä½¿ç”¨ <code>DiffUtil</code> ä¼˜åŒ– <code>Adapter</code></strong></h2><p>ğŸš€ <code>DiffUtil</code> å¯ä»¥é«˜æ•ˆæ›´æ–° <code>RecyclerView</code>ï¼Œé¿å…å…¨é‡åˆ·æ–°ï¼Œæé«˜æ€§èƒ½ã€‚</p><h3 id="åˆ›å»º-DiaryDiffCallback"><a href="#åˆ›å»º-DiaryDiffCallback" class="headerlink" title="åˆ›å»º DiaryDiffCallback"></a><strong>åˆ›å»º <code>DiaryDiffCallback</code></strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">class DiaryDiffCallback(</span><br><span class="line">    private val oldList: List&lt;Diary&gt;,</span><br><span class="line">    private val newList: List&lt;Diary&gt;</span><br><span class="line">) : DiffUtil.Callback() &#123;</span><br><span class="line">    </span><br><span class="line">    override fun getOldListSize(): Int = oldList.size</span><br><span class="line">    override fun getNewListSize(): Int = newList.size</span><br><span class="line"></span><br><span class="line">    // åˆ¤æ–­æ˜¯å¦æ˜¯åŒä¸€é¡¹ï¼ˆé€šå¸¸æ¯”è¾ƒ IDï¼‰</span><br><span class="line">    override fun areItemsTheSame(oldItemPosition: Int, newItemPosition: Int): Boolean &#123;</span><br><span class="line">        return oldList[oldItemPosition].id == newList[newItemPosition].id</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // åˆ¤æ–­å†…å®¹æ˜¯å¦ç›¸åŒï¼ˆé¿å…ä¸å¿…è¦çš„åˆ·æ–°ï¼‰</span><br><span class="line">    override fun areContentsTheSame(oldItemPosition: Int, newItemPosition: Int): Boolean &#123;</span><br><span class="line">        return oldList[oldItemPosition] == newList[newItemPosition]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="5ï¸âƒ£-ä¼˜åŒ–-Adapterï¼ˆä½¿ç”¨-ViewBindingï¼‰"><a href="#5ï¸âƒ£-ä¼˜åŒ–-Adapterï¼ˆä½¿ç”¨-ViewBindingï¼‰" class="headerlink" title="5ï¸âƒ£ ä¼˜åŒ– Adapterï¼ˆä½¿ç”¨ ViewBindingï¼‰"></a><strong>5ï¸âƒ£ ä¼˜åŒ– <code>Adapter</code>ï¼ˆä½¿ç”¨ <code>ViewBinding</code>ï¼‰</strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">class DiaryAdapter(</span><br><span class="line">    private var diaryList: MutableList&lt;Diary&gt;, // è®©æ•°æ®å¯å˜</span><br><span class="line">    private val onItemClick: (Diary) -&gt; Unit</span><br><span class="line">) : RecyclerView.Adapter&lt;DiaryAdapter.DiaryViewHolder&gt;() &#123;</span><br><span class="line"></span><br><span class="line">    // ä½¿ç”¨ ViewBinding ç®€åŒ– ViewHolder</span><br><span class="line">    class DiaryViewHolder(val binding: ItemDiaryBinding) : RecyclerView.ViewHolder(binding.root)</span><br><span class="line"></span><br><span class="line">    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): DiaryViewHolder &#123;</span><br><span class="line">        val binding = ItemDiaryBinding.inflate(LayoutInflater.from(parent.context), parent, false)</span><br><span class="line">        return DiaryViewHolder(binding)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override fun onBindViewHolder(holder: DiaryViewHolder, position: Int) &#123;</span><br><span class="line">        val diary = diaryList[position]</span><br><span class="line">        with(holder.binding) &#123;</span><br><span class="line">            tvTitle.text = diary.title</span><br><span class="line">            tvContent.text = diary.content</span><br><span class="line">            tvDate.text = diary.date</span><br><span class="line">            root.setOnClickListener &#123; onItemClick(diary) &#125; // å¤„ç†ç‚¹å‡»äº‹ä»¶</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override fun getItemCount(): Int = diaryList.size</span><br><span class="line"></span><br><span class="line">    // ğŸš€ ä½¿ç”¨ DiffUtil åˆ·æ–°æ•°æ®ï¼Œé¿å…å…¨é‡åˆ·æ–°</span><br><span class="line">    fun updateData(newList: List&lt;Diary&gt;) &#123;</span><br><span class="line">        val diffResult = DiffUtil.calculateDiff(DiaryDiffCallback(diaryList, newList))</span><br><span class="line">        diaryList.clear()</span><br><span class="line">        diaryList.addAll(newList)</span><br><span class="line">        diffResult.dispatchUpdatesTo(this)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // å¢åˆ æ”¹æŸ¥æ–¹æ³•</span><br><span class="line">    fun addDiary(diary: Diary) &#123;</span><br><span class="line">        diaryList.add(0, diary)  // æ’å…¥åˆ°ç¬¬ä¸€ä¸ªä½ç½®</span><br><span class="line">        notifyItemInserted(0)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fun removeDiary(position: Int) &#123;</span><br><span class="line">        if (position in diaryList.indices) &#123;</span><br><span class="line">            diaryList.removeAt(position)</span><br><span class="line">            notifyItemRemoved(position)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="6ï¸âƒ£-åˆ›å»º-item-diary-xml"><a href="#6ï¸âƒ£-åˆ›å»º-item-diary-xml" class="headerlink" title="6ï¸âƒ£ åˆ›å»º item_diary.xml"></a><strong>6ï¸âƒ£ åˆ›å»º <code>item_diary.xml</code></strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">    android:orientation=&quot;vertical&quot;</span><br><span class="line">    android:padding=&quot;10dp&quot;</span><br><span class="line">    android:background=&quot;@android:color/white&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:id=&quot;@+id/tvTitle&quot;</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:textSize=&quot;18sp&quot;</span><br><span class="line">        android:textColor=&quot;@android:color/black&quot;</span><br><span class="line">        android:textStyle=&quot;bold&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:id=&quot;@+id/tvContent&quot;</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:textSize=&quot;16sp&quot;</span><br><span class="line">        android:textColor=&quot;@android:color/darker_gray&quot;</span><br><span class="line">        android:maxLines=&quot;2&quot;</span><br><span class="line">        android:ellipsize=&quot;end&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:id=&quot;@+id/tvDate&quot;</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:textSize=&quot;14sp&quot;</span><br><span class="line">        android:textColor=&quot;@android:color/holo_blue_dark&quot;/&gt;</span><br><span class="line">&lt;/LinearLayout&gt;</span><br></pre></td></tr></table></figure><hr><h2 id="7ï¸âƒ£-åœ¨-MainActivity-ç»‘å®š-RecyclerView"><a href="#7ï¸âƒ£-åœ¨-MainActivity-ç»‘å®š-RecyclerView" class="headerlink" title="7ï¸âƒ£ åœ¨ MainActivity ç»‘å®š RecyclerView"></a><strong>7ï¸âƒ£ åœ¨ <code>MainActivity</code> ç»‘å®š <code>RecyclerView</code></strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">class MainActivity : AppCompatActivity() &#123;</span><br><span class="line">    </span><br><span class="line">    private lateinit var recyclerView: RecyclerView</span><br><span class="line">    private lateinit var diaryAdapter: DiaryAdapter</span><br><span class="line"></span><br><span class="line">    override fun onCreate(savedInstanceState: Bundle?) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line"></span><br><span class="line">        recyclerView = findViewById(R.id.recyclerView)</span><br><span class="line">        recyclerView.layoutManager = LinearLayoutManager(this)</span><br><span class="line"></span><br><span class="line">        // åˆå§‹æ•°æ®</span><br><span class="line">        val diaryList = mutableListOf(</span><br><span class="line">            Diary(1, &quot;ä»Šæ—¥å¿ƒæƒ…&quot;, &quot;ä»Šå¤©å¤©æ°”å¾ˆå¥½ï¼Œå¿ƒæƒ…æ„‰å¿«ï¼&quot;, &quot;2025-03-17&quot;),</span><br><span class="line">            Diary(2, &quot;å­¦ä¹  Kotlin&quot;, &quot;RecyclerView çœŸçš„å¾ˆå¥½ç”¨ï¼&quot;, &quot;2025-03-16&quot;)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        // ç»‘å®š Adapter</span><br><span class="line">        diaryAdapter = DiaryAdapter(diaryList) &#123; diary -&gt;</span><br><span class="line">            Toast.makeText(this, &quot;ç‚¹å‡»äº†: $&#123;diary.title&#125;&quot;, Toast.LENGTH_SHORT).show()</span><br><span class="line">        &#125;</span><br><span class="line">        recyclerView.adapter = diaryAdapter</span><br><span class="line"></span><br><span class="line">        // æ¨¡æ‹Ÿ 3 ç§’ååˆ·æ–°æ•°æ®</span><br><span class="line">        Handler(Looper.getMainLooper()).postDelayed(&#123;</span><br><span class="line">            val newData = diaryList + Diary(3, &quot;è®°è´¦&quot;, &quot;ä»Šå¤©åƒäº†ç«é”…ï¼ŒèŠ±äº† 120 å…ƒ&quot;, &quot;2025-03-15&quot;)</span><br><span class="line">            diaryAdapter.updateData(newData)</span><br><span class="line">        &#125;, 3000)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="8ï¸âƒ£-å¯é€‰ä¼˜åŒ–"><a href="#8ï¸âƒ£-å¯é€‰ä¼˜åŒ–" class="headerlink" title="8ï¸âƒ£ å¯é€‰ä¼˜åŒ–"></a><strong>8ï¸âƒ£ å¯é€‰ä¼˜åŒ–</strong></h2><h3 id="ï¼ˆ1ï¼‰ç½‘æ ¼å¸ƒå±€"><a href="#ï¼ˆ1ï¼‰ç½‘æ ¼å¸ƒå±€" class="headerlink" title="ï¼ˆ1ï¼‰ç½‘æ ¼å¸ƒå±€"></a><strong>ï¼ˆ1ï¼‰ç½‘æ ¼å¸ƒå±€</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">recyclerView.layoutManager = GridLayoutManager(this, 2) // 2 åˆ—</span><br></pre></td></tr></table></figure><h3 id="ï¼ˆ2ï¼‰ç€‘å¸ƒæµå¸ƒå±€"><a href="#ï¼ˆ2ï¼‰ç€‘å¸ƒæµå¸ƒå±€" class="headerlink" title="ï¼ˆ2ï¼‰ç€‘å¸ƒæµå¸ƒå±€"></a><strong>ï¼ˆ2ï¼‰ç€‘å¸ƒæµå¸ƒå±€</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">recyclerView.layoutManager = StaggeredGridLayoutManager(2, StaggeredGridLayoutManager.VERTICAL)</span><br></pre></td></tr></table></figure><hr><h2 id="ğŸ¯-æ€»ç»“"><a href="#ğŸ¯-æ€»ç»“" class="headerlink" title="ğŸ¯ æ€»ç»“"></a><strong>ğŸ¯ æ€»ç»“</strong></h2><table><thead><tr><th>æ”¹è¿›ç‚¹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>âœ… <strong>ä½¿ç”¨ <code>DiffUtil</code></strong></td><td><strong>ä¼˜åŒ–æ•°æ®æ›´æ–°</strong>ï¼Œé¿å… <code>notifyDataSetChanged()</code></td></tr><tr><td>âœ… <strong>ä½¿ç”¨ <code>ViewBinding</code></strong></td><td><strong>å‡å°‘ <code>findViewById</code> ä»£ç </strong>ï¼Œæé«˜å¯è¯»æ€§</td></tr><tr><td>âœ… <strong>å°è£…å¢åˆ æ”¹æŸ¥æ–¹æ³•</strong></td><td><code>addDiary()</code> å’Œ <code>removeDiary()</code></td></tr><tr><td>âœ… <strong>æ”¯æŒ <code>MutableList</code></strong></td><td><strong>è®©æ•°æ®å¯å˜</strong>ï¼Œæ›´æ–¹ä¾¿æ“ä½œ</td></tr><tr><td>âœ… <strong>æ”¯æŒ Grid&#x2F;ç€‘å¸ƒæµå¸ƒå±€</strong></td><td><strong>é€‚é…ä¸åŒ UI éœ€æ±‚</strong></td></tr></tbody></table><hr><p>ğŸš€ <strong>è¿™æ ·å†™çš„ <code>RecyclerView</code> æ›´é«˜æ•ˆã€æ›´æ˜“æ‰©å±•ï¼ä½ å¯ä»¥ç›´æ¥ç”¨åœ¨ Kotlin æ—¥è®°æœ¬ App é‡Œã€‚</strong> ğŸ‰</p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“çŸ¥è¯†ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ContentResolverçš„å¢åˆ æ”¹æŸ¥æ–¹æ³•ç¤ºä¾‹</title>
      <link href="/2025/03/17/ContentResolver%E7%9A%84%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5%E6%96%B9%E6%B3%95%E7%A4%BA%E4%BE%8B/"/>
      <url>/2025/03/17/ContentResolver%E7%9A%84%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5%E6%96%B9%E6%B3%95%E7%A4%BA%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="Android-ä¸­-ContentResolver-çš„å¢åˆ æ”¹æŸ¥è¯¦è§£"><a href="#Android-ä¸­-ContentResolver-çš„å¢åˆ æ”¹æŸ¥è¯¦è§£" class="headerlink" title="Android ä¸­ ContentResolver çš„å¢åˆ æ”¹æŸ¥è¯¦è§£"></a><strong>Android ä¸­ <code>ContentResolver</code> çš„å¢åˆ æ”¹æŸ¥è¯¦è§£</strong></h2><p><code>ContentResolver</code> æ˜¯ Android æä¾›çš„ APIï¼Œç”¨äºåœ¨ä¸åŒåº”ç”¨ç¨‹åºä¹‹é—´è®¿é—®å’Œæ“ä½œæ•°æ®ï¼Œé€šå¸¸ä¸ <code>ContentProvider</code> ä¸€èµ·ä½¿ç”¨ã€‚å®ƒæä¾› <strong>å¢ï¼ˆinsertï¼‰ã€åˆ ï¼ˆdeleteï¼‰ã€æ”¹ï¼ˆupdateï¼‰ã€æŸ¥ï¼ˆqueryï¼‰</strong> æ“ä½œï¼Œå¸¸è§äºè®¿é—®ç³»ç»Ÿæ•°æ®åº“ï¼ˆå¦‚é€šè®¯å½•ã€åª’ä½“åº“ç­‰ï¼‰æˆ–åº”ç”¨è‡ªå®šä¹‰çš„æ•°æ®åº“ï¼ˆå¦‚æ—¥è®°æœ¬ã€ç¬”è®°ç­‰ï¼‰ã€‚</p><hr><h2 id="ğŸ“Œ-ä½¿ç”¨-ContentResolver-çš„æ­¥éª¤"><a href="#ğŸ“Œ-ä½¿ç”¨-ContentResolver-çš„æ­¥éª¤" class="headerlink" title="ğŸ“Œ ä½¿ç”¨ ContentResolver çš„æ­¥éª¤"></a><strong>ğŸ“Œ ä½¿ç”¨ <code>ContentResolver</code> çš„æ­¥éª¤</strong></h2><ol><li><strong>ç¡®å®š <code>ContentProvider</code> æä¾›çš„æ•°æ® URI</strong>ï¼ˆ<code>content://</code> æ ¼å¼ï¼‰</li><li><strong>è·å– <code>ContentResolver</code></strong> å¯¹è±¡</li><li><strong>æ‰§è¡Œå¢ã€åˆ ã€æ”¹ã€æŸ¥æ“ä½œ</strong></li><li><strong>å¤„ç†æƒé™ï¼ˆå¦‚æœæ˜¯è®¿é—®ç³»ç»Ÿæ•°æ®ï¼‰</strong></li><li><strong>å…³é—­ <code>Cursor</code> ä»¥é‡Šæ”¾èµ„æºï¼ˆä»… <code>query</code> éœ€è¦ï¼‰</strong></li></ol><hr><h2 id="ğŸ’¡-1-è·å–-ContentResolver"><a href="#ğŸ’¡-1-è·å–-ContentResolver" class="headerlink" title="ğŸ’¡ 1. è·å– ContentResolver"></a><strong>ğŸ’¡ 1. è·å– <code>ContentResolver</code></strong></h2><p>åœ¨ <code>Activity</code> æˆ– <code>Fragment</code> ä¸­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val contentResolver = context.contentResolver</span><br></pre></td></tr></table></figure><p>åœ¨ <code>Service</code> ä¸­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val contentResolver = applicationContext.contentResolver</span><br></pre></td></tr></table></figure><hr><h2 id="ğŸ”-2-æŸ¥è¯¢æ•°æ®ï¼ˆqueryï¼‰"><a href="#ğŸ”-2-æŸ¥è¯¢æ•°æ®ï¼ˆqueryï¼‰" class="headerlink" title="ğŸ” 2. æŸ¥è¯¢æ•°æ®ï¼ˆqueryï¼‰"></a><strong>ğŸ” 2. æŸ¥è¯¢æ•°æ®ï¼ˆqueryï¼‰</strong></h2><p>æŸ¥è¯¢ <code>ContentProvider</code> æä¾›çš„æ•°æ®ï¼Œè¿”å› <code>Cursor</code>ï¼Œéœ€æ‰‹åŠ¨éå†å’Œå…³é—­ã€‚</p><h3 id="ç¤ºä¾‹ï¼šæŸ¥è¯¢æ—¥è®°"><a href="#ç¤ºä¾‹ï¼šæŸ¥è¯¢æ—¥è®°" class="headerlink" title="ç¤ºä¾‹ï¼šæŸ¥è¯¢æ—¥è®°"></a><strong>ç¤ºä¾‹ï¼šæŸ¥è¯¢æ—¥è®°</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">// 1. ç›®æ ‡ ContentProvider çš„ URI</span><br><span class="line">val uri = Uri.parse(&quot;content://com.example.provider/diary&quot;)</span><br><span class="line">//æ„é€  content:// å¼€å¤´çš„ Uriï¼Œå®ƒç”¨äºæ ‡è¯†æ•°æ®åº“ä¸­çš„æŸæ¡æ•°æ®ã€‚</span><br><span class="line"></span><br><span class="line">// 2. æŸ¥è¯¢çš„å­—æ®µï¼ˆåˆ—ï¼‰</span><br><span class="line">val projection = arrayOf(&quot;id&quot;, &quot;title&quot;, &quot;date&quot;)</span><br><span class="line"></span><br><span class="line">// 3. æŸ¥è¯¢æ¡ä»¶ï¼ˆWHEREï¼‰</span><br><span class="line">val selection = &quot;title LIKE ?&quot;</span><br><span class="line">val selectionArgs = arrayOf(&quot;%å¿ƒæƒ…%&quot;) // æŸ¥è¯¢åŒ…å«â€œå¿ƒæƒ…â€çš„æ—¥è®°</span><br><span class="line">//è¿™è¡¨ç¤ºæŸ¥è¯¢ title åˆ—ï¼Œè¦æ±‚ title çš„å†…å®¹åŒ…å«â€œå¿ƒæƒ…â€ä¸¤ä¸ªå­—ã€‚</span><br><span class="line">//LIKE æ˜¯ SQL è¯­æ³•ï¼Œç”¨äºè¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢ã€‚</span><br><span class="line">//? æ˜¯å ä½ç¬¦ï¼Œç”¨æ¥é˜²æ­¢ SQL æ³¨å…¥ï¼Œå…·ä½“å€¼ç”± selectionArgs æä¾›ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// 4. æ’åºæ–¹å¼</span><br><span class="line">val sortOrder = &quot;date DESC&quot;</span><br><span class="line"></span><br><span class="line">// 5. æ‰§è¡ŒæŸ¥è¯¢</span><br><span class="line">val cursor = contentResolver.query(uri, projection, selection, selectionArgs, sortOrder)</span><br><span class="line"></span><br><span class="line">cursor?.use &#123; </span><br><span class="line">    while (it.moveToNext()) &#123;</span><br><span class="line">        val id = it.getInt(it.getColumnIndexOrThrow(&quot;id&quot;))</span><br><span class="line">        val title = it.getString(it.getColumnIndexOrThrow(&quot;title&quot;))</span><br><span class="line">        val date = it.getLong(it.getColumnIndexOrThrow(&quot;date&quot;))</span><br><span class="line">        println(&quot;ID: $id, Title: $title, Date: $date&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125; // `use` è¯­æ³•ç¡®ä¿ Cursor å…³é—­</span><br></pre></td></tr></table></figure><p>ğŸ”¹ <strong>æ³¨æ„äº‹é¡¹</strong>ï¼š</p><ul><li>æŸ¥è¯¢æ—¶ä½¿ç”¨ <code>LIKE</code> æ”¯æŒæ¨¡ç³ŠåŒ¹é…ï¼Œ<code>?</code> ä»£è¡¨å‚æ•°å ä½ç¬¦</li><li>ä½¿ç”¨ <code>Cursor</code> éœ€è¦è°ƒç”¨ <code>.moveToNext()</code> é€è¡Œè¯»å–</li><li>å…³é—­ <code>Cursor</code> ä»¥é‡Šæ”¾èµ„æº</li></ul><hr><h2 id="ğŸ“-3-æ’å…¥æ•°æ®ï¼ˆinsertï¼‰"><a href="#ğŸ“-3-æ’å…¥æ•°æ®ï¼ˆinsertï¼‰" class="headerlink" title="ğŸ“ 3. æ’å…¥æ•°æ®ï¼ˆinsertï¼‰"></a><strong>ğŸ“ 3. æ’å…¥æ•°æ®ï¼ˆinsertï¼‰</strong></h2><p>ç”¨äºæ–°å¢æ•°æ®ï¼Œè¿”å›æ–°æ•°æ®çš„ <code>Uri</code>ã€‚</p><h3 id="ç¤ºä¾‹ï¼šæ–°å¢æ—¥è®°"><a href="#ç¤ºä¾‹ï¼šæ–°å¢æ—¥è®°" class="headerlink" title="ç¤ºä¾‹ï¼šæ–°å¢æ—¥è®°"></a><strong>ç¤ºä¾‹ï¼šæ–°å¢æ—¥è®°</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">val uri = Uri.parse(&quot;content://com.example.provider/diary&quot;)</span><br><span class="line"></span><br><span class="line">// 1. åˆ›å»º ContentValuesï¼Œå­˜å‚¨å­—æ®µå’Œå€¼</span><br><span class="line">val values = ContentValues().apply &#123;</span><br><span class="line">    put(&quot;title&quot;, &quot;ä»Šæ—¥å¿ƒæƒ…&quot;)</span><br><span class="line">    put(&quot;content&quot;, &quot;ä»Šå¤©æ˜¯ä¸ªå¥½å¤©æ°”&quot;)</span><br><span class="line">    put(&quot;date&quot;, System.currentTimeMillis())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 2. è°ƒç”¨ insert æ–¹æ³•</span><br><span class="line">val newUri = contentResolver.insert(uri, values)</span><br><span class="line"></span><br><span class="line">// 3. åˆ¤æ–­æ’å…¥ç»“æœ</span><br><span class="line">if (newUri != null) &#123;</span><br><span class="line">    println(&quot;æ’å…¥æˆåŠŸï¼ŒURI: $newUri&quot;)</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    println(&quot;æ’å…¥å¤±è´¥&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ğŸ”¹ <strong>æ³¨æ„äº‹é¡¹</strong>ï¼š</p><ul><li><code>ContentValues</code> ç±»ä¼¼ <code>Map</code>ï¼Œç”¨äºå­˜å‚¨å­—æ®µå’Œå€¼</li><li><code>insert()</code> è¿”å›æ–°æ•°æ®çš„ <code>Uri</code>ï¼Œå¤±è´¥æ—¶è¿”å› <code>null</code></li><li>newUri:è¡¨ç¤ºæ–°æ’å…¥çš„æ•°æ®çš„ <strong>URI</strong>ï¼Œç”¨äºåç»­æ“ä½œã€‚å¦‚æœæ’å…¥å¤±è´¥ï¼Œè¿”å› <code>null</code>ã€‚</li></ul><hr><h2 id="âœ-4-æ›´æ–°æ•°æ®ï¼ˆupdateï¼‰"><a href="#âœ-4-æ›´æ–°æ•°æ®ï¼ˆupdateï¼‰" class="headerlink" title="âœ 4. æ›´æ–°æ•°æ®ï¼ˆupdateï¼‰"></a><strong>âœ 4. æ›´æ–°æ•°æ®ï¼ˆupdateï¼‰</strong></h2><p>ç”¨äºä¿®æ”¹å·²æœ‰æ•°æ®ï¼Œè¿”å›å½±å“çš„è¡Œæ•°ã€‚</p><h3 id="ç¤ºä¾‹ï¼šæ›´æ–°æ—¥è®°å†…å®¹"><a href="#ç¤ºä¾‹ï¼šæ›´æ–°æ—¥è®°å†…å®¹" class="headerlink" title="ç¤ºä¾‹ï¼šæ›´æ–°æ—¥è®°å†…å®¹"></a><strong>ç¤ºä¾‹ï¼šæ›´æ–°æ—¥è®°å†…å®¹</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">val uri = Uri.parse(&quot;content://com.example.provider/diary&quot;)</span><br><span class="line"></span><br><span class="line">// 1. åˆ›å»º ContentValuesï¼Œå­˜å‚¨æ›´æ–°çš„å­—æ®µå’Œå€¼</span><br><span class="line">val values = ContentValues().apply &#123;</span><br><span class="line">    put(&quot;content&quot;, &quot;æ›´æ–°åçš„æ—¥è®°å†…å®¹&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 2. æ›´æ–°æ¡ä»¶</span><br><span class="line">val selection = &quot;id = ?&quot;</span><br><span class="line">val selectionArgs = arrayOf(&quot;1&quot;) // åªæ›´æ–° ID ä¸º 1 çš„æ—¥è®°</span><br><span class="line"></span><br><span class="line">// 3. æ‰§è¡Œ update</span><br><span class="line">val rowsUpdated = contentResolver.update(uri, values, selection, selectionArgs)</span><br><span class="line"></span><br><span class="line">println(&quot;æ›´æ–°äº† $rowsUpdated æ¡æ•°æ®&quot;)</span><br></pre></td></tr></table></figure><p>ğŸ”¹ <strong>æ³¨æ„äº‹é¡¹</strong>ï¼š</p><ul><li><code>selection</code> æ˜¯ SQL è¯­æ³•çš„ <code>WHERE</code> å­å¥</li><li><code>update()</code> è¿”å›æ›´æ–°çš„è¡Œæ•°ï¼Œå¯èƒ½ä¸º <code>0</code>ï¼ˆè¡¨ç¤ºæ•°æ®æœªæ‰¾åˆ°ï¼‰</li></ul><hr><h2 id="ğŸ—‘-5-åˆ é™¤æ•°æ®ï¼ˆdeleteï¼‰"><a href="#ğŸ—‘-5-åˆ é™¤æ•°æ®ï¼ˆdeleteï¼‰" class="headerlink" title="ğŸ—‘ 5. åˆ é™¤æ•°æ®ï¼ˆdeleteï¼‰"></a><strong>ğŸ—‘ 5. åˆ é™¤æ•°æ®ï¼ˆdeleteï¼‰</strong></h2><p>ç”¨äºåˆ é™¤æ•°æ®ï¼Œè¿”å›åˆ é™¤çš„è¡Œæ•°ã€‚</p><h3 id="ç¤ºä¾‹ï¼šåˆ é™¤æŒ‡å®šæ—¥è®°"><a href="#ç¤ºä¾‹ï¼šåˆ é™¤æŒ‡å®šæ—¥è®°" class="headerlink" title="ç¤ºä¾‹ï¼šåˆ é™¤æŒ‡å®šæ—¥è®°"></a><strong>ç¤ºä¾‹ï¼šåˆ é™¤æŒ‡å®šæ—¥è®°</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">val uri = Uri.parse(&quot;content://com.example.provider/diary&quot;)</span><br><span class="line"></span><br><span class="line">// 1. åˆ é™¤æ¡ä»¶</span><br><span class="line">val selection = &quot;id = ?&quot;</span><br><span class="line">val selectionArgs = arrayOf(&quot;1&quot;) // åªåˆ é™¤ ID ä¸º 1 çš„æ—¥è®°</span><br><span class="line"></span><br><span class="line">// 2. æ‰§è¡Œåˆ é™¤</span><br><span class="line">val rowsDeleted = contentResolver.delete(uri, selection, selectionArgs)</span><br><span class="line"></span><br><span class="line">println(&quot;åˆ é™¤äº† $rowsDeleted æ¡æ•°æ®&quot;)</span><br></pre></td></tr></table></figure><p>ğŸ”¹ <strong>æ³¨æ„äº‹é¡¹</strong>ï¼š</p><ul><li><code>delete()</code> è¿”å›åˆ é™¤çš„è¡Œæ•°</li><li>ä¸æä¾› <code>selection</code> åˆ™åˆ é™¤æ‰€æœ‰æ•°æ®ï¼ˆè°¨æ…ï¼‰</li></ul><hr><h2 id="ğŸ“–-6-è®¿é—®ç³»ç»Ÿ-ContentProvider-ç¤ºä¾‹"><a href="#ğŸ“–-6-è®¿é—®ç³»ç»Ÿ-ContentProvider-ç¤ºä¾‹" class="headerlink" title="ğŸ“– 6. è®¿é—®ç³»ç»Ÿ ContentProvider ç¤ºä¾‹"></a><strong>ğŸ“– 6. è®¿é—®ç³»ç»Ÿ <code>ContentProvider</code> ç¤ºä¾‹</strong></h2><h3 id="ğŸ“Œ-è¯»å–è”ç³»äºº"><a href="#ğŸ“Œ-è¯»å–è”ç³»äºº" class="headerlink" title="ğŸ“Œ è¯»å–è”ç³»äºº"></a><strong>ğŸ“Œ è¯»å–è”ç³»äºº</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">val uri = ContactsContract.CommonDataKinds.Phone.CONTENT_URI</span><br><span class="line">val cursor = contentResolver.query(uri, null, null, null, null)</span><br><span class="line"></span><br><span class="line">cursor?.use &#123;</span><br><span class="line">    while (it.moveToNext()) &#123;</span><br><span class="line">        val name = it.getString(it.getColumnIndexOrThrow(ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME))</span><br><span class="line">        val phone = it.getString(it.getColumnIndexOrThrow(ContactsContract.CommonDataKinds.Phone.NUMBER))</span><br><span class="line">        println(&quot;è”ç³»äºº: $name, ç”µè¯: $phone&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ğŸ“Œ-è¯»å–ç›¸å†Œ"><a href="#ğŸ“Œ-è¯»å–ç›¸å†Œ" class="headerlink" title="ğŸ“Œ è¯»å–ç›¸å†Œ"></a><strong>ğŸ“Œ è¯»å–ç›¸å†Œ</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">val uri = MediaStore.Images.Media.EXTERNAL_CONTENT_URI</span><br><span class="line">val projection = arrayOf(MediaStore.Images.Media.DATA)</span><br><span class="line">val cursor = contentResolver.query(uri, projection, null, null, null)</span><br><span class="line"></span><br><span class="line">cursor?.use &#123;</span><br><span class="line">    while (it.moveToNext()) &#123;</span><br><span class="line">        val imagePath = it.getString(it.getColumnIndexOrThrow(MediaStore.Images.Media.DATA))</span><br><span class="line">        println(&quot;å›¾ç‰‡è·¯å¾„: $imagePath&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="ğŸ”’-7-å¤„ç†æƒé™"><a href="#ğŸ”’-7-å¤„ç†æƒé™" class="headerlink" title="ğŸ”’ 7. å¤„ç†æƒé™"></a><strong>ğŸ”’ 7. å¤„ç†æƒé™</strong></h2><p><strong>å¦‚æœè®¿é—®ç³»ç»Ÿ <code>ContentProvider</code>ï¼ˆå¦‚é€šè®¯å½•ã€ç›¸å†Œç­‰ï¼‰ï¼Œéœ€ç”³è¯·æƒé™</strong>ï¼š</p><h3 id="åœ¨-AndroidManifest-xml-ç”³è¯·æƒé™"><a href="#åœ¨-AndroidManifest-xml-ç”³è¯·æƒé™" class="headerlink" title="åœ¨ AndroidManifest.xml ç”³è¯·æƒé™"></a><strong>åœ¨ <code>AndroidManifest.xml</code> ç”³è¯·æƒé™</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;uses-permission android:name=&quot;android.permission.READ_CONTACTS&quot;/&gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.WRITE_CONTACTS&quot;/&gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.READ_EXTERNAL_STORAGE&quot;/&gt;</span><br></pre></td></tr></table></figure><h3 id="åŠ¨æ€è¯·æ±‚æƒé™ï¼ˆAndroid-6-0-ï¼‰"><a href="#åŠ¨æ€è¯·æ±‚æƒé™ï¼ˆAndroid-6-0-ï¼‰" class="headerlink" title="åŠ¨æ€è¯·æ±‚æƒé™ï¼ˆAndroid 6.0+ï¼‰"></a><strong>åŠ¨æ€è¯·æ±‚æƒé™ï¼ˆAndroid 6.0+ï¼‰</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (ContextCompat.checkSelfPermission(this, Manifest.permission.READ_CONTACTS) != PackageManager.PERMISSION_GRANTED) &#123;</span><br><span class="line">    ActivityCompat.requestPermissions(this, arrayOf(Manifest.permission.READ_CONTACTS), 1)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="ğŸ“Œ-æ€»ç»“"><a href="#ğŸ“Œ-æ€»ç»“" class="headerlink" title="ğŸ“Œ æ€»ç»“"></a><strong>ğŸ“Œ æ€»ç»“</strong></h2><table><thead><tr><th>æ“ä½œ</th><th>æ–¹æ³•å</th><th>ä¸»è¦å‚æ•°</th></tr></thead><tbody><tr><td><strong>æŸ¥è¯¢</strong></td><td><code>query(uri, projection, selection, selectionArgs, sortOrder)</code></td><td><code>Uri</code>ï¼Œå­—æ®µæ•°ç»„ï¼ŒæŸ¥è¯¢æ¡ä»¶ï¼Œæ’åº</td></tr><tr><td><strong>æ’å…¥</strong></td><td><code>insert(uri, values)</code></td><td><code>Uri</code>ï¼Œ<code>ContentValues</code></td></tr><tr><td><strong>æ›´æ–°</strong></td><td><code>update(uri, values, selection, selectionArgs)</code></td><td><code>Uri</code>ï¼Œ<code>ContentValues</code>ï¼Œæ¡ä»¶</td></tr><tr><td><strong>åˆ é™¤</strong></td><td><code>delete(uri, selection, selectionArgs)</code></td><td><code>Uri</code>ï¼Œæ¡ä»¶</td></tr></tbody></table><p><strong>ğŸ’¡ ä½ æ˜¯è¦æ“ä½œè‡ªå·±çš„ <code>ContentProvider</code> è¿˜æ˜¯è®¿é—®ç³»ç»Ÿæ•°æ®ï¼Ÿå¦‚æœæ˜¯æ—¥è®°æœ¬çš„ <code>ContentProvider</code>ï¼Œå¯ä»¥ä¸€èµ·è®¾è®¡ URI å’Œæ•°æ®åº“ç»“æ„ã€‚</strong></p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“çŸ¥è¯†ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQLiteç”¨æ³•</title>
      <link href="/2025/03/15/SQLite%E7%94%A8%E6%B3%95/"/>
      <url>/2025/03/15/SQLite%E7%94%A8%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>SQLite æ˜¯ä¸€ç§è½»é‡çº§çš„åµŒå…¥å¼æ•°æ®åº“ï¼Œåœ¨ Android ä¸­ç”¨äºå­˜å‚¨ç»“æ„åŒ–æ•°æ®ã€‚ä½ å¯ä»¥é€šè¿‡ <code>SQLiteOpenHelper</code> æ¥ç®¡ç†æ•°æ®åº“çš„åˆ›å»ºã€å‡çº§ã€å’Œç‰ˆæœ¬ç®¡ç†ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨ SQLite çš„åŸºæœ¬æ­¥éª¤ï¼š</p><h2 id="1-åˆ›å»ºæ•°æ®åº“å’Œè¡¨"><a href="#1-åˆ›å»ºæ•°æ®åº“å’Œè¡¨" class="headerlink" title="1. åˆ›å»ºæ•°æ®åº“å’Œè¡¨"></a><strong>1. åˆ›å»ºæ•°æ®åº“å’Œè¡¨</strong></h2><p>ä½¿ç”¨ <code>SQLiteOpenHelper</code> åˆ›å»ºæ•°æ®åº“ä»¥åŠè¡¨ç»“æ„ã€‚è¿™ä¸ªç±»ä¼šå¸®åŠ©ä½ åˆ›å»ºæ•°æ®åº“ã€æ‰§è¡Œè¡¨çš„å‡çº§ã€é™çº§ç­‰æ“ä½œã€‚</p><h3 id="åˆ›å»º-SQLiteOpenHelper-ç±»"><a href="#åˆ›å»º-SQLiteOpenHelper-ç±»" class="headerlink" title="åˆ›å»º SQLiteOpenHelper ç±»"></a><strong>åˆ›å»º SQLiteOpenHelper ç±»</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">import android.content.Context</span><br><span class="line">import android.database.sqlite.SQLiteDatabase</span><br><span class="line">import android.database.sqlite.SQLiteOpenHelper</span><br><span class="line"></span><br><span class="line">class MyDatabaseHelper(context: Context) : SQLiteOpenHelper(context, DATABASE_NAME, null, DATABASE_VERSION) &#123;</span><br><span class="line"></span><br><span class="line">    companion object &#123;</span><br><span class="line">        private const val DATABASE_NAME = &quot;my_database.db&quot; // æ•°æ®åº“åç§°</span><br><span class="line">        private const val DATABASE_VERSION = 1 // æ•°æ®åº“ç‰ˆæœ¬å·</span><br><span class="line">        private const val TABLE_NAME = &quot;users&quot; // è¡¨åç§°</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override fun onCreate(db: SQLiteDatabase) &#123;</span><br><span class="line">        // åˆ›å»ºæ•°æ®åº“è¡¨</span><br><span class="line">        val createTableQuery = &quot;&quot;&quot;</span><br><span class="line">            CREATE TABLE $TABLE_NAME (</span><br><span class="line">                id INTEGER PRIMARY KEY AUTOINCREMENT,</span><br><span class="line">                name TEXT NOT NULL,</span><br><span class="line">                age INTEGER</span><br><span class="line">            )</span><br><span class="line">        &quot;&quot;&quot;.trimIndent()</span><br><span class="line">        db.execSQL(createTableQuery)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override fun onUpgrade(db: SQLiteDatabase, oldVersion: Int, newVersion: Int) &#123;</span><br><span class="line">        // å¦‚æœæ•°æ®åº“ç‰ˆæœ¬å˜åŒ–æ—¶ï¼Œåˆ é™¤æ—§è¡¨å¹¶åˆ›å»ºæ–°è¡¨</span><br><span class="line">        db.execSQL(&quot;DROP TABLE IF EXISTS $TABLE_NAME&quot;)</span><br><span class="line">        onCreate(db)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong><code>onCreate</code></strong>ï¼šå½“æ•°æ®åº“é¦–æ¬¡åˆ›å»ºæ—¶æ‰§è¡Œã€‚é€šå¸¸åœ¨è¿™é‡Œåˆ›å»ºè¡¨å’Œåˆå§‹åŒ–æ•°æ®ã€‚</li><li><strong><code>onUpgrade</code></strong>ï¼šå½“æ•°æ®åº“ç‰ˆæœ¬å‘ç”Ÿå˜åŒ–æ—¶æ‰§è¡Œã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œè¿›è¡Œè¡¨çš„è¿ç§»æˆ–åˆ é™¤ã€‚</li></ul><h2 id="2-æ’å…¥æ•°æ®"><a href="#2-æ’å…¥æ•°æ®" class="headerlink" title="2. æ’å…¥æ•°æ®"></a><strong>2. æ’å…¥æ•°æ®</strong></h2><p>æ’å…¥æ•°æ®éœ€è¦é€šè¿‡ <code>SQLiteDatabase.insert()</code> æ–¹æ³•æ¥å®ç°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import android.content.ContentValues</span><br><span class="line"></span><br><span class="line">fun insertUser(context: Context, name: String, age: Int) &#123;</span><br><span class="line">    val dbHelper = MyDatabaseHelper(context)</span><br><span class="line">    val db = dbHelper.writableDatabase</span><br><span class="line"></span><br><span class="line">    val values = ContentValues().apply &#123;</span><br><span class="line">        put(&quot;name&quot;, name)</span><br><span class="line">        put(&quot;age&quot;, age)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    db.insert(&quot;users&quot;, null, values)</span><br><span class="line">    db.close()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong><code>ContentValues</code></strong>ï¼šæ˜¯ç”¨äºå­˜å‚¨è¦æ’å…¥çš„æ•°æ®çš„å®¹å™¨ã€‚é€šè¿‡ <code>put</code> æ–¹æ³•å°†åˆ—åå’Œå€¼æ·»åŠ åˆ° <code>ContentValues</code> ä¸­ã€‚</li><li><strong><code>insert</code></strong>ï¼šæ’å…¥æ•°æ®çš„æ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¡¨åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯åˆ—ä¸ºç©ºæ—¶æ’å…¥çš„é»˜è®¤å€¼ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ <code>ContentValues</code>ã€‚</li></ul><h2 id="3-æŸ¥è¯¢æ•°æ®"><a href="#3-æŸ¥è¯¢æ•°æ®" class="headerlink" title="3. æŸ¥è¯¢æ•°æ®"></a><strong>3. æŸ¥è¯¢æ•°æ®</strong></h2><p>æŸ¥è¯¢æ•°æ®ä½¿ç”¨ <code>SQLiteDatabase.query()</code> æˆ– <code>SQLiteDatabase.rawQuery()</code> æ–¹æ³•ã€‚</p><h3 id="ä½¿ç”¨-query-æ–¹æ³•"><a href="#ä½¿ç”¨-query-æ–¹æ³•" class="headerlink" title="ä½¿ç”¨ query() æ–¹æ³•"></a>ä½¿ç”¨ <code>query()</code> æ–¹æ³•</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">import android.database.Cursor</span><br><span class="line"></span><br><span class="line">fun queryUsers(context: Context): List&lt;User&gt; &#123;</span><br><span class="line">    val dbHelper = MyDatabaseHelper(context)</span><br><span class="line">    val db = dbHelper.readableDatabase</span><br><span class="line"></span><br><span class="line">    val cursor: Cursor = db.query(</span><br><span class="line">        &quot;users&quot;, // è¡¨å</span><br><span class="line">        arrayOf(&quot;id&quot;, &quot;name&quot;, &quot;age&quot;), // åˆ—å</span><br><span class="line">        null, // WHERE å­å¥</span><br><span class="line">        null, // WHERE å­å¥çš„å‚æ•°</span><br><span class="line">        null, // GROUP BY å­å¥</span><br><span class="line">        null, // HAVING å­å¥</span><br><span class="line">        null // ORDER BY å­å¥</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    val users = mutableListOf&lt;User&gt;()</span><br><span class="line"></span><br><span class="line">    while (cursor.moveToNext()) &#123;</span><br><span class="line">        val id = cursor.getLong(cursor.getColumnIndexOrThrow(&quot;id&quot;))</span><br><span class="line">        val name = cursor.getString(cursor.getColumnIndexOrThrow(&quot;name&quot;))</span><br><span class="line">        val age = cursor.getInt(cursor.getColumnIndexOrThrow(&quot;age&quot;))</span><br><span class="line"></span><br><span class="line">        users.add(User(id, name, age))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cursor.close()</span><br><span class="line">    db.close()</span><br><span class="line"></span><br><span class="line">    return users</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">data class User(val id: Long, val name: String, val age: Int)</span><br></pre></td></tr></table></figure><ul><li><strong><code>query</code></strong>ï¼šç”¨äºæŸ¥è¯¢æ•°æ®åº“ï¼Œè¿”å›ä¸€ä¸ª <code>Cursor</code> å¯¹è±¡ã€‚ä½ å¯ä»¥é€šè¿‡ <code>Cursor</code> éå†ç»“æœé›†ã€‚</li><li><strong><code>getColumnIndexOrThrow()</code></strong>ï¼šæ ¹æ®åˆ—åè·å–åˆ—çš„ç´¢å¼•ï¼Œ<code>getString()</code>, <code>getInt()</code> ç­‰æ–¹æ³•ç”¨äºæå–æ•°æ®ã€‚</li></ul><h3 id="ä½¿ç”¨-rawQuery-æ–¹æ³•"><a href="#ä½¿ç”¨-rawQuery-æ–¹æ³•" class="headerlink" title="ä½¿ç”¨ rawQuery() æ–¹æ³•"></a>ä½¿ç”¨ <code>rawQuery()</code> æ–¹æ³•</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">fun queryUsersRaw(context: Context): List&lt;User&gt; &#123;</span><br><span class="line">    val dbHelper = MyDatabaseHelper(context)</span><br><span class="line">    val db = dbHelper.readableDatabase</span><br><span class="line"></span><br><span class="line">    val cursor: Cursor = db.rawQuery(&quot;SELECT * FROM users&quot;, null)</span><br><span class="line"></span><br><span class="line">    val users = mutableListOf&lt;User&gt;()</span><br><span class="line"></span><br><span class="line">    while (cursor.moveToNext()) &#123;</span><br><span class="line">        val id = cursor.getLong(cursor.getColumnIndex(&quot;id&quot;))</span><br><span class="line">        val name = cursor.getString(cursor.getColumnIndex(&quot;name&quot;))</span><br><span class="line">        val age = cursor.getInt(cursor.getColumnIndex(&quot;age&quot;))</span><br><span class="line"></span><br><span class="line">        users.add(User(id, name, age))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cursor.close()</span><br><span class="line">    db.close()</span><br><span class="line"></span><br><span class="line">    return users</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong><code>rawQuery()</code></strong>ï¼šæ‰§è¡ŒåŸå§‹çš„ SQL æŸ¥è¯¢è¯­å¥ï¼Œè¿”å›ä¸€ä¸ª <code>Cursor</code>ã€‚</li></ul><h2 id="4-æ›´æ–°æ•°æ®"><a href="#4-æ›´æ–°æ•°æ®" class="headerlink" title="4. æ›´æ–°æ•°æ®"></a><strong>4. æ›´æ–°æ•°æ®</strong></h2><p>æ›´æ–°æ•°æ®ä½¿ç”¨ <code>SQLiteDatabase.update()</code> æ–¹æ³•ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import android.content.ContentValues</span><br><span class="line"></span><br><span class="line">fun updateUser(context: Context, id: Long, name: String, age: Int) &#123;</span><br><span class="line">    val dbHelper = MyDatabaseHelper(context)</span><br><span class="line">    val db = dbHelper.writableDatabase</span><br><span class="line"></span><br><span class="line">    val values = ContentValues().apply &#123;</span><br><span class="line">        put(&quot;name&quot;, name)</span><br><span class="line">        put(&quot;age&quot;, age)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    val selection = &quot;id = ?&quot;</span><br><span class="line">    val selectionArgs = arrayOf(id.toString())</span><br><span class="line"></span><br><span class="line">    db.update(&quot;users&quot;, values, selection, selectionArgs)</span><br><span class="line">    db.close()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong><code>update()</code></strong>ï¼šæ›´æ–°æ•°æ®çš„æ–¹æ³•ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¡¨åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ›´æ–°çš„å€¼ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ <code>WHERE</code> å­å¥ï¼Œç¬¬å››ä¸ªå‚æ•°æ˜¯ <code>WHERE</code> å­å¥çš„å‚æ•°ã€‚</li></ul><h2 id="5-åˆ é™¤æ•°æ®"><a href="#5-åˆ é™¤æ•°æ®" class="headerlink" title="5. åˆ é™¤æ•°æ®"></a><strong>5. åˆ é™¤æ•°æ®</strong></h2><p>åˆ é™¤æ•°æ®ä½¿ç”¨ <code>SQLiteDatabase.delete()</code> æ–¹æ³•ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">fun deleteUser(context: Context, id: Long) &#123;</span><br><span class="line">    val dbHelper = MyDatabaseHelper(context)</span><br><span class="line">    val db = dbHelper.writableDatabase</span><br><span class="line"></span><br><span class="line">    val selection = &quot;id = ?&quot;</span><br><span class="line">    val selectionArgs = arrayOf(id.toString())</span><br><span class="line"></span><br><span class="line">    db.delete(&quot;users&quot;, selection, selectionArgs)</span><br><span class="line">    db.close()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong><code>delete()</code></strong>ï¼šåˆ é™¤æ•°æ®çš„æ–¹æ³•ï¼Œç±»ä¼¼äº <code>update()</code> æ–¹æ³•ï¼Œä¼ å…¥ <code>WHERE</code> å­å¥æ¥æŒ‡å®šåˆ é™¤æ¡ä»¶ã€‚</li></ul><h2 id="6-å…³é—­æ•°æ®åº“è¿æ¥"><a href="#6-å…³é—­æ•°æ®åº“è¿æ¥" class="headerlink" title="6. å…³é—­æ•°æ®åº“è¿æ¥"></a><strong>6. å…³é—­æ•°æ®åº“è¿æ¥</strong></h2><p>æ¯æ¬¡æ“ä½œå®Œæ•°æ®åº“åï¼Œè®°å¾—å…³é—­æ•°æ®åº“è¿æ¥ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.close()</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h2><ol><li><strong>åˆ›å»ºæ•°æ®åº“å’Œè¡¨</strong>ï¼šé€šè¿‡ç»§æ‰¿ <code>SQLiteOpenHelper</code> ç±»æ¥åˆ›å»ºæ•°æ®åº“åŠè¡¨ã€‚</li><li><strong>æ’å…¥æ•°æ®</strong>ï¼šä½¿ç”¨ <code>ContentValues</code> ç»“åˆ <code>insert()</code> æ–¹æ³•æ’å…¥æ•°æ®ã€‚</li><li><strong>æŸ¥è¯¢æ•°æ®</strong>ï¼šé€šè¿‡ <code>query()</code> æˆ– <code>rawQuery()</code> æŸ¥è¯¢æ•°æ®ï¼Œè¿”å› <code>Cursor</code> å¯¹è±¡è¿›è¡Œéå†ã€‚</li><li><strong>æ›´æ–°æ•°æ®</strong>ï¼šä½¿ç”¨ <code>update()</code> æ–¹æ³•æ›´æ–°æ•°æ®ã€‚</li><li><strong>åˆ é™¤æ•°æ®</strong>ï¼šä½¿ç”¨ <code>delete()</code> æ–¹æ³•åˆ é™¤æ•°æ®ã€‚</li><li><strong>å…³é—­æ•°æ®åº“è¿æ¥</strong>ï¼šæ“ä½œå®Œæˆåè®°å¾—å…³é—­æ•°æ®åº“ã€‚</li></ol><p>SQLite æä¾›äº†å¼ºå¤§çš„æœ¬åœ°æ•°æ®å­˜å‚¨èƒ½åŠ›ï¼Œé€‚åˆç”¨äºéœ€è¦å­˜å‚¨ç»“æ„åŒ–æ•°æ®çš„åº”ç”¨ã€‚</p><p><strong>å®Œæ•´ç¤ºä¾‹</strong></p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåº”ç”¨éœ€è¦ä¿å­˜ç”¨æˆ·ä¿¡æ¯ï¼Œæ¯ä¸ªç”¨æˆ·åŒ…å« <code>id</code>ã€<code>name</code> å’Œ <code>email</code>ã€‚æˆ‘ä»¬å¯ä»¥åœ¨æ•°æ®åº“ä¸­åˆ›å»ºä¸€ä¸ªè¡¨å¹¶å¯¹æ•°æ®è¿›è¡Œå¢åˆ æ”¹æŸ¥æ“ä½œã€‚</p><h4 id="1-æ•°æ®åº“åŠ©æ‰‹ç±»"><a href="#1-æ•°æ®åº“åŠ©æ‰‹ç±»" class="headerlink" title="1. æ•°æ®åº“åŠ©æ‰‹ç±»"></a>1. æ•°æ®åº“åŠ©æ‰‹ç±»</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">class MyDatabaseHelper(context: Context) : SQLiteOpenHelper(context, DATABASE_NAME, null, DATABASE_VERSION) &#123;</span><br><span class="line"></span><br><span class="line">    companion object &#123;</span><br><span class="line">        const val DATABASE_NAME = &quot;my_database.db&quot;</span><br><span class="line">        const val DATABASE_VERSION = 1</span><br><span class="line">        const val TABLE_NAME = &quot;users&quot;</span><br><span class="line">        const val COLUMN_ID = &quot;id&quot;</span><br><span class="line">        const val COLUMN_NAME = &quot;name&quot;</span><br><span class="line">        const val COLUMN_EMAIL = &quot;email&quot;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override fun onCreate(db: SQLiteDatabase?) &#123;</span><br><span class="line">        val createTableQuery = &quot;&quot;&quot;</span><br><span class="line">            CREATE TABLE $TABLE_NAME (</span><br><span class="line">                $COLUMN_ID INTEGER PRIMARY KEY AUTOINCREMENT,</span><br><span class="line">                $COLUMN_NAME TEXT,</span><br><span class="line">                $COLUMN_EMAIL TEXT</span><br><span class="line">            )</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        db?.execSQL(createTableQuery)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override fun onUpgrade(db: SQLiteDatabase?, oldVersion: Int, newVersion: Int) &#123;</span><br><span class="line">        db?.execSQL(&quot;DROP TABLE IF EXISTS $TABLE_NAME&quot;)</span><br><span class="line">        onCreate(db)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-æ’å…¥æ•°æ®-1"><a href="#2-æ’å…¥æ•°æ®-1" class="headerlink" title="2. æ’å…¥æ•°æ®"></a>2. æ’å…¥æ•°æ®</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">val dbHelper = MyDatabaseHelper(context)</span><br><span class="line">val db = dbHelper.writableDatabase</span><br><span class="line">val values = ContentValues().apply &#123;</span><br><span class="line">    put(MyDatabaseHelper.COLUMN_NAME, &quot;John Doe&quot;)</span><br><span class="line">    put(MyDatabaseHelper.COLUMN_EMAIL, &quot;john.doe@example.com&quot;)</span><br><span class="line">&#125;</span><br><span class="line">db.insert(MyDatabaseHelper.TABLE_NAME, null, values)</span><br></pre></td></tr></table></figure><h4 id="3-æŸ¥è¯¢æ•°æ®-1"><a href="#3-æŸ¥è¯¢æ•°æ®-1" class="headerlink" title="3. æŸ¥è¯¢æ•°æ®"></a>3. æŸ¥è¯¢æ•°æ®</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">val db = dbHelper.readableDatabase</span><br><span class="line">val cursor = db.query(</span><br><span class="line">    MyDatabaseHelper.TABLE_NAME,</span><br><span class="line">    arrayOf(MyDatabaseHelper.COLUMN_ID, MyDatabaseHelper.COLUMN_NAME, MyDatabaseHelper.COLUMN_EMAIL),</span><br><span class="line">    null, null, null, null, null</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">while (cursor.moveToNext()) &#123;</span><br><span class="line">    val id = cursor.getLong(cursor.getColumnIndex(MyDatabaseHelper.COLUMN_ID))</span><br><span class="line">    val name = cursor.getString(cursor.getColumnIndex(MyDatabaseHelper.COLUMN_NAME))</span><br><span class="line">    val email = cursor.getString(cursor.getColumnIndex(MyDatabaseHelper.COLUMN_EMAIL))</span><br><span class="line">    println(&quot;User: $id, $name, $email&quot;)</span><br><span class="line">&#125;</span><br><span class="line">cursor.close()</span><br></pre></td></tr></table></figure><h4 id="4-æ›´æ–°æ•°æ®-1"><a href="#4-æ›´æ–°æ•°æ®-1" class="headerlink" title="4. æ›´æ–°æ•°æ®"></a>4. æ›´æ–°æ•°æ®</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">val values = ContentValues().apply &#123;</span><br><span class="line">    put(MyDatabaseHelper.COLUMN_NAME, &quot;John Smith&quot;)</span><br><span class="line">&#125;</span><br><span class="line">val selection = &quot;$&#123;MyDatabaseHelper.COLUMN_ID&#125; = ?&quot;</span><br><span class="line">val selectionArgs = arrayOf(&quot;1&quot;)</span><br><span class="line"></span><br><span class="line">val db = dbHelper.writableDatabase</span><br><span class="line">db.update(MyDatabaseHelper.TABLE_NAME, values, selection, selectionArgs)</span><br></pre></td></tr></table></figure><h4 id="5-åˆ é™¤æ•°æ®-1"><a href="#5-åˆ é™¤æ•°æ®-1" class="headerlink" title="5. åˆ é™¤æ•°æ®"></a>5. åˆ é™¤æ•°æ®</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">val selection = &quot;$&#123;MyDatabaseHelper.COLUMN_ID&#125; = ?&quot;</span><br><span class="line">val selectionArgs = arrayOf(&quot;1&quot;)</span><br><span class="line"></span><br><span class="line">val db = dbHelper.writableDatabase</span><br><span class="line">db.delete(MyDatabaseHelper.TABLE_NAME, selection, selectionArgs)</span><br></pre></td></tr></table></figure><h4 id="6-å…³é—­æ•°æ®åº“"><a href="#6-å…³é—­æ•°æ®åº“" class="headerlink" title="6. å…³é—­æ•°æ®åº“"></a>6. å…³é—­æ•°æ®åº“</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.close()</span><br></pre></td></tr></table></figure><hr><h3 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h3><ul><li><strong>SQLiteOpenHelper</strong>ï¼šç®¡ç†æ•°æ®åº“çš„åˆ›å»ºã€å‡çº§ç­‰æ“ä½œã€‚</li><li><strong>SQLiteDatabase</strong>ï¼šç”¨äºæ‰§è¡Œæ•°æ®åº“æ“ä½œï¼Œå¦‚æ’å…¥ã€æŸ¥è¯¢ã€æ›´æ–°ã€åˆ é™¤ã€‚</li><li><strong>ContentValues</strong>ï¼šç”¨äºå­˜å‚¨è¦æ’å…¥æˆ–æ›´æ–°çš„æ•°æ®ã€‚</li><li><strong>Cursor</strong>ï¼šç”¨äºè®¿é—®æŸ¥è¯¢ç»“æœã€‚</li></ul><p>SQLite æ˜¯ä¸€ç§éå¸¸æœ‰æ•ˆçš„æ–¹å¼æ¥åœ¨ Android ä¸Šè¿›è¡Œæœ¬åœ°æ•°æ®å­˜å‚¨ï¼Œå°¤å…¶é€‚ç”¨äºå­˜å‚¨å°å‹ç»“æ„åŒ–æ•°æ®ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“çŸ¥è¯†ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Room+ViewModel+LiveDataä¸€èµ·ä½¿ç”¨çš„ç”¨æ³•</title>
      <link href="/2025/03/15/Room-ViewModel-LiveData%E4%B8%80%E8%B5%B7%E4%BD%BF%E7%94%A8%E7%9A%84%E7%94%A8%E6%B3%95/"/>
      <url>/2025/03/15/Room-ViewModel-LiveData%E4%B8%80%E8%B5%B7%E4%BD%BF%E7%94%A8%E7%9A%84%E7%94%A8%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>åœ¨ <code>Android</code> å¼€å‘ä¸­ï¼Œ<code>Room</code>ã€<code>ViewModel</code> å’Œ <code>LiveData</code> ç»å¸¸ä¸€èµ·ä½¿ç”¨ï¼Œä»¥å®ç° <strong>MVVM æ¶æ„</strong>ï¼Œå¹¶æä¾›æŒä¹…åŒ–æ•°æ®å­˜å‚¨ã€ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥çš„æ•°æ®ç®¡ç†å’Œè‡ªåŠ¨æ›´æ–° UI çš„èƒ½åŠ›ã€‚</p><hr><h1 id="ğŸ“Œ-1-ä¸»è¦ä½œç”¨"><a href="#ğŸ“Œ-1-ä¸»è¦ä½œç”¨" class="headerlink" title="ğŸ“Œ 1. ä¸»è¦ä½œç”¨"></a><strong>ğŸ“Œ 1. ä¸»è¦ä½œç”¨</strong></h1><table><thead><tr><th><strong>ç»„ä»¶</strong></th><th><strong>ä½œç”¨</strong></th></tr></thead><tbody><tr><td><strong>Roomï¼ˆæ•°æ®åº“ï¼‰</strong></td><td>æä¾› SQLite çš„æŠ½è±¡å±‚ï¼Œç®¡ç†æœ¬åœ°æ•°æ®å­˜å‚¨</td></tr><tr><td><strong>ViewModel</strong></td><td>ç®¡ç† UI ç›¸å…³çš„æ•°æ®ï¼Œç¡®ä¿æ•°æ®åœ¨é…ç½®å˜æ›´ï¼ˆå¦‚æ—‹è½¬å±å¹•ï¼‰æ—¶ä¸ä¼šä¸¢å¤±</td></tr><tr><td><strong>LiveData</strong></td><td>è§‚å¯Ÿæ•°æ®å˜åŒ–ï¼Œå¹¶åœ¨ UI ç»„ä»¶ç”Ÿå‘½å‘¨æœŸå†…è‡ªåŠ¨æ›´æ–°</td></tr></tbody></table><hr><h1 id="ğŸš€-2-ä½¿ç”¨-Room-ViewModel-LiveData-çš„å®Œæ•´ç¤ºä¾‹"><a href="#ğŸš€-2-ä½¿ç”¨-Room-ViewModel-LiveData-çš„å®Œæ•´ç¤ºä¾‹" class="headerlink" title="ğŸš€ 2. ä½¿ç”¨ Room + ViewModel + LiveData çš„å®Œæ•´ç¤ºä¾‹"></a><strong>ğŸš€ 2. ä½¿ç”¨ <code>Room + ViewModel + LiveData</code> çš„å®Œæ•´ç¤ºä¾‹</strong></h1><h3 id="ğŸ“Œ-åŠŸèƒ½ï¼š"><a href="#ğŸ“Œ-åŠŸèƒ½ï¼š" class="headerlink" title="ğŸ“Œ åŠŸèƒ½ï¼š"></a><strong>ğŸ“Œ åŠŸèƒ½</strong>ï¼š</h3><p>æˆ‘ä»¬å®ç°ä¸€ä¸ª<strong>ç®€å•çš„å¾…åŠäº‹é¡¹ï¼ˆToDo Listï¼‰åº”ç”¨</strong>ï¼Œå¯ä»¥ï¼š</p><ul><li><strong>å¢åˆ æŸ¥æ”¹ä»»åŠ¡</strong>ï¼Œæ•°æ®å­˜å‚¨åœ¨ <code>Room</code> æ•°æ®åº“ä¸­ã€‚</li><li><strong>ä½¿ç”¨ <code>LiveData</code></strong> è®© UI <strong>è‡ªåŠ¨æ›´æ–°</strong>ï¼Œè€Œä¸éœ€è¦æ‰‹åŠ¨åˆ·æ–°ã€‚</li><li><strong><code>ViewModel</code> è´Ÿè´£ç®¡ç†æ•°æ®</strong>ï¼Œé¿å… <code>Activity</code> ç›´æ¥æ“ä½œæ•°æ®åº“ã€‚</li></ul><hr><h2 id="ğŸ“Œ-3-åˆ›å»º-Room-æ•°æ®åº“"><a href="#ğŸ“Œ-3-åˆ›å»º-Room-æ•°æ®åº“" class="headerlink" title="ğŸ“Œ 3. åˆ›å»º Room æ•°æ®åº“"></a><strong>ğŸ“Œ 3. åˆ›å»º Room æ•°æ®åº“</strong></h2><h3 id="ï¼ˆ1ï¼‰å®šä¹‰-Entityï¼ˆæ•°æ®åº“è¡¨ï¼‰"><a href="#ï¼ˆ1ï¼‰å®šä¹‰-Entityï¼ˆæ•°æ®åº“è¡¨ï¼‰" class="headerlink" title="ï¼ˆ1ï¼‰å®šä¹‰ Entityï¼ˆæ•°æ®åº“è¡¨ï¼‰"></a><strong>ï¼ˆ1ï¼‰å®šä¹‰ <code>Entity</code>ï¼ˆæ•°æ®åº“è¡¨ï¼‰</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import androidx.room.Entity</span><br><span class="line">import androidx.room.PrimaryKey</span><br><span class="line"></span><br><span class="line">@Entity(tableName = &quot;todo_table&quot;)</span><br><span class="line">data class Todo(</span><br><span class="line">    @PrimaryKey(autoGenerate = true) val id: Int = 0,</span><br><span class="line">    val task: String,</span><br><span class="line">    val isCompleted: Boolean</span><br><span class="line">)</span><br></pre></td></tr></table></figure><ul><li><code>@Entity</code>ï¼šè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªæ•°æ®åº“è¡¨ï¼Œè¡¨åæ˜¯ <code>todo_table</code>ã€‚</li><li><code>@PrimaryKey(autoGenerate = true)</code>ï¼š<code>id</code> æ˜¯ä¸»é”®ï¼Œ<code>Room</code> ä¼šè‡ªåŠ¨ç”Ÿæˆã€‚</li></ul><hr><h3 id="ï¼ˆ2ï¼‰åˆ›å»º-DAOï¼ˆæ•°æ®è®¿é—®å¯¹è±¡ï¼‰"><a href="#ï¼ˆ2ï¼‰åˆ›å»º-DAOï¼ˆæ•°æ®è®¿é—®å¯¹è±¡ï¼‰" class="headerlink" title="ï¼ˆ2ï¼‰åˆ›å»º DAOï¼ˆæ•°æ®è®¿é—®å¯¹è±¡ï¼‰"></a><strong>ï¼ˆ2ï¼‰åˆ›å»º DAOï¼ˆæ•°æ®è®¿é—®å¯¹è±¡ï¼‰</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import androidx.lifecycle.LiveData</span><br><span class="line">import androidx.room.*</span><br><span class="line"></span><br><span class="line">@Dao</span><br><span class="line">interface TodoDao &#123;</span><br><span class="line">    @Insert(onConflict = OnConflictStrategy.REPLACE)</span><br><span class="line">    suspend fun insert(todo: Todo)</span><br><span class="line"></span><br><span class="line">    @Update</span><br><span class="line">    suspend fun update(todo: Todo)</span><br><span class="line"></span><br><span class="line">    @Delete</span><br><span class="line">    suspend fun delete(todo: Todo)</span><br><span class="line"></span><br><span class="line">    @Query(&quot;SELECT * FROM todo_table ORDER BY id DESC&quot;)</span><br><span class="line">    fun getAllTodos(): LiveData&lt;List&lt;Todo&gt;&gt; // ä½¿ç”¨ LiveData è®© UI è‡ªåŠ¨æ›´æ–°</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>@Dao</code>ï¼šæ•°æ®è®¿é—®å¯¹è±¡ï¼Œå®šä¹‰æ•°æ®åº“æ“ä½œã€‚</li><li><code>@Insert</code> &#x2F; <code>@Update</code> &#x2F; <code>@Delete</code>ï¼šæ“ä½œæ•°æ®åº“çš„åŸºæœ¬å¢ã€åˆ ã€æ”¹ã€‚</li><li><code>getAllTodos()</code> è¿”å› <code>LiveData&lt;List&lt;Todo&gt;&gt;</code>ï¼Œ<strong>Room ä¼šè‡ªåŠ¨ç›‘å¬æ•°æ®å˜åŒ–ï¼Œå¹¶æ›´æ–° UI</strong>ã€‚</li></ul><hr><h3 id="ï¼ˆ3ï¼‰åˆ›å»º-Room-æ•°æ®åº“"><a href="#ï¼ˆ3ï¼‰åˆ›å»º-Room-æ•°æ®åº“" class="headerlink" title="ï¼ˆ3ï¼‰åˆ›å»º Room æ•°æ®åº“"></a><strong>ï¼ˆ3ï¼‰åˆ›å»º Room æ•°æ®åº“</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import android.content.Context</span><br><span class="line">import androidx.room.Database</span><br><span class="line">import androidx.room.Room</span><br><span class="line">import androidx.room.RoomDatabase</span><br><span class="line"></span><br><span class="line">@Database(entities = [Todo::class], version = 1, exportSchema = false)</span><br><span class="line">abstract class TodoDatabase : RoomDatabase() &#123;</span><br><span class="line">    abstract fun todoDao(): TodoDao</span><br><span class="line"></span><br><span class="line">    companion object &#123;</span><br><span class="line">        @Volatile</span><br><span class="line">        private var INSTANCE: TodoDatabase? = null</span><br><span class="line"></span><br><span class="line">        fun getDatabase(context: Context): TodoDatabase &#123;</span><br><span class="line">            return INSTANCE ?: synchronized(this) &#123;</span><br><span class="line">                val instance = Room.databaseBuilder(</span><br><span class="line">                    context.applicationContext,</span><br><span class="line">                    TodoDatabase::class.java,</span><br><span class="line">                    &quot;todo_database&quot;</span><br><span class="line">                ).build()</span><br><span class="line">                INSTANCE = instance</span><br><span class="line">                instance</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>@Database(entities = [Todo::class], version = 1)</code>ï¼šå®šä¹‰æ•°æ®åº“ï¼ŒåŒ…å« <code>Todo</code> è¡¨ã€‚</li><li><code>synchronized(this)</code>ï¼šä¿è¯æ•°æ®åº“å®ä¾‹çš„çº¿ç¨‹å®‰å…¨ã€‚</li><li><code>Room.databaseBuilder()</code>ï¼šæ„å»º <code>Room</code> æ•°æ®åº“å®ä¾‹ã€‚</li></ul><hr><h2 id="ğŸ“Œ-4-åˆ›å»º-Repository"><a href="#ğŸ“Œ-4-åˆ›å»º-Repository" class="headerlink" title="ğŸ“Œ 4. åˆ›å»º Repository"></a><strong>ğŸ“Œ 4. åˆ›å»º Repository</strong></h2><p><code>Repository</code> è´Ÿè´£å¤„ç† <code>DAO</code> æ“ä½œï¼Œé¿å… <code>ViewModel</code> ç›´æ¥æ“ä½œæ•°æ®åº“ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import androidx.lifecycle.LiveData</span><br><span class="line"></span><br><span class="line">class TodoRepository(private val todoDao: TodoDao) &#123;</span><br><span class="line">    val allTodos: LiveData&lt;List&lt;Todo&gt;&gt; = todoDao.getAllTodos()</span><br><span class="line"></span><br><span class="line">    suspend fun insert(todo: Todo) &#123;</span><br><span class="line">        todoDao.insert(todo)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    suspend fun update(todo: Todo) &#123;</span><br><span class="line">        todoDao.update(todo)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    suspend fun delete(todo: Todo) &#123;</span><br><span class="line">        todoDao.delete(todo)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>Repository</code> å°è£… <code>DAO</code>ï¼Œ<strong>ViewModel åªéœ€è¦è°ƒç”¨ <code>Repository</code>ï¼Œè€Œä¸ç›´æ¥æ“ä½œ <code>Room</code></strong>ã€‚</li></ul><hr><h2 id="ğŸ“Œ-5-åˆ›å»º-ViewModel"><a href="#ğŸ“Œ-5-åˆ›å»º-ViewModel" class="headerlink" title="ğŸ“Œ 5. åˆ›å»º ViewModel"></a><strong>ğŸ“Œ 5. åˆ›å»º ViewModel</strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import androidx.lifecycle.*</span><br><span class="line">import kotlinx.coroutines.launch</span><br><span class="line"></span><br><span class="line">class TodoViewModel(private val repository: TodoRepository) : ViewModel() &#123;</span><br><span class="line">    val allTodos: LiveData&lt;List&lt;Todo&gt;&gt; = repository.allTodos</span><br><span class="line"></span><br><span class="line">    fun insert(todo: Todo) = viewModelScope.launch &#123;</span><br><span class="line">        repository.insert(todo)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fun update(todo: Todo) = viewModelScope.launch &#123;</span><br><span class="line">        repository.update(todo)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fun delete(todo: Todo) = viewModelScope.launch &#123;</span><br><span class="line">        repository.delete(todo)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>viewModelScope.launch &#123;&#125;</code> è®©æ•°æ®åº“æ“ä½œåœ¨ <strong>åå°çº¿ç¨‹æ‰§è¡Œ</strong>ï¼ˆ<code>suspend</code> éœ€è¦ <code>Coroutine</code>ï¼‰ã€‚</li><li><code>LiveData&lt;List&lt;Todo&gt;&gt;</code> ç¡®ä¿ UI è‡ªåŠ¨æ›´æ–°ã€‚</li></ul><hr><h2 id="ğŸ“Œ-6-åˆ›å»º-ViewModelFactory"><a href="#ğŸ“Œ-6-åˆ›å»º-ViewModelFactory" class="headerlink" title="ğŸ“Œ 6. åˆ›å»º ViewModelFactory"></a><strong>ğŸ“Œ 6. åˆ›å»º ViewModelFactory</strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import androidx.lifecycle.ViewModel</span><br><span class="line">import androidx.lifecycle.ViewModelProvider</span><br><span class="line"></span><br><span class="line">class TodoViewModelFactory(private val repository: TodoRepository) : ViewModelProvider.Factory &#123;</span><br><span class="line">    override fun &lt;T : ViewModel&gt; create(modelClass: Class&lt;T&gt;): T &#123;</span><br><span class="line">        if (modelClass.isAssignableFrom(TodoViewModel::class.java)) &#123;</span><br><span class="line">            @Suppress(&quot;UNCHECKED_CAST&quot;)</span><br><span class="line">            return TodoViewModel(repository) as T</span><br><span class="line">        &#125;</span><br><span class="line">        throw IllegalArgumentException(&quot;Unknown ViewModel class&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>ViewModelFactory</code> ç”¨äº <strong>ä¼ é€’ <code>Repository</code></strong>ï¼Œè®© <code>ViewModel</code> ä½¿ç”¨ <code>Room</code>ã€‚</li></ul><hr><h2 id="ğŸ“Œ-7-åœ¨-Activity-é‡Œä½¿ç”¨"><a href="#ğŸ“Œ-7-åœ¨-Activity-é‡Œä½¿ç”¨" class="headerlink" title="ğŸ“Œ 7. åœ¨ Activity é‡Œä½¿ç”¨"></a><strong>ğŸ“Œ 7. åœ¨ <code>Activity</code> é‡Œä½¿ç”¨</strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">class MainActivity : AppCompatActivity() &#123;</span><br><span class="line">    private lateinit var todoViewModel: TodoViewModel</span><br><span class="line"></span><br><span class="line">    override fun onCreate(savedInstanceState: Bundle?) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line"></span><br><span class="line">        // è·å–æ•°æ®åº“å®ä¾‹å’Œ DAO</span><br><span class="line">        val database = TodoDatabase.getDatabase(this)</span><br><span class="line">        val repository = TodoRepository(database.todoDao())</span><br><span class="line"></span><br><span class="line">        // åˆ›å»º ViewModel</span><br><span class="line">        val factory = TodoViewModelFactory(repository)</span><br><span class="line">        todoViewModel = ViewModelProvider(this, factory).get(TodoViewModel::class.java)</span><br><span class="line"></span><br><span class="line">        // ç›‘å¬ LiveDataï¼Œæ›´æ–° UI</span><br><span class="line">        todoViewModel.allTodos.observe(this) &#123; todos -&gt;</span><br><span class="line">            // æ›´æ–° RecyclerView æˆ– UI</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // æ·»åŠ ä»»åŠ¡</span><br><span class="line">        buttonAdd.setOnClickListener &#123;</span><br><span class="line">            val newTodo = Todo(task = &quot;New Task&quot;, isCompleted = false)</span><br><span class="line">            todoViewModel.insert(newTodo)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>getDatabase(this)</code> è·å–æ•°æ®åº“å®ä¾‹ã€‚</li><li><code>ViewModelProvider(this, factory)</code> åˆ›å»º <code>ViewModel</code>ã€‚</li><li><code>LiveData.observe()</code> ç›‘å¬æ•°æ®å˜åŒ–ï¼Œ<strong>UI è‡ªåŠ¨æ›´æ–°</strong>ã€‚</li></ul><hr><h1 id="ğŸ“Œ-8-æ€»ç»“"><a href="#ğŸ“Œ-8-æ€»ç»“" class="headerlink" title="ğŸ“Œ 8. æ€»ç»“"></a><strong>ğŸ“Œ 8. æ€»ç»“</strong></h1><p>âœ… <strong>Room è´Ÿè´£å­˜å‚¨æ•°æ®</strong>ï¼Œ<code>DAO</code> è´Ÿè´£æ•°æ®åº“æ“ä½œã€‚<br> âœ… <strong>ViewModel è´Ÿè´£æŒä¹…åŒ–æ•°æ®</strong>ï¼Œé¿å…å› å±å¹•æ—‹è½¬å¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚<br> âœ… <strong>LiveData è®© UI è‡ªåŠ¨æ›´æ–°</strong>ï¼Œä¸éœ€è¦æ‰‹åŠ¨åˆ·æ–°æ•°æ®ã€‚<br> âœ… <strong>Repository ä½œä¸ºæ•°æ®ä¸­ä»‹</strong>ï¼Œé¿å… <code>ViewModel</code> ç›´æ¥æ“ä½œ <code>Room</code>ã€‚</p><p>ğŸ“Œ <strong>æœ€ç»ˆæ•ˆæœ</strong>ï¼š</p><ol><li><strong>æ•°æ®åº“å˜æ›´æ—¶ï¼ŒUI è‡ªåŠ¨æ›´æ–°</strong>ï¼ˆ<code>LiveData</code>ï¼‰ã€‚</li><li><strong>ViewModel è®©æ•°æ®åœ¨ Activity&#x2F;Fragment ç”Ÿå‘½å‘¨æœŸå†…æŒä¹…åŒ–</strong>ã€‚</li><li><strong>Repository è®©æ•°æ®ç®¡ç†æ›´æ¸…æ™°</strong>ï¼Œé¿å… <code>ViewModel</code> ç›´æ¥è®¿é—®æ•°æ®åº“ã€‚</li></ol><p>ğŸ’¡ <strong>è¿™æ ·ï¼Œæˆ‘ä»¬çš„ <code>MVVM + Room</code> æ¶æ„æ›´åŠ æ¸…æ™°ï¼Œå¯ç»´æŠ¤æ€§æ›´å¼ºï¼</strong> ğŸš€</p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“çŸ¥è¯†ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ViewModelç”¨æ³•</title>
      <link href="/2025/03/15/ViewModel%E7%94%A8%E6%B3%95/"/>
      <url>/2025/03/15/ViewModel%E7%94%A8%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p><code>ViewModel</code> æ˜¯ Android æ¶æ„ç»„ä»¶ä¹‹ä¸€ï¼Œ<strong>ç”¨äºç®¡ç† UI ç›¸å…³çš„æ•°æ®</strong>ï¼Œå¹¶åœ¨ <strong>é…ç½®æ›´æ”¹ï¼ˆå¦‚å±å¹•æ—‹è½¬ï¼‰æ—¶ä¿æŒæ•°æ®ä¸ä¸¢å¤±</strong>ã€‚</p><hr><h2 id="ğŸ”¹-1-æ·»åŠ -ViewModel-ä¾èµ–"><a href="#ğŸ”¹-1-æ·»åŠ -ViewModel-ä¾èµ–" class="headerlink" title="ğŸ”¹ 1. æ·»åŠ  ViewModel ä¾èµ–"></a><strong>ğŸ”¹ 1. æ·»åŠ  ViewModel ä¾èµ–</strong></h2><p>åœ¨ <code>build.gradle.kts</code>ï¼ˆæ¨¡å—çº§ï¼‰ä¸­æ·»åŠ ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    implementation(&quot;androidx.lifecycle:lifecycle-viewmodel-ktx:2.6.2&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="ğŸ”¹-2-åˆ›å»º-ViewModel"><a href="#ğŸ”¹-2-åˆ›å»º-ViewModel" class="headerlink" title="ğŸ”¹ 2. åˆ›å»º ViewModel"></a><strong>ğŸ”¹ 2. åˆ›å»º ViewModel</strong></h2><h3 id="ï¼ˆ1ï¼‰åŸºç¡€-ViewModel"><a href="#ï¼ˆ1ï¼‰åŸºç¡€-ViewModel" class="headerlink" title="ï¼ˆ1ï¼‰åŸºç¡€ ViewModel"></a><strong>ï¼ˆ1ï¼‰åŸºç¡€ ViewModel</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import androidx.lifecycle.ViewModel</span><br><span class="line"></span><br><span class="line">class CounterViewModel : ViewModel() &#123;</span><br><span class="line">    var count = 0 // ViewModel å˜é‡ï¼ˆActivity é‡å»ºåä¸ä¼šä¸¢å¤±ï¼‰</span><br><span class="line"></span><br><span class="line">    fun increment() &#123;</span><br><span class="line">        count++</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="ğŸ”¹-3-åœ¨-Activity-Fragment-ä¸­ä½¿ç”¨"><a href="#ğŸ”¹-3-åœ¨-Activity-Fragment-ä¸­ä½¿ç”¨" class="headerlink" title="ğŸ”¹ 3. åœ¨ Activity&#x2F;Fragment ä¸­ä½¿ç”¨"></a><strong>ğŸ”¹ 3. åœ¨ Activity&#x2F;Fragment ä¸­ä½¿ç”¨</strong></h2><h3 id="ï¼ˆ1ï¼‰Activity-è·å–-ViewModel"><a href="#ï¼ˆ1ï¼‰Activity-è·å–-ViewModel" class="headerlink" title="ï¼ˆ1ï¼‰Activity è·å– ViewModel"></a><strong>ï¼ˆ1ï¼‰Activity è·å– ViewModel</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import android.os.Bundle</span><br><span class="line">import android.widget.TextView</span><br><span class="line">import androidx.activity.viewModels</span><br><span class="line">import androidx.appcompat.app.AppCompatActivity</span><br><span class="line"></span><br><span class="line">class MainActivity : AppCompatActivity() &#123;</span><br><span class="line">    private val counterViewModel: CounterViewModel by viewModels() // é€šè¿‡ viewModels() è·å– ViewModel</span><br><span class="line"></span><br><span class="line">    override fun onCreate(savedInstanceState: Bundle?) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line"></span><br><span class="line">        val textView: TextView = findViewById(R.id.counterText)</span><br><span class="line">        val button: Button = findViewById(R.id.incrementButton)</span><br><span class="line"></span><br><span class="line">        // æ˜¾ç¤ºå½“å‰è®¡æ•°</span><br><span class="line">        textView.text = counterViewModel.count.toString()</span><br><span class="line"></span><br><span class="line">        // ç‚¹å‡»æŒ‰é’®å¢åŠ è®¡æ•°</span><br><span class="line">        button.setOnClickListener &#123;</span><br><span class="line">            counterViewModel.increment()</span><br><span class="line">            textView.text = counterViewModel.count.toString()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>âœ… <strong>å³ä½¿æ—‹è½¬å±å¹•ï¼Œ<code>count</code> ä¹Ÿä¸ä¼šé‡ç½®</strong>ã€‚</p><hr><h2 id="ğŸ”¹-4-ViewModel-LiveData-ç›‘å¬æ•°æ®å˜åŒ–"><a href="#ğŸ”¹-4-ViewModel-LiveData-ç›‘å¬æ•°æ®å˜åŒ–" class="headerlink" title="ğŸ”¹ 4. ViewModel + LiveData ç›‘å¬æ•°æ®å˜åŒ–"></a><strong>ğŸ”¹ 4. ViewModel + LiveData ç›‘å¬æ•°æ®å˜åŒ–</strong></h2><p>ä½¿ç”¨ <code>LiveData</code>ï¼Œ<strong>UI ä¼šè‡ªåŠ¨æ›´æ–°</strong>ï¼š</p><h3 id="ï¼ˆ1ï¼‰ViewModelï¼ˆä½¿ç”¨-LiveDataï¼‰"><a href="#ï¼ˆ1ï¼‰ViewModelï¼ˆä½¿ç”¨-LiveDataï¼‰" class="headerlink" title="ï¼ˆ1ï¼‰ViewModelï¼ˆä½¿ç”¨ LiveDataï¼‰"></a><strong>ï¼ˆ1ï¼‰ViewModelï¼ˆä½¿ç”¨ <code>LiveData</code>ï¼‰</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import androidx.lifecycle.LiveData</span><br><span class="line">import androidx.lifecycle.MutableLiveData</span><br><span class="line">import androidx.lifecycle.ViewModel</span><br><span class="line"></span><br><span class="line">class CounterViewModel : ViewModel() &#123;</span><br><span class="line">    private val _count = MutableLiveData(0) // å¯å˜ LiveData</span><br><span class="line">    val count: LiveData&lt;Int&gt; = _count // åªæš´éœ²ä¸å¯å˜ LiveData</span><br><span class="line"></span><br><span class="line">    fun increment() &#123;</span><br><span class="line">        _count.value = (_count.value ?: 0) + 1 // æ›´æ–°æ•°æ®</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ï¼ˆ2ï¼‰Activity-è§‚å¯Ÿ-LiveData"><a href="#ï¼ˆ2ï¼‰Activity-è§‚å¯Ÿ-LiveData" class="headerlink" title="ï¼ˆ2ï¼‰Activity è§‚å¯Ÿ LiveData"></a><strong>ï¼ˆ2ï¼‰Activity è§‚å¯Ÿ LiveData</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">class MainActivity : AppCompatActivity() &#123;</span><br><span class="line">    private val counterViewModel: CounterViewModel by viewModels()</span><br><span class="line"></span><br><span class="line">    override fun onCreate(savedInstanceState: Bundle?) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line"></span><br><span class="line">        val textView: TextView = findViewById(R.id.counterText)</span><br><span class="line">        val button: Button = findViewById(R.id.incrementButton)</span><br><span class="line"></span><br><span class="line">        // è§‚å¯Ÿ LiveDataï¼Œè‡ªåŠ¨æ›´æ–° UI</span><br><span class="line">        counterViewModel.count.observe(this) &#123; newCount -&gt;</span><br><span class="line">            textView.text = newCount.toString()</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        button.setOnClickListener &#123;</span><br><span class="line">            counterViewModel.increment()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>âœ… <strong><code>LiveData</code> ç¡®ä¿æ•°æ®å˜åŒ–æ—¶ï¼ŒUI ä¼šè‡ªåŠ¨æ›´æ–°</strong>ã€‚</p><hr><h2 id="ğŸ”¹-5-å¤„ç†-ViewModel-ä¾èµ–ï¼ˆå¸¦å‚æ•°çš„-ViewModelï¼‰"><a href="#ğŸ”¹-5-å¤„ç†-ViewModel-ä¾èµ–ï¼ˆå¸¦å‚æ•°çš„-ViewModelï¼‰" class="headerlink" title="ğŸ”¹ 5. å¤„ç† ViewModel ä¾èµ–ï¼ˆå¸¦å‚æ•°çš„ ViewModelï¼‰"></a><strong>ğŸ”¹ 5. å¤„ç† ViewModel ä¾èµ–ï¼ˆå¸¦å‚æ•°çš„ ViewModelï¼‰</strong></h2><h3 id="ï¼ˆ1ï¼‰ViewModel-éœ€è¦å‚æ•°"><a href="#ï¼ˆ1ï¼‰ViewModel-éœ€è¦å‚æ•°" class="headerlink" title="ï¼ˆ1ï¼‰ViewModel éœ€è¦å‚æ•°"></a><strong>ï¼ˆ1ï¼‰ViewModel éœ€è¦å‚æ•°</strong></h3><p>å¦‚æœ <code>ViewModel</code> éœ€è¦å‚æ•°ï¼ˆå¦‚ <code>Repository</code>ï¼‰ï¼Œéœ€è¦åˆ›å»º <code>ViewModelProvider.Factory</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">class CounterViewModel(private val startValue: Int) : ViewModel() &#123;</span><br><span class="line">    private val _count = MutableLiveData(startValue)</span><br><span class="line">    val count: LiveData&lt;Int&gt; = _count</span><br><span class="line"></span><br><span class="line">    fun increment() &#123;</span><br><span class="line">        _count.value = (_count.value ?: 0) + 1</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// è‡ªå®šä¹‰ ViewModelFactory</span><br><span class="line">class CounterViewModelFactory(private val startValue: Int) : ViewModelProvider.Factory &#123;</span><br><span class="line">    override fun &lt;T : ViewModel&gt; create(modelClass: Class&lt;T&gt;): T &#123;</span><br><span class="line">        if (modelClass.isAssignableFrom(CounterViewModel::class.java)) &#123;</span><br><span class="line">            @Suppress(&quot;UNCHECKED_CAST&quot;)</span><br><span class="line">            return CounterViewModel(startValue) as T</span><br><span class="line">        &#125;</span><br><span class="line">        throw IllegalArgumentException(&quot;Unknown ViewModel class&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ï¼ˆ2ï¼‰Activity-è·å–å¸¦å‚æ•°çš„-ViewModel"><a href="#ï¼ˆ2ï¼‰Activity-è·å–å¸¦å‚æ•°çš„-ViewModel" class="headerlink" title="ï¼ˆ2ï¼‰Activity è·å–å¸¦å‚æ•°çš„ ViewModel"></a><strong>ï¼ˆ2ï¼‰Activity è·å–å¸¦å‚æ•°çš„ ViewModel</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">class MainActivity : AppCompatActivity() &#123;</span><br><span class="line">    private val counterViewModel: CounterViewModel by viewModels &#123;</span><br><span class="line">        CounterViewModelFactory(5) // ä¼ å…¥åˆå§‹å€¼ 5</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override fun onCreate(savedInstanceState: Bundle?) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line"></span><br><span class="line">        val textView: TextView = findViewById(R.id.counterText)</span><br><span class="line">        val button: Button = findViewById(R.id.incrementButton)</span><br><span class="line"></span><br><span class="line">        counterViewModel.count.observe(this) &#123; newCount -&gt;</span><br><span class="line">            textView.text = newCount.toString()</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        button.setOnClickListener &#123;</span><br><span class="line">            counterViewModel.increment()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>âœ… <strong>æ”¯æŒå¸¦å‚æ•°çš„ ViewModelï¼ˆå¦‚ä»æ•°æ®åº“æˆ–ç½‘ç»œè·å–åˆå§‹æ•°æ®ï¼‰</strong>ã€‚</p><hr><h2 id="ğŸ”¹-6-ViewModel-Room-æŒä¹…åŒ–æ•°æ®åº“æ•°æ®"><a href="#ğŸ”¹-6-ViewModel-Room-æŒä¹…åŒ–æ•°æ®åº“æ•°æ®" class="headerlink" title="ğŸ”¹ 6. ViewModel + Room æŒä¹…åŒ–æ•°æ®åº“æ•°æ®"></a><strong>ğŸ”¹ 6. ViewModel + Room æŒä¹…åŒ–æ•°æ®åº“æ•°æ®</strong></h2><p>å¦‚æœä½ ä½¿ç”¨ <code>Room</code> å­˜å‚¨æ•°æ®ï¼Œ<code>ViewModel</code> å¯ä»¥ç›´æ¥ä» <code>Room</code> è·å– <code>LiveData</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Dao</span><br><span class="line">interface DiaryDao &#123;</span><br><span class="line">    @Query(&quot;SELECT * FROM diary_entries ORDER BY date DESC&quot;)</span><br><span class="line">    fun getAllDiaries(): LiveData&lt;List&lt;DiaryEntry&gt;&gt; // LiveData ç›‘å¬æ•°æ®åº“</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class DiaryViewModel(private val diaryDao: DiaryDao) : ViewModel() &#123;</span><br><span class="line">    val diaryList: LiveData&lt;List&lt;DiaryEntry&gt;&gt; = diaryDao.getAllDiaries()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ <code>Fragment</code> è§‚å¯Ÿæ•°æ®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">diaryViewModel.diaryList.observe(viewLifecycleOwner) &#123; diaryList -&gt;</span><br><span class="line">    diaryAdapter.submitList(diaryList) // æ›´æ–° UI</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>âœ… <strong>Room + ViewModel + LiveData ç¡®ä¿æ•°æ®æŒä¹…åŒ–ï¼Œå¹¶è‡ªåŠ¨æ›´æ–° UI</strong>ã€‚</p><hr><h2 id="ğŸ”¹-7-ViewModel-Kotlin-Flowï¼ˆåç¨‹ï¼‰"><a href="#ğŸ”¹-7-ViewModel-Kotlin-Flowï¼ˆåç¨‹ï¼‰" class="headerlink" title="ğŸ”¹ 7. ViewModel + Kotlin Flowï¼ˆåç¨‹ï¼‰"></a><strong>ğŸ”¹ 7. ViewModel + Kotlin Flowï¼ˆåç¨‹ï¼‰</strong></h2><p>å¦‚æœä½ ç”¨ <code>Flow</code>ï¼Œå¯ä»¥è¿™æ ·ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">class DiaryViewModel(private val diaryDao: DiaryDao) : ViewModel() &#123;</span><br><span class="line">    val diaryListFlow = diaryDao.getAllDiariesFlow()</span><br><span class="line">        .stateIn(viewModelScope, SharingStarted.Lazily, emptyList()) // è½¬ä¸º StateFlow</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ <code>Fragment</code> ä¸­ <code>collect</code> æ•°æ®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">lifecycleScope.launch &#123;</span><br><span class="line">    viewModel.diaryListFlow.collect &#123; diaryList -&gt;</span><br><span class="line">        diaryAdapter.submitList(diaryList)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>âœ… <strong><code>Flow</code> æ›´é€‚åˆå¤æ‚æ•°æ®æµï¼ˆå¦‚æ•°æ®åº“ã€ç½‘ç»œè¯·æ±‚ï¼‰</strong>ã€‚</p><hr><h2 id="ğŸ”¹-8-ViewModel-ç”Ÿå‘½å‘¨æœŸ"><a href="#ğŸ”¹-8-ViewModel-ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ğŸ”¹ 8. ViewModel ç”Ÿå‘½å‘¨æœŸ"></a><strong>ğŸ”¹ 8. ViewModel ç”Ÿå‘½å‘¨æœŸ</strong></h2><table><thead><tr><th><strong>åœºæ™¯</strong></th><th><strong>ViewModel ä½œç”¨</strong></th></tr></thead><tbody><tr><td>æ—‹è½¬å±å¹•</td><td>ä¿æŒæ•°æ®ä¸ä¸¢å¤±</td></tr><tr><td>App è¿›åå°</td><td>ViewModel å¯èƒ½è¢«é”€æ¯ï¼ˆå¯ç”¨ <code>SavedStateHandle</code> å¤„ç†ï¼‰</td></tr><tr><td>Fragment åˆ‡æ¢</td><td>å…±äº« <code>ViewModel</code> ä»¥ä¿ç•™æ•°æ®</td></tr></tbody></table><hr><h2 id="ğŸ”¹-æ€»ç»“"><a href="#ğŸ”¹-æ€»ç»“" class="headerlink" title="ğŸ”¹ æ€»ç»“"></a><strong>ğŸ”¹ æ€»ç»“</strong></h2><p>âœ… <code>ViewModel</code> <strong>ç”¨äºç®¡ç† UI ç›¸å…³æ•°æ®ï¼Œé¿å…å› å±å¹•æ—‹è½¬å¯¼è‡´æ•°æ®ä¸¢å¤±</strong>ã€‚<br> âœ… æ­é… <code>LiveData</code> <strong>è‡ªåŠ¨é€šçŸ¥ UI å˜åŒ–</strong>ã€‚<br> âœ… <code>ViewModel</code> + <code>Room</code> <strong>å¯ä»¥è‡ªåŠ¨ç›‘å¬æ•°æ®åº“å˜åŒ–</strong>ã€‚<br> âœ… <code>ViewModel</code> + <code>Flow</code> <strong>é€‚åˆå¤æ‚æ•°æ®æµå¤„ç†</strong>ã€‚<br> âœ… <code>ViewModelFactory</code> <strong>ç”¨äºåˆ›å»ºå¸¦å‚æ•°çš„ ViewModel</strong>ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“çŸ¥è¯†ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Roomç”¨æ³•</title>
      <link href="/2025/03/15/Room%E7%94%A8%E6%B3%95/"/>
      <url>/2025/03/15/Room%E7%94%A8%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>Room æ˜¯ Android å®˜æ–¹æ¨èçš„æ•°æ®åº“æ¡†æ¶ï¼Œå®ƒæ˜¯ SQLite çš„æŠ½è±¡å°è£…ï¼Œæä¾›äº†æ›´ä¾¿æ·çš„æ•°æ®åº“æ“ä½œæ–¹å¼ï¼Œæ”¯æŒ Kotlin åç¨‹å’Œ LiveDataã€‚ä»¥ä¸‹æ˜¯ Room çš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•ï¼š</p><hr><h2 id="1-æ·»åŠ -Room-ä¾èµ–"><a href="#1-æ·»åŠ -Room-ä¾èµ–" class="headerlink" title="1. æ·»åŠ  Room ä¾èµ–"></a><strong>1. æ·»åŠ  Room ä¾èµ–</strong></h2><p>åœ¨ <code>build.gradle.kts</code>ï¼ˆæ¨¡å—çº§ï¼‰ä¸­æ·»åŠ  Room ç›¸å…³ä¾èµ–ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    val room_version = &quot;2.6.1&quot; // ç¡®ä¿ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬</span><br><span class="line"></span><br><span class="line">    implementation(&quot;androidx.room:room-runtime:$room_version&quot;)</span><br><span class="line">    kapt(&quot;androidx.room:room-compiler:$room_version&quot;) // ç”¨äºæ³¨è§£å¤„ç†å™¨</span><br><span class="line"></span><br><span class="line">    implementation(&quot;androidx.room:room-ktx:$room_version&quot;) // æ”¯æŒ Kotlin åç¨‹</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœé¡¹ç›®ä½¿ç”¨ Kotlin Symbol Processing (KSP) ä»£æ›¿ kaptï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ksp(&quot;androidx.room:room-compiler:$room_version&quot;)</span><br></pre></td></tr></table></figure><hr><h2 id="2-åˆ›å»ºæ•°æ®åº“å®ä½“ï¼ˆEntityï¼‰"><a href="#2-åˆ›å»ºæ•°æ®åº“å®ä½“ï¼ˆEntityï¼‰" class="headerlink" title="2. åˆ›å»ºæ•°æ®åº“å®ä½“ï¼ˆEntityï¼‰"></a><strong>2. åˆ›å»ºæ•°æ®åº“å®ä½“ï¼ˆEntityï¼‰</strong></h2><p>ä½¿ç”¨ <code>@Entity</code> æ³¨è§£å®šä¹‰æ•°æ®åº“è¡¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import androidx.room.Entity</span><br><span class="line">import androidx.room.PrimaryKey</span><br><span class="line"></span><br><span class="line">@Entity(tableName = &quot;diary_entries&quot;) // æŒ‡å®šè¡¨å</span><br><span class="line">data class DiaryEntry(</span><br><span class="line">    @PrimaryKey(autoGenerate = true) val id: Int = 0, // ä¸»é”®ï¼Œè‡ªåŠ¨ç”Ÿæˆ</span><br><span class="line">    val title: String,</span><br><span class="line">    val content: String,</span><br><span class="line">    val date: Long, // ä»¥æ—¶é—´æˆ³å½¢å¼å­˜å‚¨æ—¥æœŸ</span><br><span class="line">    val weather: String? = null</span><br><span class="line">)</span><br></pre></td></tr></table></figure><hr><h2 id="3-åˆ›å»º-DAOï¼ˆæ•°æ®è®¿é—®å¯¹è±¡ï¼‰"><a href="#3-åˆ›å»º-DAOï¼ˆæ•°æ®è®¿é—®å¯¹è±¡ï¼‰" class="headerlink" title="3. åˆ›å»º DAOï¼ˆæ•°æ®è®¿é—®å¯¹è±¡ï¼‰"></a><strong>3. åˆ›å»º DAOï¼ˆæ•°æ®è®¿é—®å¯¹è±¡ï¼‰</strong></h2><p>DAO è´Ÿè´£æ•°æ®åº“çš„ CRUD æ“ä½œï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import androidx.room.*</span><br><span class="line"></span><br><span class="line">@Dao</span><br><span class="line">interface DiaryDao &#123;</span><br><span class="line">    @Insert(onConflict = OnConflictStrategy.REPLACE)</span><br><span class="line">    suspend fun insertDiary(entry: DiaryEntry)</span><br><span class="line"></span><br><span class="line">    @Update</span><br><span class="line">    suspend fun updateDiary(entry: DiaryEntry)</span><br><span class="line"></span><br><span class="line">    @Delete</span><br><span class="line">    suspend fun deleteDiary(entry: DiaryEntry)</span><br><span class="line"></span><br><span class="line">    @Query(&quot;SELECT * FROM diary_entries ORDER BY date DESC&quot;)</span><br><span class="line">    fun getAllDiaries(): List&lt;DiaryEntry&gt; // ç›´æ¥è¿”å›åˆ—è¡¨ï¼ˆä¸æ¨èï¼Œå»ºè®®ä½¿ç”¨ Flowï¼‰</span><br><span class="line"></span><br><span class="line">    @Query(&quot;SELECT * FROM diary_entries WHERE id = :id&quot;)</span><br><span class="line">    suspend fun getDiaryById(id: Int): DiaryEntry?</span><br><span class="line"></span><br><span class="line">    @Query(&quot;SELECT * FROM diary_entries WHERE title LIKE &#x27;%&#x27; || :query || &#x27;%&#x27;&quot;)</span><br><span class="line">    fun searchDiaries(query: String): List&lt;DiaryEntry&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœéœ€è¦ç›‘å¬æ•°æ®å˜åŒ–ï¼Œå¯ä»¥ç”¨ <code>Flow</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@Query(&quot;SELECT * FROM diary_entries ORDER BY date DESC&quot;)</span><br><span class="line">fun getAllDiariesFlow(): Flow&lt;List&lt;DiaryEntry&gt;&gt; // ä½¿ç”¨ Flow ä»¥æ”¯æŒå®æ—¶ç›‘å¬</span><br></pre></td></tr></table></figure><hr><h2 id="4-åˆ›å»ºæ•°æ®åº“ï¼ˆDatabaseï¼‰"><a href="#4-åˆ›å»ºæ•°æ®åº“ï¼ˆDatabaseï¼‰" class="headerlink" title="4. åˆ›å»ºæ•°æ®åº“ï¼ˆDatabaseï¼‰"></a><strong>4. åˆ›å»ºæ•°æ®åº“ï¼ˆDatabaseï¼‰</strong></h2><p>ä½¿ç”¨ <code>@Database</code> æ³¨è§£åˆ›å»º Room æ•°æ®åº“ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import android.content.Context</span><br><span class="line">import androidx.room.Database</span><br><span class="line">import androidx.room.Room</span><br><span class="line">import androidx.room.RoomDatabase</span><br><span class="line"></span><br><span class="line">@Database(entities = [DiaryEntry::class], version = 1, exportSchema = false)</span><br><span class="line">abstract class DiaryDatabase : RoomDatabase() &#123;</span><br><span class="line">    abstract fun diaryDao(): DiaryDao</span><br><span class="line"></span><br><span class="line">    companion object &#123;</span><br><span class="line">        @Volatile</span><br><span class="line">        private var INSTANCE: DiaryDatabase? = null</span><br><span class="line"></span><br><span class="line">        fun getDatabase(context: Context): DiaryDatabase &#123;</span><br><span class="line">            return INSTANCE ?: synchronized(this) &#123;</span><br><span class="line">                val instance = Room.databaseBuilder(</span><br><span class="line">                    context.applicationContext,</span><br><span class="line">                    DiaryDatabase::class.java,</span><br><span class="line">                    &quot;diary_database&quot;</span><br><span class="line">                ).build()</span><br><span class="line">                INSTANCE = instance</span><br><span class="line">                instance</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><strong>è¯´æ˜</strong>ï¼š</p><ul><li><code>@Volatile</code> ç¡®ä¿å¤šä¸ªçº¿ç¨‹èƒ½æ­£ç¡®è®¿é—® <code>INSTANCE</code>ã€‚</li><li><code>synchronized(this)</code> ç¡®ä¿æ•°æ®åº“å®ä¾‹çš„å•ä¾‹æ¨¡å¼ã€‚</li></ul></blockquote><hr><h2 id="5-åœ¨-ViewModel-ä¸­ä½¿ç”¨"><a href="#5-åœ¨-ViewModel-ä¸­ä½¿ç”¨" class="headerlink" title="5. åœ¨ ViewModel ä¸­ä½¿ç”¨"></a><strong>5. åœ¨ ViewModel ä¸­ä½¿ç”¨</strong></h2><p>åœ¨ <code>ViewModel</code> é‡Œå°è£…æ•°æ®åº“æ“ä½œï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import androidx.lifecycle.ViewModel</span><br><span class="line">import kotlinx.coroutines.flow.Flow</span><br><span class="line"></span><br><span class="line">class DiaryViewModel(private val diaryDao: DiaryDao) : ViewModel() &#123;</span><br><span class="line">    val allDiaries: Flow&lt;List&lt;DiaryEntry&gt;&gt; = diaryDao.getAllDiariesFlow()</span><br><span class="line"></span><br><span class="line">    suspend fun addDiary(entry: DiaryEntry) &#123;</span><br><span class="line">        diaryDao.insertDiary(entry)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    suspend fun deleteDiary(entry: DiaryEntry) &#123;</span><br><span class="line">        diaryDao.deleteDiary(entry)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ <code>viewmodel</code> ç›®å½•ä¸‹æ–°å»º <code>DiaryViewModelFactory.kt</code> æ–‡ä»¶ï¼Œå¹¶å†™å…¥ä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import androidx.lifecycle.ViewModel</span><br><span class="line">import androidx.lifecycle.ViewModelProvider</span><br><span class="line">import com.example.uibestpractice.data.DiaryDao // æ›¿æ¢ä¸ºä½ çš„åŒ…å</span><br><span class="line"></span><br><span class="line">class DiaryViewModelFactory(private val diaryDao: DiaryDao) : ViewModelProvider.Factory &#123;</span><br><span class="line">    override fun &lt;T : ViewModel&gt; create(modelClass: Class&lt;T&gt;): T &#123;</span><br><span class="line">        if (modelClass.isAssignableFrom(DiaryViewModel::class.java)) &#123;</span><br><span class="line">            return DiaryViewModel(diaryDao) as T</span><br><span class="line">        &#125;</span><br><span class="line">        throw IllegalArgumentException(&quot;Unknown ViewModel class&quot;)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><hr><h2 id="6-åœ¨-Activity-Fragment-ä¸­ä½¿ç”¨"><a href="#6-åœ¨-Activity-Fragment-ä¸­ä½¿ç”¨" class="headerlink" title="6. åœ¨ Activity&#x2F;Fragment ä¸­ä½¿ç”¨"></a><strong>6. åœ¨ Activity&#x2F;Fragment ä¸­ä½¿ç”¨</strong></h2><p>åœ¨ <code>Activity</code> æˆ– <code>Fragment</code> é‡Œä½¿ç”¨ ViewModelï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import android.os.Bundle</span><br><span class="line">import androidx.activity.viewModels</span><br><span class="line">import androidx.appcompat.app.AppCompatActivity</span><br><span class="line">import androidx.lifecycle.lifecycleScope</span><br><span class="line">import kotlinx.coroutines.launch</span><br><span class="line"></span><br><span class="line">class MainActivity : AppCompatActivity() &#123;</span><br><span class="line">    private val diaryViewModel: DiaryViewModel by viewModels &#123;</span><br><span class="line">        DiaryViewModelFactory(DiaryDatabase.getDatabase(this).diaryDao())</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override fun onCreate(savedInstanceState: Bundle?) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState)</span><br><span class="line"></span><br><span class="line">        // ç›‘å¬æ•°æ®åº“å˜åŒ–</span><br><span class="line">        lifecycleScope.launch &#123;</span><br><span class="line">            diaryViewModel.allDiaries.collect &#123; diaryList -&gt;</span><br><span class="line">                // æ›´æ–° UI</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private fun addDiaryEntry() &#123;</span><br><span class="line">        lifecycleScope.launch &#123;</span><br><span class="line">            val newEntry = DiaryEntry(title = &quot;æ–°æ—¥è®°&quot;, content = &quot;ä»Šå¤©å¾ˆå¼€å¿ƒï¼&quot;, date = System.currentTimeMillis())</span><br><span class="line">            diaryViewModel.addDiary(newEntry)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="7-çº¿ç¨‹è°ƒåº¦ï¼ˆåç¨‹ï¼‰"><a href="#7-çº¿ç¨‹è°ƒåº¦ï¼ˆåç¨‹ï¼‰" class="headerlink" title="7. çº¿ç¨‹è°ƒåº¦ï¼ˆåç¨‹ï¼‰"></a><strong>7. çº¿ç¨‹è°ƒåº¦ï¼ˆåç¨‹ï¼‰</strong></h2><p>Room å…è®¸åœ¨ <code>suspend</code> å‡½æ•°ä¸­è°ƒç”¨æ•°æ®åº“æ“ä½œï¼ŒKotlin åç¨‹ä¼šè‡ªåŠ¨åˆ‡æ¢åˆ° IO çº¿ç¨‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">suspend fun insertDiary(entry: DiaryEntry) &#123;</span><br><span class="line">    diaryDao.insertDiary(entry) // Room åœ¨ IO çº¿ç¨‹æ‰§è¡Œ</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äº <strong>ä¸æ”¯æŒåç¨‹çš„å‡½æ•°</strong>ï¼ˆå¦‚ <code>getAllDiaries()</code>ï¼‰ï¼Œåº”ä½¿ç”¨ <code>withContext(Dispatchers.IO)</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fun getAllDiariesBlocking(): List&lt;DiaryEntry&gt; &#123;</span><br><span class="line">    return runBlocking &#123; withContext(Dispatchers.IO) &#123; diaryDao.getAllDiaries() &#125; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h2><p>Room æä¾›äº† <strong>ç®€å•ã€å®‰å…¨ã€é«˜æ•ˆ</strong> çš„æ•°æ®åº“ç®¡ç†ï¼š</p><ol><li><strong>Entity</strong>ï¼ˆè¡¨ï¼‰ â†’ <code>@Entity</code></li><li><strong>DAO</strong>ï¼ˆæ•°æ®æ“ä½œï¼‰ â†’ <code>@Dao</code></li><li><strong>Database</strong>ï¼ˆæ•°æ®åº“å®ä¾‹ï¼‰ â†’ <code>@Database</code></li><li><strong>ViewModel</strong>ï¼ˆå°è£…ä¸šåŠ¡é€»è¾‘ï¼‰</li><li><strong>Activity&#x2F;Fragment</strong>ï¼ˆUI å±‚ä½¿ç”¨æ•°æ®åº“ï¼‰</li></ol><p>ä½ å¯ä»¥ç»“åˆ <code>Flow</code> è¿›è¡Œ <strong>å®æ—¶ç›‘å¬</strong>ï¼Œç»“åˆ <strong>Kotlin åç¨‹</strong> è¿›è¡Œ <strong>å¼‚æ­¥å¤„ç†</strong>ï¼Œä½¿æ•°æ®åº“æ“ä½œæ›´åŠ æµç•…é«˜æ•ˆã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“çŸ¥è¯†ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>startActivityå’ŒregisterForActivityResultçš„ç”¨æ³•</title>
      <link href="/2025/03/14/startActivity%E5%92%8CregisterForActivityResult%E7%9A%84%E7%94%A8%E6%B3%95/"/>
      <url>/2025/03/14/startActivity%E5%92%8CregisterForActivityResult%E7%9A%84%E7%94%A8%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>åœ¨ Android Kotlin å¼€å‘ä¸­ï¼Œ<code>startActivity</code> å’Œ <code>registerForActivityResult</code> æ˜¯å¯åŠ¨æ–° Activity å¹¶å¤„ç†è¿”å›ç»“æœçš„ä¸¤ç§æ–¹å¼ã€‚</p><hr><h2 id="1-ä½¿ç”¨-startActivity"><a href="#1-ä½¿ç”¨-startActivity" class="headerlink" title="1. ä½¿ç”¨ startActivity"></a>1. ä½¿ç”¨ <code>startActivity</code></h2><p><code>startActivity</code> é€‚ç”¨äº <strong>ä¸éœ€è¦è·å–è¿”å›å€¼</strong> çš„æƒ…å†µï¼Œä¾‹å¦‚ä» <code>MainActivity</code> è·³è½¬åˆ° <code>SecondActivity</code>ï¼š</p><h3 id="ç¤ºä¾‹ï¼šå¯åŠ¨æ–°-Activity"><a href="#ç¤ºä¾‹ï¼šå¯åŠ¨æ–°-Activity" class="headerlink" title="ç¤ºä¾‹ï¼šå¯åŠ¨æ–° Activity"></a><strong>ç¤ºä¾‹ï¼šå¯åŠ¨æ–° Activity</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">val intent = Intent(this, SecondActivity::class.java)</span><br><span class="line">startActivity(intent)</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ éœ€è¦ä¼ é€’æ•°æ®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">val intent = Intent(this, SecondActivity::class.java).apply &#123;</span><br><span class="line">    putExtra(&quot;key&quot;, &quot;Hello, SecondActivity!&quot;)</span><br><span class="line">&#125;</span><br><span class="line">startActivity(intent)</span><br></pre></td></tr></table></figure><p>åœ¨ <code>SecondActivity</code> ä¸­è·å–ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val data = intent.getStringExtra(&quot;key&quot;)</span><br></pre></td></tr></table></figure><hr><h2 id="2-ä½¿ç”¨-registerForActivityResult"><a href="#2-ä½¿ç”¨-registerForActivityResult" class="headerlink" title="2. ä½¿ç”¨ registerForActivityResult"></a>2. ä½¿ç”¨ <code>registerForActivityResult</code></h2><p><code>registerForActivityResult</code> é€‚ç”¨äº <strong>éœ€è¦ä»å­ Activity è¿”å›æ•°æ®</strong> çš„æƒ…å†µï¼Œæ¯”å¦‚ç”¨æˆ·é€‰æ‹©äº†ä¸€ä¸ªæ–‡ä»¶æˆ–æ‹ç…§åè¿”å›å›¾ç‰‡ã€‚</p><h3 id="ç¤ºä¾‹ï¼šå¯åŠ¨-Activity-å¹¶è·å–è¿”å›å€¼"><a href="#ç¤ºä¾‹ï¼šå¯åŠ¨-Activity-å¹¶è·å–è¿”å›å€¼" class="headerlink" title="ç¤ºä¾‹ï¼šå¯åŠ¨ Activity å¹¶è·å–è¿”å›å€¼"></a><strong>ç¤ºä¾‹ï¼šå¯åŠ¨ Activity å¹¶è·å–è¿”å›å€¼</strong></h3><p>å…ˆåœ¨ä¸» Activity ä¸­æ³¨å†Œä¸€ä¸ª <code>ActivityResultLauncher</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">private val launcher=registerForActivityResult(ActivityResultContracts.StartActivityForResult())&#123; result -&gt;</span><br><span class="line">    if (result.resultCode == Activity.RESULT_OK) &#123;</span><br><span class="line">        val data = result.data?.getStringExtra(&quot;result_key&quot;)</span><br><span class="line">        Toast.makeText(this, &quot;æ”¶åˆ°è¿”å›å€¼: $data&quot;, Toast.LENGTH_SHORT).show()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åä½¿ç”¨ <code>launcher.launch(intent)</code> å¯åŠ¨æ–° Activityï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">val intent = Intent(this, SecondActivity::class.java)</span><br><span class="line">launcher.launch(intent)</span><br></pre></td></tr></table></figure><h3 id="åœ¨-SecondActivity-å¤„ç†è¿”å›æ•°æ®"><a href="#åœ¨-SecondActivity-å¤„ç†è¿”å›æ•°æ®" class="headerlink" title="åœ¨ SecondActivity å¤„ç†è¿”å›æ•°æ®"></a><strong>åœ¨ SecondActivity å¤„ç†è¿”å›æ•°æ®</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">val resultIntent = Intent().apply &#123;</span><br><span class="line">    putExtra(&quot;result_key&quot;, &quot;è¿”å›çš„æ•°æ®&quot;)</span><br><span class="line">&#125;</span><br><span class="line">setResult(Activity.RESULT_OK, resultIntent)</span><br><span class="line">finish()</span><br></pre></td></tr></table></figure><hr><h2 id="3-startActivityForResult-å·²åºŸå¼ƒ"><a href="#3-startActivityForResult-å·²åºŸå¼ƒ" class="headerlink" title="3. startActivityForResult å·²åºŸå¼ƒ"></a>3. <code>startActivityForResult</code> å·²åºŸå¼ƒ</h2><p><code>startActivityForResult</code> åœ¨ API 30ï¼ˆAndroid 11ï¼‰å¼€å§‹è¢« <strong>å¼ƒç”¨</strong>ï¼Œå®˜æ–¹æ¨èä½¿ç”¨ <code>registerForActivityResult</code> ä»£æ›¿ã€‚</p><p>å¦‚æœä½ çš„ä»£ç ä»ç„¶ä½¿ç”¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">startActivityForResult(intent, REQUEST_CODE)</span><br></pre></td></tr></table></figure><p>åˆ™åº”æ”¹ç”¨ <code>registerForActivityResult</code>ã€‚</p><hr><h2 id="4-å…¶ä»–-ActivityResultContracts"><a href="#4-å…¶ä»–-ActivityResultContracts" class="headerlink" title="4. å…¶ä»– ActivityResultContracts"></a>4. å…¶ä»– <code>ActivityResultContracts</code></h2><p><code>registerForActivityResult</code> è¿˜æ”¯æŒå¤šç§ <code>ActivityResultContracts</code>ï¼Œå¦‚ï¼š</p><ul><li><code>ActivityResultContracts.RequestPermission()</code>ï¼ˆè¯·æ±‚å•ä¸ªæƒé™ï¼‰</li><li><code>ActivityResultContracts.GetContent()</code>ï¼ˆé€‰æ‹©æ–‡ä»¶ï¼‰</li><li><code>ActivityResultContracts.TakePicture()</code>ï¼ˆæ‹ç…§ï¼‰</li></ul><h3 id="ç¤ºä¾‹ï¼šè·å–å›¾ç‰‡"><a href="#ç¤ºä¾‹ï¼šè·å–å›¾ç‰‡" class="headerlink" title="ç¤ºä¾‹ï¼šè·å–å›¾ç‰‡"></a><strong>ç¤ºä¾‹ï¼šè·å–å›¾ç‰‡</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">private val getImage = registerForActivityResult(ActivityResultContracts.GetContent()) &#123; uri: Uri? -&gt;</span><br><span class="line">    uri?.let &#123;</span><br><span class="line">        imageView.setImageURI(it)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">button.setOnClickListener &#123;</span><br><span class="line">    getImage.launch(&quot;image/*&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p><strong>æ€»ç»“ï¼š</strong></p><ul><li><code>startActivity()</code> é€‚ç”¨äºæ— è¿”å›å€¼çš„è·³è½¬ã€‚</li><li><code>registerForActivityResult()</code> é€‚ç”¨äºéœ€è¦è·å–è¿”å›å€¼çš„æƒ…å†µï¼Œå¹¶ä¸”æ¯” <code>startActivityForResult()</code> æ›´æ¨èã€‚</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“çŸ¥è¯†ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Retrofitç”¨æ³•ç¤ºä¾‹</title>
      <link href="/2025/03/14/Retrofit%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B/"/>
      <url>/2025/03/14/Retrofit%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<p><strong>Retrofit ä½¿ç”¨æŒ‡å—</strong></p><p><code>Retrofit</code> æ˜¯ Android ä¸Šæœ€å¸¸ç”¨çš„ç½‘ç»œè¯·æ±‚åº“ä¹‹ä¸€ï¼Œå®ƒç®€åŒ–äº† HTTP è¯·æ±‚çš„å¤„ç†ï¼Œæ”¯æŒ <strong>GETã€POSTã€PUTã€DELETE</strong> ç­‰è¯·æ±‚æ–¹å¼ï¼Œå¹¶ä¸”å¯ä»¥é…åˆ <code>Gson</code>ã€<code>Moshi</code> ç­‰è§£æ JSON æ•°æ®ã€‚</p><h2 id="1-æ·»åŠ ä¾èµ–"><a href="#1-æ·»åŠ ä¾èµ–" class="headerlink" title="1. æ·»åŠ ä¾èµ–"></a><strong>1. æ·»åŠ ä¾èµ–</strong></h2><p>åœ¨ <code>build.gradle</code> (Module çº§) ä¸­æ·»åŠ ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    implementation &#x27;com.squareup.retrofit2:retrofit:2.9.0&#x27;</span><br><span class="line">    implementation &#x27;com.squareup.retrofit2:converter-gson:2.9.0&#x27; // Gson è§£æ JSON</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-åˆ›å»º-API-æ¥å£"><a href="#2-åˆ›å»º-API-æ¥å£" class="headerlink" title="2. åˆ›å»º API æ¥å£"></a><strong>2. åˆ›å»º API æ¥å£</strong></h2><p>å®šä¹‰ API æ¥å£ï¼Œä¾‹å¦‚è·å–ç”¨æˆ·ä¿¡æ¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import retrofit2.Call</span><br><span class="line">import retrofit2.http.GET</span><br><span class="line">import retrofit2.http.POST</span><br><span class="line">import retrofit2.http.PUT</span><br><span class="line">import retrofit2.http.DELETE</span><br><span class="line">import retrofit2.http.Body</span><br><span class="line">import retrofit2.http.Path</span><br><span class="line">import retrofit2.http.Header</span><br><span class="line"></span><br><span class="line">interface ApiService &#123;</span><br><span class="line">    @GET(&quot;users/&#123;id&#125;&quot;)  // GET è¯·æ±‚</span><br><span class="line">    fun getUser(@Path(&quot;id&quot;) userId: Int): Call&lt;User&gt;</span><br><span class="line"></span><br><span class="line">    @POST(&quot;users&quot;)  // POST è¯·æ±‚</span><br><span class="line">    fun createUser(@Body user: User): Call&lt;User&gt;</span><br><span class="line"></span><br><span class="line">    @PUT(&quot;users/&#123;id&#125;&quot;)  // PUT è¯·æ±‚</span><br><span class="line">    fun updateUser(@Path(&quot;id&quot;) userId: Int, @Body user: User): Call&lt;User&gt;</span><br><span class="line"></span><br><span class="line">    @DELETE(&quot;users/&#123;id&#125;&quot;)  // DELETE è¯·æ±‚</span><br><span class="line">    fun deleteUser(@Path(&quot;id&quot;) userId: Int): Call&lt;Void&gt;</span><br><span class="line"></span><br><span class="line">    @GET(&quot;users/&#123;id&#125;&quot;)  // æ·»åŠ è‡ªå®šä¹‰ Header</span><br><span class="line">    fun getUserWithHeader(@Path(&quot;id&quot;) userId: Int, @Header(&quot;Authorization&quot;) token: String): Call&lt;User&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-å®šä¹‰æ•°æ®æ¨¡å‹"><a href="#3-å®šä¹‰æ•°æ®æ¨¡å‹" class="headerlink" title="3. å®šä¹‰æ•°æ®æ¨¡å‹"></a><strong>3. å®šä¹‰æ•°æ®æ¨¡å‹</strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data class User(</span><br><span class="line">    val id: Int,</span><br><span class="line">    val name: String,</span><br><span class="line">    val email: String</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h2 id="4-åˆ›å»º-Retrofit-å®ä¾‹"><a href="#4-åˆ›å»º-Retrofit-å®ä¾‹" class="headerlink" title="4. åˆ›å»º Retrofit å®ä¾‹"></a><strong>4. åˆ›å»º Retrofit å®ä¾‹</strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import retrofit2.Retrofit</span><br><span class="line">import retrofit2.converter.gson.GsonConverterFactory</span><br><span class="line"></span><br><span class="line">object RetrofitClient &#123;</span><br><span class="line">    private const val BASE_URL = &quot;https://api.example.com/&quot;</span><br><span class="line"></span><br><span class="line">    val instance: ApiService by lazy &#123;</span><br><span class="line">        Retrofit.Builder()</span><br><span class="line">            .baseUrl(BASE_URL)</span><br><span class="line">            .addConverterFactory(GsonConverterFactory.create())</span><br><span class="line">            .build()</span><br><span class="line">            .create(ApiService::class.java)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="5-å‘èµ·ç½‘ç»œè¯·æ±‚"><a href="#5-å‘èµ·ç½‘ç»œè¯·æ±‚" class="headerlink" title="5. å‘èµ·ç½‘ç»œè¯·æ±‚"></a><strong>5. å‘èµ·ç½‘ç»œè¯·æ±‚</strong></h2><h4 id="GET-è¯·æ±‚"><a href="#GET-è¯·æ±‚" class="headerlink" title="GET è¯·æ±‚"></a><strong>GET è¯·æ±‚</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">val call = RetrofitClient.instance.getUser(1)</span><br><span class="line">call.enqueue(object : retrofit2.Callback&lt;User&gt; &#123;</span><br><span class="line">    override fun onResponse(call: Call&lt;User&gt;, response: retrofit2.Response&lt;User&gt;) &#123;</span><br><span class="line">        if (response.isSuccessful) &#123;</span><br><span class="line">            val user = response.body()</span><br><span class="line">            println(&quot;ç”¨æˆ·ä¿¡æ¯: $&#123;user?.name&#125;, $&#123;user?.email&#125;&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override fun onFailure(call: Call&lt;User&gt;, t: Throwable) &#123;</span><br><span class="line">        println(&quot;è¯·æ±‚å¤±è´¥: $&#123;t.message&#125;&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="POST-è¯·æ±‚"><a href="#POST-è¯·æ±‚" class="headerlink" title="POST è¯·æ±‚"></a><strong>POST è¯·æ±‚</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">val newUser = User(0, &quot;John Doe&quot;, &quot;john@example.com&quot;)</span><br><span class="line">val call = RetrofitClient.instance.createUser(newUser)</span><br></pre></td></tr></table></figure><h4 id="PUT-è¯·æ±‚"><a href="#PUT-è¯·æ±‚" class="headerlink" title="PUT è¯·æ±‚"></a><strong>PUT è¯·æ±‚</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">val updatedUser = User(1, &quot;Updated Name&quot;, &quot;updated@example.com&quot;)</span><br><span class="line">val call = RetrofitClient.instance.updateUser(1, updatedUser)</span><br></pre></td></tr></table></figure><h4 id="DELETE-è¯·æ±‚"><a href="#DELETE-è¯·æ±‚" class="headerlink" title="DELETE è¯·æ±‚"></a><strong>DELETE è¯·æ±‚</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val call = RetrofitClient.instance.deleteUser(1)</span><br></pre></td></tr></table></figure><h4 id="æ·»åŠ -Header-è¯·æ±‚"><a href="#æ·»åŠ -Header-è¯·æ±‚" class="headerlink" title="æ·»åŠ  Header è¯·æ±‚"></a><strong>æ·»åŠ  Header è¯·æ±‚</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">val token = &quot;Bearer your_token_here&quot;</span><br><span class="line">val call = RetrofitClient.instance.getUserWithHeader(1, token)</span><br></pre></td></tr></table></figure><h2 id="6-ä½¿ç”¨åç¨‹-Coroutine-ä¼˜åŒ–è¯·æ±‚"><a href="#6-ä½¿ç”¨åç¨‹-Coroutine-ä¼˜åŒ–è¯·æ±‚" class="headerlink" title="6. ä½¿ç”¨åç¨‹ (Coroutine) ä¼˜åŒ–è¯·æ±‚"></a><strong>6. ä½¿ç”¨åç¨‹ (Coroutine) ä¼˜åŒ–è¯·æ±‚</strong></h2><p>å°† API æ¥å£ä¿®æ”¹ä¸ºä½¿ç”¨ suspend å‡½æ•°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">interface ApiService &#123;</span><br><span class="line">    @GET(&quot;users/&#123;id&#125;&quot;)</span><br><span class="line">    suspend fun getUser(@Path(&quot;id&quot;) userId: Int): User</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ ViewModel ä¸­è°ƒç”¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import androidx.lifecycle.ViewModel</span><br><span class="line">import androidx.lifecycle.viewModelScope</span><br><span class="line">import kotlinx.coroutines.launch</span><br><span class="line"></span><br><span class="line">class UserViewModel : ViewModel() &#123;</span><br><span class="line">    fun fetchUser() &#123;</span><br><span class="line">        viewModelScope.launch &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                val user = RetrofitClient.instance.getUser(1)</span><br><span class="line">                println(&quot;ç”¨æˆ·ä¿¡æ¯: $&#123;user.name&#125;, $&#123;user.email&#125;&quot;)</span><br><span class="line">            &#125; catch (e: Exception) &#123;</span><br><span class="line">                println(&quot;è¯·æ±‚å¤±è´¥: $&#123;e.message&#125;&quot;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="7-æ€»ç»“"><a href="#7-æ€»ç»“" class="headerlink" title="7. æ€»ç»“"></a><strong>7. æ€»ç»“</strong></h2><ul><li><strong>GETã€POSTã€PUTã€DELETE åŸºæœ¬è¯·æ±‚</strong></li><li><strong>æ·»åŠ  Header è¯·æ±‚</strong></li><li><strong>ä½¿ç”¨ suspend + Coroutine ä¼˜åŒ–è¯·æ±‚</strong></li></ul><p><strong>æœ€åæˆ‘æƒ³è¯´æƒ³äº†è§£æ›´å¤šæ›´å…¨å…³äºRotrofitçš„çŸ¥è¯†å»çœ‹ä¹¦P451å§ï¼ï¼ï¼</strong></p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å“çŸ¥è¯†ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CMDå‘½ä»¤å¤§å…¨</title>
      <link href="/2025/03/13/CMD%E5%91%BD%E4%BB%A4%E5%A4%A7%E5%85%A8/"/>
      <url>/2025/03/13/CMD%E5%91%BD%E4%BB%A4%E5%A4%A7%E5%85%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="CMD-å‘½ä»¤å¤§å…¨ï¼šä»å…¥é—¨åˆ°ç²¾é€š"><a href="#CMD-å‘½ä»¤å¤§å…¨ï¼šä»å…¥é—¨åˆ°ç²¾é€š" class="headerlink" title="CMD å‘½ä»¤å¤§å…¨ï¼šä»å…¥é—¨åˆ°ç²¾é€š"></a>CMD å‘½ä»¤å¤§å…¨ï¼šä»å…¥é—¨åˆ°ç²¾é€š</h1><p>å‘½ä»¤æç¤ºç¬¦ï¼ˆCMDï¼‰æ˜¯ Windows æ“ä½œç³»ç»Ÿä¸­çš„å‘½ä»¤è¡Œç•Œé¢ï¼Œå…è®¸ç”¨æˆ·é€šè¿‡è¾“å…¥å‘½ä»¤æ¥æ‰§è¡Œå„ç§ä»»åŠ¡ã€‚å®ƒæ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œé€‚ç”¨äºç³»ç»Ÿç®¡ç†ã€ç½‘ç»œé…ç½®ã€æ–‡ä»¶æ“ä½œç­‰å¤šç§åœºæ™¯ã€‚æœ¬æ–‡è¯¦ç»†ä»‹ç»äº†å¸¸ç”¨çš„ CMD å‘½ä»¤ï¼Œå¸®åŠ©ä½ ä»å…¥é—¨åˆ°ç²¾é€š CMDã€‚<strong>ä¸è¿‡ä¹Ÿå¯ä»¥ç›´æ¥æ‰“helpå¯»æ‰¾å‘½ä»¤çš„ã€‚</strong></p><p>[å‚è€ƒæ¥æº](<a href="https://blog.csdn.net/m0_70474954/article/details/143496800">CMD å‘½ä»¤å¤§å…¨ï¼šä»å…¥é—¨åˆ°ç²¾é€š_cmdå‘½ä»¤-CSDNåšå®¢</a>)</p><h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><ol><li><a href="#cmd-%E5%9F%BA%E7%A1%80">CMD åŸºç¡€</a></li><li><a href="#%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4">æ–‡ä»¶å’Œç›®å½•æ“ä½œå‘½ä»¤</a></li><li><a href="#%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E5%91%BD%E4%BB%A4">ç³»ç»Ÿä¿¡æ¯è·å–å‘½ä»¤</a></li><li><a href="#%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%91%BD%E4%BB%A4">ç½‘ç»œé…ç½®å‘½ä»¤</a></li><li><a href="#%E7%A3%81%E7%9B%98%E5%92%8C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4">ç£ç›˜å’Œæ–‡ä»¶ç³»ç»Ÿæ“ä½œå‘½ä»¤</a></li><li><a href="#%E6%89%B9%E5%A4%84%E7%90%86%E6%96%87%E4%BB%B6">æ‰¹å¤„ç†æ–‡ä»¶</a></li><li><a href="#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F">ç¯å¢ƒå˜é‡</a></li><li><a href="#cmd-%E9%AB%98%E7%BA%A7%E6%8A%80%E5%B7%A7">CMD é«˜çº§æŠ€å·§</a></li><li><a href="#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88">å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</a></li><li><a href="#%E6%80%BB%E7%BB%93">æ€»ç»“</a></li></ol><hr><h2 id="CMD-åŸºç¡€"><a href="#CMD-åŸºç¡€" class="headerlink" title="CMD åŸºç¡€"></a>CMD åŸºç¡€</h2><h3 id="1-1-æ‰“å¼€-CMD"><a href="#1-1-æ‰“å¼€-CMD" class="headerlink" title="1.1 æ‰“å¼€ CMD"></a>1.1 æ‰“å¼€ CMD</h3><p>åœ¨ Windows ä¸­ï¼Œå¯é€šè¿‡ä»¥ä¸‹æ–¹å¼æ‰“å¼€å‘½ä»¤æç¤ºç¬¦ï¼š</p><ul><li>æŒ‰ <code>Win + R</code>ï¼Œè¾“å…¥ <code>cmd</code>ï¼Œç„¶åæŒ‰ <code>Enter</code>ã€‚</li><li>åœ¨å¼€å§‹èœå•ä¸­æœç´¢ â€œcmdâ€ æˆ– â€œå‘½ä»¤æç¤ºç¬¦â€ã€‚</li></ul><h3 id="1-2-å¸¸ç”¨å‘½ä»¤æ ¼å¼"><a href="#1-2-å¸¸ç”¨å‘½ä»¤æ ¼å¼" class="headerlink" title="1.2 å¸¸ç”¨å‘½ä»¤æ ¼å¼"></a>1.2 å¸¸ç”¨å‘½ä»¤æ ¼å¼</h3><p>CMD å‘½ä»¤é€šå¸¸éµå¾ªä»¥ä¸‹æ ¼å¼ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å‘½ä»¤ [å‚æ•°]</span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dir /w</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <code>dir</code> æ˜¯å‘½ä»¤ï¼Œ<code>/w</code> æ˜¯å‚æ•°ã€‚</p><hr><h2 id="æ–‡ä»¶å’Œç›®å½•æ“ä½œå‘½ä»¤"><a href="#æ–‡ä»¶å’Œç›®å½•æ“ä½œå‘½ä»¤" class="headerlink" title="æ–‡ä»¶å’Œç›®å½•æ“ä½œå‘½ä»¤"></a>æ–‡ä»¶å’Œç›®å½•æ“ä½œå‘½ä»¤</h2><h3 id="2-1-æŸ¥çœ‹å½“å‰ç›®å½•"><a href="#2-1-æŸ¥çœ‹å½“å‰ç›®å½•" class="headerlink" title="2.1 æŸ¥çœ‹å½“å‰ç›®å½•"></a>2.1 æŸ¥çœ‹å½“å‰ç›®å½•</h3><p>ä½¿ç”¨ <code>cd</code> å‘½ä»¤æ˜¾ç¤ºå½“å‰å·¥ä½œç›®å½•çš„è·¯å¾„ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd</span><br></pre></td></tr></table></figure><h3 id="2-2-åˆ—å‡ºç›®å½•ä¸­çš„æ–‡ä»¶"><a href="#2-2-åˆ—å‡ºç›®å½•ä¸­çš„æ–‡ä»¶" class="headerlink" title="2.2 åˆ—å‡ºç›®å½•ä¸­çš„æ–‡ä»¶"></a>2.2 åˆ—å‡ºç›®å½•ä¸­çš„æ–‡ä»¶</h3><p>ä½¿ç”¨ <code>dir</code> å‘½ä»¤åˆ—å‡ºå½“å‰ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dir</span><br></pre></td></tr></table></figure><h3 id="2-3-è¿›å…¥ç›®å½•"><a href="#2-3-è¿›å…¥ç›®å½•" class="headerlink" title="2.3 è¿›å…¥ç›®å½•"></a>2.3 è¿›å…¥ç›®å½•</h3><p>ä½¿ç”¨ <code>cd [ç›®å½•è·¯å¾„]</code> è¿›å…¥æŒ‡å®šç›®å½•ã€‚ä¾‹å¦‚ï¼Œè¿›å…¥ <code>D:\Documents</code> ç›®å½•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd D:\Documents</span><br></pre></td></tr></table></figure><h3 id="2-4-è¿”å›ä¸Šä¸€çº§ç›®å½•"><a href="#2-4-è¿”å›ä¸Šä¸€çº§ç›®å½•" class="headerlink" title="2.4 è¿”å›ä¸Šä¸€çº§ç›®å½•"></a>2.4 è¿”å›ä¸Šä¸€çº§ç›®å½•</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd ..</span><br></pre></td></tr></table></figure><h3 id="2-5-åˆ›å»ºæ–°ç›®å½•"><a href="#2-5-åˆ›å»ºæ–°ç›®å½•" class="headerlink" title="2.5 åˆ›å»ºæ–°ç›®å½•"></a>2.5 åˆ›å»ºæ–°ç›®å½•</h3><p>ä½¿ç”¨ <code>mkdir [ç›®å½•å]</code> åˆ›å»ºæ–°ç›®å½•ã€‚ä¾‹å¦‚ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º <code>NewFolder</code> çš„ç›®å½•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir NewFolder</span><br></pre></td></tr></table></figure><h3 id="2-6-åˆ é™¤ç›®å½•"><a href="#2-6-åˆ é™¤ç›®å½•" class="headerlink" title="2.6 åˆ é™¤ç›®å½•"></a>2.6 åˆ é™¤ç›®å½•</h3><p>ä½¿ç”¨ <code>rmdir [ç›®å½•å]</code> åˆ é™¤ç©ºç›®å½•ã€‚å¦‚æœè¦åˆ é™¤éç©ºç›®å½•ï¼Œè¯·ä½¿ç”¨ <code>/s</code> å‚æ•°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rmdir /s [ç›®å½•å]</span><br></pre></td></tr></table></figure><h3 id="2-7-å¤åˆ¶æ–‡ä»¶"><a href="#2-7-å¤åˆ¶æ–‡ä»¶" class="headerlink" title="2.7 å¤åˆ¶æ–‡ä»¶"></a>2.7 å¤åˆ¶æ–‡ä»¶</h3><p>ä½¿ç”¨ <code>copy [æºæ–‡ä»¶è·¯å¾„] [ç›®æ ‡è·¯å¾„]</code> å¤åˆ¶æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œå°† <code>file.txt</code> å¤åˆ¶åˆ° <code>D:\Backup</code> ç›®å½•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">copy file.txt D:\Backup</span><br></pre></td></tr></table></figure><h3 id="2-8-ç§»åŠ¨æ–‡ä»¶"><a href="#2-8-ç§»åŠ¨æ–‡ä»¶" class="headerlink" title="2.8 ç§»åŠ¨æ–‡ä»¶"></a>2.8 ç§»åŠ¨æ–‡ä»¶</h3><p>ä½¿ç”¨ <code>move [æºæ–‡ä»¶è·¯å¾„] [ç›®æ ‡è·¯å¾„]</code> ç§»åŠ¨æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œå°† <code>file.txt</code> ç§»åŠ¨åˆ° <code>D:\Documents</code> ç›®å½•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">move file.txt D:\Documents</span><br></pre></td></tr></table></figure><h3 id="2-9-åˆ é™¤æ–‡ä»¶"><a href="#2-9-åˆ é™¤æ–‡ä»¶" class="headerlink" title="2.9 åˆ é™¤æ–‡ä»¶"></a>2.9 åˆ é™¤æ–‡ä»¶</h3><p>ä½¿ç”¨ <code>del [æ–‡ä»¶å]</code> åˆ é™¤æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œåˆ é™¤ <code>file.txt</code> æ–‡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">del file.txt</span><br></pre></td></tr></table></figure><h3 id="2-10-é‡å‘½åæ–‡ä»¶"><a href="#2-10-é‡å‘½åæ–‡ä»¶" class="headerlink" title="2.10 é‡å‘½åæ–‡ä»¶"></a>2.10 é‡å‘½åæ–‡ä»¶</h3><p>ä½¿ç”¨ <code>ren [æ—§æ–‡ä»¶å] [æ–°æ–‡ä»¶å]</code> é‡å‘½åæ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œå°† <code>oldfile.txt</code> é‡å‘½åä¸º <code>newfile.txt</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ren oldfile.txt newfile.txt</span><br></pre></td></tr></table></figure><hr><h2 id="ç³»ç»Ÿä¿¡æ¯è·å–å‘½ä»¤"><a href="#ç³»ç»Ÿä¿¡æ¯è·å–å‘½ä»¤" class="headerlink" title="ç³»ç»Ÿä¿¡æ¯è·å–å‘½ä»¤"></a>ç³»ç»Ÿä¿¡æ¯è·å–å‘½ä»¤</h2><h3 id="3-1-æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯"><a href="#3-1-æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯" class="headerlink" title="3.1 æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯"></a>3.1 æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯</h3><p>ä½¿ç”¨ <code>systeminfo</code> æ˜¾ç¤ºè®¡ç®—æœºçš„è¯¦ç»†ä¿¡æ¯ï¼ˆæ“ä½œç³»ç»Ÿç‰ˆæœ¬ã€å†…å­˜ã€ç½‘ç»œé€‚é…å™¨ç­‰ï¼‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systeminfo</span><br></pre></td></tr></table></figure><h3 id="3-2-æŸ¥çœ‹å½“å‰ç”¨æˆ·"><a href="#3-2-æŸ¥çœ‹å½“å‰ç”¨æˆ·" class="headerlink" title="3.2 æŸ¥çœ‹å½“å‰ç”¨æˆ·"></a>3.2 æŸ¥çœ‹å½“å‰ç”¨æˆ·</h3><p>ä½¿ç”¨ <code>whoami</code> æ˜¾ç¤ºå½“å‰ç™»å½•çš„ç”¨æˆ·åç§°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">whoami</span><br></pre></td></tr></table></figure><h3 id="3-3-æŸ¥çœ‹è®¡ç®—æœºå"><a href="#3-3-æŸ¥çœ‹è®¡ç®—æœºå" class="headerlink" title="3.3 æŸ¥çœ‹è®¡ç®—æœºå"></a>3.3 æŸ¥çœ‹è®¡ç®—æœºå</h3><p>ä½¿ç”¨ <code>hostname</code> æ˜¾ç¤ºè®¡ç®—æœºçš„ä¸»æœºåï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hostname</span><br></pre></td></tr></table></figure><h3 id="3-4-æŸ¥çœ‹è¿›ç¨‹åˆ—è¡¨"><a href="#3-4-æŸ¥çœ‹è¿›ç¨‹åˆ—è¡¨" class="headerlink" title="3.4 æŸ¥çœ‹è¿›ç¨‹åˆ—è¡¨"></a>3.4 æŸ¥çœ‹è¿›ç¨‹åˆ—è¡¨</h3><p>ä½¿ç”¨ <code>tasklist</code> åˆ—å‡ºå½“å‰è¿è¡Œçš„æ‰€æœ‰è¿›ç¨‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tasklist</span><br></pre></td></tr></table></figure><h3 id="3-5-ç»“æŸè¿›ç¨‹"><a href="#3-5-ç»“æŸè¿›ç¨‹" class="headerlink" title="3.5 ç»“æŸè¿›ç¨‹"></a>3.5 ç»“æŸè¿›ç¨‹</h3><p>ä½¿ç”¨ <code>taskkill /IM [è¿›ç¨‹å] /F</code> å¼ºåˆ¶ç»“æŸæŒ‡å®šè¿›ç¨‹ã€‚ä¾‹å¦‚ï¼Œç»“æŸ <code>notepad.exe</code> è¿›ç¨‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">taskkill /IM notepad.exe /F</span><br></pre></td></tr></table></figure><hr><h2 id="ç½‘ç»œé…ç½®å‘½ä»¤"><a href="#ç½‘ç»œé…ç½®å‘½ä»¤" class="headerlink" title="ç½‘ç»œé…ç½®å‘½ä»¤"></a>ç½‘ç»œé…ç½®å‘½ä»¤</h2><h3 id="4-1-æŸ¥çœ‹-IP-é…ç½®"><a href="#4-1-æŸ¥çœ‹-IP-é…ç½®" class="headerlink" title="4.1 æŸ¥çœ‹ IP é…ç½®"></a>4.1 æŸ¥çœ‹ IP é…ç½®</h3><p>ä½¿ç”¨ <code>ipconfig</code> æ˜¾ç¤ºè®¡ç®—æœºçš„ IP åœ°å€ã€å­ç½‘æ©ç å’Œé»˜è®¤ç½‘å…³ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ipconfig</span><br></pre></td></tr></table></figure><h3 id="4-2-åˆ·æ–°-IP-åœ°å€"><a href="#4-2-åˆ·æ–°-IP-åœ°å€" class="headerlink" title="4.2 åˆ·æ–° IP åœ°å€"></a>4.2 åˆ·æ–° IP åœ°å€</h3><p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤é‡Šæ”¾å¹¶æ›´æ–° DHCP åˆ†é…çš„ IP åœ°å€ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ipconfig /release</span><br><span class="line">ipconfig /renew</span><br></pre></td></tr></table></figure><h3 id="4-3-æŸ¥çœ‹ç½‘ç»œè¿æ¥"><a href="#4-3-æŸ¥çœ‹ç½‘ç»œè¿æ¥" class="headerlink" title="4.3 æŸ¥çœ‹ç½‘ç»œè¿æ¥"></a>4.3 æŸ¥çœ‹ç½‘ç»œè¿æ¥</h3><p>ä½¿ç”¨ <code>netstat</code> æ˜¾ç¤ºå½“å‰æ‰€æœ‰ç½‘ç»œè¿æ¥å’Œç›‘å¬ç«¯å£ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat</span><br></pre></td></tr></table></figure><h3 id="4-4-æµ‹è¯•ç½‘ç»œè¿æ¥"><a href="#4-4-æµ‹è¯•ç½‘ç»œè¿æ¥" class="headerlink" title="4.4 æµ‹è¯•ç½‘ç»œè¿æ¥"></a>4.4 æµ‹è¯•ç½‘ç»œè¿æ¥</h3><p>ä½¿ç”¨ <code>ping [IP åœ°å€æˆ–åŸŸå]</code> æµ‹è¯•ç½‘ç»œè¿æ¥ã€‚ä¾‹å¦‚ï¼Œæµ‹è¯•ä¸ Google çš„è¿æ¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping www.google.com</span><br></pre></td></tr></table></figure><h3 id="4-5-è¿½è¸ªè·¯ç”±"><a href="#4-5-è¿½è¸ªè·¯ç”±" class="headerlink" title="4.5 è¿½è¸ªè·¯ç”±"></a>4.5 è¿½è¸ªè·¯ç”±</h3><p>ä½¿ç”¨ <code>tracert [IP åœ°å€æˆ–åŸŸå]</code> è¿½è¸ªç½‘ç»œè·¯ç”±ã€‚ä¾‹å¦‚ï¼Œè¿½è¸ªåˆ° Google çš„è·¯ç”±ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tracert www.google.com</span><br></pre></td></tr></table></figure><hr><h2 id="ç£ç›˜å’Œæ–‡ä»¶ç³»ç»Ÿæ“ä½œå‘½ä»¤"><a href="#ç£ç›˜å’Œæ–‡ä»¶ç³»ç»Ÿæ“ä½œå‘½ä»¤" class="headerlink" title="ç£ç›˜å’Œæ–‡ä»¶ç³»ç»Ÿæ“ä½œå‘½ä»¤"></a>ç£ç›˜å’Œæ–‡ä»¶ç³»ç»Ÿæ“ä½œå‘½ä»¤</h2><h3 id="5-1-æŸ¥çœ‹ç£ç›˜ä½¿ç”¨æƒ…å†µ"><a href="#5-1-æŸ¥çœ‹ç£ç›˜ä½¿ç”¨æƒ…å†µ" class="headerlink" title="5.1 æŸ¥çœ‹ç£ç›˜ä½¿ç”¨æƒ…å†µ"></a>5.1 æŸ¥çœ‹ç£ç›˜ä½¿ç”¨æƒ…å†µ</h3><p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ˜¾ç¤ºæ¯ä¸ªé€»è¾‘ç£ç›˜çš„æ€»å¤§å°å’Œå¯ç”¨ç©ºé—´ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic logicaldisk get size,freespace,caption</span><br></pre></td></tr></table></figure><h3 id="5-2-æ ¼å¼åŒ–ç£ç›˜"><a href="#5-2-æ ¼å¼åŒ–ç£ç›˜" class="headerlink" title="5.2 æ ¼å¼åŒ–ç£ç›˜"></a>5.2 æ ¼å¼åŒ–ç£ç›˜</h3><p>ä½¿ç”¨ <code>format [é©±åŠ¨å™¨:] /FS:[æ–‡ä»¶ç³»ç»Ÿ]</code> æ ¼å¼åŒ–ç£ç›˜ã€‚ä¾‹å¦‚ï¼Œå°† D ç›˜æ ¼å¼åŒ–ä¸º NTFS æ–‡ä»¶ç³»ç»Ÿï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">format D: /FS:NTFS</span><br></pre></td></tr></table></figure><h3 id="5-3-æ£€æŸ¥ç£ç›˜é”™è¯¯"><a href="#5-3-æ£€æŸ¥ç£ç›˜é”™è¯¯" class="headerlink" title="5.3 æ£€æŸ¥ç£ç›˜é”™è¯¯"></a>5.3 æ£€æŸ¥ç£ç›˜é”™è¯¯</h3><p>ä½¿ç”¨ <code>chkdsk [é©±åŠ¨å™¨:]</code> æ£€æŸ¥ç£ç›˜é”™è¯¯ã€‚ä¾‹å¦‚ï¼Œæ£€æŸ¥ C ç›˜é”™è¯¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkdsk C:</span><br></pre></td></tr></table></figure><h3 id="5-4-æ˜¾ç¤ºç£ç›˜åˆ†åŒºä¿¡æ¯"><a href="#5-4-æ˜¾ç¤ºç£ç›˜åˆ†åŒºä¿¡æ¯" class="headerlink" title="5.4 æ˜¾ç¤ºç£ç›˜åˆ†åŒºä¿¡æ¯"></a>5.4 æ˜¾ç¤ºç£ç›˜åˆ†åŒºä¿¡æ¯</h3><p>ä½¿ç”¨ <code>diskpart</code> è¿›å…¥ DiskPart å·¥å…·ï¼Œç„¶ååœ¨æç¤ºç¬¦ä¸‹è¾“å…¥ <code>list disk</code> æŸ¥çœ‹æ‰€æœ‰ç£ç›˜ä¿¡æ¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">diskpart</span><br></pre></td></tr></table></figure><hr><h2 id="æ‰¹å¤„ç†æ–‡ä»¶"><a href="#æ‰¹å¤„ç†æ–‡ä»¶" class="headerlink" title="æ‰¹å¤„ç†æ–‡ä»¶"></a>æ‰¹å¤„ç†æ–‡ä»¶</h2><p>æ‰¹å¤„ç†æ–‡ä»¶æ˜¯åŒ…å«å¤šä¸ª CMD å‘½ä»¤çš„æ–‡æœ¬æ–‡ä»¶ï¼Œä¾¿äºä¸€æ¬¡æ€§æ‰§è¡Œä¸€ç³»åˆ—å‘½ä»¤ã€‚</p><h3 id="6-1-åˆ›å»ºæ‰¹å¤„ç†æ–‡ä»¶"><a href="#6-1-åˆ›å»ºæ‰¹å¤„ç†æ–‡ä»¶" class="headerlink" title="6.1 åˆ›å»ºæ‰¹å¤„ç†æ–‡ä»¶"></a>6.1 åˆ›å»ºæ‰¹å¤„ç†æ–‡ä»¶</h3><p>ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆå¦‚ Notepadï¼‰åˆ›å»ºä¸€ä¸ª <code>.bat</code> æ–‡ä»¶ï¼Œå¹¶è¾“å…¥å¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">echo Hello, World!</span><br><span class="line">pause</span><br></pre></td></tr></table></figure><h3 id="6-2-è¿è¡Œæ‰¹å¤„ç†æ–‡ä»¶"><a href="#6-2-è¿è¡Œæ‰¹å¤„ç†æ–‡ä»¶" class="headerlink" title="6.2 è¿è¡Œæ‰¹å¤„ç†æ–‡ä»¶"></a>6.2 è¿è¡Œæ‰¹å¤„ç†æ–‡ä»¶</h3><p>åŒå‡» <code>.bat</code> æ–‡ä»¶ï¼Œæˆ–åœ¨ CMD ä¸­è¾“å…¥æ–‡ä»¶è·¯å¾„æ¥è¿è¡Œè¯¥æ–‡ä»¶ã€‚</p><hr><h2 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h2><h3 id="7-1-æŸ¥çœ‹ç¯å¢ƒå˜é‡"><a href="#7-1-æŸ¥çœ‹ç¯å¢ƒå˜é‡" class="headerlink" title="7.1 æŸ¥çœ‹ç¯å¢ƒå˜é‡"></a>7.1 æŸ¥çœ‹ç¯å¢ƒå˜é‡</h3><p>ä½¿ç”¨ <code>set</code> å‘½ä»¤æ˜¾ç¤ºæ‰€æœ‰ç¯å¢ƒå˜é‡åŠå…¶å€¼ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set</span><br></pre></td></tr></table></figure><h3 id="7-2-è®¾ç½®ç¯å¢ƒå˜é‡"><a href="#7-2-è®¾ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="7.2 è®¾ç½®ç¯å¢ƒå˜é‡"></a>7.2 è®¾ç½®ç¯å¢ƒå˜é‡</h3><p>ä½¿ç”¨ <code>set [å˜é‡å]=[å€¼]</code> è®¾ç½®ç¯å¢ƒå˜é‡ã€‚ä¾‹å¦‚ï¼Œè®¾ç½®åä¸º <code>MY_VAR</code> çš„ç¯å¢ƒå˜é‡ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set MY_VAR=Hello</span><br></pre></td></tr></table></figure><h3 id="7-3-åˆ é™¤ç¯å¢ƒå˜é‡"><a href="#7-3-åˆ é™¤ç¯å¢ƒå˜é‡" class="headerlink" title="7.3 åˆ é™¤ç¯å¢ƒå˜é‡"></a>7.3 åˆ é™¤ç¯å¢ƒå˜é‡</h3><p>å°†ç¯å¢ƒå˜é‡å€¼è®¾ä¸ºç©ºå³å¯åˆ é™¤ã€‚ä¾‹å¦‚ï¼Œåˆ é™¤ <code>MY_VAR</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set MY_VAR=</span><br></pre></td></tr></table></figure><hr><h2 id="CMD-é«˜çº§æŠ€å·§"><a href="#CMD-é«˜çº§æŠ€å·§" class="headerlink" title="CMD é«˜çº§æŠ€å·§"></a>CMD é«˜çº§æŠ€å·§</h2><h3 id="8-1-ä½¿ç”¨ç®¡é“"><a href="#8-1-ä½¿ç”¨ç®¡é“" class="headerlink" title="8.1 ä½¿ç”¨ç®¡é“"></a>8.1 ä½¿ç”¨ç®¡é“</h3><p>ç®¡é“ç¬¦å· <code>|</code> å¯å°†ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºä¼ é€’ç»™å¦ä¸€ä¸ªå‘½ä»¤ã€‚ä¾‹å¦‚ï¼ŒæŸ¥æ‰¾è¿›ç¨‹åˆ—è¡¨ä¸­åŒ…å« â€œchromeâ€ çš„è¿›ç¨‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tasklist | find &quot;chrome&quot;</span><br></pre></td></tr></table></figure><h3 id="8-2-ä½¿ç”¨é‡å®šå‘"><a href="#8-2-ä½¿ç”¨é‡å®šå‘" class="headerlink" title="8.2 ä½¿ç”¨é‡å®šå‘"></a>8.2 ä½¿ç”¨é‡å®šå‘</h3><p>é‡å®šå‘ç¬¦ <code>&gt;</code> å¯å°†å‘½ä»¤çš„è¾“å‡ºä¿å­˜åˆ°æ–‡ä»¶ä¸­ã€‚ä¾‹å¦‚ï¼Œå°† <code>dir</code> å‘½ä»¤çš„è¾“å‡ºä¿å­˜åˆ° <code>output.txt</code> æ–‡ä»¶ä¸­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dir &gt; output.txt</span><br></pre></td></tr></table></figure><h3 id="8-3-æ‰¹é‡é‡å‘½åæ–‡ä»¶"><a href="#8-3-æ‰¹é‡é‡å‘½åæ–‡ä»¶" class="headerlink" title="8.3 æ‰¹é‡é‡å‘½åæ–‡ä»¶"></a>8.3 æ‰¹é‡é‡å‘½åæ–‡ä»¶</h3><p>ä½¿ç”¨ <code>for</code> å¾ªç¯æ‰¹é‡é‡å‘½åæ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œå°†å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰ <code>.txt</code> æ–‡ä»¶é‡å‘½åä¸º <code>.bak</code> æ–‡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for %f in (*.txt) do ren &quot;%f&quot; &quot;*.bak&quot;</span><br></pre></td></tr></table></figure><p><em>æ³¨ï¼šåœ¨æ‰¹å¤„ç†æ–‡ä»¶ä¸­ä½¿ç”¨ for å¾ªç¯æ—¶ï¼Œéœ€å°† <code>%f</code> æ›¿æ¢ä¸º <code>%%f</code>ã€‚</em></p><hr><h2 id="å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ"><a href="#å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ" class="headerlink" title="å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ"></a>å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h2><h3 id="9-1-CMD-æ— æ³•è¯†åˆ«å‘½ä»¤"><a href="#9-1-CMD-æ— æ³•è¯†åˆ«å‘½ä»¤" class="headerlink" title="9.1 CMD æ— æ³•è¯†åˆ«å‘½ä»¤"></a>9.1 CMD æ— æ³•è¯†åˆ«å‘½ä»¤</h3><ul><li>å¦‚æœ CMD æç¤º â€œä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤â€ï¼Œå¯èƒ½æ˜¯å› ä¸ºå‘½ä»¤è¾“å…¥é”™è¯¯æˆ–ç›¸åº”ç¨‹åºæœªå®‰è£…ã€‚</li></ul><h3 id="9-2-æƒé™ä¸è¶³"><a href="#9-2-æƒé™ä¸è¶³" class="headerlink" title="9.2 æƒé™ä¸è¶³"></a>9.2 æƒé™ä¸è¶³</h3><ul><li>æŸäº›å‘½ä»¤éœ€è¦ç®¡ç†å‘˜æƒé™ã€‚è¯·å³é”®ç‚¹å‡» CMD å›¾æ ‡ï¼Œé€‰æ‹©â€œä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œâ€ã€‚</li></ul><hr><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡è¯¦ç»†ä»‹ç»äº† CMD çš„åŸºæœ¬å‘½ä»¤ã€æ–‡ä»¶å’Œç›®å½•æ“ä½œã€ç³»ç»Ÿä¿¡æ¯è·å–ã€ç½‘ç»œé…ç½®ç­‰å†…å®¹ã€‚é€šè¿‡å…·ä½“ç¤ºä¾‹å’Œæ“ä½œè¯´æ˜ï¼Œå¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’ŒæŒæ¡ CMD çš„ä½¿ç”¨ã€‚å¸Œæœ›è¿™ä»½ CMD å‘½ä»¤å¤§å…¨èƒ½å¸®åŠ©ä½ æé«˜å·¥ä½œæ•ˆç‡ï¼Œæˆä¸º CMD ä½¿ç”¨çš„é«˜æ‰‹ï¼</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Task3 Android Diary</title>
      <link href="/2025/03/05/Task3-Diary/"/>
      <url>/2025/03/05/Task3-Diary/</url>
      
        <content type="html"><![CDATA[<h1 id="MY-API-KEY-å’Œé£"><a href="#MY-API-KEY-å’Œé£" class="headerlink" title="MY API KEY(å’Œé£)"></a>MY API KEY(å’Œé£)</h1><p>670ca929136a456992608cd2e794df24</p><h1 id="Mainactivity"><a href="#Mainactivity" class="headerlink" title="Mainactivity"></a>Mainactivity</h1><h2 id="è¶…çº§å¥½çš„Mainactivity"><a href="#è¶…çº§å¥½çš„Mainactivity" class="headerlink" title="è¶…çº§å¥½çš„Mainactivity"></a>è¶…çº§å¥½çš„Mainactivity</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line">package com.example.diary_3.activity</span><br><span class="line"></span><br><span class="line">import androidx.core.widget.addTextChangedListener</span><br><span class="line">import android.app.Activity</span><br><span class="line">import android.content.BroadcastReceiver</span><br><span class="line">import android.content.Context</span><br><span class="line">import android.content.Intent</span><br><span class="line">import android.content.IntentFilter</span><br><span class="line">import android.os.Build</span><br><span class="line">import android.os.Bundle</span><br><span class="line">import android.util.Log</span><br><span class="line">import android.widget.Toast</span><br><span class="line">import androidx.activity.result.contract.ActivityResultContracts</span><br><span class="line">import androidx.appcompat.app.AlertDialog</span><br><span class="line">import androidx.appcompat.app.AppCompatActivity</span><br><span class="line">import androidx.lifecycle.Observer</span><br><span class="line">import androidx.lifecycle.lifecycleScope</span><br><span class="line">import androidx.recyclerview.widget.LinearLayoutManager</span><br><span class="line">import com.example.diary_3.adapter.DiaryAdapter</span><br><span class="line">import com.example.diary_3.database.Diary</span><br><span class="line">import com.example.diary_3.database.DiaryDatabase</span><br><span class="line">import com.example.diary_3.databinding.ActivityMainBinding</span><br><span class="line">import kotlinx.coroutines.Dispatchers</span><br><span class="line">import kotlinx.coroutines.launch</span><br><span class="line">import kotlinx.coroutines.withContext</span><br><span class="line"></span><br><span class="line">class MainActivity : AppCompatActivity() &#123;</span><br><span class="line">    private lateinit var binding: ActivityMainBinding</span><br><span class="line">    private lateinit var diaryDatabase: DiaryDatabase</span><br><span class="line">    private lateinit var diaryAdapter: DiaryAdapter</span><br><span class="line"></span><br><span class="line">    private val addDiaryLauncher = registerForActivityResult(ActivityResultContracts.StartActivityForResult()) &#123; result -&gt;</span><br><span class="line">        when (result.resultCode) &#123;</span><br><span class="line">            Activity.RESULT_OK -&gt; loadAllDiaries()</span><br><span class="line">            Activity.RESULT_CANCELED -&gt; &#123;&#125;</span><br><span class="line">            else -&gt; Log.d(&quot;MainActivity&quot;, &quot;æœªçŸ¥çš„è¿”å›ç»“æœ: $&#123;result.resultCode&#125;&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private val diarySavedReceiver = object : BroadcastReceiver() &#123;</span><br><span class="line">        override fun onReceive(context: Context?, intent: Intent?) &#123;</span><br><span class="line">            if (intent?.action == &quot;SAVED&quot;) &#123;</span><br><span class="line">                loadAllDiaries()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override fun onCreate(savedInstanceState: Bundle?) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState)</span><br><span class="line">        binding = ActivityMainBinding.inflate(layoutInflater)</span><br><span class="line">        setContentView(binding.root)</span><br><span class="line"></span><br><span class="line">        diaryDatabase = DiaryDatabase.getInstance(this)</span><br><span class="line">        binding.recyclerView.layoutManager = LinearLayoutManager(this)</span><br><span class="line">        diaryAdapter = DiaryAdapter(this, emptyList())</span><br><span class="line">        binding.recyclerView.adapter = diaryAdapter</span><br><span class="line"></span><br><span class="line">        val filter = IntentFilter(&quot;SAVED&quot;)</span><br><span class="line">        registerReceiver(diarySavedReceiver, filter)</span><br><span class="line"></span><br><span class="line">        loadAllDiaries()</span><br><span class="line"></span><br><span class="line">        // ç›‘å¬æœç´¢æ¡†</span><br><span class="line">        binding.searchBox.addTextChangedListener &#123; text -&gt;</span><br><span class="line">            searchDiaries(text.toString())</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // å¯åŠ¨æ·»åŠ æ—¥è®°é¡µé¢</span><br><span class="line">        binding.addDiaryButton.setOnClickListener &#123;</span><br><span class="line">            val intent = Intent(this, AddDiaryActivity::class.java)</span><br><span class="line">            addDiaryLauncher.launch(intent)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // ç»‘å®šåˆ é™¤æŒ‰é’®</span><br><span class="line">        binding.deleteDiaryButton.setOnClickListener &#123;</span><br><span class="line">            deleteDiary()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // åˆ é™¤æ—¥è®°çš„æ–¹æ³•</span><br><span class="line">    private fun deleteDiary() &#123;</span><br><span class="line">        val diaries = diaryAdapter.getCurrentDiaries()</span><br><span class="line">        if (diaries.isEmpty()) &#123;</span><br><span class="line">            Toast.makeText(this, &quot;å½“å‰æ²¡æœ‰æ—¥è®°å¯åˆ é™¤&quot;, Toast.LENGTH_SHORT).show()</span><br><span class="line">            return</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        val diaryTitles = diaries.map &#123; it.title &#125;.toTypedArray()</span><br><span class="line">        var selectedIndex = 0</span><br><span class="line"></span><br><span class="line">        AlertDialog.Builder(this)</span><br><span class="line">            .setTitle(&quot;é€‰æ‹©è¦åˆ é™¤çš„æ—¥è®°&quot;)</span><br><span class="line">            .setSingleChoiceItems(diaryTitles, 0) &#123; _, which -&gt;</span><br><span class="line">                selectedIndex = which</span><br><span class="line">            &#125;</span><br><span class="line">            .setPositiveButton(&quot;åˆ é™¤&quot;) &#123; _, _ -&gt;</span><br><span class="line">                val diaryToDelete = diaries[selectedIndex]</span><br><span class="line">                lifecycleScope.launch(Dispatchers.IO) &#123;</span><br><span class="line">                    diaryDatabase.diaryDao().deleteDiary(diaryToDelete)</span><br><span class="line">                    withContext(Dispatchers.Main) &#123;</span><br><span class="line">                        loadAllDiaries()</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .setNegativeButton(&quot;å–æ¶ˆ&quot;, null)</span><br><span class="line">            .show()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // åŠ è½½æ‰€æœ‰æ—¥è®°</span><br><span class="line">    private fun loadAllDiaries() &#123;</span><br><span class="line">        diaryDatabase.diaryDao().getDiaries().observe(this, Observer &#123; diaries -&gt;</span><br><span class="line">            diaryAdapter.updateData(diaries) // æ›´æ–°æ•°æ®</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // æœç´¢æ—¥è®°</span><br><span class="line">    private fun searchDiaries(query: String) &#123;</span><br><span class="line">        diaryDatabase.diaryDao().searchDiaries(&quot;%$query%&quot;)</span><br><span class="line">            .observe(this, Observer &#123; diaries -&gt;</span><br><span class="line">                diaryAdapter.updateData(diaries)</span><br><span class="line">            &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override fun onDestroy() &#123;</span><br><span class="line">        super.onDestroy()</span><br><span class="line">        unregisterReceiver(diarySavedReceiver)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line">package com.example.diary_3.activity</span><br><span class="line">import androidx.core.widget.addTextChangedListener</span><br><span class="line">import android.app.Activity</span><br><span class="line">import android.content.BroadcastReceiver</span><br><span class="line">import android.content.Context</span><br><span class="line">import android.content.Intent</span><br><span class="line">import android.content.IntentFilter</span><br><span class="line">import android.os.Build</span><br><span class="line">import android.os.Bundle</span><br><span class="line">import android.text.Editable</span><br><span class="line">import android.text.TextWatcher</span><br><span class="line">import android.util.Log</span><br><span class="line">import android.widget.Toast</span><br><span class="line">import androidx.activity.result.contract.ActivityResultContracts</span><br><span class="line">import androidx.annotation.RequiresApi</span><br><span class="line">import androidx.appcompat.app.AppCompatActivity</span><br><span class="line">import androidx.lifecycle.lifecycleScope</span><br><span class="line">import androidx.recyclerview.widget.LinearLayoutManager</span><br><span class="line">import androidx.room.InvalidationTracker</span><br><span class="line">import com.example.diary_3.adapter.DiaryAdapter</span><br><span class="line">import com.example.diary_3.database.Diary</span><br><span class="line">import com.example.diary_3.database.DiaryDatabase</span><br><span class="line">import com.example.diary_3.databinding.ActivityMainBinding</span><br><span class="line">import java.util.concurrent.Executors</span><br><span class="line">import kotlinx.coroutines.CoroutineScope</span><br><span class="line">import kotlinx.coroutines.Dispatchers</span><br><span class="line">import kotlinx.coroutines.launch</span><br><span class="line">import kotlinx.coroutines.withContext</span><br><span class="line">import androidx.lifecycle.Observer</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class MainActivity : AppCompatActivity() &#123;</span><br><span class="line">    private lateinit var binding: ActivityMainBinding</span><br><span class="line">    private lateinit var diaryDatabase: DiaryDatabase</span><br><span class="line">    private lateinit var diaryAdapter: DiaryAdapter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    private val addDiaryLauncher = registerForActivityResult(ActivityResultContracts.StartActivityForResult()) &#123; result -&gt;</span><br><span class="line">        when (result.resultCode) &#123;</span><br><span class="line">            Activity.RESULT_OK -&gt; &#123;</span><br><span class="line">                // å¦‚æœæœ‰è¿”å›ç»“æœï¼Œåˆ·æ–°æ•°æ®</span><br><span class="line">                loadAllDiaries()</span><br><span class="line">            &#125;</span><br><span class="line">            Activity.RESULT_CANCELED -&gt; &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            else -&gt; &#123;</span><br><span class="line">                // å¤„ç†å…¶ä»–å¯èƒ½çš„è¿”å›æƒ…å†µ</span><br><span class="line">                Log.d(&quot;MainActivity&quot;, &quot;æœªçŸ¥çš„è¿”å›ç»“æœ: $&#123;result.resultCode&#125;&quot;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    private val diarySavedReceiver = object : BroadcastReceiver() &#123;</span><br><span class="line">        override fun onReceive(context: Context?, intent: Intent?) &#123;</span><br><span class="line">            if (intent?.action == &quot;SAVED&quot;) &#123;</span><br><span class="line">                loadAllDiaries()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;//gl gd</span><br><span class="line"></span><br><span class="line">    override fun onCreate(savedInstanceState: Bundle?) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState)</span><br><span class="line">        binding = ActivityMainBinding.inflate(layoutInflater)</span><br><span class="line">        setContentView(binding.root)</span><br><span class="line">        diaryDatabase = DiaryDatabase.getInstance(this)</span><br><span class="line">        binding.recyclerView.layoutManager = LinearLayoutManager(this)</span><br><span class="line">        diaryAdapter = DiaryAdapter(this, emptyList())</span><br><span class="line">        binding.recyclerView.adapter = diaryAdapter</span><br><span class="line">        val filter = IntentFilter(&quot;SAVED&quot;)</span><br><span class="line">        if (android.os.Build.VERSION.SDK_INT &gt;= android.os.Build.VERSION_CODES.TIRAMISU) &#123;</span><br><span class="line">            registerReceiver(diarySavedReceiver, filter, Context.RECEIVER_NOT_EXPORTED)</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            registerReceiver(diarySavedReceiver, filter, RECEIVER_NOT_EXPORTED)</span><br><span class="line">        &#125;//ys5 gd</span><br><span class="line">        loadAllDiaries()</span><br><span class="line">        binding.searchBox.addTextChangedListener &#123; text -&gt;</span><br><span class="line">            searchDiaries(text.toString())</span><br><span class="line">        &#125;//ys3 gd</span><br><span class="line">        // ä½¿ç”¨ ActivityResultLauncher å¯åŠ¨ AddDiaryActivity</span><br><span class="line">        binding.addDiaryButton.setOnClickListener &#123;</span><br><span class="line">            val intent = Intent(this, AddDiaryActivity::class.java)</span><br><span class="line">            addDiaryLauncher.launch(intent)</span><br><span class="line">        &#125;//ys4 gd</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    private fun loadAllDiaries() &#123;</span><br><span class="line">        lifecycleScope.launch &#123;</span><br><span class="line">            val diaries = withContext(Dispatchers.IO) &#123;</span><br><span class="line">                diaryDatabase.diaryDao().getAllDiaries()</span><br><span class="line">            &#125;</span><br><span class="line">            diaryAdapter.updateData(diaries) // æ›´æ–°æ•°æ®</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;//ys8 gd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    private fun searchDiaries(query: String) &#123;</span><br><span class="line">        diaryDatabase.diaryDao().searchDiaries(&quot;%$query%&quot;)</span><br><span class="line">            .observe(this, object : Observer&lt;List&lt;Diary&gt;&gt; &#123;</span><br><span class="line">                override fun onChanged(diaries: List&lt;Diary&gt;) &#123;</span><br><span class="line">                    diaryAdapter = DiaryAdapter(this@MainActivity, diaries)</span><br><span class="line">                    binding.recyclerView.adapter = diaryAdapter</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">    &#125;//ys9 gd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    override fun onDestroy() &#123;</span><br><span class="line">        super.onDestroy()</span><br><span class="line">        unregisterReceiver(diarySavedReceiver)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="AddDiaryActivity"><a href="#AddDiaryActivity" class="headerlink" title="AddDiaryActivity"></a>AddDiaryActivity</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br></pre></td><td class="code"><pre><span class="line">package com.example.diary_3.activity</span><br><span class="line">import androidx.appcompat.app.AlertDialog</span><br><span class="line">import android.view.View</span><br><span class="line">import android.widget.EditText</span><br><span class="line">import com.example.diary_3.utils.DateUtils</span><br><span class="line">import android.content.Intent</span><br><span class="line">import android.content.pm.PackageManager</span><br><span class="line">import android.net.Uri</span><br><span class="line">import android.os.Bundle</span><br><span class="line">import android.os.Looper</span><br><span class="line">import android.provider.MediaStore</span><br><span class="line">import android.util.Log</span><br><span class="line">import android.widget.Toast</span><br><span class="line">import androidx.appcompat.app.AppCompatActivity</span><br><span class="line">import androidx.core.app.ActivityCompat</span><br><span class="line">import androidx.core.content.ContextCompat</span><br><span class="line">import com.bumptech.glide.Glide</span><br><span class="line">import com.bumptech.glide.request.RequestOptions</span><br><span class="line">import com.example.diary_3.R</span><br><span class="line">import com.example.diary_3.database.Diary</span><br><span class="line">import com.example.diary_3.database.DiaryDatabase</span><br><span class="line">import com.example.diary_3.databinding.ActivityAddDiaryBinding</span><br><span class="line">import com.example.diary_3.model.CityResponse</span><br><span class="line">import com.example.diary_3.model.WeatherResponse</span><br><span class="line">import com.example.diary_3.network.RetrofitClient</span><br><span class="line">import com.example.diary_3.network.WeatherApi</span><br><span class="line">import com.example.diary_3.utils.LocationUtils</span><br><span class="line">import retrofit2.Call</span><br><span class="line">import retrofit2.Callback</span><br><span class="line">import retrofit2.Response</span><br><span class="line">import java.util.Calendar</span><br><span class="line">import java.util.concurrent.Executors</span><br><span class="line"></span><br><span class="line">class AddDiaryActivity : AppCompatActivity() &#123;</span><br><span class="line">    private val selectedLocalImageUris = mutableListOf&lt;Uri&gt;()</span><br><span class="line">    private val networkImageUrls = mutableListOf&lt;String&gt;()</span><br><span class="line">    private val API_KEY = &quot;670ca929136a456992608cd2e794df24&quot;</span><br><span class="line">    private lateinit var binding: ActivityAddDiaryBinding</span><br><span class="line">    private var selectedDate: Calendar = Calendar.getInstance()</span><br><span class="line">    private lateinit var diaryDatabase: DiaryDatabase</span><br><span class="line">    private lateinit var locationUtils: LocationUtils</span><br><span class="line">    private val PERMISSION_REQUEST_CODE = 1</span><br><span class="line">    private var selectedLocalImageUri: Uri? = null</span><br><span class="line">    private var networkImageUrl: String? = null</span><br><span class="line"></span><br><span class="line">    private fun hasPermission(permission: String): Boolean &#123;</span><br><span class="line">        return ContextCompat.checkSelfPermission(this, permission) == PackageManager.PERMISSION_GRANTED</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override fun onCreate(savedInstanceState: Bundle?) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState)</span><br><span class="line">        binding = ActivityAddDiaryBinding.inflate(layoutInflater)</span><br><span class="line">        setContentView(binding.root)</span><br><span class="line"></span><br><span class="line">        diaryDatabase = DiaryDatabase.getInstance(this)</span><br><span class="line">        locationUtils = LocationUtils(this)</span><br><span class="line"></span><br><span class="line">        binding.selectImageButton.setOnClickListener &#123;</span><br><span class="line">            pickLocalImage()</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        binding.addNetworkImageButton.setOnClickListener &#123;</span><br><span class="line">            // åˆ›å»ºä¸€ä¸ªè¾“å…¥æ¡†</span><br><span class="line">            val input = EditText(this)</span><br><span class="line">            input.hint = &quot;è¯·è¾“å…¥æœ‰æ•ˆçš„å›¾ç‰‡é“¾æ¥&quot;</span><br><span class="line"></span><br><span class="line">            // æ„å»ºå¯¹è¯æ¡†</span><br><span class="line">            AlertDialog.Builder(this)</span><br><span class="line">                .setTitle(&quot;è¾“å…¥å›¾ç‰‡URL&quot;)</span><br><span class="line">                .setView(input)</span><br><span class="line">                .setPositiveButton(&quot;ç¡®å®š&quot;) &#123; dialog, which -&gt;</span><br><span class="line">                    val url = input.text.toString().trim()</span><br><span class="line">                    if (url.isNotBlank()) &#123;</span><br><span class="line">                        networkImageUrl = url</span><br><span class="line">                        Glide.with(this)</span><br><span class="line">                            .load(url)</span><br><span class="line">                            .placeholder(R.drawable.loading_placeholder) // åŠ è½½è¿‡ç¨‹ä¸­çš„å ä½ç¬¦å›¾ç‰‡</span><br><span class="line">                            .apply(RequestOptions.circleCropTransform())</span><br><span class="line">                            .error(R.drawable.no) // åŠ è½½å¤±è´¥æ—¶æ˜¾ç¤ºçš„å›¾ç‰‡</span><br><span class="line">                            .into(binding.selectedImageView)</span><br><span class="line">                        binding.selectedImageView.visibility = View.VISIBLE</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                        Toast.makeText(this, &quot;è¯·è¾“å…¥æœ‰æ•ˆçš„å›¾ç‰‡é“¾æ¥&quot;, Toast.LENGTH_SHORT).show()</span><br><span class="line">                        binding.selectedImageView.visibility = View.GONE</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                .setNegativeButton(&quot;å–æ¶ˆ&quot;) &#123; dialog, which -&gt;</span><br><span class="line">                    dialog.cancel()</span><br><span class="line">                &#125;</span><br><span class="line">                .show()</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        binding.saveDiaryButton.setOnClickListener &#123;</span><br><span class="line">            saveDiary()</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        // æ–°å¢æŒ‰é’®ï¼šç‚¹å‡»åˆ·æ–°åœ°ç‚¹å’Œå¤©æ°”</span><br><span class="line">        binding.refreshWeatherLocationButton.setOnClickListener &#123;</span><br><span class="line">            getLocation()</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        val permissionsToRequest = mutableListOf&lt;String&gt;()</span><br><span class="line"></span><br><span class="line">        if (!hasPermission(android.Manifest.permission.ACCESS_FINE_LOCATION)) &#123;</span><br><span class="line">            permissionsToRequest.add(android.Manifest.permission.ACCESS_FINE_LOCATION)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if (!hasPermission(android.Manifest.permission.READ_EXTERNAL_STORAGE)) &#123;</span><br><span class="line">            permissionsToRequest.add(android.Manifest.permission.READ_EXTERNAL_STORAGE)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if (permissionsToRequest.isNotEmpty()) &#123;</span><br><span class="line">            ActivityCompat.requestPermissions(</span><br><span class="line">                this,</span><br><span class="line">                permissionsToRequest.toTypedArray(),</span><br><span class="line">                PERMISSION_REQUEST_CODE</span><br><span class="line">            )</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            getLocation()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private fun pickLocalImage() &#123;</span><br><span class="line">        val intent = Intent(Intent.ACTION_PICK, MediaStore.Images.Media.EXTERNAL_CONTENT_URI)</span><br><span class="line">        startActivityForResult(intent, 1)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override fun onActivityResult(requestCode: Int, resultCode: Int, data: Intent?) &#123;</span><br><span class="line">        super.onActivityResult(requestCode, resultCode, data)</span><br><span class="line"></span><br><span class="line">        if (requestCode == 1 &amp;&amp; resultCode == RESULT_OK &amp;&amp; data != null) &#123;</span><br><span class="line">            selectedLocalImageUri = data.data</span><br><span class="line">            Glide.with(this)</span><br><span class="line">                .load(selectedLocalImageUri)</span><br><span class="line">                .into(binding.selectedImageView)</span><br><span class="line">            binding.selectedImageView.visibility = android.view.View.VISIBLE</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private fun getLocation() &#123;</span><br><span class="line">        locationUtils.getLocation &#123; location -&gt;</span><br><span class="line">            if (location != null) &#123;</span><br><span class="line">                val latitude = location.latitude</span><br><span class="line">                val longitude = location.longitude</span><br><span class="line">                Log.d(&quot;AddDiaryActivity&quot;, &quot;è·å–åˆ°çš„ç»çº¬åº¦: çº¬åº¦ $latitude, ç»åº¦ $longitude&quot;)</span><br><span class="line">                // æ ¼å¼åŒ–ç»çº¬åº¦å­—ç¬¦ä¸²ï¼Œæ³¨æ„è¿™é‡Œ longitude å’Œ latitude çš„é¡ºåºå¯ä»¥æ ¹æ®æ¥å£è¦æ±‚è°ƒæ•´</span><br><span class="line">                val loc = String.format(&quot;%.2f,%.2f&quot;, location.longitude, location.latitude)</span><br><span class="line">                Executors.newSingleThreadExecutor().execute &#123;</span><br><span class="line">                    runOnUiThread &#123;</span><br><span class="line">                        binding.locationTextView.text = loc</span><br><span class="line">                        getCityId(loc)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                runOnUiThread &#123;</span><br><span class="line">                    Toast.makeText(this, &quot;æ— æ³•è·å–å½“å‰ä½ç½®&quot;, Toast.LENGTH_SHORT).show()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private fun showToastOnUiThread(message: String) &#123;</span><br><span class="line">        if (Looper.myLooper() == Looper.getMainLooper()) &#123;</span><br><span class="line">            Toast.makeText(this, message, Toast.LENGTH_SHORT).show()</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            runOnUiThread &#123;</span><br><span class="line">                Toast.makeText(this, message, Toast.LENGTH_SHORT).show()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private fun getCityId(cityName: String) &#123;</span><br><span class="line">        val weatherApi = RetrofitClient.geoInstance.create(WeatherApi::class.java)</span><br><span class="line">        weatherApi.getCityInfo(API_KEY, cityName).enqueue(object : Callback&lt;CityResponse&gt; &#123;</span><br><span class="line">            override fun onResponse(call: Call&lt;CityResponse&gt;, response: Response&lt;CityResponse&gt;) &#123;</span><br><span class="line">                if (response.isSuccessful &amp;&amp; response.body()?.code == &quot;200&quot;) &#123;</span><br><span class="line">                    val cityLocation = response.body()?.location?.firstOrNull()</span><br><span class="line">                    if (cityLocation != null) &#123;</span><br><span class="line">                        binding.locationTextView.text = cityLocation.name</span><br><span class="line">                        getWeatherInfo(cityLocation.id)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    Log.e(&quot;AddDiaryActivity&quot;, &quot;è·å–åŸå¸‚ ID å¤±è´¥: $&#123;response.message()&#125;, å“åº”ä»£ç : $&#123;response.code()&#125;, å“åº”ä½“: $&#123;response.errorBody()?.string()&#125;&quot;)</span><br><span class="line">                    showToastOnUiThread(&quot;è·å–åŸå¸‚ ID å¤±è´¥&quot;)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            override fun onFailure(call: Call&lt;CityResponse&gt;, t: Throwable) &#123;</span><br><span class="line">                Log.e(&quot;AddDiaryActivity&quot;, &quot;è·å–åŸå¸‚ ID ç½‘ç»œè¯·æ±‚å¤±è´¥: $&#123;t.message&#125;&quot;, t)</span><br><span class="line">                showToastOnUiThread(&quot;è·å–åŸå¸‚ ID ç½‘ç»œè¯·æ±‚å¤±è´¥&quot;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private fun getWeatherInfo(cityId: String) &#123;</span><br><span class="line">        val weatherApi = RetrofitClient.weatherInstance.create(WeatherApi::class.java)</span><br><span class="line">        weatherApi.getWeatherInfo(API_KEY, cityId).enqueue(object : Callback&lt;WeatherResponse&gt; &#123;</span><br><span class="line">            override fun onResponse(call: Call&lt;WeatherResponse&gt;, response: Response&lt;WeatherResponse&gt;) &#123;</span><br><span class="line">                if (response.isSuccessful &amp;&amp; response.body()?.code == &quot;200&quot;) &#123;</span><br><span class="line">                    val today = DateUtils.formatDate(Calendar.getInstance().time)</span><br><span class="line">                    val todayWeather = response.body()?.daily?.firstOrNull &#123; it.fxDate == today &#125;</span><br><span class="line">                    if (todayWeather != null) &#123;</span><br><span class="line">                        val weatherText = todayWeather.textDay</span><br><span class="line">                        binding.weatherTextView.text = weatherText</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    Log.e(&quot;AddDiaryActivity&quot;, &quot;è·å–å¤©æ°”ä¿¡æ¯å¤±è´¥: $&#123;response.message()&#125;, å“åº”ä»£ç : $&#123;response.code()&#125;, å“åº”ä½“: $&#123;response.errorBody()?.string()&#125;&quot;)</span><br><span class="line">                    showToastOnUiThread(&quot;è·å–å¤©æ°”ä¿¡æ¯å¤±è´¥&quot;)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            override fun onFailure(call: Call&lt;WeatherResponse&gt;, t: Throwable) &#123;</span><br><span class="line">                Log.e(&quot;AddDiaryActivity&quot;, &quot;è·å–å¤©æ°”ä¿¡æ¯ç½‘ç»œè¯·æ±‚å¤±è´¥: $&#123;t.message&#125;&quot;, t)</span><br><span class="line">                showToastOnUiThread(&quot;è·å–å¤©æ°”ä¿¡æ¯ç½‘ç»œè¯·æ±‚å¤±è´¥&quot;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private fun saveDiary() &#123;</span><br><span class="line">        Executors.newSingleThreadExecutor().execute &#123;</span><br><span class="line">            val title = binding.titleEditText.text.toString()</span><br><span class="line">            val content = binding.contentEditText.text.toString()</span><br><span class="line">            val localImagePath = selectedLocalImageUri?.toString()</span><br><span class="line">            val date = DateUtils.formatDate(Calendar.getInstance().time)</span><br><span class="line">            val weather = binding.weatherTextView.text.toString()</span><br><span class="line">            val location = binding.locationTextView.text.toString()</span><br><span class="line"></span><br><span class="line">            val diary = Diary(</span><br><span class="line">                title = title,</span><br><span class="line">                content = content,</span><br><span class="line">                localImagePath = localImagePath,</span><br><span class="line">                networkImageUrl = networkImageUrl,</span><br><span class="line">                date = date,</span><br><span class="line">                weather = weather,</span><br><span class="line">                location = location</span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">            diaryDatabase.diaryDao().insertDiary(diary)</span><br><span class="line">            runOnUiThread &#123;</span><br><span class="line">                Toast.makeText(this, &quot;æ—¥è®°ä¿å­˜æˆåŠŸ&quot;, Toast.LENGTH_SHORT).show()</span><br><span class="line">                val intent = Intent(&quot;SAVED&quot;) // æˆ–è€… &quot;com.example.app.DIARY_SAVED&quot;</span><br><span class="line">                sendBroadcast(intent)</span><br><span class="line">                finish()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="DetailUtils"><a href="#DetailUtils" class="headerlink" title="DetailUtils"></a>DetailUtils</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">package com.example.diary_final.utils</span><br><span class="line"></span><br><span class="line">import java.text.SimpleDateFormat</span><br><span class="line">import java.util.Date</span><br><span class="line">import java.util.Locale</span><br><span class="line"></span><br><span class="line">object DateUtils &#123;</span><br><span class="line">    private const val DEFAULT_DATE_FORMAT = &quot;yyyy-MM-dd&quot;</span><br><span class="line"></span><br><span class="line">    // çº¿ç¨‹å®‰å…¨çš„ SimpleDateFormat ç”Ÿæˆ</span><br><span class="line">    private fun getDateFormat(pattern: String): SimpleDateFormat &#123;</span><br><span class="line">        return SimpleDateFormat(pattern, Locale.getDefault())</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // æ ¼å¼åŒ–æ—¥æœŸï¼ˆé»˜è®¤æ ¼å¼ &quot;yyyy-MM-dd&quot;ï¼‰</span><br><span class="line">    fun formatDate(date: Date, pattern: String = DEFAULT_DATE_FORMAT): String &#123;</span><br><span class="line">        return getDateFormat(pattern).format(date)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // è·å–å½“å‰æ—¥æœŸçš„æ ¼å¼åŒ–å­—ç¬¦ä¸²</span><br><span class="line">    fun getCurrentDate(pattern: String = DEFAULT_DATE_FORMAT): String &#123;</span><br><span class="line">        return formatDate(Date(), pattern)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="LocationUtils"><a href="#LocationUtils" class="headerlink" title="LocationUtils"></a>LocationUtils</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">package com.example.diary_final.utils</span><br><span class="line"></span><br><span class="line">import android.Manifest</span><br><span class="line">import android.content.Context</span><br><span class="line">import android.content.pm.PackageManager</span><br><span class="line">import android.location.Location</span><br><span class="line">import android.location.LocationListener</span><br><span class="line">import android.location.LocationManager</span><br><span class="line">import android.os.Bundle</span><br><span class="line">import androidx.core.app.ActivityCompat</span><br><span class="line"></span><br><span class="line">class LocationUtils(private val context: Context) &#123;</span><br><span class="line"></span><br><span class="line">    private val locationManager = context.getSystemService(Context.LOCATION_SERVICE) as LocationManager</span><br><span class="line">    private var locationListener: LocationListener? = null</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * è·å–å½“å‰ä½ç½®</span><br><span class="line">     */</span><br><span class="line">    fun getLocation(onLocationReceived: (Location) -&gt; Unit) &#123;</span><br><span class="line">        // æƒé™æ£€æŸ¥</span><br><span class="line">        if (ActivityCompat.checkSelfPermission(context, Manifest.permission.ACCESS_FINE_LOCATION) != PackageManager.PERMISSION_GRANTED &amp;&amp;</span><br><span class="line">            ActivityCompat.checkSelfPermission(context, Manifest.permission.ACCESS_COARSE_LOCATION) != PackageManager.PERMISSION_GRANTED</span><br><span class="line">        ) &#123;</span><br><span class="line">            return // æ²¡æœ‰æƒé™ï¼Œç›´æ¥è¿”å›</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // è·å–ä¸Šæ¬¡å·²çŸ¥ä½ç½®ï¼ˆå¯èƒ½ä¼šåŠ å¿«é¦–æ¬¡è·å–é€Ÿåº¦ï¼‰</span><br><span class="line">        val lastKnownLocation: Location? = locationManager.getLastKnownLocation(LocationManager.GPS_PROVIDER)</span><br><span class="line">            ?: locationManager.getLastKnownLocation(LocationManager.NETWORK_PROVIDER)</span><br><span class="line">        if (lastKnownLocation != null) &#123;</span><br><span class="line">            onLocationReceived(lastKnownLocation)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // ç›‘å¬å®æ—¶ä½ç½®æ›´æ–°</span><br><span class="line">        locationListener = object : LocationListener &#123;</span><br><span class="line">            override fun onLocationChanged(location: Location) &#123;</span><br><span class="line">                onLocationReceived(location)</span><br><span class="line">                removeLocationUpdates() // è·å–åˆ°ä½ç½®åç§»é™¤ç›‘å¬</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            override fun onStatusChanged(provider: String?, status: Int, extras: Bundle?) &#123;&#125;</span><br><span class="line">            override fun onProviderEnabled(provider: String) &#123;&#125;</span><br><span class="line">            override fun onProviderDisabled(provider: String) &#123;&#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // è¯·æ±‚ä½ç½®æ›´æ–°ï¼ˆä¼˜å…ˆä½¿ç”¨ GPSï¼Œç½‘ç»œä½œä¸ºå¤‡ç”¨ï¼‰</span><br><span class="line">        try &#123;</span><br><span class="line">            locationManager.requestLocationUpdates(</span><br><span class="line">                LocationManager.GPS_PROVIDER,</span><br><span class="line">                5000L, // 5ç§’æ›´æ–°ä¸€æ¬¡</span><br><span class="line">                10f,   // 10ç±³å˜åŒ–æ›´æ–°</span><br><span class="line">                locationListener!!</span><br><span class="line">            )</span><br><span class="line">        &#125; catch (e: Exception) &#123;</span><br><span class="line">            e.printStackTrace()</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        try &#123;</span><br><span class="line">            locationManager.requestLocationUpdates(</span><br><span class="line">                LocationManager.NETWORK_PROVIDER,</span><br><span class="line">                5000L,</span><br><span class="line">                10f,</span><br><span class="line">                locationListener!!</span><br><span class="line">            )</span><br><span class="line">        &#125; catch (e: Exception) &#123;</span><br><span class="line">            e.printStackTrace()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * ç§»é™¤ä½ç½®æ›´æ–°ç›‘å¬ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼</span><br><span class="line">     */</span><br><span class="line">    fun removeLocationUpdates() &#123;</span><br><span class="line">        locationListener?.let &#123;</span><br><span class="line">            locationManager.removeUpdates(it)</span><br><span class="line">            locationListener = null</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Kotlinè¯­æ³•</title>
      <link href="/2025/03/03/Kotlin%E8%AF%AD%E6%B3%95/"/>
      <url>/2025/03/03/Kotlin%E8%AF%AD%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h2 id="1-ä½œç”¨åŸŸå‡½æ•°"><a href="#1-ä½œç”¨åŸŸå‡½æ•°" class="headerlink" title="1. ä½œç”¨åŸŸå‡½æ•°"></a>1. ä½œç”¨åŸŸå‡½æ•°</h2><p>Kotlin æä¾›äº†ä¸€ç³»åˆ—ä½œç”¨åŸŸå‡½æ•°ï¼Œå®ƒä»¬å¯ä»¥è®©ä½ åœ¨å¯¹è±¡çš„ç‰¹å®šä½œç”¨åŸŸå†…æ‰§è¡Œä»£ç ï¼Œä»è€Œé¿å…é‡å¤å¼•ç”¨å¯¹è±¡ï¼ˆå¦‚ <code>this</code> æˆ– <code>it</code>ï¼‰ï¼Œæé«˜ä»£ç ç®€æ´æ€§ä¸å¯è¯»æ€§ã€‚</p><h3 id="1-1-apply-åœ¨å¯¹è±¡è‡ªèº«ä½œç”¨åŸŸå†…ä¿®æ”¹å¯¹è±¡"><a href="#1-1-apply-åœ¨å¯¹è±¡è‡ªèº«ä½œç”¨åŸŸå†…ä¿®æ”¹å¯¹è±¡" class="headerlink" title="1.1 apply - åœ¨å¯¹è±¡è‡ªèº«ä½œç”¨åŸŸå†…ä¿®æ”¹å¯¹è±¡"></a>1.1 apply - åœ¨å¯¹è±¡è‡ªèº«ä½œç”¨åŸŸå†…ä¿®æ”¹å¯¹è±¡</h3><ul><li><strong>è¿”å›å€¼</strong>ï¼šè°ƒç”¨è€…æœ¬èº«ï¼ˆthisï¼‰</li><li><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼š<ul><li>ç”¨äºåˆå§‹åŒ–å¯¹è±¡ï¼Œé¿å…å¤šæ¬¡è°ƒç”¨ set æ–¹æ³•</li><li>æ”¯æŒé“¾å¼è°ƒç”¨</li></ul></li></ul><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">class Person &#123;</span><br><span class="line">    var name: String = &quot;&quot;</span><br><span class="line">    var age: Int = 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">val person = Person().apply &#123;</span><br><span class="line">    name = &quot;Alice&quot;</span><br><span class="line">    age = 20</span><br><span class="line">&#125;</span><br><span class="line">println(person.name) // Alice</span><br><span class="line">println(person.age)  // 20</span><br></pre></td></tr></table></figure><p><strong>åˆ†æ</strong>ï¼š<br> åœ¨ <code>apply</code> çš„ä»£ç å—ä¸­ï¼Œ<code>this</code> ä»£è¡¨å½“å‰å¯¹è±¡ï¼Œé€šè¿‡ç›´æ¥ä¿®æ”¹å±æ€§ï¼Œæœ€åè¿”å›ä¿®æ”¹åçš„å¯¹è±¡æœ¬èº«ã€‚</p><hr><h3 id="1-2-let-é€‚ç”¨äºéç©ºå€¼çš„æ“ä½œ"><a href="#1-2-let-é€‚ç”¨äºéç©ºå€¼çš„æ“ä½œ" class="headerlink" title="1.2 let - é€‚ç”¨äºéç©ºå€¼çš„æ“ä½œ"></a>1.2 let - é€‚ç”¨äºéç©ºå€¼çš„æ“ä½œ</h3><ul><li><strong>è¿”å›å€¼</strong>ï¼šLambda è¡¨è¾¾å¼çš„æœ€åä¸€è¡Œç»“æœ</li><li><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼š<ul><li>é’ˆå¯¹å¯ç©ºå¯¹è±¡è¿›è¡Œæ“ä½œï¼Œé¿å… NullPointerException</li><li>æ§åˆ¶å˜é‡çš„ä½œç”¨åŸŸ</li></ul></li></ul><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">val name: String? = &quot;Kotlin&quot;</span><br><span class="line">name?.let &#123;</span><br><span class="line">    println(it.uppercase())  // KOTLIN</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¦ä¸€ç¤ºä¾‹ï¼ˆå˜é‡ä½œç”¨åŸŸæ§åˆ¶ï¼‰ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">val number = 5</span><br><span class="line">val square = number.let &#123;</span><br><span class="line">    val result = it * it</span><br><span class="line">    result</span><br><span class="line">&#125;</span><br><span class="line">println(square) // 25</span><br></pre></td></tr></table></figure><hr><h3 id="1-3-run-åœ¨å¯¹è±¡ä½œç”¨åŸŸå†…æ‰§è¡Œä»£ç å¹¶è¿”å›è®¡ç®—ç»“æœ"><a href="#1-3-run-åœ¨å¯¹è±¡ä½œç”¨åŸŸå†…æ‰§è¡Œä»£ç å¹¶è¿”å›è®¡ç®—ç»“æœ" class="headerlink" title="1.3 run - åœ¨å¯¹è±¡ä½œç”¨åŸŸå†…æ‰§è¡Œä»£ç å¹¶è¿”å›è®¡ç®—ç»“æœ"></a>1.3 run - åœ¨å¯¹è±¡ä½œç”¨åŸŸå†…æ‰§è¡Œä»£ç å¹¶è¿”å›è®¡ç®—ç»“æœ</h3><ul><li><strong>è¿”å›å€¼</strong>ï¼šLambda è¡¨è¾¾å¼çš„æœ€åä¸€è¡Œç»“æœ</li><li><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼š<ul><li>éœ€è¦åœ¨å¯¹è±¡ä¸Šæ‰§è¡Œå¤šä¸ªæ“ä½œå¹¶è¿”å›ä¸€ä¸ªç»“æœ</li></ul></li></ul><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">val personInfo = Person().run &#123;</span><br><span class="line">    name = &quot;Bob&quot;</span><br><span class="line">    age = 25</span><br><span class="line">    &quot;åå­—æ˜¯ $name, å¹´é¾„æ˜¯ $age&quot;</span><br><span class="line">&#125;</span><br><span class="line">println(personInfo)  // åå­—æ˜¯ Bob, å¹´é¾„æ˜¯ 25</span><br></pre></td></tr></table></figure><p><strong>åˆ†æ</strong>ï¼š<br> <code>run</code> åœ¨å¯¹è±¡ä½œç”¨åŸŸå†…æ‰§è¡Œæ“ä½œï¼Œè¿”å›æœ€åä¸€è¡Œè¡¨è¾¾å¼çš„ç»“æœï¼Œè€Œä¸æ˜¯å¯¹è±¡æœ¬èº«ã€‚</p><hr><h3 id="1-4-also-é€‚ç”¨äºå¯¹è±¡çš„é¢å¤–æ“ä½œ"><a href="#1-4-also-é€‚ç”¨äºå¯¹è±¡çš„é¢å¤–æ“ä½œ" class="headerlink" title="1.4 also - é€‚ç”¨äºå¯¹è±¡çš„é¢å¤–æ“ä½œ"></a>1.4 also - é€‚ç”¨äºå¯¹è±¡çš„é¢å¤–æ“ä½œ</h3><ul><li><strong>è¿”å›å€¼</strong>ï¼šè°ƒç”¨è€…æœ¬èº«ï¼ˆthisï¼‰</li><li><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼š<ul><li>è®°å½•æ—¥å¿—ã€è°ƒè¯•ç­‰é¢å¤–æ“ä½œï¼Œä¸æ”¹å˜å¯¹è±¡æœ¬èº«</li></ul></li></ul><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">val numbers = mutableListOf(1, 2, 3).also &#123;</span><br><span class="line">    println(&quot;åŸå§‹åˆ—è¡¨: $it&quot;) // è¾“å‡ºï¼šåŸå§‹åˆ—è¡¨: [1, 2, 3]</span><br><span class="line">&#125;.apply &#123;</span><br><span class="line">    add(4)</span><br><span class="line">&#125;</span><br><span class="line">println(numbers) // è¾“å‡ºï¼š[1, 2, 3, 4]</span><br></pre></td></tr></table></figure><p><strong>åˆ†æ</strong>ï¼š<br> <code>also</code> ç”¨äºæ‰§è¡Œå‰¯ä½œç”¨ï¼ˆå¦‚æ—¥å¿—æ‰“å°ï¼‰ï¼Œè¿”å›åŸå¯¹è±¡ï¼Œè€Œåç»­çš„ <code>apply</code> åˆ™å¯¹å¯¹è±¡è¿›è¡Œä¿®æ”¹ã€‚</p><hr><h3 id="1-5-with-ç”¨äºéæ‰©å±•å¯¹è±¡çš„ä½œç”¨åŸŸè°ƒç”¨"><a href="#1-5-with-ç”¨äºéæ‰©å±•å¯¹è±¡çš„ä½œç”¨åŸŸè°ƒç”¨" class="headerlink" title="1.5 with - ç”¨äºéæ‰©å±•å¯¹è±¡çš„ä½œç”¨åŸŸè°ƒç”¨"></a>1.5 with - ç”¨äºéæ‰©å±•å¯¹è±¡çš„ä½œç”¨åŸŸè°ƒç”¨</h3><ul><li><strong>è¿”å›å€¼</strong>ï¼šLambda è¡¨è¾¾å¼çš„æœ€åä¸€è¡Œç»“æœ</li><li><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼š<ul><li>å¯¹éæ‰©å±•å¯¹è±¡æ‰§è¡Œä¸€ç³»åˆ—æ“ä½œï¼Œå¹¶è¿”å›è®¡ç®—ç»“æœ</li></ul></li></ul><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">val person = Person()</span><br><span class="line">val result = with(person) &#123;</span><br><span class="line">    name = &quot;Charlie&quot;</span><br><span class="line">    age = 30</span><br><span class="line">    &quot;åå­—: $name, å¹´é¾„: $age&quot;</span><br><span class="line">&#125;</span><br><span class="line">println(result)  // è¾“å‡ºï¼šåå­—: Charlie, å¹´é¾„: 30</span><br></pre></td></tr></table></figure><hr><h3 id="1-6-ä½œç”¨åŸŸå‡½æ•°å¯¹æ¯”æ€»ç»“"><a href="#1-6-ä½œç”¨åŸŸå‡½æ•°å¯¹æ¯”æ€»ç»“" class="headerlink" title="1.6 ä½œç”¨åŸŸå‡½æ•°å¯¹æ¯”æ€»ç»“"></a>1.6 ä½œç”¨åŸŸå‡½æ•°å¯¹æ¯”æ€»ç»“</h3><table><thead><tr><th>å‡½æ•°</th><th>ä½¿ç”¨åœºæ™¯</th><th>ä½œç”¨åŸŸå†…å¯¹è±¡å¼•ç”¨</th><th>è¿”å›å€¼</th></tr></thead><tbody><tr><td><strong>apply</strong></td><td>ä¿®æ”¹å¯¹è±¡æœ¬èº«</td><td><code>this</code></td><td>å¯¹è±¡æœ¬èº«</td></tr><tr><td><strong>let</strong></td><td>é’ˆå¯¹å¯ç©ºå¯¹è±¡æˆ–å±€éƒ¨å˜é‡</td><td><code>it</code></td><td>Lambda æœ€åä¸€è¡Œç»“æœ</td></tr><tr><td><strong>run</strong></td><td>æ‰§è¡Œæ“ä½œå¹¶è¿”å›è®¡ç®—ç»“æœ</td><td><code>this</code></td><td>Lambda æœ€åä¸€è¡Œç»“æœ</td></tr><tr><td><strong>also</strong></td><td>æ‰§è¡Œé¢å¤–æ“ä½œï¼ˆæ—¥å¿—ã€è°ƒè¯•ç­‰ï¼‰</td><td><code>it</code></td><td>å¯¹è±¡æœ¬èº«</td></tr><tr><td><strong>with</strong></td><td>å¯¹æ™®é€šå¯¹è±¡æ‰§è¡Œæ“ä½œå¹¶è¿”å›ç»“æœ</td><td><code>this</code></td><td>Lambda æœ€åä¸€è¡Œç»“æœ</td></tr></tbody></table><p><strong>æœ€ä½³å®è·µæç¤ºï¼š</strong></p><ul><li>ä¿®æ”¹å¯¹è±¡å¹¶è¿”å›å¯¹è±¡æœ¬èº«æ—¶ï¼Œé€‰æ‹© <code>apply</code></li><li>é’ˆå¯¹å¯ç©ºå¯¹è±¡æ“ä½œæ—¶ï¼Œé€‰æ‹© <code>let</code></li><li>éœ€è¦è¿”å›è®¡ç®—ç»“æœæ—¶ï¼Œé€‰æ‹© <code>run</code> æˆ– <code>with</code></li><li>ä»…æ‰§è¡Œå‰¯ä½œç”¨æ“ä½œæ—¶ï¼Œé€‰æ‹© <code>also</code></li></ul><hr><h2 id="2-æ—¶é—´è¾“å‡º"><a href="#2-æ—¶é—´è¾“å‡º" class="headerlink" title="2. æ—¶é—´è¾“å‡º"></a>2. æ—¶é—´è¾“å‡º</h2><p>ä¸‹é¢çš„ä»£ç å±•ç¤ºäº†å¦‚ä½•åœ¨ Kotlin ä¸­è·å–å½“å‰æ—¶é—´ã€æ ¼å¼åŒ–æ—¶é—´ã€è§£æå­—ç¬¦ä¸²ä¸ºæ—¥æœŸï¼Œä»¥åŠé€šè¿‡ Calendar è·å–æ—¶é—´ç»„ä»¶ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">package com.example.diary_final</span><br><span class="line">import java.text.SimpleDateFormat</span><br><span class="line">import java.util.Calendar</span><br><span class="line">import java.util.Date</span><br><span class="line">import java.util.Locale</span><br><span class="line"></span><br><span class="line">fun main() &#123;</span><br><span class="line">    // è·å–å½“å‰æ—¶é—´ï¼Œå¹¶æ ¼å¼åŒ–ä¸ºå­—ç¬¦ä¸²</span><br><span class="line">    val date = Date() // å½“å‰æ—¶é—´</span><br><span class="line">    val sdf = SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;, Locale.getDefault())</span><br><span class="line">    val formattedDate = sdf.format(date)</span><br><span class="line">    println(formattedDate)  // è¾“å‡ºæ ¼å¼åŒ–æ—¥æœŸï¼Œä¾‹å¦‚ï¼š2025-03-15 14:08:23</span><br><span class="line">    </span><br><span class="line">    // å°†å­—ç¬¦ä¸²è§£æä¸º Date ç±»å‹</span><br><span class="line">    val dateString = &quot;2025-03-09 14:45:30&quot;</span><br><span class="line">    val sdfp = SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;, Locale.getDefault())</span><br><span class="line">    val datep = sdfp.parse(dateString)</span><br><span class="line">    println(datep)  // è¾“å‡º: Sun Mar 09 14:45:30 GMT 2025</span><br><span class="line">    </span><br><span class="line">    // ä½¿ç”¨ Calendar è·å–å½“å‰æ—¶é—´çš„æ—¶ã€åˆ†ã€ç§’</span><br><span class="line">    val calendar = Calendar.getInstance()</span><br><span class="line">    val hour = calendar.get(Calendar.HOUR_OF_DAY)</span><br><span class="line">    val minute = calendar.get(Calendar.MINUTE)</span><br><span class="line">    val second = calendar.get(Calendar.SECOND)</span><br><span class="line">    println(&quot;å½“å‰æ—¶é—´: $hour:$minute:$second&quot;)</span><br><span class="line">    </span><br><span class="line">    // æ ¼å¼åŒ–è¾“å‡ºæ—¶é—´ï¼ˆ24å°æ—¶åˆ¶ï¼‰</span><br><span class="line">    val formattedTime = String.format(&quot;%02d:%02d:%02d&quot;, hour, minute, second)</span><br><span class="line">    println(&quot;å½“å‰æ—¶é—´: $formattedTime&quot;)</span><br><span class="line">    println(&quot;å½“å‰æ—¶é—´: $&#123;String.format(&quot;%02d:%02d:%02d&quot;, hour, minute, second)&#125;&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¯´æ˜ï¼š</strong></p><ul><li>ä½¿ç”¨ <code>SimpleDateFormat</code> æ ¼å¼åŒ–å’Œè§£ææ—¥æœŸ</li><li><code>Calendar</code> ç”¨äºæå–å½“å‰æ—¶é—´çš„å„ä¸ªå­—æ®µ</li></ul><hr><h2 id="3-å›è°ƒæœºåˆ¶"><a href="#3-å›è°ƒæœºåˆ¶" class="headerlink" title="3. å›è°ƒæœºåˆ¶"></a>3. å›è°ƒæœºåˆ¶</h2><h3 id="3-1-ä»€ä¹ˆæ˜¯å›è°ƒï¼Ÿ"><a href="#3-1-ä»€ä¹ˆæ˜¯å›è°ƒï¼Ÿ" class="headerlink" title="3.1 ä»€ä¹ˆæ˜¯å›è°ƒï¼Ÿ"></a>3.1 ä»€ä¹ˆæ˜¯å›è°ƒï¼Ÿ</h3><p>å›è°ƒç±»ä¼¼äºâ€œä»»åŠ¡å®Œæˆåé€šçŸ¥æˆ‘â€ã€‚ä¾‹å¦‚ï¼Œè®©æœ‹å‹å»ä¹°å’–å•¡ï¼Œä¹°å®Œåæ‰“ç”µè¯å‘Šè¯‰ä½ ã€‚åœ¨ç¼–ç¨‹ä¸­ï¼Œå›è°ƒæŒ‡çš„æ˜¯ä»»åŠ¡å®Œæˆåè‡ªåŠ¨è°ƒç”¨çš„å‡½æ•°ã€‚</p><h3 id="3-2-ç¤ºä¾‹ï¼šä¸ä½¿ç”¨å›è°ƒï¼ˆåŒæ­¥ç­‰å¾…ï¼‰"><a href="#3-2-ç¤ºä¾‹ï¼šä¸ä½¿ç”¨å›è°ƒï¼ˆåŒæ­¥ç­‰å¾…ï¼‰" class="headerlink" title="3.2 ç¤ºä¾‹ï¼šä¸ä½¿ç”¨å›è°ƒï¼ˆåŒæ­¥ç­‰å¾…ï¼‰"></a>3.2 ç¤ºä¾‹ï¼šä¸ä½¿ç”¨å›è°ƒï¼ˆåŒæ­¥ç­‰å¾…ï¼‰</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">fun buyGroceries() &#123;</span><br><span class="line">    Thread.sleep(2000) // æ¨¡æ‹Ÿä¹°ä¸œè¥¿è€—æ—¶2ç§’</span><br><span class="line">    println(&quot;ä¹°å®Œäº†ï¼&quot;) // ä¹°å®Œåé€šçŸ¥</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun main() &#123;</span><br><span class="line">    println(&quot;è¯·å¸®æˆ‘å»ä¹°ä¸œè¥¿...&quot;)</span><br><span class="line">    buyGroceries()</span><br><span class="line">    println(&quot;æˆ‘æ”¶åˆ°é€šçŸ¥äº†&quot;) // ç­‰å¾…ä»»åŠ¡å®Œæˆåæ‰§è¡Œ</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>é—®é¢˜</strong>ï¼šä¸»çº¿ç¨‹ä¼šè¢«é˜»å¡ï¼Œæ— æ³•åŒæ—¶å¤„ç†å…¶ä»–ä»»åŠ¡ã€‚</p><hr><h3 id="3-3-ç¤ºä¾‹ï¼šä½¿ç”¨å›è°ƒï¼ˆå¼‚æ­¥é€šçŸ¥ï¼‰"><a href="#3-3-ç¤ºä¾‹ï¼šä½¿ç”¨å›è°ƒï¼ˆå¼‚æ­¥é€šçŸ¥ï¼‰" class="headerlink" title="3.3 ç¤ºä¾‹ï¼šä½¿ç”¨å›è°ƒï¼ˆå¼‚æ­¥é€šçŸ¥ï¼‰"></a>3.3 ç¤ºä¾‹ï¼šä½¿ç”¨å›è°ƒï¼ˆå¼‚æ­¥é€šçŸ¥ï¼‰</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">fun buyGroceries(callback: () -&gt; Unit) &#123;</span><br><span class="line">    Thread &#123;</span><br><span class="line">        Thread.sleep(2000) // æ¨¡æ‹Ÿä¹°ä¸œè¥¿è€—æ—¶2ç§’</span><br><span class="line">        println(&quot;ä¹°å®Œäº†ï¼&quot;)</span><br><span class="line">        callback() // ä»»åŠ¡å®Œæˆåæ‰§è¡Œå›è°ƒ</span><br><span class="line">    &#125;.start()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun main() &#123;</span><br><span class="line">    println(&quot;è¯·å¸®æˆ‘å»ä¹°ä¸œè¥¿...&quot;)</span><br><span class="line">    buyGroceries &#123;</span><br><span class="line">        println(&quot;æˆ‘æ”¶åˆ°é€šçŸ¥äº†ï¼&quot;) // ä»»åŠ¡å®Œæˆåè°ƒç”¨å›è°ƒ</span><br><span class="line">    &#125;</span><br><span class="line">    println(&quot;æˆ‘å¯ä»¥åšåˆ«çš„äº‹æƒ…ï¼Œä¸ç”¨ç­‰&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>åˆ†æ</strong>ï¼š<br> ä½¿ç”¨å›è°ƒåï¼Œä»»åŠ¡åœ¨åå°æ‰§è¡Œï¼Œä¸»çº¿ç¨‹å¯ç»§ç»­æ‰§è¡Œå…¶ä»–æ“ä½œï¼Œå¾…ä»»åŠ¡å®Œæˆåè‡ªåŠ¨è°ƒç”¨å›è°ƒå‡½æ•°ã€‚</p><hr><h3 id="3-4-å›è°ƒåœ¨-Android-å¼€å‘ä¸­çš„åº”ç”¨"><a href="#3-4-å›è°ƒåœ¨-Android-å¼€å‘ä¸­çš„åº”ç”¨" class="headerlink" title="3.4 å›è°ƒåœ¨ Android å¼€å‘ä¸­çš„åº”ç”¨"></a>3.4 å›è°ƒåœ¨ Android å¼€å‘ä¸­çš„åº”ç”¨</h3><ul><li><p><strong>æŒ‰é’®ç‚¹å‡»äº‹ä»¶ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">button.setOnClickListener &#123;</span><br><span class="line">    println(&quot;æŒ‰é’®è¢«ç‚¹å‡»äº†ï¼&quot;) // æŒ‰é’®ç‚¹å‡»åçš„å›è°ƒ</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>ç½‘ç»œè¯·æ±‚ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">fun fetchData(callback: (String) -&gt; Unit) &#123;</span><br><span class="line">    Thread &#123;</span><br><span class="line">        Thread.sleep(2000) // æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚è€—æ—¶</span><br><span class="line">        callback(&quot;æ•°æ®åŠ è½½æˆåŠŸäº†å“ˆå“ˆå“ˆï¼&quot;)</span><br><span class="line">    &#125;.start()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun main() &#123;</span><br><span class="line">    println(&quot;å¼€å§‹è¯·æ±‚æ•°æ®...&quot;)</span><br><span class="line">    fetchData &#123; result -&gt;</span><br><span class="line">        println(result) // æ•°æ®è¿”å›åçš„å›è°ƒ</span><br><span class="line">    &#125;</span><br><span class="line">    println(&quot;è¯·æ±‚å·²ç»å‘é€ï¼Œæˆ‘å…ˆåšåˆ«çš„äº‹æƒ…&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><hr><h2 id="4-Lambda-è¡¨è¾¾å¼"><a href="#4-Lambda-è¡¨è¾¾å¼" class="headerlink" title="4. Lambda è¡¨è¾¾å¼"></a>4. Lambda è¡¨è¾¾å¼</h2><h3 id="4-1-ä»€ä¹ˆæ˜¯-Lambda-è¡¨è¾¾å¼ï¼Ÿ"><a href="#4-1-ä»€ä¹ˆæ˜¯-Lambda-è¡¨è¾¾å¼ï¼Ÿ" class="headerlink" title="4.1 ä»€ä¹ˆæ˜¯ Lambda è¡¨è¾¾å¼ï¼Ÿ"></a>4.1 ä»€ä¹ˆæ˜¯ Lambda è¡¨è¾¾å¼ï¼Ÿ</h3><p>Lambda è¡¨è¾¾å¼æ˜¯åŒ¿åå‡½æ•°çš„ä¸€ç§å†™æ³•ï¼Œç”¨äºç®€åŒ–ä»£ç ã€‚å…¶åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; å‚æ•° -&gt; è¡¨è¾¾å¼ &#125;</span><br></pre></td></tr></table></figure><h3 id="4-2-ç¤ºä¾‹ï¼šåŸºæœ¬ç”¨æ³•"><a href="#4-2-ç¤ºä¾‹ï¼šåŸºæœ¬ç”¨æ³•" class="headerlink" title="4.2 ç¤ºä¾‹ï¼šåŸºæœ¬ç”¨æ³•"></a>4.2 ç¤ºä¾‹ï¼šåŸºæœ¬ç”¨æ³•</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// å®šä¹‰ä¸€ä¸ª Lambda è¡¨è¾¾å¼ï¼Œæ¥å—ä¸¤ä¸ª Int å‚æ•°å¹¶è¿”å›å®ƒä»¬çš„å’Œ</span><br><span class="line">val add: (Int, Int) -&gt; Int = &#123; a, b -&gt; a + b &#125;</span><br><span class="line">println(add(2, 3))  // è¾“å‡ºï¼š5</span><br></pre></td></tr></table></figure><h3 id="4-3-Lambda-åœ¨é«˜é˜¶å‡½æ•°ä¸­çš„åº”ç”¨"><a href="#4-3-Lambda-åœ¨é«˜é˜¶å‡½æ•°ä¸­çš„åº”ç”¨" class="headerlink" title="4.3 Lambda åœ¨é«˜é˜¶å‡½æ•°ä¸­çš„åº”ç”¨"></a>4.3 Lambda åœ¨é«˜é˜¶å‡½æ•°ä¸­çš„åº”ç”¨</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// å®šä¹‰ä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼Œæ¥å—ä¸€ä¸ªæ“ä½œå‡½æ•°ä½œä¸ºå‚æ•°</span><br><span class="line">fun calculate(a: Int, b: Int, operation: (Int, Int) -&gt; Int): Int &#123;</span><br><span class="line">    return operation(a, b)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun main() &#123;</span><br><span class="line">    // ä½¿ç”¨å°¾éš Lambda è¯­æ³•</span><br><span class="line">    val result = calculate(10, 5) &#123; x, y -&gt; x + y &#125;</span><br><span class="line">    println(result)  // è¾“å‡ºï¼š15</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-4-å•å‚æ•°-Lambda-ç¤ºä¾‹"><a href="#4-4-å•å‚æ•°-Lambda-ç¤ºä¾‹" class="headerlink" title="4.4 å•å‚æ•° Lambda ç¤ºä¾‹"></a>4.4 å•å‚æ•° Lambda ç¤ºä¾‹</h3><p>å½“ Lambda åªæœ‰ä¸€ä¸ªå‚æ•°æ—¶ï¼Œå¯ä»¥ä½¿ç”¨é»˜è®¤å˜é‡ <code>it</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">val numbers = listOf(1, 2, 3, 4)</span><br><span class="line">val doubled = numbers.map &#123; it * 2 &#125;</span><br><span class="line">println(doubled)  // è¾“å‡ºï¼š[2, 4, 6, 8]</span><br></pre></td></tr></table></figure><hr><h2 id="5-æ³›å‹ä¸å§”æ‰˜"><a href="#5-æ³›å‹ä¸å§”æ‰˜" class="headerlink" title="5. æ³›å‹ä¸å§”æ‰˜"></a>5. æ³›å‹ä¸å§”æ‰˜</h2><h3 id="5-1-æ³›å‹"><a href="#5-1-æ³›å‹" class="headerlink" title="5.1 æ³›å‹"></a>5.1 æ³›å‹</h3><p>æ³›å‹å…è®¸ä½ ç¼–å†™é€‚ç”¨äºä»»æ„æ•°æ®ç±»å‹çš„é€šç”¨ä»£ç ï¼Œä»è€Œæé«˜ä»£ç å¤ç”¨æ€§å’Œç±»å‹å®‰å…¨æ€§ã€‚</p><h4 id="5-1-1-æ³›å‹ç±»ç¤ºä¾‹"><a href="#5-1-1-æ³›å‹ç±»ç¤ºä¾‹" class="headerlink" title="5.1.1 æ³›å‹ç±»ç¤ºä¾‹"></a>5.1.1 æ³›å‹ç±»ç¤ºä¾‹</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// å®šä¹‰ä¸€ä¸ªæ³›å‹ç±» Boxï¼Œå¯ä»¥å­˜æ”¾ä»»æ„ç±»å‹çš„æ•°æ®</span><br><span class="line">class Box&lt;T&gt;(var value: T)</span><br><span class="line"></span><br><span class="line">fun main() &#123;</span><br><span class="line">    val intBox = Box(123)      // T è¢«æ¨æ–­ä¸º Int</span><br><span class="line">    val strBox = Box(&quot;Hello&quot;)  // T è¢«æ¨æ–­ä¸º String</span><br><span class="line">    println(intBox.value)      // è¾“å‡ºï¼š123</span><br><span class="line">    println(strBox.value)      // è¾“å‡ºï¼šHello</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="5-1-2-æ³›å‹å‡½æ•°ç¤ºä¾‹"><a href="#5-1-2-æ³›å‹å‡½æ•°ç¤ºä¾‹" class="headerlink" title="5.1.2 æ³›å‹å‡½æ•°ç¤ºä¾‹"></a>5.1.2 æ³›å‹å‡½æ•°ç¤ºä¾‹</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// å®šä¹‰ä¸€ä¸ªæ³›å‹å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªåªåŒ…å«ä¸€ä¸ªå…ƒç´ çš„åˆ—è¡¨</span><br><span class="line">fun &lt;T&gt; singletonList(item: T): List&lt;T&gt; &#123;</span><br><span class="line">    return listOf(item)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun main() &#123;</span><br><span class="line">    val numbers = singletonList(42)      // T è¢«æ¨æ–­ä¸º Int</span><br><span class="line">    val words = singletonList(&quot;Kotlin&quot;)    // T è¢«æ¨æ–­ä¸º String</span><br><span class="line">    println(numbers) // è¾“å‡ºï¼š[42]</span><br><span class="line">    println(words)   // è¾“å‡ºï¼š[Kotlin]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="5-1-3-ç±»å‹å‚æ•°çš„é™å®š"><a href="#5-1-3-ç±»å‹å‚æ•°çš„é™å®š" class="headerlink" title="5.1.3 ç±»å‹å‚æ•°çš„é™å®š"></a>5.1.3 ç±»å‹å‚æ•°çš„é™å®š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// æ³›å‹ T é™åˆ¶ä¸º Number æˆ–å…¶å­ç±»</span><br><span class="line">fun &lt;T : Number&gt; add(a: T, b: T): Double &#123;</span><br><span class="line">    return a.toDouble() + b.toDouble()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun main() &#123;</span><br><span class="line">    println(add(10, 20))      // è¾“å‡ºï¼š30.0</span><br><span class="line">    // println(add(&quot;a&quot;, &quot;b&quot;)) // é”™è¯¯ï¼ŒString ä¸æ˜¯ Number çš„å­ç±»</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="5-1-4-åå˜ä¸é€†å˜"><a href="#5-1-4-åå˜ä¸é€†å˜" class="headerlink" title="5.1.4 åå˜ä¸é€†å˜"></a>5.1.4 åå˜ä¸é€†å˜</h4><h4 id="æ„Ÿè§‰ä¸å¦‚ä¹¦ä¸ŠP418è®²å¾—å¥½"><a href="#æ„Ÿè§‰ä¸å¦‚ä¹¦ä¸ŠP418è®²å¾—å¥½" class="headerlink" title="(æ„Ÿè§‰ä¸å¦‚ä¹¦ä¸ŠP418è®²å¾—å¥½)"></a>(æ„Ÿè§‰ä¸å¦‚ä¹¦ä¸ŠP418è®²å¾—å¥½)</h4><p><strong>1. ä»€ä¹ˆæ˜¯åå˜å’Œé€†å˜ï¼Ÿ</strong></p><p>å®ƒä»¬è§£å†³çš„æ˜¯<strong>æ³›å‹çš„å­ç±»å‹å…³ç³»</strong>ï¼Œä¹Ÿå°±æ˜¯<strong>æ³›å‹ç±» <code>A&lt;T&gt;</code> å’Œ <code>A&lt;U&gt;</code> ä¹‹é—´æ˜¯å¦å¯ä»¥äº’ç›¸èµ‹å€¼</strong>ã€‚</p><p>å…ˆçœ‹æ™®é€šçš„å­ç±»å‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">kotlinå¤åˆ¶ç¼–è¾‘open class Parent</span><br><span class="line">class Child : Parent()</span><br><span class="line"></span><br><span class="line">val parent: Parent = Child() // âœ… å­ç±»å¯ä»¥èµ‹å€¼ç»™çˆ¶ç±»</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ²¡é—®é¢˜ï¼Œ<code>Child</code> æ˜¯ <code>Parent</code> çš„å­ç±»ã€‚ä½†å¦‚æœæ˜¯<strong>æ³›å‹</strong>å‘¢ï¼Ÿ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">val childList: List&lt;Child&gt; = listOf(Child())</span><br><span class="line">// val parentList: List&lt;Parent&gt; = childList // âŒ æŠ¥é”™ï¼</span><br></pre></td></tr></table></figure><p>Kotlin <strong>ä¸å…è®¸</strong> <code>List&lt;Child&gt;</code> èµ‹å€¼ç»™ <code>List&lt;Parent&gt;</code>ï¼Œå› ä¸ºæ³›å‹é»˜è®¤æ˜¯**ä¸å˜ï¼ˆInvariantï¼‰**çš„ï¼Œå³ <code>List&lt;Child&gt;</code> å’Œ <code>List&lt;Parent&gt;</code> æ²¡æœ‰ä»»ä½•ç»§æ‰¿å…³ç³»ã€‚</p><hr><h5 id="åå˜ï¼ˆCovarianceï¼‰â€”â€”-out-T"><a href="#åå˜ï¼ˆCovarianceï¼‰â€”â€”-out-T" class="headerlink" title="åå˜ï¼ˆCovarianceï¼‰â€”â€” out T"></a><strong>åå˜ï¼ˆCovarianceï¼‰â€”â€” <code>out T</code></strong></h5><p> <strong>è®© <code>List&lt;Child&gt;</code> èµ‹å€¼ç»™ <code>List&lt;Parent&gt;</code></strong></p><p>å¦‚æœæˆ‘ä»¬æƒ³è®© <code>List&lt;Child&gt;</code> èµ‹å€¼ç»™ <code>List&lt;Parent&gt;</code>ï¼Œå°±è¦ç”¨<strong>åå˜</strong>ï¼ˆ<code>out</code> å…³é”®å­—ï¼‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> interface Producer&lt;out T&gt; &#123; // T åªèƒ½â€œç”Ÿäº§â€ï¼Œä¸èƒ½â€œæ¶ˆè´¹â€</span><br><span class="line">    fun produce(): T</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">val childProducer: Producer&lt;Child&gt; = object : Producer&lt;Child&gt; &#123;</span><br><span class="line">    override fun produce(): Child = Child()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// âœ… å¯ä»¥æŠŠ Producer&lt;Child&gt; èµ‹å€¼ç»™ Producer&lt;Parent&gt;</span><br><span class="line">val parentProducer: Producer&lt;Parent&gt; = childProducer</span><br></pre></td></tr></table></figure><p> <strong>ä¸ºä»€ä¹ˆ <code>out</code> åªå…è®¸è¯»å–ï¼ˆç”Ÿäº§ï¼‰ï¼Ÿ</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">interface Producer&lt;out T&gt; &#123;</span><br><span class="line">    fun produce(): T // âœ… åªèƒ½æä¾› T</span><br><span class="line">    // fun consume(item: T) // âŒ é”™è¯¯ï¼Œä¸èƒ½æ¥æ”¶ T</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>out T</code> <strong>åªèƒ½ä½œä¸ºè¿”å›å€¼ï¼ˆç”Ÿäº§è€…ï¼‰</strong>ï¼Œä¸èƒ½ä½œä¸ºå‚æ•°ï¼ˆæ¶ˆè´¹è€…ï¼‰ã€‚</li><li>å› ä¸º <code>Producer&lt;Child&gt;</code> èµ‹å€¼ç»™ <code>Producer&lt;Parent&gt;</code> åï¼Œå¦‚æœå…è®¸ <code>consume(item: T)</code>ï¼Œé‚£å°±å¯èƒ½å¾€ <code>Producer&lt;Child&gt;</code> é‡Œé¢æ”¾ <code>Parent</code>ï¼Œå¯¼è‡´ç±»å‹é”™è¯¯ã€‚</li></ul><p> <strong>ç¤ºä¾‹ï¼šç”Ÿäº§è€…</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">class Book</span><br><span class="line">class ScienceBook : Book()</span><br><span class="line"></span><br><span class="line">fun getScienceBooks(): List&lt;ScienceBook&gt; &#123;</span><br><span class="line">    return listOf(ScienceBook())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// âœ… ä½¿ç”¨ `out T` è®©å­ç±»æ³›å‹å¯ä»¥èµ‹å€¼ç»™çˆ¶ç±»æ³›å‹</span><br><span class="line">fun readBooks(books: List&lt;out Book&gt;) &#123;</span><br><span class="line">    for (book in books) &#123;</span><br><span class="line">        println(book)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">val scienceBooks = getScienceBooks()</span><br><span class="line">readBooks(scienceBooks) // âœ… OKï¼Œå› ä¸º List&lt;ScienceBook&gt; å¯ä»¥èµ‹å€¼ç»™ List&lt;out Book&gt;</span><br></pre></td></tr></table></figure><p><strong>å£è¯€ï¼š</strong></p><blockquote><p><strong>Producer Outï¼ˆç”Ÿäº§è€…ç”¨ <code>out</code>ï¼Œåªèƒ½è¯»ï¼Œä¸èƒ½å†™ï¼‰</strong></p></blockquote><hr><h5 id="é€†å˜ï¼ˆContravarianceï¼‰â€”â€”-in-T"><a href="#é€†å˜ï¼ˆContravarianceï¼‰â€”â€”-in-T" class="headerlink" title="é€†å˜ï¼ˆContravarianceï¼‰â€”â€” in T"></a><strong>é€†å˜ï¼ˆContravarianceï¼‰â€”â€” <code>in T</code></strong></h5><p> <strong>è®© <code>Consumer&lt;Parent&gt;</code> èµ‹å€¼ç»™ <code>Consumer&lt;Child&gt;</code></strong></p><p>å¦‚æœæˆ‘ä»¬æƒ³è®© <code>Consumer&lt;Parent&gt;</code> èµ‹å€¼ç»™ <code>Consumer&lt;Child&gt;</code>ï¼Œå°±è¦ç”¨<strong>é€†å˜</strong>ï¼ˆ<code>in</code> å…³é”®å­—ï¼‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">interface Consumer&lt;in T&gt; &#123; // T åªèƒ½â€œæ¶ˆè´¹â€ï¼Œä¸èƒ½â€œç”Ÿäº§â€</span><br><span class="line">    fun consume(item: T)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">val parentConsumer: Consumer&lt;Parent&gt; = object : Consumer&lt;Parent&gt; &#123;</span><br><span class="line">    override fun consume(item: Parent) &#123;</span><br><span class="line">        println(&quot;Consumed a Parent&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// âœ… å¯ä»¥æŠŠ Consumer&lt;Parent&gt; èµ‹å€¼ç»™ Consumer&lt;Child&gt;</span><br><span class="line">val childConsumer: Consumer&lt;Child&gt; = parentConsumer</span><br></pre></td></tr></table></figure><p> <strong>ä¸ºä»€ä¹ˆ <code>in</code> åªå…è®¸å†™å…¥ï¼ˆæ¶ˆè´¹ï¼‰ï¼Ÿ</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">interface Consumer&lt;in T&gt; &#123;</span><br><span class="line">    fun consume(item: T) // âœ… åªèƒ½æ¶ˆè´¹ T</span><br><span class="line">    // fun produce(): T // âŒ é”™è¯¯ï¼Œä¸èƒ½è¿”å› T</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>in T</code> <strong>åªèƒ½ä½œä¸ºå‚æ•°ï¼ˆæ¶ˆè´¹è€…ï¼‰</strong>ï¼Œä¸èƒ½ä½œä¸ºè¿”å›å€¼ï¼ˆç”Ÿäº§è€…ï¼‰ã€‚</li><li>å› ä¸º <code>Consumer&lt;Parent&gt;</code> èµ‹å€¼ç»™ <code>Consumer&lt;Child&gt;</code> åï¼Œå¦‚æœå…è®¸ <code>produce()</code>ï¼Œå°±å¯èƒ½è¿”å› <code>Parent</code>ï¼Œä½† <code>Consumer&lt;Child&gt;</code> åªèƒ½å¤„ç† <code>Child</code>ï¼Œå¯¼è‡´ç±»å‹é”™è¯¯ã€‚</li></ul><p> <strong>ç¤ºä¾‹ï¼šæ¶ˆè´¹è€…</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">class Animal</span><br><span class="line">class Dog : Animal()</span><br><span class="line"></span><br><span class="line">fun trainDogs(trainers: MutableList&lt;in Dog&gt;) &#123;</span><br><span class="line">    trainers.add(Dog()) // âœ… å¯ä»¥æ·»åŠ  Dog</span><br><span class="line">    // val dog: Dog = trainers[0] // âŒ ä¸èƒ½å®‰å…¨åœ°è¯»å–</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">val animals = mutableListOf&lt;Animal&gt;()</span><br><span class="line">trainDogs(animals) // âœ… OKï¼Œå› ä¸º `MutableList&lt;in Dog&gt;` å…è®¸ `MutableList&lt;Animal&gt;` ä½œä¸ºå‚æ•°</span><br></pre></td></tr></table></figure><p><strong>å£è¯€ï¼š</strong></p><blockquote><p><strong>Consumer Inï¼ˆæ¶ˆè´¹è€…ç”¨ <code>in</code>ï¼Œåªèƒ½å†™ï¼Œä¸èƒ½è¯»ï¼‰</strong></p></blockquote><hr><h5 id="è®°ä½è¿™ä¸¤ä¸ªåŸåˆ™"><a href="#è®°ä½è¿™ä¸¤ä¸ªåŸåˆ™" class="headerlink" title="è®°ä½è¿™ä¸¤ä¸ªåŸåˆ™"></a><strong>è®°ä½è¿™ä¸¤ä¸ªåŸåˆ™</strong></h5><table><thead><tr><th>æ³›å‹ç±»å‹</th><th>å…³é”®å­—</th><th>è¯»å–</th><th>å†™å…¥</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>åå˜</strong></td><td><code>out T</code></td><td>âœ… å…è®¸</td><td>âŒ ç¦æ­¢</td><td><strong>ç”Ÿäº§è€…</strong>ï¼ˆåªè¯»ï¼‰</td></tr><tr><td><strong>é€†å˜</strong></td><td><code>in T</code></td><td>âŒ åªèƒ½ç”¨ <code>Any?</code> è¯»å–</td><td>âœ… å…è®¸</td><td><strong>æ¶ˆè´¹è€…</strong>ï¼ˆåªå†™ï¼‰</td></tr></tbody></table><p> <strong>æœ€ç®€å•çš„è®°å¿†å£è¯€</strong></p><ul><li><strong>â€œç”Ÿäº§è€…ç”¨ outâ€</strong>ï¼ˆProducer Outï¼‰ â†’ åªèƒ½è¯»ï¼Œä¸èƒ½å†™ã€‚</li><li><strong>â€œæ¶ˆè´¹è€…ç”¨ inâ€</strong>ï¼ˆConsumer Inï¼‰ â†’ åªèƒ½å†™ï¼Œä¸èƒ½å®‰å…¨åœ°è¯»ã€‚</li></ul><hr><h5 id="ç”Ÿæ´»ä¸­çš„ä¾‹å­"><a href="#ç”Ÿæ´»ä¸­çš„ä¾‹å­" class="headerlink" title="ç”Ÿæ´»ä¸­çš„ä¾‹å­"></a><strong>ç”Ÿæ´»ä¸­çš„ä¾‹å­</strong></h5><p> <strong>ğŸ”µ åå˜ï¼ˆ<code>out</code>ï¼‰ï¼šåªè¯»ï¼Œä¸å†™</strong></p><p>å‡è®¾ä½ å»<strong>çœ‹ä¹¦</strong> ğŸ“–ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">kotlin</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å¤åˆ¶ç¼–è¾‘</span><br><span class="line">val books: List&lt;out Book&gt; = listOf(ScienceBook())</span><br></pre></td></tr></table></figure><ul><li>ä½ å¯ä»¥<strong>æ‹¿èµ·ä¸€æœ¬ä¹¦æ¥çœ‹</strong>ï¼ˆ<code>val book: Book = books[0]</code> âœ…ï¼‰ã€‚</li><li>ä½†ä½ <strong>ä¸èƒ½å¾€ä¹¦æ¶ä¸Šéšä¾¿æ”¾ä¹¦</strong>ï¼ˆ<code>books.add(Book())</code> âŒï¼‰ï¼Œå› ä¸ºè¿™å¯èƒ½æ˜¯ç§‘å­¦ä¹¦æ¶ï¼Œåªèƒ½æ”¾ã€Šç§‘å­¦ä¹¦ã€‹ã€‚</li></ul><p> <strong>ğŸ”´ é€†å˜ï¼ˆ<code>in</code>ï¼‰ï¼šåªå†™ï¼Œä¸è¯»</strong></p><p>å‡è®¾ä½ æœ‰ä¸€ä¸ª<strong>æä¹¦ç®±</strong> ğŸ“¦ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">kotlin</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å¤åˆ¶ç¼–è¾‘</span><br><span class="line">val donateBox: MutableList&lt;in ScienceBook&gt; = mutableListOf&lt;Book&gt;()</span><br></pre></td></tr></table></figure><ul><li>ä½ å¯ä»¥<strong>å¾€é‡Œé¢æ”¾ä¸€æœ¬ç§‘å­¦ä¹¦</strong>ï¼ˆ<code>donateBox.add(ScienceBook())</code> âœ…ï¼‰ã€‚</li><li>ä½†ä½ <strong>å–å‡ºæ¥çš„ä¹¦ä¸ä¸€å®šæ˜¯ç§‘å­¦ä¹¦</strong>ï¼ˆ<code>val sb: ScienceBook = donateBox[0]</code> âŒï¼‰ï¼Œå¯èƒ½æ˜¯ä¸€æœ¬æ™®é€šä¹¦ï¼Œç”šè‡³æ˜¯ä¸€æœ¬å­—å…¸ ğŸ“šã€‚</li></ul><hr><p> <strong>6. åå˜é€†å˜æ€»ç»“</strong></p><ol><li><strong><code>out</code>ï¼ˆåå˜ï¼‰ â†’ åªè¯»</strong><br> âœ… <code>List&lt;ScienceBook&gt;</code> å¯ä»¥èµ‹å€¼ç»™ <code>List&lt;out Book&gt;</code>ï¼Œä½†ä¸èƒ½ <code>add()</code>ã€‚</li><li><strong><code>in</code>ï¼ˆé€†å˜ï¼‰ â†’ åªå†™</strong><br> âœ… <code>MutableList&lt;Book&gt;</code> å¯ä»¥èµ‹å€¼ç»™ <code>MutableList&lt;in ScienceBook&gt;</code>ï¼Œä½†ä¸èƒ½å®‰å…¨ <code>get()</code>ã€‚</li><li><strong><code>in</code> + <code>out</code> ä¸èƒ½æ··ç”¨</strong>ï¼ˆåŒæ—¶ <code>in</code> å’Œ <code>out</code> ä¼šæŠ¥é”™ï¼‰ã€‚</li></ol><h4 id="5-1-5-æ³›å‹å®åŒ–ï¼ˆreifiedï¼‰"><a href="#5-1-5-æ³›å‹å®åŒ–ï¼ˆreifiedï¼‰" class="headerlink" title="5.1.5 æ³›å‹å®åŒ–ï¼ˆreifiedï¼‰"></a>5.1.5 æ³›å‹å®åŒ–ï¼ˆreifiedï¼‰</h4><p>ç”±äºæ³›å‹åœ¨è¿è¡Œæ—¶ä¼šè¢«æ“¦é™¤ï¼Œä½¿ç”¨ <code>reified</code> å¯ä»¥ä¿ç•™ç±»å‹ä¿¡æ¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// é”™è¯¯ç¤ºä¾‹ï¼šæ— æ³•åœ¨è¿è¡Œæ—¶è·å– T çš„ç±»å‹ä¿¡æ¯</span><br><span class="line">fun &lt;T&gt; getType(): String &#123;</span><br><span class="line">    return T::class.java.name  // âŒ</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// æ­£ç¡®ç¤ºä¾‹ï¼šä½¿ç”¨ reified ä¿ç•™ç±»å‹ä¿¡æ¯</span><br><span class="line">inline fun &lt;reified T&gt; getType(): String &#123;</span><br><span class="line">    return T::class.java.name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun main() &#123;</span><br><span class="line">    println(getType&lt;String&gt;())  // è¾“å‡º: java.lang.String</span><br><span class="line">    println(getType&lt;Int&gt;())     // è¾“å‡º: int</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="5-2-å§”æ‰˜"><a href="#5-2-å§”æ‰˜" class="headerlink" title="5.2 å§”æ‰˜"></a>5.2 å§”æ‰˜</h3><p>å§”æ‰˜æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œå¯ä»¥å°†éƒ¨åˆ†å·¥ä½œäº¤ç”±å…¶ä»–å¯¹è±¡æ¥å¤„ç†ï¼Œä½¿ä»£ç æ›´ç®€æ´å’Œçµæ´»ã€‚</p><h4 id="5-2-1-å±æ€§å§”æ‰˜"><a href="#5-2-1-å±æ€§å§”æ‰˜" class="headerlink" title="5.2.1 å±æ€§å§”æ‰˜"></a>5.2.1 å±æ€§å§”æ‰˜</h4><p><strong>lazy å§”æ‰˜</strong>ï¼šå»¶è¿Ÿè®¡ç®—ï¼Œé¦–æ¬¡è®¿é—®æ—¶è®¡ç®—ç»“æœå¹¶ç¼“å­˜ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// å®šä¹‰ä¸€ä¸ª lazy å§”æ‰˜å±æ€§ï¼Œåªæœ‰é¦–æ¬¡è®¿é—®æ—¶è®¡ç®—å€¼</span><br><span class="line">val lazyValue: String by lazy &#123;</span><br><span class="line">    println(&quot;å¼€å§‹è®¡ç®—&quot;)</span><br><span class="line">    &quot;Hello, Kotlin&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun main() &#123;</span><br><span class="line">    println(&quot;ç¨‹åºå¼€å§‹&quot;)</span><br><span class="line">    println(lazyValue) // ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶è¾“å‡ºè®¡ç®—è¿‡ç¨‹å’Œç»“æœ</span><br><span class="line">    println(lazyValue) // ç¬¬äºŒæ¬¡è°ƒç”¨æ—¶ç›´æ¥è¾“å‡ºç»“æœï¼Œæ— é‡å¤è®¡ç®—</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>observable å§”æ‰˜</strong>ï¼šç›‘å¬å±æ€§å˜åŒ–ï¼Œæ¯æ¬¡å±æ€§æ”¹å˜æ—¶è§¦å‘å›è°ƒã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import kotlin.properties.Delegates</span><br><span class="line"></span><br><span class="line">var name: String by Delegates.observable(&quot;åˆå§‹å€¼11&quot;) &#123; property, oldValue, newValue -&gt;</span><br><span class="line">    println(&quot;å±æ€§ $&#123;property.name&#125; ä» $oldValue å˜æˆäº† $newValue&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun main() &#123;</span><br><span class="line">    name = &quot;Kotlin22&quot;  // è¾“å‡ºï¼šå±æ€§ name ä» åˆå§‹å€¼11 å˜æˆäº† Kotlin22</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="5-2-2-ç±»å§”æ‰˜"><a href="#5-2-2-ç±»å§”æ‰˜" class="headerlink" title="5.2.2 ç±»å§”æ‰˜"></a>5.2.2 ç±»å§”æ‰˜</h4><p>é€šè¿‡ç±»å§”æ‰˜ï¼Œå¯ä»¥å°†æ¥å£çš„å®ç°ä»»åŠ¡äº¤ç”±å…¶ä»–ç±»å¤„ç†ï¼Œé¿å…é‡å¤å®ç°ç›¸åŒçš„æ–¹æ³•ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// å®šä¹‰ä¸€ä¸ªæ¥å£</span><br><span class="line">interface Printer &#123;</span><br><span class="line">    fun print()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å®šä¹‰æ¥å£å®ç°ç±»</span><br><span class="line">class PrinterImpl(val message: String) : Printer &#123;</span><br><span class="line">    override fun print() &#123;</span><br><span class="line">        println(message)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// ç±»å§”æ‰˜ï¼šDelegatingPrinter å°† Printer æ¥å£çš„å®ç°å§”æ‰˜ç»™ä¼ å…¥çš„ printer å¯¹è±¡</span><br><span class="line">class DelegatingPrinter(printer: Printer) : Printer by printer</span><br><span class="line"></span><br><span class="line">fun main() &#123;</span><br><span class="line">    val printerImpl = PrinterImpl(&quot;Hello from PrinterImpl&quot;)</span><br><span class="line">    val delegatingPrinter = DelegatingPrinter(printerImpl)</span><br><span class="line">    delegatingPrinter.print() // å®é™…è°ƒç”¨ PrinterImpl çš„ print() æ–¹æ³•</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li><strong>ä½œç”¨åŸŸå‡½æ•°</strong>ï¼šé€šè¿‡ <code>apply</code>ã€<code>let</code>ã€<code>run</code>ã€<code>also</code> å’Œ <code>with</code> ç®€åŒ–å¯¹è±¡æ“ä½œï¼Œé€‰æ‹©åˆé€‚çš„å‡½æ•°å¯æé«˜ä»£ç ç®€æ´æ€§å’Œå¯è¯»æ€§ã€‚</li><li><strong>æ—¶é—´è¾“å‡º</strong>ï¼šä½¿ç”¨ <code>SimpleDateFormat</code> å’Œ <code>Calendar</code> å®ç°æ—¥æœŸæ ¼å¼åŒ–ã€è§£æå’Œæ—¶é—´ç»„ä»¶è·å–ã€‚</li><li><strong>å›è°ƒæœºåˆ¶</strong>ï¼šå›è°ƒå¯ä»¥åœ¨ä»»åŠ¡å®Œæˆæ—¶é€šçŸ¥ä½ ï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹ï¼Œå¸¸ç”¨äº UI äº‹ä»¶ã€ç½‘ç»œè¯·æ±‚ç­‰åœºæ™¯ã€‚</li><li><strong>Lambda è¡¨è¾¾å¼</strong>ï¼šç”¨äºç¼–å†™åŒ¿åå‡½æ•°ï¼Œç®€åŒ–ä»£ç ï¼Œå°¤å…¶åœ¨é«˜é˜¶å‡½æ•°ä¸­åº”ç”¨å¹¿æ³›ã€‚</li><li><strong>æ³›å‹ä¸å§”æ‰˜</strong>ï¼šæ³›å‹æé«˜ä»£ç é€šç”¨æ€§å’Œç±»å‹å®‰å…¨ï¼›å§”æ‰˜ï¼ˆå±æ€§å§”æ‰˜å’Œç±»å§”æ‰˜ï¼‰ä½¿ä»£ç æ›´åŠ ç®€æ´çµæ´»ï¼Œé¿å…é‡å¤å®ç°ã€‚</li></ul><h2 id="inline-å‡½æ•°æ˜¯ä»€ä¹ˆ"><a href="#inline-å‡½æ•°æ˜¯ä»€ä¹ˆ" class="headerlink" title="inline å‡½æ•°æ˜¯ä»€ä¹ˆ"></a>inline å‡½æ•°æ˜¯ä»€ä¹ˆ</h2><p>åœ¨ Kotlin ä¸­ï¼Œ<strong>inline å‡½æ•°</strong> æ˜¯ä¸€ç§ä¼˜åŒ–æ‰‹æ®µï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯åœ¨ç¼–è¯‘æœŸå°†å‡½æ•°ä½“ç›´æ¥æ›¿æ¢åˆ°è°ƒç”¨å¤„ï¼Œä»è€Œé¿å…å‡½æ•°è°ƒç”¨çš„å¼€é”€ï¼Œç‰¹åˆ«é€‚ç”¨äºé«˜é˜¶å‡½æ•°ï¼ˆå³æ¥å— lambda å‚æ•°çš„å‡½æ•°ï¼‰ã€‚</p><hr><h3 id="1-åŸºæœ¬æ¦‚å¿µ"><a href="#1-åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="1. åŸºæœ¬æ¦‚å¿µ"></a>1. åŸºæœ¬æ¦‚å¿µ</h3><ul><li><strong>ç›®çš„</strong>ï¼šå‡å°‘å‡½æ•°è°ƒç”¨å¸¦æ¥çš„æ€§èƒ½å¼€é”€ï¼Œå°¤å…¶åœ¨ä½¿ç”¨ lambda è¡¨è¾¾å¼æ—¶ï¼Œé¿å…åˆ›å»ºé¢å¤–çš„å¯¹è±¡ã€‚</li><li><strong>å·¥ä½œåŸç†</strong>ï¼šç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶å°† inline å‡½æ•°çš„ä»£ç â€œå†…è”â€ï¼ˆinlineï¼‰åˆ°è°ƒç”¨è¯¥å‡½æ•°çš„ä½ç½®ï¼Œè€Œä¸æ˜¯åœ¨è¿è¡Œæ—¶è°ƒç”¨ã€‚</li></ul><hr><h3 id="2-ä½¿ç”¨åœºæ™¯"><a href="#2-ä½¿ç”¨åœºæ™¯" class="headerlink" title="2. ä½¿ç”¨åœºæ™¯"></a>2. ä½¿ç”¨åœºæ™¯</h3><ul><li><strong>é«˜é˜¶å‡½æ•°</strong>ï¼šå½“å‡½æ•°æ¥å— lambda å‚æ•°æ—¶ï¼Œä½¿ç”¨ inline å¯ä»¥å‡å°‘ lambda å¯¹è±¡çš„åˆ›å»ºï¼Œæé«˜æ€§èƒ½ã€‚</li><li><strong>å°å‹å‡½æ•°</strong>ï¼šé€‚ç”¨äºé‚£äº›é¢‘ç¹è°ƒç”¨çš„å°å‡½æ•°ï¼Œå¯ä»¥æé«˜æ•ˆç‡ã€‚</li><li><strong>æ³›å‹å®åŒ–</strong>ï¼šä¸ <code>reified</code> å…³é”®å­—ç»“åˆä½¿ç”¨ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶è·å–æ³›å‹å‚æ•°çš„å…·ä½“ç±»å‹ã€‚</li></ul><hr><h3 id="3-ç¤ºä¾‹"><a href="#3-ç¤ºä¾‹" class="headerlink" title="3. ç¤ºä¾‹"></a>3. ç¤ºä¾‹</h3><h4 id="3-1-åŸºæœ¬ç¤ºä¾‹"><a href="#3-1-åŸºæœ¬ç¤ºä¾‹" class="headerlink" title="3.1 åŸºæœ¬ç¤ºä¾‹"></a>3.1 åŸºæœ¬ç¤ºä¾‹</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// å®šä¹‰ä¸€ä¸ª inline å‡½æ•°</span><br><span class="line">inline fun performOperation(operation: () -&gt; Unit) &#123;</span><br><span class="line">    println(&quot;æ“ä½œå¼€å§‹&quot;)</span><br><span class="line">    operation()</span><br><span class="line">    println(&quot;æ“ä½œç»“æŸ&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun main() &#123;</span><br><span class="line">    performOperation &#123;</span><br><span class="line">        println(&quot;æ‰§è¡Œå…·ä½“æ“ä½œ&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¯´æ˜</strong>ï¼šåœ¨ç¼–è¯‘æ—¶ï¼Œ<code>performOperation</code> çš„ä»£ç ä¼šç›´æ¥å†…è”åˆ°è°ƒç”¨å¤„ï¼Œä»è€Œå‡å°‘äº†å‡½æ•°è°ƒç”¨çš„é¢å¤–å¼€é”€ã€‚</p><hr><h4 id="3-2-ä¸-reified-ç»“åˆ"><a href="#3-2-ä¸-reified-ç»“åˆ" class="headerlink" title="3.2 ä¸ reified ç»“åˆ"></a>3.2 ä¸ reified ç»“åˆ</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// ä½¿ç”¨ inline å’Œ reified å®ç°ä¸€ä¸ªæ³›å‹å‡½æ•°ï¼Œè·å–ç±»å‹åç§°</span><br><span class="line">inline fun &lt;reified T&gt; getTypeName(): String &#123;</span><br><span class="line">    return T::class.java.name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun main() &#123;</span><br><span class="line">    println(getTypeName&lt;String&gt;()) // è¾“å‡º: java.lang.String</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¯´æ˜</strong>ï¼š</p><ul><li>ä½¿ç”¨ <code>reified</code> åï¼Œæ³›å‹å‚æ•°åœ¨è¿è¡Œæ—¶ä¸ä¼šè¢«æ“¦é™¤ï¼Œå¯ä»¥ç›´æ¥è·å–ç±»å‹ä¿¡æ¯ã€‚</li><li><code>reified</code> å…³é”®å­—å¿…é¡»å’Œ <code>inline</code> å‡½æ•°ä¸€èµ·ä½¿ç”¨ã€‚</li></ul><hr><h3 id="4-æ³¨æ„äº‹é¡¹"><a href="#4-æ³¨æ„äº‹é¡¹" class="headerlink" title="4. æ³¨æ„äº‹é¡¹"></a>4. æ³¨æ„äº‹é¡¹</h3><ul><li><strong>ä»£ç è†¨èƒ€</strong>ï¼šç”±äº inline å‡½æ•°ä¼šå°†å‡½æ•°ä½“å¤åˆ¶åˆ°æ¯ä¸ªè°ƒç”¨å¤„ï¼Œå¦‚æœå‡½æ•°ä½“è¿‡å¤§æˆ–è€…è°ƒç”¨æ¬¡æ•°å¾ˆå¤šï¼Œå¯èƒ½ä¼šå¯¼è‡´ç”Ÿæˆçš„å­—èŠ‚ç å˜å¤§ã€‚</li><li><strong>é€‚ç”¨é™åˆ¶</strong>ï¼šæŸäº›æƒ…å†µä¸‹ï¼ˆä¾‹å¦‚é€’å½’è°ƒç”¨ï¼‰ä¸é€‚åˆä½¿ç”¨ inline å‡½æ•°ã€‚</li></ul><hr><h3 id="inlineå‡½æ•°æ€»ç»“"><a href="#inlineå‡½æ•°æ€»ç»“" class="headerlink" title="inlineå‡½æ•°æ€»ç»“"></a>inlineå‡½æ•°æ€»ç»“</h3><p>inline å‡½æ•°ä¸»è¦ç”¨äºä¼˜åŒ–é«˜é˜¶å‡½æ•°ï¼Œé€šè¿‡åœ¨ç¼–è¯‘æœŸå†…è”å‡½æ•°ä½“æ¥å‡å°‘è¿è¡Œæ—¶çš„å‡½æ•°è°ƒç”¨å¼€é”€ã€‚åŒæ—¶ï¼Œå®ƒå¯ä»¥ä¸ <code>reified</code> ç»“åˆä½¿ç”¨ï¼Œä»¥åœ¨è¿è¡Œæ—¶ä¿ç•™æ³›å‹ç±»å‹ä¿¡æ¯ã€‚è™½ç„¶ inline å‡½æ•°èƒ½å¤Ÿæé«˜æ€§èƒ½ï¼Œä½†åœ¨ä½¿ç”¨æ—¶ä¹Ÿéœ€æ³¨æ„é¿å…ä»£ç è†¨èƒ€é—®é¢˜ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Kotlinè¯­æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Markdownè¯­æ³•</title>
      <link href="/2025/02/24/Markdown%E8%AF%AD%E6%B3%95/"/>
      <url>/2025/02/24/Markdown%E8%AF%AD%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€-æ ‡é¢˜"><a href="#ä¸€-æ ‡é¢˜" class="headerlink" title="ä¸€.æ ‡é¢˜"></a>ä¸€.æ ‡é¢˜</h1><p>ä½¿ç”¨#</p><h1 id="äºŒ-å­—ä½“"><a href="#äºŒ-å­—ä½“" class="headerlink" title="äºŒ.å­—ä½“"></a>äºŒ.å­—ä½“</h1><h2 id="1-ç²—ä½“"><a href="#1-ç²—ä½“" class="headerlink" title="1.ç²—ä½“"></a>1.ç²—ä½“</h2><p>ä¸¤ä¸ª*</p><p><strong>M</strong></p><p><strong>M</strong></p><h2 id="2-æ–œä½“"><a href="#2-æ–œä½“" class="headerlink" title="2.æ–œä½“"></a>2.æ–œä½“</h2><p>ä¸€ä¸ª*</p><p><em>M</em></p><p><em>M</em></p><h2 id="3-ç²—ä½“åŠ æ–œä½“"><a href="#3-ç²—ä½“åŠ æ–œä½“" class="headerlink" title="3.ç²—ä½“åŠ æ–œä½“"></a>3.ç²—ä½“åŠ æ–œä½“</h2><p>ä¸‰ä¸ª*</p><p><em><strong>M</strong></em></p><p><em><strong>M</strong></em></p><h2 id="4-åˆ é™¤"><a href="#4-åˆ é™¤" class="headerlink" title="4.åˆ é™¤"></a>4.åˆ é™¤</h2><p>ä½¿ç”¨ä¸¤ä¸ªæ³¢æµªçº¿</p><p><del>M</del></p><p><del>M</del></p><h1 id="ä¸‰-å¼•ç”¨"><a href="#ä¸‰-å¼•ç”¨" class="headerlink" title="ä¸‰.å¼•ç”¨"></a>ä¸‰.å¼•ç”¨</h1><p>ä½¿ç”¨å¤§äºå·</p><blockquote><p>M</p></blockquote><blockquote><p>M</p></blockquote><h1 id="å››-åˆ†å‰²çº¿"><a href="#å››-åˆ†å‰²çº¿" class="headerlink" title="å››.åˆ†å‰²çº¿"></a>å››.åˆ†å‰²çº¿</h1><p>ä¸‰ä¸ª*æˆ–è€…ä¸‰ä¸ª-</p><h1 id="äº”-å›¾ç‰‡"><a href="#äº”-å›¾ç‰‡" class="headerlink" title="äº”.å›¾ç‰‡"></a>äº”.å›¾ç‰‡</h1><p>!+[]+()ï¼Œå…¶ä¸­[]å†…å¡«å†™åå­—ï¼Œ()å†…å¡«å†™å›¾ç‰‡åœ°å€</p><p><img src="/"></p><h1 id="å…­-è¶…é“¾æ¥"><a href="#å…­-è¶…é“¾æ¥" class="headerlink" title="å…­.è¶…é“¾æ¥"></a>å…­.è¶…é“¾æ¥</h1><p>[]+()ï¼Œå…¶ä¸­[]å†…å¡«å†™åå­—ï¼Œ()å†…å¡«å†™ç½‘å€</p><p><a href="www.baidu.com">hh</a></p><h1 id="ä¸ƒ-åˆ—è¡¨"><a href="#ä¸ƒ-åˆ—è¡¨" class="headerlink" title="ä¸ƒ.åˆ—è¡¨"></a>ä¸ƒ.åˆ—è¡¨</h1><h2 id="æœ‰åºåˆ—è¡¨"><a href="#æœ‰åºåˆ—è¡¨" class="headerlink" title="æœ‰åºåˆ—è¡¨"></a>æœ‰åºåˆ—è¡¨</h2><p>æ•°å­—åŠ â€.â€,å†åŠ ç©ºæ ¼ï¼Œå³ç”Ÿæˆæœ‰åºåˆ—è¡¨</p><ol><li>A</li><li>B</li></ol><h2 id="æ— åºåˆ—è¡¨"><a href="#æ— åºåˆ—è¡¨" class="headerlink" title="æ— åºåˆ—è¡¨"></a>æ— åºåˆ—è¡¨</h2><p>-åŠ ç©ºæ ¼</p><ul><li>1</li><li>2</li></ul><h1 id="å…«-è¡¨æ ¼"><a href="#å…«-è¡¨æ ¼" class="headerlink" title="å…«.è¡¨æ ¼"></a>å…«.è¡¨æ ¼</h1><p>1.å³é”®ï¼Œé€‰æ‹©æ’å…¥ï¼Œé€‰æ‹©è¡¨æ ¼</p><p>2.Ctrl+T</p><p>3.åŸå§‹äººæ¨¡å¼</p><p>å…ˆå†™å¥½æ ¼å¼å¦‚ä¸‹</p><p>X|Y|Z</p><p>â€“|â€“|â€“</p><p>1|2|3</p><p>ç„¶åç‚¹å‡»å·¦ä¸‹è§’å›¾æ¡ˆ&lt;&#x2F;&gt;ï¼Œå¼€å¯æºä»£ç æ¨¡å¼ï¼ŒæŠŠå„è¡Œä¹‹é—´çš„ç©ºè¡Œåˆ é™¤ï¼Œå³å¯ç”Ÿæˆè¡¨æ ¼ã€‚</p><h1 id="ä¹-æ’å…¥ä»£ç å—"><a href="#ä¹-æ’å…¥ä»£ç å—" class="headerlink" title="ä¹.æ’å…¥ä»£ç å—"></a>ä¹.æ’å…¥ä»£ç å—</h1><p>ä½¿ç”¨ä¸‰ä¸ª&#96;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>SQLæ•°æ®åº“</title>
      <link href="/2025/02/24/SQL%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
      <url>/2025/02/24/SQL%E6%95%B0%E6%8D%AE%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<p>è¿›åº¦1:32:06</p><h1 id="ä¸€-æ•°æ®ç±»å‹"><a href="#ä¸€-æ•°æ®ç±»å‹" class="headerlink" title="ä¸€.æ•°æ®ç±»å‹"></a>ä¸€.æ•°æ®ç±»å‹</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">INT                    --æ•´æ•°</span><br><span class="line">DECIMAL(3,2)   --æœ‰å°æ•°ç‚¹çš„æ•°</span><br><span class="line">VARCHAR(10)            --å­—ä¸²</span><br><span class="line">BLOB                   --(Binary Large Object) å›¾ç‰‡ å½±ç‰‡ æ¡£æ¡ˆ...</span><br><span class="line">DATA                   --&#x27;YYYY-MM-DD&#x27; æ—¥æœŸ</span><br><span class="line">TIMESTAMP              --&#x27;YYYY-MM-DD HH:MM:SS&#x27; è®°å½•æ—¶é—´</span><br></pre></td></tr></table></figure><h1 id="äºŒ-ç®€å•ä¾‹å­"><a href="#äºŒ-ç®€å•ä¾‹å­" class="headerlink" title="äºŒ.ç®€å•ä¾‹å­"></a>äºŒ.ç®€å•ä¾‹å­</h1><h2 id="ä¾‹ä¸€"><a href="#ä¾‹ä¸€" class="headerlink" title="ä¾‹ä¸€"></a>ä¾‹ä¸€</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> dATABASE `sql_tutorial`;</span><br><span class="line"><span class="keyword">SHOW</span> DAtABaSES;</span><br><span class="line">USE `sql_tutorial`;</span><br><span class="line"><span class="keyword">CREATE TABLE</span> `student`(</span><br><span class="line">`student_id` <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> auto_increment,</span><br><span class="line">`name` <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT NULL</span> ,  <span class="comment">-- è¿™æ˜¯ä¸€ä¸ªæ³¨é‡Šï¼Œè®°å¾—æ˜¯å‡å‡åŠ ç©ºæ ¼</span></span><br><span class="line">`major` <span class="type">VARCHAR</span>(<span class="number">20</span>)  <span class="keyword">default</span> <span class="string">&#x27;å†å²&#x27;</span>,</span><br><span class="line">`score` <span class="type">INT</span> <span class="keyword">default</span> <span class="number">100</span> <span class="comment">-- æœ€åä¸€ä¸ªå±æ€§ä¸ç”¨åŠ é€—å·</span></span><br><span class="line">);      <span class="comment">/*æœ€åæœ‰;ç›¸å½“äºä¸€å¥è¯çš„ç»“æŸï¼Ÿ*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">dESCriBe</span> `student`;</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">TABLE</span> `student`;</span><br><span class="line"><span class="keyword">ALTER TABLE</span> `student` <span class="keyword">ADD</span> gpa <span class="type">DECIMAL</span>(<span class="number">3</span>,<span class="number">2</span>) <span class="keyword">default</span> <span class="number">0.00</span>; <span class="comment">-- æ–°å¢å±æ€§</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> `student` <span class="keyword">DROP</span> <span class="keyword">COLUMN</span> gpa; <span class="comment">-- åˆ é™¤å±æ€§</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> `student`;</span><br><span class="line"><span class="keyword">INSERT INTO</span> `student` <span class="keyword">VALUES</span>(<span class="number">1</span>,<span class="string">&#x27;å°ç™½&#x27;</span>,<span class="string">&#x27;å†å²&#x27;</span>,<span class="number">100</span>); <span class="comment">-- æ’å…¥æ•°æ®ï¼Œæ³¨æ„æ˜¯ç”¨å•å¼•å·â€™è€Œä¸æ˜¯`</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> `student` <span class="keyword">VALUES</span>(<span class="number">2</span>,<span class="string">&#x27;å°ç»¿&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">80</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `student`(`name`,`major`,`student_id`) <span class="keyword">VALUES</span>(<span class="string">&#x27;å°è“&#x27;</span>,<span class="string">&#x27;è‹±è¯­&#x27;</span>,<span class="number">3</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `student`(`name`,`student_id`) <span class="keyword">VALUES</span>(<span class="string">&#x27;å°çº¢&#x27;</span>,<span class="number">4</span>); </span><br><span class="line"><span class="keyword">INSERT INTO</span> `student`(`name`,`major`) <span class="keyword">VALUES</span>(<span class="string">&#x27;å°çº¢&#x27;</span>,<span class="keyword">NULL</span>); <span class="comment">-- ä¸å†™idæ˜¯å› ä¸ºauto_incrementè‡ªåŠ¨ç”Ÿæˆid</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> `student` <span class="keyword">WHERE</span> `student_id` <span class="operator">=</span> <span class="number">4</span>;  <span class="comment">-- åˆ é™¤idä¸º4çš„é‚£ä¸€è¡Œ</span></span><br><span class="line"><span class="keyword">SET</span> SQL_SAFE_UPDATES<span class="operator">=</span><span class="number">0</span> ;<span class="comment">-- ç”¨äºå…³é—­å®‰å…¨æ›´æ–°æ¨¡å¼ï¼Œå…è®¸ä½ æ‰§è¡Œ UPDATE æˆ– DELETE è¯­å¥ï¼Œå³ä½¿æ²¡æœ‰ WHERE æ¡ä»¶æˆ–æ²¡æœ‰ä¸»é”®ç´¢å¼•ã€‚</span></span><br><span class="line"><span class="keyword">UPDATE</span> `student` </span><br><span class="line"><span class="keyword">SET</span> `major` <span class="operator">=</span><span class="string">&#x27;è‹±è¯­æ–‡å­¦&#x27;</span> <span class="comment">-- ä¸æ˜¯è¡Œåˆ—åç­‰ï¼Œè¦ä½¿ç”¨&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">WHERE</span> `major` <span class="operator">=</span><span class="string">&#x27;è‹±è¯­&#x27;</span> ;</span><br><span class="line"><span class="keyword">UPDATE</span> `student` <span class="keyword">SET</span> `name`<span class="operator">=</span><span class="string">&#x27;å°1&#x27;</span> <span class="keyword">WHERE</span> `name`<span class="operator">=</span><span class="string">&#x27;å°ç»¿&#x27;</span> <span class="keyword">or</span> `name`<span class="operator">=</span> <span class="string">&#x27;å°ç™½&#x27;</span>;  <span class="comment">-- æ›´æ–°è¡¨æ ¼</span></span><br><span class="line"><span class="keyword">UPDATE</span> `student` <span class="keyword">SET</span> `name`<span class="operator">=</span><span class="string">&#x27;å°ç°&#x27;</span>,`major`<span class="operator">=</span><span class="string">&#x27;ç‰©ç†&#x27;</span> <span class="keyword">WHERE</span> `student_id`<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> `student` <span class="keyword">SET</span> `major`<span class="operator">=</span><span class="string">&#x27;ç‰©ç†&#x27;</span>;</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> `student` <span class="keyword">where</span> `name`<span class="operator">=</span><span class="string">&#x27;å°ç°&#x27;</span> <span class="keyword">and</span> `major`<span class="operator">=</span><span class="string">&#x27;ç‰©ç†&#x27;</span>; <span class="comment">-- whereç”¨andè¿æ¥</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> `student` <span class="keyword">where</span> `score`<span class="operator">&lt;</span><span class="number">60</span>;</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> `student` ;<span class="comment">-- æŠŠstudentå†…æ•°æ®å…¨éƒ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">-- å–å¾—èµ„æ–™</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> `student`;</span><br><span class="line"><span class="keyword">Select</span> `name` <span class="keyword">from</span> `student` ;</span><br><span class="line"><span class="keyword">select</span> `name` , `major` <span class="keyword">from</span> `student`; <span class="comment">-- ä¸­é—´ç”¨,è€Œä¸æ˜¯and</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">from</span> `student` <span class="keyword">order</span> <span class="keyword">by</span> `score` ; <span class="comment">-- ä»ä½åˆ°é«˜ï¼Œæˆ–è€…åœ¨order byåé¢åŠ ä¸ŠASC</span></span><br><span class="line"><span class="keyword">selecT</span> <span class="operator">*</span> <span class="keyword">from</span> `student` <span class="keyword">order</span> <span class="keyword">by</span> `score` <span class="keyword">DESC</span>;<span class="comment">-- ä»é«˜åˆ°ä½</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> `student` <span class="keyword">order</span> <span class="keyword">by</span> `score`<span class="keyword">DESC</span>,`student_id`  Limit <span class="number">3</span>; <span class="comment">-- å…ˆæ ¹æ®scoreé™åºæ’åºï¼Œè‹¥æ˜¯scoreä¸€æ ·ï¼Œåˆ™æŒ‰student_idå‡åºæ’åºï¼Œåªè¿”å›å‰ä¸‰ä¸ª</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> `student` <span class="keyword">where</span> `major`<span class="operator">=</span><span class="string">&#x27;è‹±è¯­&#x27;</span> <span class="keyword">and</span> `student_id`<span class="operator">=</span><span class="number">1</span>; <span class="comment">-- whereç”¨andè¿æ¥</span></span><br></pre></td></tr></table></figure><h2 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h2><p>1.<em><strong>æ³¨é‡Š</strong></em>æœ‰â€“ å’Œ&#x2F;**&#x2F;ä¸¤ç§â€“åé¢è¦è·Ÿç©ºæ ¼</p><p>2.ä¸€ä¸ªå¼•å·æ˜¯ä¸€å¥ï¼Œæ¯”å¦‚è™½ç„¶CREATE TABLE <code>student</code> æœ‰é‚£ä¹ˆå¤šè¡Œï¼Œå…¶å®åªæœ‰ä¸€å¥ï¼Œæ‰€ä»¥cursoræŒ‡å‘å®¹æ˜“ä¸€è¡Œå°±å¯ä»¥æ‰§è¡Œæ•´ä¸ªè¯­å¥</p><p>3.é—ªç”µåªä¼šé—ªç”µä¸€å¥è¯ï¼Œæ¯”å¦‚ä½ æ²¡æœ‰æ‰§è¡ŒUSE sql_tutorial è¿™ä¸€å¥è¯ï¼Œå»æ‰§è¡ŒdESCriBe <code>student</code>;å°±ä¼šæŠ¥é”™ï¼Œè®°ä½<em><strong>ä¸€å®šè¦å…ˆæ‰§è¡ŒUSE sql_tutorialè¿™å¥è¯</strong></em></p><p>4.å…³é”®å­—çš„å¤§å°å†™æ˜¯æ— æ‰€è°“çš„ï¼Œä½†å»ºè®®å…³é”®å­—å…¨ç”¨å¤§å†™ï¼Œä¸Šé¢ä¾‹å­åªæ˜¯ä¸ºäº†ä½“ç°å¤§å°å†™ä»»æ„çš„ç‰¹å¾ï¼Œå®é™…ä¸Šä¸€ä¸ªå…¨éƒ¨å¤§å†™ï¼Œè‡ªå·±å®šä¹‰çš„å­—å»ºè®®ä½¿ç”¨&#96;&#96;åŒ…æ‹¬èµ·æ¥ï¼Œå¹¶ä½¿ç”¨å°å†™</p><p>5.&gt;å¤§äº   &lt;å°äº   &gt;&#x3D;å¤§äºç­‰äº   &#x3D;ç­‰äº    &lt;&gt;ä¸ç­‰äº</p><p>6.whereç”¨andï¼Œorè¿æ¥ï¼Ÿ</p><h2 id="ä¾‹äºŒ"><a href="#ä¾‹äºŒ" class="headerlink" title="ä¾‹äºŒ"></a>ä¾‹äºŒ</h2>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨ASçš„å‡†å¤‡</title>
      <link href="/2025/02/16/%E4%BD%BF%E7%94%A8AS%E7%9A%84%E5%87%86%E5%A4%87/"/>
      <url>/2025/02/16/%E4%BD%BF%E7%94%A8AS%E7%9A%84%E5%87%86%E5%A4%87/</url>
      
        <content type="html"><![CDATA[<h1 id="1-viewbinding"><a href="#1-viewbinding" class="headerlink" title="1.viewbinding"></a>1.viewbinding</h1><p>build.gradle.ktsä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">android&#123;</span><br><span class="line">...</span><br><span class="line">buildFeatures &#123;</span><br><span class="line">    viewBinding = true</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="2-compileSdk"><a href="#2-compileSdk" class="headerlink" title="2.compileSdk"></a>2.compileSdk</h1><p>build.gradle.ktsä¸­compileSdk&#x3D;34æ”¹æˆcompileSdk&#x3D;35</p><h1 id="3-dependencies"><a href="#3-dependencies" class="headerlink" title="3.dependencies"></a>3.dependencies</h1><p>åœ¨dependenciesä¸­æ·»åŠ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">implementation(&quot;androidx.fragment:fragment:1.6.2&quot;)</span><br><span class="line">implementation(&quot;com.squareup.okhttp3:okhttp:4.10.0&quot;)</span><br><span class="line">implementation(&quot;com.google.code.gson:gson:2.10.1&quot;)</span><br><span class="line">implementation(&quot;com.squareup.retrofit2:retrofit:2.9.0&quot;)</span><br><span class="line">implementation(&quot;com.squareup.retrofit2:converter-gson:2.9.0&quot;)</span><br><span class="line">implementation(&quot;org.jetbrains.kotlinx:kotlinx-coroutines-core:1.1.1&quot;)</span><br><span class="line">implementation(&quot;org.jetbrains.kotlinx:kotlinx-coroutines-android:1.1.1&quot;)</span><br><span class="line">implementation(&quot;androidx.lifecycle:lifecycle-runtime-ktx:2.4.0&quot;)</span><br><span class="line">implementation(&quot;androidx.lifecycle:lifecycle-livedata-ktx:2.8.7&quot;)</span><br><span class="line">implementation(&quot;androidx.lifecycle:lifecycle-viewmodel-ktx:2.4.0&quot;)</span><br><span class="line">implementation(&quot;androidx.room:room-runtime:2.6.1&quot;)</span><br><span class="line">kapt(&quot;androidx.room:room-compiler:2.6.1&quot;)</span><br><span class="line">implementation(&quot;androidx.work:work-runtime:2.10.0&quot;)</span><br><span class="line">implementation(&quot;com.github.bumptech.glide:glide:4.15.1&quot;)</span><br><span class="line">implementation (&quot;androidx.lifecycle:lifecycle-livedata-ktx:2.3.1&quot;)</span><br><span class="line">implementation (&quot;androidx.lifecycle:lifecycle-viewmodel-ktx:2.3.1&quot;)</span><br><span class="line">implementation (&quot;com.github.bumptech.glide:glide:4.13.0&quot;)</span><br><span class="line">annotationProcessor (&quot;com.github.bumptech.glide:compiler:4.13.0&quot;)</span><br><span class="line">implementation(&quot;androidx.room:room-runtime:2.5.2&quot;)</span><br><span class="line">kapt(&quot;androidx.room:room-compiler:2.5.2&quot;)</span><br><span class="line">implementation(&quot;androidx.room:room-ktx:2.5.2&quot;)</span><br><span class="line">implementation(&quot;com.google.android.material:material:1.12.0&quot;)</span><br><span class="line">implementation(&quot;de.hdodenhof:circleimageview:3.1.0&quot;)</span><br><span class="line">implementation(&quot;androidx.swiperefreshlayout:swiperefreshlayout:1.1.0&quot;)</span><br></pre></td></tr></table></figure><p>è§£é‡Š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">implementation(&quot;androidx.fragment:fragment-ktx:1.6.2&quot;)</span><br><span class="line">implementation(&quot;com.squareup.okhttp3:okhttp:4.10.0&quot;)//å¼•ç”¨OkHttpåº“</span><br><span class="line">implementation(&quot;com.google.code.gson:gson:2.10.1&quot;)//ä½¿ç”¨gson</span><br><span class="line">implementation(&quot;com.squareup.retrofit2:retrofit:2.9.0&quot;)//ä½¿ç”¨Retrofit,ä¼šè‡ªåŠ¨å°†Retrofitã€OkHttpã€å’ŒOkioè¿™å‡ ä¸ªåº“ä¸€èµ·ä¸‹è½½ï¼Œä¸ç”¨å†æ‰‹åŠ¨å¼•å…¥OkHttpåº“ã€‚</span><br><span class="line">implementation(&quot;com.squareup.retrofit2:converter-gson:2.9.0&quot;)//ä½¿ç”¨Retrofitï¼Œè¿™æ˜¯ä¸€ä¸ªRetrofitçš„è½¬æ¢åº“ï¼Œå®ƒæ˜¯å€ŸåŠ©GSONæ¥è§£æJSONæ•°æ®çš„ï¼Œæ‰€ä»¥ä¼šè‡ªåŠ¨å°†GSONåº“ä¸‹è½½ä¸‹æ¥ï¼Œæ‰€ä»¥ä¸ç”¨æ‰‹åŠ¨å¼•å…¥GSONåº“äº†</span><br><span class="line">implementation(&quot;org.jetbrains.kotlinx:kotlinx-coroutines-core:1.1.1&quot;)//åç¨‹</span><br><span class="line">implementation(&quot;org.jetbrains.kotlinx:kotlinx-coroutines-android:1.1.1&quot;)//åç¨‹</span><br><span class="line">implementation(&quot;androidx.lifecycle:lifecycle-runtime-ktx:2.4.0&quot;)//ä½¿ç”¨ViewModelç»„ä»¶</span><br><span class="line">implementation(&quot;androidx.lifecycle:lifecycle-livedata-ktx:2.8.7&quot;)//ä½¿ç”¨ViewModelã€livedataç»„ä»¶</span><br><span class="line">implementation(&quot;androidx.lifecycle:lifecycle-viewmodel-ktx:2.4.0&quot;)//ä½¿ç”¨ViewModelç»„ä»¶</span><br><span class="line">implementation(&quot;androidx.room:room-runtime:2.6.1&quot;)//room</span><br><span class="line">kapt(&quot;androidx.room:room-compiler:2.6.1&quot;)//room</span><br><span class="line">implementation(&quot;androidx.work:work-runtime:2.10.0&quot;)//WorkManager</span><br><span class="line">implementation(&quot;com.github.bumptech.glide:glide:4.15.1&quot;)/*Glide,å¦å¤–ï¼ŒGlideä¸­éœ€è¦ç”¨åˆ°ç½‘ç»œåŠŸèƒ½ï¼Œå› æ­¤ä½ è¿˜å¾—åœ¨AndroidManifest.xmlä¸­å£°æ˜ä¸€ä¸‹ç½‘ç»œæƒé™æ‰è¡Œï¼š&lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;*/</span><br><span class="line">annotationProcessor (&quot;com.github.bumptech.glide:compiler:4.13.0&quot;)</span><br><span class="line">implementation(&quot;androidx.room:room-runtime:2.5.2&quot;)</span><br><span class="line">kapt(&quot;androidx.room:room-compiler:2.5.2&quot;)</span><br><span class="line">implementation(&quot;androidx.room:room-ktx:2.5.2&quot;)</span><br><span class="line">implementation(&quot;com.google.android.material:material:1.12.0&quot;)</span><br><span class="line">implementation(&quot;de.hdodenhof:circleimageview:3.1.0&quot;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="4-plugins"><a href="#4-plugins" class="headerlink" title="4.plugins"></a>4.plugins</h1><p>æ·»åŠ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id(&quot;kotlin-kapt&quot;)</span><br></pre></td></tr></table></figure><p>è§£é‡Š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id(&quot;kotlin-kapt&quot;)//ä¸ºäº†dependenciesä¸­èƒ½ä½¿ç”¨kapt(&quot;...&quot;)è¿™æ ·çš„è¯­æ³•</span><br></pre></td></tr></table></figure><h1 id="5-binding"><a href="#5-binding" class="headerlink" title="5.binding"></a>5.binding</h1><p>æ”¹ç”¨binding.root</p><h1 id="6-å£°æ˜ç½‘ç»œæƒé™"><a href="#6-å£°æ˜ç½‘ç»œæƒé™" class="headerlink" title="6.å£°æ˜ç½‘ç»œæƒé™"></a>6.å£°æ˜ç½‘ç»œæƒé™</h1><p>åœ¨AndroidManifest.xmlå¼€å¤´æ·»åŠ </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.INTERNET&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>å¦‚ä¸‹é¢ä¾‹å­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.INTERNET&quot;/&gt;</span><br></pre></td></tr></table></figure><h1 id="7-ä½¿ç”¨HTTP"><a href="#7-ä½¿ç”¨HTTP" class="headerlink" title="7.ä½¿ç”¨HTTP"></a>7.ä½¿ç”¨HTTP</h1><p>åœ¨res-&gt;xmlæ–‡ä»¶å¤¹ä¸‹ï¼Œæ–°å»ºnetwork_config.xmlæ–‡ä»¶ï¼Œç„¶åä¿®æ”¹æ–‡ä»¶ä¸­å†…å®¹å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span><br><span class="line">&lt;network-security-config&gt;</span><br><span class="line">    &lt;base-config cleartextTrafficPermitted=&quot;true&quot;&gt;</span><br><span class="line">        &lt;trust-anchors&gt;</span><br><span class="line">            &lt;certificates src=&quot;system&quot;/&gt;</span><br><span class="line">        &lt;/trust-anchors&gt;</span><br><span class="line">    &lt;/base-config&gt;</span><br><span class="line">&lt;/network-security-config&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™æ®µé…ç½®æ–‡ä»¶çš„æ„æ€æ˜¯å…è®¸æˆ‘ä»¬ä»¥æ˜æ–‡çš„æ–¹å¼åœ¨ç½‘ç»œä¸Šä¼ è¾“æ•°æ®ï¼Œè€ŒHTTPä½¿ç”¨çš„å°±æ˜¯æ˜æ–‡ä¼ è¾“æ–¹å¼ã€‚</p><p>æ¥ä¸‹æ¥ä¿®æ”¹AndroidManifest.xmlä¸­çš„ä»£ç æ¥å¯ç”¨æˆ‘ä»¬åˆšæ‰åˆ›å»ºçš„é…ç½®æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;application</span><br><span class="line">        android:allowBackup=&quot;true&quot;</span><br><span class="line">        android:dataExtractionRules=&quot;@xml/data_extraction_rules&quot;</span><br><span class="line">        android:fullBackupContent=&quot;@xml/backup_rules&quot;</span><br><span class="line">        android:icon=&quot;@mipmap/ic_launcher&quot;</span><br><span class="line">        android:label=&quot;@string/app_name&quot;</span><br><span class="line">        android:roundIcon=&quot;@mipmap/ic_launcher_round&quot;</span><br><span class="line">        android:supportsRtl=&quot;true&quot;</span><br><span class="line">        android:theme=&quot;@style/Theme.NetworkTest&quot;</span><br><span class="line">        tools:targetApi=&quot;31&quot;</span><br><span class="line">        android:networkSecurityConfig=&quot;@xml/network_config&quot;//å°±æ˜¯æ·»åŠ è¿™ä¸€è¡Œå“¦</span><br><span class="line">        &gt;</span><br></pre></td></tr></table></figure><h1 id="AndroidManifest-xmlçš„æƒé™å£°æ˜"><a href="#AndroidManifest-xmlçš„æƒé™å£°æ˜" class="headerlink" title="AndroidManifest.xmlçš„æƒé™å£°æ˜"></a>AndroidManifest.xmlçš„æƒé™å£°æ˜</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;uses-permission android:name=&quot;android.permission.INTERNET&quot;/&gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.ACCESS_FINE_LOCATION&quot; /&gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.ACCESS_COARSE_LOCATION&quot; /&gt; </span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.READ_EXTERNAL_STORAGE&quot; /&gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.CAMERA&quot; /&gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.POST_NOTIFICATIONS&quot; /&gt;</span><br><span class="line">&lt;!-- æ™®é€šå‰å°æœåŠ¡æƒé™ --&gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.FOREGROUND_SERVICE&quot;/&gt;</span><br><span class="line">&lt;!-- MediaPlayback ç±»å‹çš„å‰å°æœåŠ¡éœ€è¦é¢å¤–çš„æƒé™ --&gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.FOREGROUND_SERVICE_MEDIA_PLAYBACK&quot;/&gt;</span><br></pre></td></tr></table></figure><h1 id="Activity"><a href="#Activity" class="headerlink" title="Activity"></a>Activity</h1><p>1.åˆ enableEdgeToEdge()ï¼Œå…¶å®è¿˜æ˜¯åˆ«åˆ äº†</p><p>2.åˆ ViewCompat.setOnApplyWindowInsetsListenerï¼Œå…¶å®è¿˜æ˜¯åˆ«åˆ äº†ï¼Œä½†æ˜¯ViewCompat.setOnApplyWindowInsetsListenerå’ŒfitsSystemWindows&#x3D;â€trueâ€æœ‰å†²çªï¼Œæ‰€ä»¥ä¸å¾—å·²çš„æ—¶å€™åªèƒ½åˆ äº†ï¼Œä½†æ˜¯å…¶å®ViewCompat.setOnApplyWindowInsetsListeneræ¯”fitsSystemWindowså¥½ç”¨å¤šäº†ï¼Œè¿˜ä¸å¦‚ä¿ç•™ViewCompat.setOnApplyWindowInsetsListenerï¼Œåˆ é™¤fitsSystemWindowsã€‚</p><p>3.åˆå§‹åŒ–bindingå’Œæ”¹setContentView(binding.root)</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Task-4</title>
      <link href="/2025/02/10/Task-4/"/>
      <url>/2025/02/10/Task-4/</url>
      
        <content type="html"><![CDATA[<h1 id="å¯’å‡ç¬¬å››è®²"><a href="#å¯’å‡ç¬¬å››è®²" class="headerlink" title="å¯’å‡ç¬¬å››è®²"></a>å¯’å‡ç¬¬å››è®²</h1><h2 id="ä¸€-æœ‰ç†æ•°å–ä½™"><a href="#ä¸€-æœ‰ç†æ•°å–ä½™" class="headerlink" title="ä¸€.æœ‰ç†æ•°å–ä½™"></a>ä¸€.æœ‰ç†æ•°å–ä½™</h2><h3 id="1-å¯¹åº”æ€è·¯"><a href="#1-å¯¹åº”æ€è·¯" class="headerlink" title="1.å¯¹åº”æ€è·¯"></a>1.å¯¹åº”æ€è·¯</h3><p>è¯¥é—®é¢˜è¦æ±‚è®¡ç®—æœ‰ç†æ•° c&#x3D;ab<em>c</em>&#x3D;<em>b**a</em> å¯¹19260817å–æ¨¡çš„å€¼ã€‚æ ¹æ®æ¨¡è¿ç®—çš„æ€§è´¨ï¼Œè¿™ç›¸å½“äºæ±‚è§£æ–¹ç¨‹ bxâ‰¡amodâ€‰â€‰19260817<em>b**x</em>â‰¡<em>a</em>mod19260817ã€‚è§£çš„å­˜åœ¨æ€§å–å†³äº b<em>b</em> æ˜¯å¦å­˜åœ¨æ¨¡19260817çš„é€†å…ƒã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><strong>å¤§æ•°å–æ¨¡</strong>ï¼šç”±äºè¾“å…¥çš„ a<em>a</em> å’Œ b<em>b</em> å¯èƒ½éå¸¸å¤§ï¼ˆæœ€å¤š10001ä½ï¼‰ï¼Œéœ€è¦å°†è¿™ä¸¤ä¸ªæ•°è½¬æ¢ä¸ºæ¨¡19260817åçš„å€¼ã€‚è¿™å¯ä»¥é€šè¿‡é€ä½å¤„ç†å­—ç¬¦ä¸²å¹¶å–æ¨¡æ¥å®ç°ã€‚</li><li><strong>åˆ¤æ–­é€†å…ƒå­˜åœ¨æ€§</strong>ï¼šè‹¥ b<em>b</em> æ¨¡19260817çš„ç»“æœä¸º0ï¼Œåˆ™æ–¹ç¨‹æ— è§£ï¼Œç›´æ¥è¾“å‡ºâ€œAngry!â€ã€‚å¦åˆ™ï¼Œåˆ©ç”¨è´¹é©¬å°å®šç†è®¡ç®— b<em>b</em> çš„é€†å…ƒï¼Œå› ä¸º19260817æ˜¯è´¨æ•°ã€‚</li><li><strong>è®¡ç®—æœ€ç»ˆç»“æœ</strong>ï¼šå°† a<em>a</em> çš„æ¨¡å€¼ä¸é€†å…ƒç›¸ä¹˜åå†æ¬¡å–æ¨¡ï¼Œå¾—åˆ°æœ€ç»ˆç»“æœã€‚</li></ol><h3 id="2-å¯¹åº”ä»£ç "><a href="#2-å¯¹åº”ä»£ç " class="headerlink" title="2.å¯¹åº”ä»£ç "></a>2.å¯¹åº”ä»£ç </h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;string&gt;</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">const int MOD = 19260817;</span><br><span class="line"></span><br><span class="line">int mod(const string&amp; s, int m) &#123;</span><br><span class="line">    int res = 0;</span><br><span class="line">    for (char c : s) &#123;</span><br><span class="line">        res = (res * 10LL + (c - &#x27;0&#x27;)) % m;</span><br><span class="line">    &#125;</span><br><span class="line">    return res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">long long pow_mod(long long a, long long b, int mod) &#123;</span><br><span class="line">    long long res = 1;</span><br><span class="line">    a %= mod;</span><br><span class="line">    while (b &gt; 0) &#123;</span><br><span class="line">        if (b % 2 == 1) res = (res * a) % mod;</span><br><span class="line">        a = (a * a) % mod;</span><br><span class="line">        b /= 2;</span><br><span class="line">    &#125;</span><br><span class="line">    return res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">    string a_str, b_str;</span><br><span class="line">    cin &gt;&gt; a_str &gt;&gt; b_str;</span><br><span class="line"></span><br><span class="line">    int a_mod = mod(a_str, MOD);</span><br><span class="line">    int b_mod = mod(b_str, MOD);</span><br><span class="line"></span><br><span class="line">    if (b_mod == 0) &#123;</span><br><span class="line">        cout &lt;&lt; &quot;Angry!&quot; &lt;&lt; endl;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        long long inv_b = pow_mod(b_mod, MOD - 2, MOD);</span><br><span class="line">        long long ans = (a_mod * inv_b) % MOD;</span><br><span class="line">        cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-å­¦ä¹ æ€»ç»“"><a href="#3-å­¦ä¹ æ€»ç»“" class="headerlink" title="3.å­¦ä¹ æ€»ç»“"></a>3.å­¦ä¹ æ€»ç»“</h3><ol><li><strong>å¤§æ•°å–æ¨¡æŠ€å·§</strong>ï¼šå¤„ç†è¶…å¤§æ•°æ—¶ï¼Œå¯ä»¥é€šè¿‡é€ä½å–æ¨¡çš„æ–¹å¼é¿å…æ•°å€¼æº¢å‡ºã€‚ä¾‹å¦‚ï¼Œå°†å­—ç¬¦ä¸²çš„æ¯ä¸€ä½ä¾æ¬¡è½¬æ¢ä¸ºå½“å‰ç»“æœçš„10å€åŠ ä¸Šè¯¥ä½æ•°å­—ï¼Œç„¶åç«‹å³å–æ¨¡ã€‚</li><li><strong>é€†å…ƒè®¡ç®—</strong>ï¼šå½“æ¨¡æ•°ä¸ºè´¨æ•°æ—¶ï¼Œå¯ä»¥åˆ©ç”¨è´¹é©¬å°å®šç†å¿«é€Ÿè®¡ç®—é€†å…ƒï¼ˆå³ apâˆ’2modâ€‰â€‰p<em>a**p</em>âˆ’2mod<em>p</em>ï¼‰ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(logâ¡p)<em>O</em>(log<em>p</em>)ã€‚</li><li><strong>è¾“å…¥å¤„ç†</strong>ï¼šæ³¨æ„è¾“å…¥çš„æ•°å€¼èŒƒå›´ï¼Œä½¿ç”¨å­—ç¬¦ä¸²å¤„ç†å¤§æ•°ï¼Œå¹¶ç¡®ä¿å¤„ç†è¿‡ç¨‹ä¸­ä¸ä¼šæº¢å‡ºã€‚</li><li><strong>è¾¹ç•Œæ¡ä»¶</strong>ï¼šé¢˜ç›®ä¿è¯è¾“å…¥çš„ a<em>a</em> å’Œ b<em>b</em> ä¸åŒæ—¶æ˜¯æ¨¡æ•°çš„å€æ•°ï¼Œå› æ­¤å½“ b<em>b</em> çš„æ¨¡ä¸º0æ—¶ï¼Œç›´æ¥åˆ¤å®šæ— è§£ã€‚</li></ol><p>è¯¥é—®é¢˜ç»“åˆäº†æ•°è®ºä¸­çš„æ¨¡è¿ç®—å’Œé€†å…ƒçŸ¥è¯†ï¼ŒåŒæ—¶è€ƒå¯Ÿäº†å¤„ç†å¤§æ•°çš„æŠ€å·§ï¼Œç»¼åˆåº”ç”¨äº†å¤šç§ç®—æ³•å’Œç¼–ç¨‹æŠ€æœ¯ã€‚</p><h2 id="äºŒ-Minimal-Coprime"><a href="#äºŒ-Minimal-Coprime" class="headerlink" title="äºŒ.Minimal Coprime"></a>äºŒ.Minimal Coprime</h2><h3 id="1-å¯¹åº”æ€è·¯-1"><a href="#1-å¯¹åº”æ€è·¯-1" class="headerlink" title="1.å¯¹åº”æ€è·¯"></a>1.å¯¹åº”æ€è·¯</h3><p>å¯¹äºæ¯ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾å‡ºåŒºé—´ [l, r] å†…æ‰€æœ‰çš„æœ€å°äº’è´¨åŒºé—´ã€‚ç”±äºæˆ‘ä»¬è¦åˆ¤æ–­åŒºé—´æ˜¯å¦æ˜¯æœ€å°äº’è´¨ï¼Œå®é™…æ“ä½œæ—¶å¯ä»¥è€ƒè™‘ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ol><li>å¦‚æœ l &#x3D;&#x3D; rï¼Œé‚£ä¹ˆåªæœ‰ä¸€ä¸ªå•ä¸€çš„æ•°ï¼Œéœ€è¦æ£€æŸ¥è¯¥æ•°æ˜¯å¦ä¸è‡ªèº«äº’è´¨ï¼Œæ˜¾ç„¶ï¼Œå¯¹äºä»»æ„æ•° aï¼Œ<code>gcd(a, a) â‰  1</code>ï¼Œå› æ­¤è¿™ç±»åŒºé—´æ— æ³•æ„æˆäº’è´¨åŒºé—´ã€‚</li><li>å¦‚æœ l !&#x3D; rï¼Œåˆ™è¦åˆ¤æ–­åŒºé—´ [l, r] å†…æ¯ä¸€ä¸ªå•å…ƒç´ å­åŒºé—´æ˜¯å¦äº’è´¨ï¼ŒåŒæ—¶å¯¹äºæ›´å¤§çš„åŒºé—´æ˜¯å¦æ˜¯æœ€å°äº’è´¨åŒºé—´ã€‚</li></ol><h3 id="2-ä»£ç "><a href="#2-ä»£ç " class="headerlink" title="2.ä»£ç "></a>2.ä»£ç </h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;bits/stdc++.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">#define int long long</span><br><span class="line">#define endl &#x27;\n&#x27;</span><br><span class="line">const int N = 1e6 + 10,mod = 19260817,INT = 1e17,M = 5e6;</span><br><span class="line"> </span><br><span class="line">typedef pair&lt;int,int&gt; PII;</span><br><span class="line"> </span><br><span class="line">int qmi(int a,int k)&#123;</span><br><span class="line">int res = 1;</span><br><span class="line">while(k)&#123;</span><br><span class="line">if(k&amp;1) res = res * a % mod;</span><br><span class="line">a = a * a % mod; </span><br><span class="line">k &gt;&gt;= 1;</span><br><span class="line">&#125;</span><br><span class="line">return res;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">void slove()&#123;</span><br><span class="line">string a,b;</span><br><span class="line">cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">int na = 0,nb = 0;</span><br><span class="line">for(auto c:a)&#123;</span><br><span class="line">na = (na * 10 + c - &#x27;0&#x27;) % mod;</span><br><span class="line">&#125;</span><br><span class="line">for(auto c:b) nb = (nb * 10 + c - &#x27;0&#x27;) % mod;</span><br><span class="line"></span><br><span class="line">cout &lt;&lt; na * qmi(nb,mod - 2) % mod &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">signed main()</span><br><span class="line">&#123;</span><br><span class="line">ios::sync_with_stdio(false);cin.tie(nullptr);</span><br><span class="line">int T = 1;</span><br><span class="line">while(T--) slove();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-å­¦ä¹ æ€»ç»“-1"><a href="#3-å­¦ä¹ æ€»ç»“-1" class="headerlink" title="3.å­¦ä¹ æ€»ç»“"></a>3.å­¦ä¹ æ€»ç»“</h3><p><strong>æœ€å¤§å…¬çº¦æ•° (gcd)</strong>ï¼šåœ¨è¿™é“é¢˜ä¸­ï¼Œæˆ‘ä»¬é¢‘ç¹ä½¿ç”¨ <code>gcd</code> æ¥åˆ¤æ–­ä¸¤ä¸ªæ•°æ˜¯å¦äº’è´¨ã€‚é€šè¿‡è¾—è½¬ç›¸é™¤æ³•ï¼Œå¯ä»¥æœ‰æ•ˆåœ°æ±‚å‡ºä¸¤ä¸ªæ•°çš„æœ€å¤§å…¬çº¦æ•°ï¼Œè¿›è€Œåˆ¤æ–­å®ƒä»¬æ˜¯å¦äº’è´¨ã€‚</p><p><strong>åŒºé—´å†…äº’è´¨åˆ¤æ–­</strong>ï¼šå¯¹äºæ¯ä¸€ä¸ªå­åŒºé—´ï¼Œéœ€è¦æ£€æŸ¥å®ƒä»¬æ˜¯å¦äº’è´¨ï¼Œå¹¶ä¸”åˆ¤æ–­æ˜¯å¦åŒ…å«æ›´å°çš„äº’è´¨å­åŒºé—´ã€‚è¿™è¦æ±‚æˆ‘ä»¬åœ¨æ±‚è§£æ—¶è¦å°å¿ƒå¤„ç†æ¯ä¸ªåŒºé—´ï¼Œé¿å…é—æ¼ã€‚</p><p><strong>æœ€å°äº’è´¨åŒºé—´çš„åˆ¤å®š</strong>ï¼šæœ€å°äº’è´¨åŒºé—´éœ€è¦æ»¡è¶³ä¸åŒ…å«ä»»ä½•å…¶ä»–äº’è´¨åŒºé—´ï¼Œè¿™ä¸€ç‚¹æ˜¯è§£é¢˜çš„å…³é”®ã€‚é€šè¿‡éå†åŒºé—´çš„æ‰€æœ‰å­åŒºé—´ï¼Œå¹¶ç¡®ä¿å®ƒä»¬ä¸å«æ›´å°çš„äº’è´¨åŒºé—´ï¼Œå¯ä»¥ç¡®ä¿æ‰¾åˆ°æ‰€æœ‰æœ€å°äº’è´¨åŒºé—´ã€‚</p><p><strong>ä¼˜åŒ–</strong>ï¼šè™½ç„¶æœ¬è§£æ³•ç›´æ¥æš´åŠ›æšä¸¾æ‰€æœ‰åŒºé—´ï¼Œä½†è€ƒè™‘åˆ°é¢˜ç›®ä¸­åŒºé—´èŒƒå›´è¾ƒå¤§ï¼Œåº”è¯¥åœ¨å®é™…ä½¿ç”¨ä¸­è¿›è¡Œä¸€äº›ä¼˜åŒ–ï¼Œå¦‚å‰ªæç­‰ç­–ç•¥ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> practice </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Task 3</title>
      <link href="/2025/02/06/Task-3/"/>
      <url>/2025/02/06/Task-3/</url>
      
        <content type="html"><![CDATA[<h1 id="å¯’å‡ç¬¬ä¸‰è®²"><a href="#å¯’å‡ç¬¬ä¸‰è®²" class="headerlink" title="å¯’å‡ç¬¬ä¸‰è®²"></a>å¯’å‡ç¬¬ä¸‰è®²</h1><h2 id="ä¸€-priority-queue"><a href="#ä¸€-priority-queue" class="headerlink" title="ä¸€.priority queue"></a>ä¸€.priority queue</h2><h3 id="1-å¯¹åº”æ€è·¯"><a href="#1-å¯¹åº”æ€è·¯" class="headerlink" title="1.å¯¹åº”æ€è·¯"></a>1.å¯¹åº”æ€è·¯</h3><p>é¢˜ç›®è¦æ±‚å®ç°ä¸€ä¸ªä¼˜å…ˆé˜Ÿåˆ—ï¼Œæ”¯æŒæ’å…¥æ“ä½œ <code>insert(k)</code> å’Œæå–æœ€å¤§å…ƒç´ æ“ä½œ <code>extractMax</code>ã€‚åœ¨ C++ ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>priority_queue</code> æ¥å®ç°è¿™ä¸€ç»“æ„ã€‚<code>priority_queue</code> é»˜è®¤æ˜¯æœ€å¤§å †ï¼Œæ’å…¥æ“ä½œå°†å…ƒç´ æ·»åŠ åˆ°å †ä¸­ï¼Œè€Œæå–æ“ä½œè¿”å›å¹¶åˆ é™¤å †é¡¶çš„å…ƒç´ ã€‚</p><p>é¦–å…ˆï¼Œè¾“å…¥åŒ…å«å¤šä¸ªæ“ä½œï¼Œæ¯ä¸ªæ“ä½œå¯èƒ½æ˜¯ <code>insert k</code>ï¼ˆæ’å…¥æ•´æ•° kï¼‰ã€<code>extract</code>ï¼ˆæå–æœ€å¤§å…ƒç´ ï¼‰æˆ– <code>end</code>ï¼ˆç»“æŸè¾“å…¥ï¼‰ã€‚å¯¹äºæ¯ä¸ª <code>insert k</code> æ“ä½œï¼Œæˆ‘ä»¬å°†å…ƒç´ æ’å…¥åˆ°ä¼˜å…ˆé˜Ÿåˆ—ä¸­ã€‚å¯¹äºæ¯ä¸ª <code>extract</code> æ“ä½œï¼Œæˆ‘ä»¬ä»å †ä¸­æå–å¹¶è¾“å‡ºå½“å‰æœ€å¤§å€¼ã€‚</p><p>C++ çš„ <code>priority_queue</code> æ•°æ®ç»“æ„é»˜è®¤æŒ‰é™åºæ’åˆ—ï¼ˆå³æœ€å¤§å †ï¼‰ï¼Œå› æ­¤æ— éœ€é¢å¤–å¤„ç†å³å¯æ»¡è¶³é¢˜ç›®è¦æ±‚ã€‚ç¨‹åºé€šè¿‡å¾ªç¯è¯»å–æ“ä½œï¼Œé’ˆå¯¹ <code>insert</code> è¿›è¡Œå †æ’å…¥ï¼Œé’ˆå¯¹ <code>extract</code> è¿›è¡Œå †é¡¶å…ƒç´ æå–å¹¶è¾“å‡ºï¼Œç›´åˆ°é‡åˆ° <code>end</code> æ“ä½œåœæ­¢ã€‚</p><h3 id="2-ä»£ç "><a href="#2-ä»£ç " class="headerlink" title="2.ä»£ç "></a>2.ä»£ç </h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;queue&gt;</span><br><span class="line">#include &lt;string&gt;</span><br><span class="line">#include &lt;sstream&gt;</span><br><span class="line"></span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">struct Compare &#123;</span><br><span class="line">    bool operator()(int a, int b) &#123;</span><br><span class="line">        return a &lt; b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">    priority_queue&lt;int, vector&lt;int&gt;, Compare&gt; pq; </span><br><span class="line">    string line;</span><br><span class="line"></span><br><span class="line">    while (getline(cin, line)) &#123;</span><br><span class="line">        if (line.empty()) continue;</span><br><span class="line"></span><br><span class="line">        stringstream ss(line);</span><br><span class="line">        string command;</span><br><span class="line">        ss &gt;&gt; command;</span><br><span class="line"></span><br><span class="line">        if (command == &quot;insert&quot;) &#123;</span><br><span class="line">            int k;</span><br><span class="line">            ss &gt;&gt; k;</span><br><span class="line">            pq.push(k);</span><br><span class="line">        &#125; else if (command == &quot;extract&quot;) &#123;</span><br><span class="line">            if (!pq.empty()) &#123;</span><br><span class="line">                cout &lt;&lt; pq.top() &lt;&lt; endl; </span><br><span class="line">                pq.pop(); </span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else if (command == &quot;end&quot;) &#123;</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h3 id="3-å­¦ä¹ æ€»ç»“"><a href="#3-å­¦ä¹ æ€»ç»“" class="headerlink" title="3.å­¦ä¹ æ€»ç»“"></a>3.å­¦ä¹ æ€»ç»“</h3><p>é€šè¿‡å®ç°è¿™ä¸ªä¼˜å…ˆé˜Ÿåˆ—ï¼Œäº†è§£äº† C++ ä¸­ <code>priority_queue</code> çš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•ã€‚<code>priority_queue</code> ä½¿ç”¨æœ€å¤§å †ç»“æ„ï¼Œè‡ªåŠ¨ä¿è¯æ¯æ¬¡æå–çš„éƒ½æ˜¯å½“å‰æœ€å¤§å…ƒç´ ï¼Œå› æ­¤æ’å…¥å’Œæå–æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸º <code>O(log n)</code>ï¼Œéå¸¸é«˜æ•ˆã€‚æ­¤å¤–ï¼Œä½¿ç”¨ <code>priority_queue</code> è¿˜å¯ä»¥é¿å…æ‰‹åŠ¨ç»´æŠ¤å †ç»“æ„ï¼Œä»è€Œå‡å°‘äº†ç¨‹åºå¤æ‚åº¦ã€‚é€šè¿‡è¾“å…¥å’Œè¾“å‡ºæµçš„å¤„ç†ï¼Œæˆ‘ä¹Ÿæ›´æ·±å…¥åœ°ç†è§£äº†å¦‚ä½•é«˜æ•ˆå¤„ç†å¤§è§„æ¨¡æ•°æ®è¾“å…¥ã€‚ç‰¹åˆ«æ˜¯å¯¹äºé¢˜ç›®ä¸­é™åˆ¶çš„ 200 ä¸‡æ¬¡æ“ä½œï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿ç¨‹åºçš„è¾“å…¥è¾“å‡ºæ•ˆç‡ï¼Œå› æ­¤åº”è¯¥å°½é‡å‡å°‘ä¸å¿…è¦çš„æ“ä½œï¼Œä½¿ç”¨åˆé€‚çš„è¾“å…¥è¾“å‡ºæ–¹æ³•æé«˜ç¨‹åºæ€§èƒ½ã€‚</p><h2 id="STè¡¨-RMQé—®é¢˜"><a href="#STè¡¨-RMQé—®é¢˜" class="headerlink" title="STè¡¨&amp;&amp;RMQé—®é¢˜"></a>STè¡¨&amp;&amp;RMQé—®é¢˜</h2><h3 id="1-å¯¹åº”æ€è·¯-1"><a href="#1-å¯¹åº”æ€è·¯-1" class="headerlink" title="1.å¯¹åº”æ€è·¯"></a>1.å¯¹åº”æ€è·¯</h3><p>è¯¥ç¨‹åºåˆ©ç”¨ ST è¡¨è¿›è¡Œé™æ€åŒºé—´æœ€å¤§å€¼æŸ¥è¯¢ã€‚é¦–å…ˆï¼Œä½¿ç”¨ <code>preprocess</code> å‡½æ•°æ„å»º ST è¡¨ï¼Œé¢„å¤„ç†æ—¶é—´å¤æ‚åº¦ä¸º O(N log N)ã€‚<br>å¯¹äºæ¯ä¸ªæŸ¥è¯¢ï¼Œæˆ‘ä»¬åˆ©ç”¨å¯¹æ•°è¡¨ <code>log_table</code> é¢„è®¡ç®—æŸ¥è¯¢èŒƒå›´çš„æœ€ä¼˜åˆ†å—ï¼Œä½¿å¾—æŸ¥è¯¢å¤æ‚åº¦é™ä¸º O(1)ã€‚<br>é€šè¿‡ <code>read()</code> è¿›è¡Œé«˜æ•ˆè¾“å…¥ï¼Œå‡å°‘ IO æ—¶é—´ï¼Œé€‚ç”¨äºå¤§æ•°æ®é‡åœºæ™¯ã€‚</p><h3 id="2-ä»£ç -1"><a href="#2-ä»£ç -1" class="headerlink" title="2.ä»£ç "></a>2.ä»£ç </h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;vector&gt;</span><br><span class="line">#include &lt;cmath&gt;</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">const int MAX_N = 100000;</span><br><span class="line">const int LOG = 17;</span><br><span class="line">int st[MAX_N][LOG];</span><br><span class="line">int log_table[MAX_N + 1];</span><br><span class="line"></span><br><span class="line">inline int read() &#123;</span><br><span class="line">    int x = 0, f = 1;</span><br><span class="line">    char ch = getchar();</span><br><span class="line">    while (ch &lt; &#x27;0&#x27; || ch &gt; &#x27;9&#x27;) &#123;</span><br><span class="line">        if (ch == &#x27;-&#x27;) f = -1;</span><br><span class="line">        ch = getchar();</span><br><span class="line">    &#125;</span><br><span class="line">    while (ch &gt;= &#x27;0&#x27; &amp;&amp; ch &lt;= &#x27;9&#x27;) &#123;</span><br><span class="line">        x = x * 10 + ch - &#x27;0&#x27;;</span><br><span class="line">        ch = getchar();</span><br><span class="line">    &#125;</span><br><span class="line">    return x * f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void preprocess(const vector&lt;int&gt;&amp; arr, int n) &#123;</span><br><span class="line">    for (int i = 0; i &lt; n; i++) &#123;</span><br><span class="line">        st[i][0] = arr[i];</span><br><span class="line">    &#125;</span><br><span class="line">    for (int j = 1; (1 &lt;&lt; j) &lt;= n; j++) &#123;</span><br><span class="line">        for (int i = 0; i + (1 &lt;&lt; j) - 1 &lt; n; i++) &#123;</span><br><span class="line">            st[i][j] = max(st[i][j - 1], st[i + (1 &lt;&lt; (j - 1))][j - 1]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    log_table[1] = 0;</span><br><span class="line">    for (int i = 2; i &lt;= n; i++) &#123;</span><br><span class="line">        log_table[i] = log_table[i / 2] + 1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int query(int l, int r) &#123;</span><br><span class="line">    int j = log_table[r - l + 1];</span><br><span class="line">    return max(st[l][j], st[r - (1 &lt;&lt; j) + 1][j]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">    int n = read(), m = read();</span><br><span class="line">    vector&lt;int&gt; arr(n);</span><br><span class="line">    for (int i = 0; i &lt; n; i++) &#123;</span><br><span class="line">        arr[i] = read();</span><br><span class="line">    &#125;</span><br><span class="line">    preprocess(arr, n);</span><br><span class="line">    while (m--) &#123;</span><br><span class="line">        int l = read() - 1, r = read() - 1;</span><br><span class="line">        printf(&quot;%d\n&quot;, query(l, r));</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h3 id="3-å­¦ä¹ æ€»ç»“-1"><a href="#3-å­¦ä¹ æ€»ç»“-1" class="headerlink" title="3.å­¦ä¹ æ€»ç»“"></a>3.å­¦ä¹ æ€»ç»“</h3><ol><li>ST è¡¨é€‚ç”¨äºé™æ€æŸ¥è¯¢ï¼Œé¢„å¤„ç†ä»£ä»·è¾ƒé«˜ï¼Œä½†æŸ¥è¯¢æå¿«ã€‚</li><li>åˆ©ç”¨ <code>log_table</code> é¢„è®¡ç®—å¯¹æ•°å€¼å¯ä»¥å‡å°‘ <code>log</code> å‡½æ•°è°ƒç”¨ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚</li><li>å¿«é€Ÿè¾“å…¥ <code>read()</code> å¯æœ‰æ•ˆå‡å°‘æ—¶é—´å¼€é”€ï¼Œé€‚ç”¨äºé«˜å¼ºåº¦æ•°æ®ã€‚</li><li>ST è¡¨çš„æ ¸å¿ƒæ€æƒ³æ˜¯åˆ©ç”¨åŒºé—´çš„é‡å æ€§ï¼Œé€šè¿‡ <code>dp</code> æ–¹å¼é«˜æ•ˆå­˜å‚¨åŒºé—´ä¿¡æ¯</li></ol><h2 id="åˆå¹¶æœå­"><a href="#åˆå¹¶æœå­" class="headerlink" title="åˆå¹¶æœå­"></a>åˆå¹¶æœå­</h2><h3 id="1-å¯¹åº”æ€è·¯-2"><a href="#1-å¯¹åº”æ€è·¯-2" class="headerlink" title="1.å¯¹åº”æ€è·¯"></a>1.å¯¹åº”æ€è·¯</h3><p>æœ¬é¢˜å¯ä»¥é€šè¿‡å“ˆå¤«æ›¼æ ‘ï¼ˆHuffman Treeï¼‰çš„æ€æƒ³æ¥è§£å†³ï¼Œä½¿ç”¨æœ€å°å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰è¿›è¡Œè´ªå¿ƒåˆå¹¶ã€‚<br>æ¯æ¬¡å–å‡ºå½“å‰æœ€å°çš„ä¸¤å †æœå­è¿›è¡Œåˆå¹¶ï¼Œåˆå¹¶çš„ä»£ä»·æ˜¯ä¸¤è€…ä¹‹å’Œï¼Œå¹¶å°†æ–°å †é‡æ–°åŠ å…¥ä¼˜å…ˆé˜Ÿåˆ—ã€‚<br>è¿™ä¸ªè¿‡ç¨‹æŒç»­ n-1 æ¬¡ï¼Œæœ€ç»ˆä¼˜å…ˆé˜Ÿåˆ—ä¸­åªå‰©ä¸‹ä¸€å †ï¼Œç´¯åŠ æ‰€æœ‰åˆå¹¶çš„ä»£ä»·ï¼Œå³ä¸ºæœ€å°çš„ä½“åŠ›è€—è´¹ã€‚<br>ç”±äºä½¿ç”¨äº†æœ€å°å †ï¼Œæ¯æ¬¡æ’å…¥ä¸åˆ é™¤çš„å¤æ‚åº¦æ˜¯ O(log n)ï¼Œæ•´ä½“å¤æ‚åº¦ä¸º O(n log n)ã€‚</p><h3 id="2-ä»£ç -2"><a href="#2-ä»£ç -2" class="headerlink" title="2.ä»£ç "></a>2.ä»£ç </h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;queue&gt;</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">inline int read() &#123;</span><br><span class="line">    int x = 0, f = 1;</span><br><span class="line">    char ch = getchar();</span><br><span class="line">    while (ch &lt; &#x27;0&#x27; || ch &gt; &#x27;9&#x27;) &#123;</span><br><span class="line">        if (ch == &#x27;-&#x27;) f = -1;</span><br><span class="line">        ch = getchar();</span><br><span class="line">    &#125;</span><br><span class="line">    while (ch &gt;= &#x27;0&#x27; &amp;&amp; ch &lt;= &#x27;9&#x27;) &#123;</span><br><span class="line">        x = x * 10 + ch - &#x27;0&#x27;;</span><br><span class="line">        ch = getchar();</span><br><span class="line">    &#125;</span><br><span class="line">    return x * f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">    int n = read();</span><br><span class="line">    priority_queue&lt;int, vector&lt;int&gt;, greater&lt;int&gt;&gt; pq;</span><br><span class="line">    for (int i = 0; i &lt; n; i++) &#123;</span><br><span class="line">        pq.push(read());</span><br><span class="line">    &#125;</span><br><span class="line">    int total_cost = 0;</span><br><span class="line">    while (pq.size() &gt; 1) &#123;</span><br><span class="line">        int a = pq.top(); pq.pop();</span><br><span class="line">        int b = pq.top(); pq.pop();</span><br><span class="line">        int cost = a + b;</span><br><span class="line">        total_cost += cost;</span><br><span class="line">        pq.push(cost);</span><br><span class="line">    &#125;</span><br><span class="line">    printf(&quot;%d\n&quot;, total_cost);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="3-å­¦ä¹ æ€»ç»“-2"><a href="#3-å­¦ä¹ æ€»ç»“-2" class="headerlink" title="3.å­¦ä¹ æ€»ç»“"></a>3.å­¦ä¹ æ€»ç»“</h3><ol><li>æœ¬é¢˜æ˜¯å…¸å‹çš„è´ªå¿ƒç®—æ³•åº”ç”¨ï¼Œé€šè¿‡å±€éƒ¨æœ€ä¼˜ï¼ˆæ¯æ¬¡åˆå¹¶æœ€å°çš„ä¸¤å †ï¼‰è¾¾åˆ°å…¨å±€æœ€ä¼˜ã€‚</li><li>æœ€å°å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰æ˜¯ä¸€ç§æœ‰æ•ˆçš„æ•°æ®ç»“æ„ï¼Œé€‚ç”¨äºå¤„ç†åŠ¨æ€é›†åˆä¸­çš„æœ€å°å€¼é—®é¢˜ã€‚</li><li>å“ˆå¤«æ›¼æ ‘çš„æ„é€ ä¸æœ¬é¢˜ç±»ä¼¼ï¼Œå®ƒç”¨äºæœ€ä¼˜å‰ç¼€ç¼–ç é—®é¢˜ï¼Œå…·æœ‰å¹¿æ³›åº”ç”¨ã€‚</li><li>ç”±äº n æœ€å¤§ä¸º 10000ï¼Œä½¿ç”¨ O(n log n) å¤æ‚åº¦çš„æ–¹æ³•æ˜¯åˆç†å¯è¡Œçš„ï¼Œè‹¥ç”¨ O(n^2) çš„æ–¹æ³•ä¼šè¶…æ—¶ã€‚</li><li>é€šè¿‡ <code>priority_queue</code> çš„ <code>greater&lt;int&gt;</code> å®ç°æœ€å°å †ï¼Œæé«˜ä»£ç å¯è¯»æ€§å’Œæ•ˆç‡ã€‚</li></ol><h2 id="å››-çº¦ç‘Ÿå¤«é—®é¢˜"><a href="#å››-çº¦ç‘Ÿå¤«é—®é¢˜" class="headerlink" title="å››.çº¦ç‘Ÿå¤«é—®é¢˜"></a>å››.çº¦ç‘Ÿå¤«é—®é¢˜</h2><h3 id="1-å¯¹åº”æ€è·¯-3"><a href="#1-å¯¹åº”æ€è·¯-3" class="headerlink" title="1.å¯¹åº”æ€è·¯"></a>1.å¯¹åº”æ€è·¯</h3><p>è¯¥é¢˜æ˜¯ç»å…¸çš„çº¦ç‘Ÿå¤«ç¯é—®é¢˜ã€‚æˆ‘ä»¬é€šè¿‡æ¨¡æ‹ŸæŠ¥æ•°è¿‡ç¨‹æ¥è§£å†³ï¼Œä½¿ç”¨åŒç«¯é˜Ÿåˆ—ï¼ˆ<code>deque</code>ï¼‰æ¥æ¨¡æ‹Ÿæ¯æ¬¡å‡ºåœˆçš„æ“ä½œã€‚é¦–å…ˆå°†æ‰€æœ‰äººçš„ç¼–å·ä¾æ¬¡åŠ å…¥é˜Ÿåˆ—ï¼Œæ¯æ¬¡å°†å‰ mmm ä¸ªäººæŠ¥æ•°ï¼Œç¬¬ mmm ä¸ªäººå‡ºåˆ—ï¼Œå†ä»ä¸‹ä¸€ä¸ªäººå¼€å§‹ç»§ç»­æŠ¥æ•°ã€‚è¯¥è¿‡ç¨‹é‡å¤ç›´åˆ°æ‰€æœ‰äººéƒ½å‡ºåˆ—ã€‚é€šè¿‡é˜Ÿåˆ—çš„ <code>push_back</code> å’Œ <code>pop_front</code> æ“ä½œæ¥æ¨¡æ‹Ÿå¾ªç¯æŠ¥æ•°ï¼Œä¿è¯æ¯ä¸ªå‡ºåœˆäººçš„ç¼–å·æŒ‰é¡ºåºè¾“å‡ºã€‚</p><h3 id="2-ä»£ç -3"><a href="#2-ä»£ç -3" class="headerlink" title="2.ä»£ç "></a>2.ä»£ç </h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;deque&gt;</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">    int n, m;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    deque&lt;int&gt; people;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    for (int i = 1; i &lt;= n; i++) &#123;</span><br><span class="line">        people.push_back(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    while (!people.empty()) &#123;</span><br><span class="line">        </span><br><span class="line">        for (int i = 1; i &lt; m; i++) &#123;</span><br><span class="line">            people.push_back(people.front());</span><br><span class="line">            people.pop_front();</span><br><span class="line">        &#125;</span><br><span class="line">      </span><br><span class="line">        cout &lt;&lt; people.front() &lt;&lt; &quot; &quot;;</span><br><span class="line">        people.pop_front();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h3 id="å­¦ä¹ æ€»ç»“"><a href="#å­¦ä¹ æ€»ç»“" class="headerlink" title="å­¦ä¹ æ€»ç»“"></a>å­¦ä¹ æ€»ç»“</h3><p><strong>çº¦ç‘Ÿå¤«ç¯é—®é¢˜</strong>ï¼šæ˜¯ç»å…¸çš„åŠ¨æ€ç»“æ„é—®é¢˜ï¼Œä½¿ç”¨é˜Ÿåˆ—æ¨¡æ‹Ÿèƒ½å¤Ÿæœ‰æ•ˆè§£å†³ã€‚</p><p><strong>é˜Ÿåˆ—æ“ä½œ</strong>ï¼šé˜Ÿåˆ—çš„ <code>push_back</code> å’Œ <code>pop_front</code> æ“ä½œæ—¶é—´å¤æ‚åº¦ä¸º O(1)ï¼Œé€‚åˆè¿›è¡Œå¾ªç¯æ¨¡æ‹Ÿã€‚</p><p><strong>å¾ªç¯è¿‡ç¨‹ç†è§£</strong>ï¼šé€šè¿‡ç†è§£æ¯æ¬¡ä»é˜Ÿåˆ—ä¸­ç§»é™¤ç¬¬ mmm ä¸ªäººï¼Œå¹¶å°†ä¸‹ä¸€ä¸ªäººé‡æ–°ä»å¤´å¼€å§‹æŠ¥æ•°ï¼Œå¯ä»¥è½»æ¾è§£å†³é—®é¢˜ã€‚</p><p><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šå¯¹äº n å’Œ m è¾ƒå°çš„æƒ…å†µï¼ŒO(n * m) çš„æ—¶é—´å¤æ‚åº¦æ˜¯å¯è¡Œçš„ã€‚</p><p><strong>åº”ç”¨èŒƒå›´</strong>ï¼šè¿™ç§æ–¹æ³•é€‚ç”¨äºç±»ä¼¼çš„å¾ªç¯æ’åˆ—é—®é¢˜ï¼Œç†è§£å…¶å®ç°æ–¹å¼å¯¹äºè§£å†³å…¶ä»–ç±»ä¼¼é—®é¢˜éå¸¸æœ‰å¸®åŠ©ã€‚</p><h2 id="äº”-Look-Up-S"><a href="#äº”-Look-Up-S" class="headerlink" title="äº”.Look Up S"></a>äº”.Look Up S</h2><h3 id="1-å¯¹åº”æ€è·¯-4"><a href="#1-å¯¹åº”æ€è·¯-4" class="headerlink" title="1.å¯¹åº”æ€è·¯"></a>1.å¯¹åº”æ€è·¯</h3><p>æœ¬é¢˜çš„æ ¸å¿ƒåœ¨äºæŸ¥æ‰¾æ¯ä¸ªå¥¶ç‰›çš„å³ä¾§ç¬¬ä¸€ä¸ªæ¯”å¥¹é«˜çš„å¥¶ç‰›ã€‚é€šè¿‡ä½¿ç”¨æ ˆï¼ˆstackï¼‰æ•°æ®ç»“æ„ï¼Œå¯ä»¥é«˜æ•ˆåœ°ç»´æŠ¤ä¸€ä¸ªé€’å‡çš„åºåˆ—ã€‚æ¯æ¬¡é‡åˆ°ä¸€ä¸ªå¥¶ç‰›æ—¶ï¼Œå°†å…¶ä¸æ ˆé¡¶çš„å¥¶ç‰›è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœæ ˆé¡¶å¥¶ç‰›çš„èº«é«˜ä¸å¤§äºå½“å‰å¥¶ç‰›ï¼Œå°±å°†å…¶å¼¹å‡ºï¼Œç›´åˆ°æ ˆé¡¶å¥¶ç‰›çš„èº«é«˜å¤§äºå½“å‰å¥¶ç‰›æˆ–æ ˆä¸ºç©ºã€‚æ­¤æ—¶æ ˆé¡¶å…ƒç´ å³ä¸ºå½“å‰å¥¶ç‰›çš„ä»°æœ›å¯¹è±¡ã€‚</p><h3 id="2-ä»£ç -4"><a href="#2-ä»£ç -4" class="headerlink" title="2.ä»£ç "></a>2.ä»£ç </h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;vector&gt;</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">const int MAXN = 1e5 + 5;</span><br><span class="line">int h[MAXN];</span><br><span class="line">int ans[MAXN];</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">    int n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    for (int i = 1; i &lt;= n; ++i) &#123;</span><br><span class="line">        cin &gt;&gt; h[i];</span><br><span class="line">    &#125;</span><br><span class="line">    vector&lt;int&gt; stk;</span><br><span class="line">    for (int i = n; i &gt;= 1; --i) &#123;</span><br><span class="line">        while (!stk.empty() &amp;&amp; h[stk.back()] &lt;= h[i]) &#123;</span><br><span class="line">            stk.pop_back();</span><br><span class="line">        &#125;</span><br><span class="line">        ans[i] = stk.empty() ? 0 : stk.back();</span><br><span class="line">        stk.push_back(i);</span><br><span class="line">    &#125;</span><br><span class="line">    for (int i = 1; i &lt;= n; ++i) &#123;</span><br><span class="line">        cout &lt;&lt; ans[i] &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="3-å­¦ä¹ æ€»ç»“-3"><a href="#3-å­¦ä¹ æ€»ç»“-3" class="headerlink" title="3.å­¦ä¹ æ€»ç»“"></a>3.å­¦ä¹ æ€»ç»“</h3><p><strong>æ ˆçš„åº”ç”¨</strong>ï¼šæœ¬é¢˜è¿ç”¨äº†æ ˆæ¥è§£å†³æŸ¥æ‰¾â€œå³ä¾§ç¬¬ä¸€ä¸ªæ›´å¤§å…ƒç´ â€çš„é—®é¢˜ã€‚æ ˆéå¸¸é€‚åˆè§£å†³é€’å¢&#x2F;é€’å‡é—®é¢˜ï¼Œèƒ½å¤Ÿé¿å…ä¸å¿…è¦çš„é‡å¤è®¡ç®—ã€‚</p><p><strong>æ—¶é—´å¤æ‚åº¦ä¼˜åŒ–</strong>ï¼šé€šè¿‡æ ˆçš„æ–¹å¼ï¼Œæ¯ä¸ªå¥¶ç‰›çš„èº«é«˜æœ€å¤šå…¥æ ˆå’Œå‡ºæ ˆä¸€æ¬¡ï¼Œæ•´ä½“æ—¶é—´å¤æ‚åº¦ä¸º O(N)ï¼Œæ»¡è¶³å¤§è§„æ¨¡æ•°æ®çš„éœ€æ±‚ã€‚</p><p><strong>è´ªå¿ƒç­–ç•¥</strong>ï¼šæ ˆçš„ä½¿ç”¨ä½“ç°äº†è´ªå¿ƒç­–ç•¥ï¼Œé€šè¿‡é€æ­¥æ‰¾å‡ºæœ€ä¼˜è§£ã€‚æ¯æ¬¡éƒ½ä¿è¯æ ˆä¸­çš„å¥¶ç‰›æŒ‰é€’å‡é¡ºåºæ’åˆ—ï¼Œèƒ½å¿«é€Ÿæ‰¾åˆ°æ¯ä¸ªå¥¶ç‰›çš„ç¬¬ä¸€ä¸ªä»°æœ›å¯¹è±¡ã€‚</p><p><strong>è§£å†³ç±»ä¼¼é—®é¢˜</strong>ï¼šæŒæ¡æ ˆçš„åº”ç”¨å¯ä»¥è§£å†³è®¸å¤šç±»ä¼¼çš„â€œå¯»æ‰¾ä¸‹ä¸€ä¸ªæ›´å¤§&#x2F;å°å…ƒç´ â€ç±»å‹çš„é—®é¢˜ã€‚</p><h2 id="äº”-å›½æ——è®¡åˆ’"><a href="#äº”-å›½æ——è®¡åˆ’" class="headerlink" title="äº”.å›½æ——è®¡åˆ’"></a>äº”.å›½æ——è®¡åˆ’</h2><h3 id="1-å¯¹åº”æ€è·¯-5"><a href="#1-å¯¹åº”æ€è·¯-5" class="headerlink" title="1.å¯¹åº”æ€è·¯"></a>1.å¯¹åº”æ€è·¯</h3><ol><li><p><strong>åŒºé—´è½¬åŒ–</strong>ï¼š</p><ul><li>æ¯ä¸ªè¾¹é˜²æˆ˜å£«å¸¸é©»ä¸¤ä¸ªè¾¹é˜²ç«™ <code>C_i</code> å’Œ <code>D_i</code>ï¼Œå…¶å¥”è¢­åŒºé—´ä¸ºä» <code>C_i</code> åˆ° <code>D_i</code>ã€‚å¦‚æœ <code>C_i &gt; D_i</code>ï¼Œè¯´æ˜è¯¥åŒºé—´è·¨è¶Šäº†è¾¹å¢ƒï¼Œéœ€è¦åŠ ä¸Šè¾¹å¢ƒçš„æ€»é•¿åº¦ <code>M</code>ï¼Œè¿™æ ·å°±èƒ½ç¡®ä¿æ‰€æœ‰åŒºé—´éƒ½æ˜¯çº¿æ€§åŒºé—´ï¼Œæ–¹ä¾¿åç»­å¤„ç†ã€‚</li></ul><p><strong>æ’åº</strong>ï¼š</p><ul><li>ç”±äºåŒºé—´è¦†ç›–é—®é¢˜é€šå¸¸éœ€è¦æŒ‰é¡ºåºå¤„ç†ï¼Œæ‰€æœ‰è¾¹é˜²æˆ˜å£«çš„å¥”è¢­åŒºé—´æŒ‰ç…§å·¦ç«¯ç‚¹ <code>l</code> æ’åºã€‚æ’åºåçš„æ•°ç»„ä½¿å¾—æˆ‘ä»¬å¯ä»¥æ–¹ä¾¿åœ°é€ä¸€å¤„ç†æ¯ä¸ªè¾¹é˜²æˆ˜å£«ï¼Œå¹¶è®¡ç®—å‡ºæœ€å°‘éœ€è¦å¤šå°‘æˆ˜å£«æ¥è¦†ç›–è¾¹å¢ƒã€‚</li></ul><p><strong>åŠ¨æ€è§„åˆ’å’Œè·³è·ƒæ³•</strong>ï¼š</p><ul><li>é‡‡ç”¨åŠ¨æ€è§„åˆ’æ¥è§£å†³æ¯ä¸ªè¾¹é˜²æˆ˜å£«è¦†ç›–çš„æœ€è¿œåŒºé—´é—®é¢˜ã€‚é€šè¿‡äºŒåˆ†æŸ¥æ‰¾ï¼Œæ‰¾åˆ°æ¯ä¸ªæˆ˜å£«èƒ½è¦†ç›–çš„æœ€è¿œä½ç½®ï¼Œè®°å½•åœ¨äºŒç»´æ•°ç»„ <code>go</code> ä¸­ã€‚<code>go[i][0]</code> å­˜å‚¨æˆ˜å£« <code>i</code> è¦†ç›–åŒºé—´çš„æœ€è¿œæˆ˜å£« <code>k</code> çš„ä¸‹æ ‡ã€‚ä¸ºäº†æ›´é«˜æ•ˆåœ°æŸ¥è¯¢æœ€å¤§è¦†ç›–ï¼Œä»£ç é€šè¿‡å¤šçº§è·³è·ƒçš„æ–¹å¼ï¼Œæ„å»ºäº† <code>go</code> æ•°ç»„ï¼Œå¹¶é€šè¿‡åŠ¨æ€è§„åˆ’å®ç°å¿«é€ŸæŸ¥è¯¢ã€‚</li></ul><p><strong>æŸ¥è¯¢æœ€å°æˆ˜å£«æ•°é‡</strong>ï¼š</p><ul><li>åœ¨æŸ¥è¯¢æ¯ä¸ªæˆ˜å£«å¿…é¡»å‚ä¸çš„å‰æä¸‹ï¼Œæˆ‘ä»¬ä»è¯¥æˆ˜å£«çš„èµ·å§‹ä½ç½®å¼€å§‹ï¼Œä¾æ¬¡æ‰¾åˆ°èƒ½å¤Ÿè¦†ç›–åŒºé—´çš„æœ€è¿œæˆ˜å£«ï¼Œé€šè¿‡äºŒåˆ†æŸ¥æ‰¾çš„æ–¹å¼è¿­ä»£è·³è·ƒï¼Œæœ€åè®¡ç®—å‡ºæœ€å°‘éœ€è¦çš„æˆ˜å£«æ•°é‡ã€‚</li></ul><p><strong>è¾“å‡ºç»“æœ</strong>ï¼š</p><ul><li>å¯¹äºæ¯ä¸ªæˆ˜å£«ï¼Œè¾“å‡ºå¿…é¡»å‚ä¸çš„å‰æä¸‹ï¼Œæœ€å°‘éœ€è¦å¤šå°‘ä¸ªæˆ˜å£«æ¥è¦†ç›–æ•´ä¸ªè¾¹å¢ƒçº¿ã€‚</li></ul></li></ol><h3 id="2-ä»£ç -5"><a href="#2-ä»£ç -5" class="headerlink" title="2.ä»£ç "></a>2.ä»£ç </h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;cstdio&gt;</span><br><span class="line">#include &lt;cstring&gt;</span><br><span class="line">#include &lt;cmath&gt;</span><br><span class="line">#include &lt;cstdlib&gt;</span><br><span class="line">#include &lt;algorithm&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">int n, m, res[200005];</span><br><span class="line">struct soldier &#123;</span><br><span class="line">int id, l, r;</span><br><span class="line">&#125; s[400005];</span><br><span class="line">int cmp(soldier a, soldier b)</span><br><span class="line">&#123;</span><br><span class="line">return a.l &lt; b.l; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int go[400005][20];</span><br><span class="line"></span><br><span class="line">void pre()</span><br><span class="line">&#123;</span><br><span class="line">for(int i = 1, p = i; i &lt;= 2 * n; i++) &#123;</span><br><span class="line">while(p &lt;= 2 * n &amp;&amp; s[p].l &lt;= s[i].r)</span><br><span class="line">p++;</span><br><span class="line">int pos = p - 1;</span><br><span class="line">go[i][0] = pos;</span><br><span class="line">&#125;</span><br><span class="line">for(int i = 1; i &lt; 20; i++) &#123;</span><br><span class="line">for(int j = 1; j &lt;= 2 * n; j++) &#123;</span><br><span class="line">go[j][i] = go[go[j][i - 1]][i - 1];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">void search(int k)</span><br><span class="line">&#123;</span><br><span class="line">int lmt = s[k].l + m, ans = 1, p = k;</span><br><span class="line">for(int i = 19; i &gt;= 0; i--) &#123;</span><br><span class="line">if(go[k][i] != 0 &amp;&amp; s[go[k][i]].r &lt; lmt) &#123;</span><br><span class="line">ans += (1 &lt;&lt; i);</span><br><span class="line">k = go[k][i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">res[s[p].id] = ans + 1;</span><br><span class="line">&#125;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">for(int i = 1; i &lt;= n; i++) &#123;</span><br><span class="line">cin &gt;&gt; s[i].l &gt;&gt; s[i].r;</span><br><span class="line">if(s[i].r &lt; s[i].l)</span><br><span class="line">s[i].r += m;</span><br><span class="line">s[i].id = i;</span><br><span class="line">&#125;</span><br><span class="line">sort(s + 1, s + 1 + n, cmp);</span><br><span class="line">for(int i = 1; i &lt;= n; i++) &#123;</span><br><span class="line">s[i + n] = s[i];</span><br><span class="line">s[i + n].l = s[i].l + m;</span><br><span class="line">s[i + n].r = s[i].r + m;</span><br><span class="line">&#125;</span><br><span class="line">pre();</span><br><span class="line">for(int i = 1; i &lt;= n; i++)</span><br><span class="line">search(i);</span><br><span class="line">for(int i = 1; i &lt;= n; i++)</span><br><span class="line">cout &lt;&lt; res[i] &lt;&lt; &quot; &quot;;</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h3 id="å­¦ä¹ æ€»ç»“-1"><a href="#å­¦ä¹ æ€»ç»“-1" class="headerlink" title="å­¦ä¹ æ€»ç»“"></a>å­¦ä¹ æ€»ç»“</h3><p>è¿™æ®µä»£ç å®ç°äº†ä¸€ä¸ªç»å…¸çš„åŒºé—´è¦†ç›–é—®é¢˜ï¼Œæ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡æ’åºå’ŒåŠ¨æ€è§„åˆ’æ¥é«˜æ•ˆåœ°è§£å†³è¦†ç›–åŒºé—´çš„æœ€å°è¾¹é˜²æˆ˜å£«æ•°é‡ã€‚å…·ä½“åšæ³•æ˜¯å°†æ‰€æœ‰çš„åŒºé—´è½¬åŒ–æˆçº¿æ€§åŒºé—´ï¼Œä½¿ç”¨æ’åºä¿è¯è¦†ç›–çš„é¡ºåºæ€§ï¼Œå†é€šè¿‡äºŒåˆ†æŸ¥æ‰¾å’ŒåŠ¨æ€è§„åˆ’çš„ç»“åˆï¼Œä¼˜åŒ–æŸ¥è¯¢æ•ˆç‡ã€‚è¿™ä¸ªæ€è·¯å¯¹äºè§£å†³ç±»ä¼¼çš„åŒºé—´è¦†ç›–é—®é¢˜éå¸¸æœ‰æ•ˆï¼Œå°¤å…¶æ˜¯åœ¨å¤§è§„æ¨¡æ•°æ®è¾“å…¥æ—¶ï¼Œèƒ½å¤Ÿæ˜¾è‘—å‡å°‘è®¡ç®—å¤æ‚åº¦ã€‚é€šè¿‡åˆç†ä½¿ç”¨è·³è·ƒè¡¨å’ŒäºŒåˆ†æŸ¥æ‰¾ï¼Œä»£ç å®ç°äº†è¾ƒé«˜çš„æ•ˆç‡ï¼Œæ˜¯å­¦ä¹ ç®—æ³•è®¾è®¡å’Œä¼˜åŒ–çš„é‡è¦æ¡ˆä¾‹ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Task 2</title>
      <link href="/2025/02/06/Task-2/"/>
      <url>/2025/02/06/Task-2/</url>
      
        <content type="html"><![CDATA[<h1 id="å¯’å‡ç¬¬äºŒè®²-â€œäºŒåˆ†â€"><a href="#å¯’å‡ç¬¬äºŒè®²-â€œäºŒåˆ†â€" class="headerlink" title="å¯’å‡ç¬¬äºŒè®²:â€œäºŒåˆ†â€"></a>å¯’å‡ç¬¬äºŒè®²:â€œäºŒåˆ†â€</h1><h2 id="ä¸€-äºŒåˆ†æŸ¥æ‰¾"><a href="#ä¸€-äºŒåˆ†æŸ¥æ‰¾" class="headerlink" title="ä¸€.äºŒåˆ†æŸ¥æ‰¾"></a>ä¸€.äºŒåˆ†æŸ¥æ‰¾</h2><h3 id="1-å¯¹åº”æ€è·¯"><a href="#1-å¯¹åº”æ€è·¯" class="headerlink" title="1.å¯¹åº”æ€è·¯"></a>1.å¯¹åº”æ€è·¯</h3><p>è¿™ä¸ªé—®é¢˜çš„è¦æ±‚æ˜¯é€šè¿‡äºŒåˆ†æŸ¥æ‰¾ï¼Œåœ¨ä¸€ä¸ªå·²ç»æŒ‰å‡åºæ’åˆ—çš„æ•´æ•°åºåˆ—ä¸­æŸ¥æ‰¾æ˜¯å¦åŒ…å«æŸ¥è¯¢çš„æ•´æ•°ã€‚å¯¹äºæ¯æ¬¡æŸ¥è¯¢ï¼Œè‹¥è¯¥æ•´æ•°åœ¨åºåˆ—ä¸­å‡ºç°ï¼Œåˆ™è¾“å‡º â€œYesâ€ï¼Œå¦åˆ™è¾“å‡º â€œNoâ€ã€‚</p><ol><li><strong>è¾“å…¥å¤„ç†</strong>ï¼š<ul><li>è¾“å…¥ä¸€ä¸ªæ•´æ•° nnnï¼Œè¡¨ç¤ºæ•°ç»„çš„å¤§å°ã€‚</li><li>æ¥ä¸‹æ¥è¾“å…¥ nnn ä¸ªæ•´æ•°ï¼Œè¿™äº›æ•´æ•°å·²æ’åºã€‚</li><li>æ¥ç€è¾“å…¥ä¸€ä¸ªæ•´æ•° qqqï¼Œè¡¨ç¤ºæŸ¥è¯¢æ¬¡æ•°ã€‚</li><li>å¯¹äºæ¯æ¬¡æŸ¥è¯¢ï¼Œè¾“å…¥ä¸€ä¸ªæ•´æ•° mmmï¼Œéœ€è¦åˆ¤æ–­ mmm æ˜¯å¦å‡ºç°åœ¨æ’åºæ•°ç»„ä¸­ã€‚</li></ul></li><li><strong>äºŒåˆ†æŸ¥æ‰¾</strong>ï¼š<ul><li>äºŒåˆ†æŸ¥æ‰¾æ˜¯ä¸€ç§é«˜æ•ˆçš„æŸ¥æ‰¾æ–¹æ³•ï¼Œåœ¨ä¸€ä¸ªå·²æ’åºçš„æ•°ç»„ä¸­æŸ¥æ‰¾æŸä¸ªå…ƒç´ çš„æ—¶é—´å¤æ‚åº¦ä¸º O(logâ¡n)O(\log n)O(logn)ã€‚</li><li>ä½¿ç”¨æ ‡å‡†åº“çš„ <code>lower_bound</code> å‡½æ•°æ¥å®ç°äºŒåˆ†æŸ¥æ‰¾ã€‚å®ƒä¼šè¿”å›ä¸€ä¸ªæŒ‡å‘æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªå¤§äºæˆ–ç­‰äºæŸ¥è¯¢å€¼çš„è¿­ä»£å™¨ã€‚å¦‚æœè¿­ä»£å™¨æŒ‡å‘çš„å…ƒç´ ä¸æŸ¥è¯¢å€¼ç›¸åŒï¼Œåˆ™è¡¨ç¤ºè¯¥å…ƒç´ å­˜åœ¨ã€‚</li></ul></li><li><strong>è¾“å‡º</strong>ï¼š<ul><li>å¦‚æœæŸ¥è¯¢å€¼åœ¨æ•°ç»„ä¸­å­˜åœ¨ï¼Œåˆ™è¾“å‡º â€œYesâ€ï¼›å¦åˆ™è¾“å‡º â€œNoâ€ã€‚</li></ul></li></ol><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;vector&gt;</span><br><span class="line">#include &lt;algorithm&gt;  // For lower_bound</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">    int n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    </span><br><span class="line">    vector&lt;int&gt; arr(n);</span><br><span class="line">    for (int i = 0; i &lt; n; ++i) &#123;</span><br><span class="line">        cin &gt;&gt; arr[i];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    int q;</span><br><span class="line">    cin &gt;&gt; q;</span><br><span class="line">    </span><br><span class="line">    for (int i = 0; i &lt; q; ++i) &#123;</span><br><span class="line">        int m;</span><br><span class="line">        cin &gt;&gt; m;</span><br><span class="line">      </span><br><span class="line">        auto it = lower_bound(arr.begin(), arr.end(), m);</span><br><span class="line">  </span><br><span class="line">        if (it != arr.end() &amp;&amp; *it == m) &#123;</span><br><span class="line">            cout &lt;&lt; &quot;Yes&quot; &lt;&lt; endl;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            cout &lt;&lt; &quot;No&quot; &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h3 id="3-å­¦ä¹ æ€»ç»“"><a href="#3-å­¦ä¹ æ€»ç»“" class="headerlink" title="3.å­¦ä¹ æ€»ç»“"></a>3.å­¦ä¹ æ€»ç»“</h3><p>è¯¥é—®é¢˜è¦æ±‚åœ¨å·²æ’åºçš„æ•°ç»„ä¸­è¿›è¡Œå¤šä¸ªæŸ¥æ‰¾æ“ä½œï¼Œæœ€ç›´è§‚çš„åšæ³•æ˜¯ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾ã€‚äºŒåˆ†æŸ¥æ‰¾èƒ½å¤Ÿå°†æŸ¥æ‰¾æ—¶é—´ä» O(n)O(n)O(n) é™ä½åˆ° O(logâ¡n)O(\log n)O(logn)ï¼Œå› æ­¤å¯¹äºå¤§è§„æ¨¡æ•°æ®ï¼Œèƒ½å¤Ÿæ˜¾è‘—æé«˜æ•ˆç‡ã€‚åˆ©ç”¨ C++ STL æä¾›çš„ <code>lower_bound</code> å‡½æ•°ï¼Œå¯ä»¥é«˜æ•ˆåœ°å®ç°äºŒåˆ†æŸ¥æ‰¾ï¼Œé¿å…æ‰‹åŠ¨å®ç°æŸ¥æ‰¾ç®—æ³•ã€‚é€šè¿‡è¿™ç§æ–¹æ³•ï¼Œæ¯æ¬¡æŸ¥è¯¢çš„æ—¶é—´å¤æ‚åº¦ä¸º O(logâ¡n)O(\log n)O(logn)ï¼Œå› æ­¤æ€»çš„æ—¶é—´å¤æ‚åº¦ä¸º O(qlogâ¡n)O(q \log n)O(qlogn)ï¼Œé€‚åˆå¤„ç†è¾ƒå¤§è§„æ¨¡çš„è¾“å…¥æ•°æ®ã€‚</p><p>è¿™ä¸ªè§£æ³•å¯¹äºæœ€å¤§å€¼ n&#x3D;100000n &#x3D; 100000n&#x3D;100000 å’Œ q&#x3D;100000q &#x3D; 100000q&#x3D;100000 çš„æƒ…å†µä¹Ÿæ˜¯å¯è¡Œçš„ï¼Œæ»¡è¶³æ—¶é—´é™åˆ¶ã€‚</p><h2 id="äºŒ-A-Bæ•°å¯¹"><a href="#äºŒ-A-Bæ•°å¯¹" class="headerlink" title="äºŒ.A-Bæ•°å¯¹"></a>äºŒ.A-Bæ•°å¯¹</h2><h3 id="1-å¯¹åº”æ€è·¯-1"><a href="#1-å¯¹åº”æ€è·¯-1" class="headerlink" title="1.å¯¹åº”æ€è·¯"></a>1.å¯¹åº”æ€è·¯</h3><p>ç»™å®šæ•°åˆ—ä»¥åŠå¸¸æ•° CCCï¼Œè¦æ±‚è®¡ç®—æ»¡è¶³æ¡ä»¶ Aâˆ’B&#x3D;CA - B &#x3D; CAâˆ’B&#x3D;C çš„æ•°å¯¹ä¸ªæ•°ã€‚è¿™ä¸ªé—®é¢˜è¦æ±‚åˆ¤æ–­åœ¨æ•°åˆ—ä¸­ï¼Œå­˜åœ¨å¤šå°‘å¯¹ (A,B)(A, B)(A,B)ï¼Œä½¿å¾— Aâˆ’B&#x3D;CA - B &#x3D; CAâˆ’B&#x3D;Cï¼Œå³ A&#x3D;B+CA &#x3D; B + CA&#x3D;B+Cã€‚</p><h4 id="è§£å†³æ€è·¯ï¼š"><a href="#è§£å†³æ€è·¯ï¼š" class="headerlink" title="è§£å†³æ€è·¯ï¼š"></a>è§£å†³æ€è·¯ï¼š</h4><ol><li><strong>æ•°å­¦è½¬æ¢</strong>ï¼š<ul><li>ç»™å®šæ¡ä»¶ Aâˆ’B&#x3D;CA - B &#x3D; CAâˆ’B&#x3D;Cï¼Œå¯è½¬åŒ–ä¸º A&#x3D;B+CA &#x3D; B + CA&#x3D;B+Cã€‚å› æ­¤ï¼Œå¯¹äºæ¯ä¸ª BBBï¼Œæˆ‘ä»¬åªéœ€è¦åˆ¤æ–­ B+CB + CB+C æ˜¯å¦å‡ºç°åœ¨æ•°åˆ—ä¸­ã€‚</li></ul></li><li><strong>ä½¿ç”¨å“ˆå¸Œè¡¨</strong>ï¼š<ul><li>ä½¿ç”¨å“ˆå¸Œè¡¨ï¼ˆ<code>unordered_map</code>ï¼‰æ¥è®°å½•æ•°åˆ—ä¸­æ¯ä¸ªæ•°å­—çš„å‡ºç°æ¬¡æ•°ã€‚éå†æ•°åˆ—ï¼Œå¯¹äºæ¯ä¸ªæ•° BBBï¼Œè®¡ç®— B+CB + CB+Cï¼Œç„¶åæ£€æŸ¥å“ˆå¸Œè¡¨ä¸­æ˜¯å¦æœ‰è¿™ä¸ªæ•°ã€‚å¦‚æœæœ‰ï¼Œåˆ™è®¡æ•°å¢åŠ ã€‚</li></ul></li><li><strong>æ•ˆç‡é—®é¢˜</strong>ï¼š<ul><li>ç”¨å“ˆå¸Œè¡¨ç»Ÿè®¡æ•°åˆ—ä¸­å„ä¸ªæ•°å­—çš„å‡ºç°æ¬¡æ•°ï¼ŒæŸ¥æ‰¾æŸä¸ªæ•°æ˜¯å¦å­˜åœ¨çš„æ“ä½œæ˜¯ O(1)O(1)O(1)ï¼Œæ‰€ä»¥è¯¥ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(N)O(N)O(N)ï¼Œé€‚ç”¨äºå¤§è§„æ¨¡æ•°æ®ã€‚</li></ul></li></ol><h3 id="2-ä»£ç "><a href="#2-ä»£ç " class="headerlink" title="2.ä»£ç "></a>2.ä»£ç </h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;unordered_map&gt;</span><br><span class="line">#include &lt;vector&gt;</span><br><span class="line"></span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">    int N, C;</span><br><span class="line">    cin &gt;&gt; N &gt;&gt; C;</span><br><span class="line">    </span><br><span class="line">    vector&lt;int&gt; arr(N);</span><br><span class="line">    unordered_map&lt;int, int&gt; freq;  </span><br><span class="line"></span><br><span class="line">    for (int i = 0; i &lt; N; ++i) &#123;</span><br><span class="line">        cin &gt;&gt; arr[i];</span><br><span class="line">        ++freq[arr[i]];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    long long count = 0; </span><br><span class="line"></span><br><span class="line">    for (int i = 0; i &lt; N; ++i) &#123;</span><br><span class="line">        int B = arr[i];</span><br><span class="line">        int A = B + C;  // è®¡ç®—A = B + C</span><br><span class="line">       </span><br><span class="line">        if (freq.find(A) != freq.end()) &#123;</span><br><span class="line">            count += freq[A];  </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    cout &lt;&lt; count &lt;&lt; endl;  </span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h3 id="3-å­¦ä¹ æ€»ç»“-1"><a href="#3-å­¦ä¹ æ€»ç»“-1" class="headerlink" title="3.å­¦ä¹ æ€»ç»“"></a>3.å­¦ä¹ æ€»ç»“</h3><p><strong>å“ˆå¸Œè¡¨</strong>ï¼š å“ˆå¸Œè¡¨åœ¨å¤„ç†éœ€è¦å¿«é€ŸæŸ¥æ‰¾çš„åœºæ™¯ä¸­éå¸¸æœ‰ç”¨ã€‚åœ¨æœ¬é¢˜ä¸­ï¼Œå“ˆå¸Œè¡¨å¸®åŠ©æˆ‘ä»¬åœ¨ O(1)O(1)O(1) çš„æ—¶é—´å¤æ‚åº¦å†…æŸ¥æ‰¾æŸä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨ï¼Œä½¿å¾—æ•´ä½“å¤æ‚åº¦ä» O(N2)O(N^2)O(N2) é™ä½åˆ° O(N)O(N)O(N)ã€‚</p><p><strong>ä¼˜åŒ–æ€ç»´</strong>ï¼š é€šè¿‡å°†é—®é¢˜è½¬åŒ–ä¸ºæŸ¥æ‰¾æ•°åˆ—ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªæ•° A&#x3D;B+CA &#x3D; B + CA&#x3D;B+Cï¼Œæˆ‘ä»¬é¿å…äº†æšä¸¾æ‰€æœ‰æ•°å¯¹çš„ä½æ•ˆæ–¹æ³•ã€‚è¿™æ˜¯å…¸å‹çš„é€šè¿‡æ•°å­¦è½¬åŒ–ä¼˜åŒ–é—®é¢˜çš„æ€è·¯ã€‚</p><p><strong>æ—¶é—´ä¸ç©ºé—´å¤æ‚åº¦</strong>ï¼š å­¦ä¹ å¦‚ä½•å¹³è¡¡æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦ã€‚é€šè¿‡ä½¿ç”¨å“ˆå¸Œè¡¨ï¼Œè™½ç„¶å¢åŠ äº†é¢å¤–çš„ç©ºé—´å¼€é”€ï¼Œä½†æå¤§åœ°æé«˜äº†ç®—æ³•æ•ˆç‡ï¼Œé€‚åº”äº†é—®é¢˜çš„å¤§æ•°æ®è§„æ¨¡ã€‚</p><p><strong>å®é™…åº”ç”¨</strong>ï¼š å“ˆå¸Œè¡¨å’Œé›†åˆæ“ä½œåœ¨å®é™…å¼€å‘ä¸­æœ‰ç€å¹¿æ³›åº”ç”¨ï¼Œä¾‹å¦‚æ•°æ®åº“çš„ç´¢å¼•ã€ç¼“å­˜ç³»ç»Ÿç­‰ï¼Œäº†è§£å¹¶æŒæ¡è¿™äº›åŸºæœ¬æ•°æ®ç»“æ„å¯¹è§£å†³å®é™…é—®é¢˜è‡³å…³é‡è¦ã€‚</p><h2 id="ä¸‰-åˆ†å·§å…‹åŠ›"><a href="#ä¸‰-åˆ†å·§å…‹åŠ›" class="headerlink" title="ä¸‰.åˆ†å·§å…‹åŠ›"></a>ä¸‰.åˆ†å·§å…‹åŠ›</h2><h3 id="1-å¯¹åº”æ€è·¯-2"><a href="#1-å¯¹åº”æ€è·¯-2" class="headerlink" title="1.å¯¹åº”æ€è·¯"></a>1.å¯¹åº”æ€è·¯</h3><p>é¢˜ç›®è¦æ±‚æˆ‘ä»¬ä» <code>N</code> å—å·§å…‹åŠ›ä¸­åˆ‡å‡º <code>K</code> å—æ­£æ–¹å½¢å·§å…‹åŠ›ï¼Œä¸”æ¯å—æ­£æ–¹å½¢çš„è¾¹é•¿å°½å¯èƒ½å¤§ã€‚æˆ‘ä»¬éœ€è¦é€šè¿‡åˆ‡å‰²å·§å…‹åŠ›çš„é•¿æ–¹å½¢ï¼Œå¾—åˆ°å¤§å°ç›¸åŒçš„æ­£æ–¹å½¢ã€‚</p><h4 id="é—®é¢˜åˆ†æï¼š"><a href="#é—®é¢˜åˆ†æï¼š" class="headerlink" title="é—®é¢˜åˆ†æï¼š"></a>é—®é¢˜åˆ†æï¼š</h4><ol><li><strong>æ­£æ–¹å½¢çš„å¤§å°</strong>ï¼š<ul><li>å¯¹äºæ¯ä¸€å—å·§å…‹åŠ› HiÃ—WiH_i \times W_iHiÃ—Wiï¼Œæˆ‘ä»¬èƒ½å¤Ÿä»ä¸­åˆ‡å‡ºå¤šå°‘ä¸ª SÃ—SS \times SSÃ—S çš„æ­£æ–¹å½¢ï¼ˆå…¶ä¸­ SSS ä¸ºæ­£æ–¹å½¢çš„è¾¹é•¿ï¼‰ï¼Ÿ</li><li>æˆ‘ä»¬å¯ä»¥é€šè¿‡å°† HiH_iHi å’Œ WiW_iWi åˆ†åˆ«é™¤ä»¥ SSSï¼Œè®¡ç®—æ¯ä¸ªé•¿æ–¹å½¢å¯ä»¥åˆ‡å‡ºçš„æ­£æ–¹å½¢æ•°é‡ï¼š ä¸ªæ•°&#x3D;âŒŠHiSâŒ‹Ã—âŒŠWiSâŒ‹\text{ä¸ªæ•°} &#x3D; \left\lfloor \frac{H_i}{S} \right\rfloor \times \left\lfloor \frac{W_i}{S} \right\rfloorä¸ªæ•°&#x3D;âŒŠSHiâŒ‹Ã—âŒŠSWiâŒ‹</li><li>æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ª SSSï¼Œä½¿å¾—ä»æ‰€æœ‰ NNN å—å·§å…‹åŠ›ä¸­åˆ‡å‡ºçš„æ­£æ–¹å½¢æ€»æ•°è‡³å°‘ä¸º KKKã€‚</li></ul></li><li><strong>äºŒåˆ†æŸ¥æ‰¾</strong>ï¼š<ul><li>ç”±äºæˆ‘ä»¬å¸Œæœ›åˆ‡å‡ºçš„æ­£æ–¹å½¢è¾¹é•¿å°½å¯èƒ½å¤§ï¼Œæœ€ç›´è§‚çš„åŠæ³•æ˜¯ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾æ¥ç¡®å®šè¾¹é•¿ SSS çš„æœ€å¤§å€¼ã€‚èŒƒå›´ä» 1 åˆ°æ¯å—å·§å…‹åŠ›çš„æœ€å¤§è¾¹é•¿ï¼ˆå³ minâ¡(Hi,Wi)\min(H_i, W_i)min(Hi,Wi)ï¼‰ã€‚</li></ul></li><li><strong>æ£€æŸ¥æ¡ä»¶</strong>ï¼š<ul><li>å¯¹äºæ¯ä¸ª SSSï¼Œæˆ‘ä»¬è®¡ç®—å‡ºæ‰€æœ‰å·§å…‹åŠ›åˆ‡å‡ºçš„æ­£æ–¹å½¢æ•°é‡ï¼Œå¹¶åˆ¤æ–­æ˜¯å¦èƒ½å¤Ÿæ»¡è¶³è‡³å°‘æœ‰ KKK å—å·§å…‹åŠ›ã€‚å¦‚æœèƒ½æ»¡è¶³ï¼Œè¯´æ˜ SSS æ˜¯ä¸€ä¸ªå¯èƒ½çš„è§£ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­å°è¯•æ›´å¤§çš„ SSSï¼›å¦åˆ™ï¼Œå°è¯•æ›´å°çš„ SSSã€‚</li></ul></li></ol><h3 id="2-ä»£ç -1"><a href="#2-ä»£ç -1" class="headerlink" title="2.ä»£ç "></a>2.ä»£ç </h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;vector&gt;</span><br><span class="line">#include &lt;algorithm&gt;</span><br><span class="line"></span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">// åˆ¤æ–­ç»™å®šè¾¹é•¿ S èƒ½å¦ä»æ‰€æœ‰å·§å…‹åŠ›ä¸­åˆ‡å‡ºè‡³å°‘ K å—æ­£æ–¹å½¢</span><br><span class="line">bool canCutSquares(const vector&lt;pair&lt;int, int&gt;&gt;&amp; chocolates, int S, int K) &#123;</span><br><span class="line">    long long totalCount = 0;  // è®°å½•åˆ‡å‡ºçš„æ­£æ–¹å½¢æ€»æ•°</span><br><span class="line">    for (const auto&amp; chocolate : chocolates) &#123;</span><br><span class="line">        int H = chocolate.first;</span><br><span class="line">        int W = chocolate.second;</span><br><span class="line">        totalCount += (H / S) * (W / S);  // è®¡ç®—è¯¥å·§å…‹åŠ›èƒ½åˆ‡å‡ºå¤šå°‘ä¸ª S * S çš„æ­£æ–¹å½¢</span><br><span class="line">        if (totalCount &gt;= K) return true;  // å¦‚æœå·²è¾¾åˆ°è¦æ±‚çš„æ•°é‡ï¼Œæå‰è¿”å›</span><br><span class="line">    &#125;</span><br><span class="line">    return totalCount &gt;= K;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">    int N, K;</span><br><span class="line">    cin &gt;&gt; N &gt;&gt; K;</span><br><span class="line"></span><br><span class="line">    vector&lt;pair&lt;int, int&gt;&gt; chocolates(N);</span><br><span class="line">    int maxSide = 0;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    for (int i = 0; i &lt; N; ++i) &#123;</span><br><span class="line">        cin &gt;&gt; chocolates[i].first &gt;&gt; chocolates[i].second;</span><br><span class="line">        maxSide = max(maxSide, min(chocolates[i].first, chocolates[i].second));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    int low = 1, high = maxSide, bestSide = 0;</span><br><span class="line"></span><br><span class="line">    while (low &lt;= high) &#123;</span><br><span class="line">        int mid = (low + high) / 2;</span><br><span class="line">        if (canCutSquares(chocolates, mid, K)) &#123;</span><br><span class="line">            bestSide = mid;  </span><br><span class="line">            low = mid + 1;  </span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            high = mid - 1;  </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; bestSide &lt;&lt; endl; </span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h3 id="3-å­¦ä¹ æ€»ç»“-2"><a href="#3-å­¦ä¹ æ€»ç»“-2" class="headerlink" title="3.å­¦ä¹ æ€»ç»“"></a>3.å­¦ä¹ æ€»ç»“</h3><p><strong>äºŒåˆ†æŸ¥æ‰¾çš„åº”ç”¨</strong>ï¼šé€šè¿‡äºŒåˆ†æŸ¥æ‰¾å¯ä»¥é«˜æ•ˆåœ°æ±‚è§£æ­£æ–¹å½¢çš„æœ€å¤§è¾¹é•¿ï¼Œå°¤å…¶æ˜¯åœ¨è¾¹é•¿ç©ºé—´è¾ƒå¤§æ—¶ï¼Œèƒ½å¤Ÿæ˜¾è‘—é™ä½æ—¶é—´å¤æ‚åº¦ã€‚</p><p><strong>ç©ºé—´åˆ©ç”¨</strong>ï¼šé€šè¿‡ä½¿ç”¨å“ˆå¸Œè¡¨å’ŒäºŒåˆ†æŸ¥æ‰¾ï¼Œæˆ‘ä»¬åœ¨æ—¶é—´å’Œç©ºé—´ä¸Šè¾¾åˆ°äº†è¾ƒä¼˜çš„å¹³è¡¡ï¼Œèƒ½å¤Ÿå¤„ç†æœ€å¤§è§„æ¨¡çš„æ•°æ®ã€‚</p><p><strong>é—®é¢˜çš„æ•°å­¦è½¬åŒ–</strong>ï¼šé€šè¿‡å°†åˆ‡å‰²é—®é¢˜è½¬åŒ–ä¸ºæ•°ç›®åˆ¤æ–­é—®é¢˜ï¼Œåˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾å¯ä»¥æœ‰æ•ˆé¿å…æš´åŠ›ç ´è§£çš„é«˜æ—¶é—´å¤æ‚åº¦ã€‚</p><h2 id="å››-å¡ç‰Œ"><a href="#å››-å¡ç‰Œ" class="headerlink" title="å››.å¡ç‰Œ"></a>å››.å¡ç‰Œ</h2><h3 id="1-å¯¹åº”æ€è·¯-3"><a href="#1-å¯¹åº”æ€è·¯-3" class="headerlink" title="1.å¯¹åº”æ€è·¯"></a>1.å¯¹åº”æ€è·¯</h3><p><strong>å‡å°‘é‡å¤è®¡ç®—</strong>ï¼š</p><ul><li>åœ¨ <code>canMakeKSets</code> å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬æ¯æ¬¡éƒ½éœ€è¦è®¡ç®—ç©ºç™½å¡ç‰Œçš„æ•°é‡ã€‚è€ƒè™‘åˆ° <code>a[i]</code> å’Œ <code>b[i]</code> å¯¹äºæ¯ä¸ªå¡ç‰Œæ˜¯å›ºå®šçš„ï¼Œæˆ‘ä»¬å¯ä»¥æå‰è®¡ç®—æ¯ç§å¡ç‰Œçš„è¡¥å……é‡ï¼Œç„¶åç›´æ¥é€šè¿‡å‰ç¼€å’Œè®¡ç®—æ¯ä¸ª <code>k</code> çš„æ‰€éœ€è¡¥å……å¡ç‰Œæ•°ã€‚</li></ul><p><strong>é€šè¿‡å‰ç¼€å’Œä¼˜åŒ–å¡ç‰Œéœ€æ±‚è®¡ç®—</strong>ï¼š</p><ul><li>è®¡ç®—éœ€è¦è¡¥å……çš„ç©ºç™½å¡ç‰Œæ•°æ—¶ï¼Œå¦‚æœæˆ‘ä»¬èƒ½æå‰è®¡ç®—å‡ºæ¯ç§å¡ç‰Œåœ¨æ¯ä¸ª <code>k</code> å€¼ä¸‹éœ€è¦å¤šå°‘ç©ºç™½å¡ç‰Œï¼Œå¯ä»¥åŠ é€ŸæŸ¥æ‰¾ã€‚</li><li>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <strong>è´ªå¿ƒç­–ç•¥</strong> æˆ–è€… <strong>æ‰«æç®—æ³•</strong>ï¼Œé¿å…æ¯æ¬¡éƒ½å…¨é‡æ‰«æ <code>n</code> ä¸ªå¡ç‰Œã€‚</li></ul><h3 id="2-ä»£ç -2"><a href="#2-ä»£ç -2" class="headerlink" title="2.ä»£ç "></a>2.ä»£ç </h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;bits/stdc++.h&gt;</span><br><span class="line">#define int long long</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">const int N = 2e5;</span><br><span class="line">int n, m, a[N + 5], b[N + 5];</span><br><span class="line"></span><br><span class="line">inline int read() &#123;</span><br><span class="line">    int x = 0;</span><br><span class="line">    bool f = 1;</span><br><span class="line">    char ch = getchar();</span><br><span class="line">    for (; ch &lt; &#x27;0&#x27; || ch &gt; &#x27;9&#x27;; ch = getchar()) f ^= (ch == &#x27;-&#x27;);</span><br><span class="line">    for (; ch &gt;= &#x27;0&#x27; &amp;&amp; ch &lt;= &#x27;9&#x27;; ch = getchar()) x = (x &lt;&lt; 1) + (x &lt;&lt; 3) + (ch ^ 48);</span><br><span class="line">    return f ? x : -x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">bool check(int mid) &#123;</span><br><span class="line">    int cnt = 0;</span><br><span class="line">    for (int i = 1; i &lt;= n; ++i) &#123;</span><br><span class="line">        cnt += max(0LL, mid - a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    return cnt &lt;= m;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void Kafka() &#123;</span><br><span class="line">    n = read();</span><br><span class="line">    m = read();</span><br><span class="line">    </span><br><span class="line">    int L = 1, R = n * 2;</span><br><span class="line"> </span><br><span class="line">    for (int i = 1; i &lt;= n; ++i) &#123;</span><br><span class="line">        a[i] = read();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    for (int i = 1; i &lt;= n; ++i) &#123;</span><br><span class="line">        b[i] = read();</span><br><span class="line">        R = min(a[i] + b[i], R);  </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // äºŒåˆ†æŸ¥æ‰¾æœ€å¤§å¥—ç‰Œæ•°</span><br><span class="line">    while (L &lt; R) &#123;</span><br><span class="line">        int mid = (L + R + 1) &gt;&gt; 1;</span><br><span class="line">        if (check(mid)) &#123;</span><br><span class="line">            L = mid;  </span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            R = mid - 1; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; L &lt;&lt; &#x27;\n&#x27;;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">signed main() &#123;</span><br><span class="line">    Kafka();</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h3 id="3-å­¦ä¹ æ€»ç»“-3"><a href="#3-å­¦ä¹ æ€»ç»“-3" class="headerlink" title="3.å­¦ä¹ æ€»ç»“"></a>3.å­¦ä¹ æ€»ç»“</h3><p><strong>æå‰è®¡ç®—è¡¥å……æ•°é‡</strong>ï¼šé€šè¿‡ä¸€æ¬¡éå†è®¡ç®—æ¯ä¸ª <code>k</code> éœ€è¦çš„è¡¥å……å¡ç‰Œæ•°é‡ï¼Œå¯ä»¥å‡å°‘æ—¶é—´å¤æ‚åº¦ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚</p><p><strong>äºŒåˆ†æŸ¥æ‰¾çš„æŠ€å·§</strong>ï¼šé€šè¿‡äºŒåˆ†æŸ¥æ‰¾å¯ä»¥æœ‰æ•ˆç¼©å°æœç´¢èŒƒå›´ï¼Œæ¯æ¬¡åˆ¤æ–­å¯ä»¥é›†ä¸­åˆ¤æ–­æŸä¸ª <code>k</code> æ˜¯å¦å¯è¡Œã€‚</p><p><strong>ç©ºé—´ä¼˜åŒ–</strong>ï¼šåªä½¿ç”¨ç®€å•çš„æ•°ç»„æ¥å­˜å‚¨å¡ç‰Œæ•°é‡å’Œè¡¥å……é™åˆ¶ï¼Œç©ºé—´å¤æ‚åº¦ä¸º <code>O(n)</code>ï¼Œç¬¦åˆé¢˜ç›®è¦æ±‚ã€‚</p><h2 id="äº”-ä¹¦çš„å¤åˆ¶"><a href="#äº”-ä¹¦çš„å¤åˆ¶" class="headerlink" title="äº”.ä¹¦çš„å¤åˆ¶"></a>äº”.ä¹¦çš„å¤åˆ¶</h2><h3 id="1-å¯¹åº”æ€è·¯-4"><a href="#1-å¯¹åº”æ€è·¯-4" class="headerlink" title="1.å¯¹åº”æ€è·¯"></a>1.å¯¹åº”æ€è·¯</h3><p>æœ¬é¢˜ç›®è¦æ±‚å°† <code>m</code> æœ¬æœ‰é¡ºåºçš„ä¹¦åˆ†ç»™ <code>k</code> ä¸ªäººå¤åˆ¶ï¼Œæ¯ä¸ªäººæŠ„å†™çš„ä¹¦æ˜¯è¿ç»­çš„ï¼Œå¹¶ä¸”éœ€è¦å°½å¯èƒ½æœ€çŸ­çš„å¤åˆ¶æ—¶é—´ã€‚å¤åˆ¶æ—¶é—´æŒ‡çš„æ˜¯æŠ„å†™é¡µæ•°æœ€å¤šçš„äººæ‰€ç”¨çš„æ—¶é—´ï¼Œç›®æ ‡æ˜¯å°½å¯èƒ½å‡å°‘è¿™ä¸ªæ—¶é—´ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œé‡‡ç”¨äº† <strong>äºŒåˆ†æŸ¥æ‰¾</strong> å’Œ <strong>è´ªå¿ƒç®—æ³•</strong> ç»“åˆçš„ç­–ç•¥ï¼š</p><ol><li><strong>äºŒåˆ†æŸ¥æ‰¾</strong>ï¼š<ul><li>å¯¹äºå¤åˆ¶æ—¶é—´çš„æœ€å¤§å€¼ <code>max_time</code>ï¼ˆå³æŠ„å†™é¡µæ•°æœ€å¤šçš„äººçš„æ—¶é—´ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾ã€‚</li><li>åˆå§‹æ—¶ï¼Œè®¾ç½® <code>L = 1</code>ï¼ˆæœ€å°å€¼ï¼‰å’Œ <code>R = sum(a)</code>ï¼ˆæœ€å¤§å€¼ï¼Œæ‰€æœ‰ä¹¦é¡µåŠ èµ·æ¥ï¼‰ã€‚</li><li>å¯¹äºæ¯ä¸ªä¸­é—´å€¼ <code>mid</code>ï¼Œæˆ‘ä»¬è¦åˆ¤æ–­æ˜¯å¦èƒ½åœ¨ <code>mid</code> çš„æœ€å¤§æ—¶é—´é™åˆ¶ä¸‹ï¼Œåˆç†åˆ†é…ä¹¦ç±ç»™ <code>k</code> ä¸ªäººã€‚</li></ul></li><li><strong>è´ªå¿ƒç®—æ³•</strong>ï¼š<ul><li>æ¯æ¬¡å°è¯•ç”¨å½“å‰çš„ <code>mid</code> æ¥åˆ†é…ä¹¦ç±ï¼šä»ä¹¦ç±åˆ—è¡¨ä¸­ä¾æ¬¡åˆ†é…ï¼Œå¦‚æœå½“å‰äººçš„å·²åˆ†é…é¡µæ•°è¶…è¿‡ <code>mid</code>ï¼Œå°±å¼€å§‹åˆ†é…ç»™ä¸‹ä¸€ä¸ªäººã€‚</li><li>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šåœ¨å½“å‰çš„ <code>mid</code> æ—¶é—´ä¸‹ï¼Œèƒ½åˆ†é…ç»™ <code>k</code> ä¸ªäººã€‚</li></ul></li><li><strong>è¿‡ç¨‹æè¿°</strong>ï¼š<ul><li>å¯¹äºæ¯æ¬¡äºŒåˆ†æŸ¥æ‰¾çš„ <code>mid</code>ï¼Œæˆ‘ä»¬ä»ç¬¬ 1 ä¸ªäººå¼€å§‹ï¼Œè´ªå¿ƒåœ°åˆ†é…ä¹¦ç±ã€‚å¦‚æœå½“å‰ä¹¦ç±æ— æ³•åˆ†é…ç»™å½“å‰äººï¼ˆè¶…å‡ºäº† <code>mid</code> æ—¶é—´ï¼‰ï¼Œå°±æ¢ç»™ä¸‹ä¸€ä¸ªäººï¼Œç›´åˆ°æ‰€æœ‰ä¹¦ç±åˆ†é…å®Œã€‚</li><li>å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿåœ¨ <code>k</code> ä¸ªäººå†…å®Œæˆåˆ†é…ï¼Œé‚£ä¹ˆè¯´æ˜å½“å‰çš„ <code>mid</code> å€¼æ˜¯å¯è¡Œçš„ï¼Œæˆ‘ä»¬å°è¯•ç¼©å° <code>mid</code>ï¼›å¦åˆ™ï¼Œå¢å¤§ <code>mid</code>ã€‚</li></ul></li><li><strong>ç»“æœè¾“å‡º</strong>ï¼š<ul><li>äºŒåˆ†æŸ¥æ‰¾ç»“æŸåï¼Œæœ€ç»ˆçš„æœ€ä¼˜æ—¶é—´å°±æ˜¯ <code>L</code>ï¼Œç„¶åæ ¹æ®è¯¥æ—¶é—´è¾“å‡ºæ¯ä¸ªäººæŠ„å†™çš„ä¹¦ç±åŒºé—´ã€‚</li></ul></li></ol><h3 id="2-ä»£ç -3"><a href="#2-ä»£ç -3" class="headerlink" title="2.ä»£ç "></a>2.ä»£ç </h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;bits/stdc++.h&gt;</span><br><span class="line">#define int long long</span><br><span class="line">using namespace std;</span><br><span class="line">const int K=500;</span><br><span class="line">int m,k,a[K+5];</span><br><span class="line">int st[K+5],ed[K+5];</span><br><span class="line">inline int read()</span><br><span class="line">&#123;</span><br><span class="line">    int x=0;bool f=1;char ch=getchar();</span><br><span class="line">    for(;ch&lt;&#x27;0&#x27;||ch&gt;&#x27;9&#x27;;ch=getchar())f^=(ch==&#x27;-&#x27;);</span><br><span class="line">    for(;ch&gt;=&#x27;0&#x27;&amp;&amp;ch&lt;=&#x27;9&#x27;;ch=getchar())x=(x&lt;&lt;1)+(x&lt;&lt;3)+(ch^48);</span><br><span class="line">    return f?x:-x;</span><br><span class="line">&#125;</span><br><span class="line">bool check(int mid)</span><br><span class="line">&#123;</span><br><span class="line">    int cnt=1,now=mid;</span><br><span class="line">    for(int i=1;i&lt;=m&amp;&amp;cnt&lt;=k;++i) </span><br><span class="line">    &#123;</span><br><span class="line">        if(a[i]&gt;now) ++cnt,--i,now=mid;</span><br><span class="line">        else now-=a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    return cnt&lt;=k;</span><br><span class="line">&#125;</span><br><span class="line">void Kafka()</span><br><span class="line">&#123;</span><br><span class="line">    m=read(),k=read();</span><br><span class="line">    int L=1,R=0;</span><br><span class="line">    for(int i=1;i&lt;=m;++i) a[i]=read(),R+=a[i];</span><br><span class="line">    for(int mid=L+R&gt;&gt;1;L&lt;R;check(mid)?R=mid:L=mid+1)mid=L+R&gt;&gt;1;</span><br><span class="line">    ed[k]=m,st[1]=1;</span><br><span class="line">    for(int i=k,j=m,now=L;i;--i)</span><br><span class="line">    &#123;</span><br><span class="line">        for(;now&gt;=a[j]&amp;&amp;j;--j) now-=a[j];</span><br><span class="line">        st[i]=j+1,ed[i-1]=j,now=L;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    for(int i=1;i&lt;=k;++i) cout&lt;&lt;st[i]&lt;&lt;&#x27; &#x27;&lt;&lt;ed[i]&lt;&lt;&#x27;\n&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">signed main()</span><br><span class="line">&#123;</span><br><span class="line">    Kafka();</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h3 id="3-å­¦ä¹ æ€»ç»“-4"><a href="#3-å­¦ä¹ æ€»ç»“-4" class="headerlink" title="3.å­¦ä¹ æ€»ç»“"></a>3.å­¦ä¹ æ€»ç»“</h3><p>æœ¬é¢˜è€ƒå¯Ÿäº† <strong>äºŒåˆ†æŸ¥æ‰¾</strong> å’Œ <strong>è´ªå¿ƒç®—æ³•</strong> çš„ç»“åˆä½¿ç”¨ã€‚é€šè¿‡äºŒåˆ†æŸ¥æ‰¾é«˜æ•ˆåœ°æ¢ç´¢æœ€ä¼˜è§£ç©ºé—´ï¼Œå†ç»“åˆè´ªå¿ƒç®—æ³•å¿«é€Ÿåˆ¤æ–­æ˜¯å¦èƒ½åœ¨æŒ‡å®šæ—¶é—´å†…å®Œæˆåˆ†é…ï¼Œä½¿å¾—é—®é¢˜å¾—ä»¥é«˜æ•ˆè§£å†³ã€‚è¿™ç§ç±»å‹çš„é—®é¢˜ä¸ä»…èƒ½å¤ŸåŠ æ·±å¯¹ç®—æ³•æ€ç»´çš„ç†è§£ï¼Œè¿˜èƒ½å¸®åŠ©è§£å†³å®é™…ä¸­é‡åˆ°çš„ç±»ä¼¼æœ€ä¼˜åŒ–é—®é¢˜ã€‚</p><h2 id="å…­-é’è›™è¿‡æ²³"><a href="#å…­-é’è›™è¿‡æ²³" class="headerlink" title="å…­.é’è›™è¿‡æ²³"></a>å…­.é’è›™è¿‡æ²³</h2><h3 id="1-å¯¹åº”æ€è·¯-5"><a href="#1-å¯¹åº”æ€è·¯-5" class="headerlink" title="1.å¯¹åº”æ€è·¯"></a>1.å¯¹åº”æ€è·¯</h3><p>é¢˜ç›®è¦æ±‚å°é’è›™åœ¨æ²³å¯¹å²¸å’Œå­¦æ ¡ä¹‹é—´æ¥å›è·³è·ƒï¼Œä»¥æœ€å°åŒ–è·³è·ƒçš„èƒ½åŠ›ï¼ˆå³æœ€å°çš„è·³è·ƒè·ç¦»ï¼‰ã€‚æ¯æ¬¡å°é’è›™å¿…é¡»ä»ä¸€å—çŸ³å¤´èµ·è·³ï¼Œå¹¶ä¸”è·³è·ƒçš„è·ç¦»ä¸èƒ½è¶…è¿‡æŸä¸ªå€¼ã€‚ä¸ºäº†ç¡®ä¿å°é’è›™èƒ½å¤Ÿå®ŒæˆæŒ‡å®šçš„è·³è·ƒæ¬¡æ•°ï¼ˆ2xæ¬¡ï¼‰ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„è·³è·ƒè·ç¦»ï¼Œä½¿å¾—å®ƒèƒ½å¤Ÿåœ¨æœ‰é™çš„è·³è·ƒæ¬¡æ•°å†…æˆåŠŸå®Œæˆä»»åŠ¡ã€‚</p><ul><li><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦ç¡®å®šæœ€å°è·³è·ƒèƒ½åŠ›çš„èŒƒå›´ã€‚æœ€å°å€¼ä¸º <code>1</code>ï¼Œæœ€å¤§å€¼ä¸º <code>n-1</code>ï¼ˆå³æ²³å®½åº¦ï¼‰ï¼Œå³ä»æ²³çš„èµ·ç‚¹åˆ°ç»ˆç‚¹çš„æœ€å¤§è·³è·ƒè·ç¦»ã€‚</p></li><li><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾æ¥ç¼©å°è·³è·ƒèƒ½åŠ›çš„èŒƒå›´ã€‚é€šè¿‡ä¸æ–­å°è¯•ä¸åŒçš„è·³è·ƒèƒ½åŠ› <code>mid</code>ï¼Œå¹¶åˆ¤æ–­æ˜¯å¦èƒ½å¤Ÿå®Œæˆ <code>2x</code> æ¬¡è·³è·ƒã€‚</p></li><li><p>ä¸ºäº†åˆ¤æ–­æŸä¸ªè·³è·ƒèƒ½åŠ›æ˜¯å¦åˆé€‚ï¼Œæ¨¡æ‹Ÿå°é’è›™çš„è·³è·ƒè¿‡ç¨‹ï¼šä»èµ·ç‚¹å¼€å§‹ï¼Œæ¯æ¬¡å°è¯•è·³è·ƒå°½å¯èƒ½è¿œçš„çŸ³å¤´ï¼ˆè·³è·ƒçš„è·ç¦»ä¸è¶…è¿‡å½“å‰çš„ <code>mid</code>ï¼‰ï¼Œå¹¶å°½é‡å‡å°‘è·³è·ƒçš„æ¬¡æ•°ã€‚</p></li><li><p>å¦‚æœè·³è·ƒæ¬¡æ•°å°äºæˆ–ç­‰äº <code>2x</code>ï¼Œåˆ™å½“å‰è·³è·ƒèƒ½åŠ› <code>mid</code> æ˜¯å¯è¡Œçš„ã€‚</p></li><li><p>å¦åˆ™ï¼Œå½“å‰è·³è·ƒèƒ½åŠ› <code>mid</code> å¤ªå°ï¼Œä¸èƒ½å®Œæˆä»»åŠ¡ã€‚</p></li><li><p>é€šè¿‡äºŒåˆ†æŸ¥æ‰¾ä¸æ–­è°ƒæ•´è·³è·ƒèƒ½åŠ›çš„èŒƒå›´ï¼Œç›´åˆ°æ‰¾åˆ°æœ€å°çš„å¯è¡Œè·³è·ƒèƒ½åŠ›ã€‚</p></li></ul><h3 id="2-ä»£ç -4"><a href="#2-ä»£ç -4" class="headerlink" title="2.ä»£ç "></a>2.ä»£ç </h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;bits/stdc++.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">const int N = 1e5;</span><br><span class="line">int n, x, H[N + 5], sum[N + 5];</span><br><span class="line"></span><br><span class="line">inline int read() &#123;</span><br><span class="line">    int x = 0; bool f = 1; char ch = getchar();</span><br><span class="line">    for (; ch &lt; &#x27;0&#x27; || ch &gt; &#x27;9&#x27;; ch = getchar()) f ^= (ch == &#x27;-&#x27;);</span><br><span class="line">    for (; ch &gt;= &#x27;0&#x27; &amp;&amp; ch &lt;= &#x27;9&#x27;; ch = getchar()) x = (x &lt;&lt; 1) + (x &lt;&lt; 3) + (ch ^ 48);</span><br><span class="line">    return f ? x : -x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">bool check(int mid) &#123;</span><br><span class="line">    int cnt = 0, last = 0;</span><br><span class="line">    for (int i = 1; i &lt; n; i++) &#123;</span><br><span class="line">        if (i - last &gt; mid) &#123;</span><br><span class="line">            cnt++;</span><br><span class="line">            last = i - 1;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if (n - last &gt; mid) cnt++;</span><br><span class="line">    return cnt &lt;= 2 * x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void Kafka() &#123;</span><br><span class="line">    n = read(), x = read();</span><br><span class="line">    </span><br><span class="line">    for (int i = 1; i &lt; n; i++) &#123;</span><br><span class="line">        H[i] = read();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    int L = 1, R = n, ans = n;</span><br><span class="line">    while (L &lt;= R) &#123;</span><br><span class="line">        int mid = (L + R) &gt;&gt; 1;</span><br><span class="line">        if (check(mid)) &#123;</span><br><span class="line">            ans = mid;</span><br><span class="line">            R = mid - 1;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            L = mid + 1;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; ans &lt;&lt; &#x27;\n&#x27;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">signed main() &#123;</span><br><span class="line">    Kafka();</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h3 id="3-å­¦ä¹ æ€»ç»“-5"><a href="#3-å­¦ä¹ æ€»ç»“-5" class="headerlink" title="3.å­¦ä¹ æ€»ç»“"></a>3.å­¦ä¹ æ€»ç»“</h3><p><strong>äºŒåˆ†æŸ¥æ‰¾çš„åº”ç”¨</strong><br>äºŒåˆ†æŸ¥æ‰¾é€šå¸¸ç”¨æ¥åœ¨æœ‰åºåŒºé—´ä¸­æŸ¥æ‰¾æŸä¸ªæ»¡è¶³æ¡ä»¶çš„å€¼ã€‚åœ¨æœ¬é¢˜ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡äºŒåˆ†æŸ¥æ‰¾æ¥æ‰¾åˆ°æœ€å°çš„è·³è·ƒèƒ½åŠ›ï¼Œè¿™ç§é—®é¢˜é€šå¸¸è¢«ç§°ä¸ºâ€œæœ€å°æœ€å¤§åŒ–é—®é¢˜â€ã€‚</p><p><strong>æ¨¡æ‹Ÿé—®é¢˜çš„å®ç°</strong><br>æœ¬é¢˜ä¸­æ¨¡æ‹Ÿäº†å°é’è›™çš„è·³è·ƒè¿‡ç¨‹ï¼Œæ¨¡æ‹Ÿçš„å…³é”®æ˜¯å¦‚ä½•åˆ¤æ–­æ˜¯å¦èƒ½åœ¨æœ‰é™çš„è·³è·ƒæ¬¡æ•°å†…å®Œæˆä»»åŠ¡ã€‚é€šè¿‡æ£€æŸ¥æ¯ä¸ª <code>mid</code> è·³è·ƒèƒ½åŠ›æ˜¯å¦èƒ½å¤Ÿå®Œæˆ <code>2x</code> æ¬¡è·³è·ƒï¼Œåˆ¤æ–­å½“å‰è·³è·ƒèƒ½åŠ›çš„å¯è¡Œæ€§ã€‚</p><p><strong>é—®é¢˜æ±‚è§£ä¸­çš„äºŒåˆ†æŸ¥æ‰¾ä¼˜åŒ–</strong><br>ç”±äºæœ¬é¢˜çš„è·³è·ƒèƒ½åŠ›æ˜¯ä¸€ä¸ªæ•´æ•°èŒƒå›´ï¼Œä¸”é€šè¿‡éªŒè¯è·³è·ƒèƒ½åŠ›çš„å¯è¡Œæ€§å¯ä»¥åœ¨å¸¸æ•°æ—¶é—´å†…å®Œæˆï¼Œæ‰€ä»¥äºŒåˆ†æŸ¥æ‰¾åœ¨è¿™ä¸ªé—®é¢˜ä¸­æ˜¯ä¸€ç§é«˜æ•ˆçš„æ±‚è§£æ–¹æ³•ã€‚</p><p><strong>å¤æ‚åº¦åˆ†æ</strong></p><ul><li>äºŒåˆ†æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦æ˜¯ <code>O(log n)</code>ã€‚</li><li>å¯¹æ¯ä¸ª <code>mid</code> å€¼ï¼Œæˆ‘ä»¬éœ€è¦éå†çŸ³å¤´è¿›è¡Œä¸€æ¬¡è·³è·ƒæ¨¡æ‹Ÿï¼Œæœ€åæƒ…å†µä¸‹æ˜¯ <code>O(n)</code>ã€‚</li><li>å› æ­¤ï¼Œæ€»çš„æ—¶é—´å¤æ‚åº¦æ˜¯ <code>O(n log n)</code>ï¼Œå¯¹äº <code>n</code> æœ€å¤§ä¸º <code>10^5</code> çš„æ•°æ®ï¼Œèƒ½å¤Ÿæœ‰æ•ˆåœ°åœ¨æ—¶é—´é™åˆ¶å†…å®Œæˆè®¡ç®—ã€‚</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Task 1</title>
      <link href="/2025/02/06/Task-1/"/>
      <url>/2025/02/06/Task-1/</url>
      
        <content type="html"><![CDATA[<h1 id="å¯’å‡ç¬¬ä¸€è®²ï¼šC-åŸºç¡€"><a href="#å¯’å‡ç¬¬ä¸€è®²ï¼šC-åŸºç¡€" class="headerlink" title="å¯’å‡ç¬¬ä¸€è®²ï¼šC++ åŸºç¡€"></a>å¯’å‡ç¬¬ä¸€è®²ï¼šC++ åŸºç¡€</h1><h2 id="ä¸€-Long-Loong"><a href="#ä¸€-Long-Loong" class="headerlink" title="ä¸€.Long Loong"></a>ä¸€.Long Loong</h2><h3 id="1-å¯¹åº”æ€è·¯"><a href="#1-å¯¹åº”æ€è·¯" class="headerlink" title="1.å¯¹åº”æ€è·¯"></a>1.å¯¹åº”æ€è·¯</h3><p>æ€è·¯è¾ƒä¸ºç®€å•ï¼Œå°±æ˜¯å…ˆå›ºå®šè¾“å‡ºLï¼Œå†æ ¹æ®è¾“å…¥çš„Nå¾—åˆ°åº”è¯¥è¾“å‡ºå¤šå°‘oï¼Œæœ€åå†å›ºå®šè¾“å‡ºngã€‚</p><h3 id="2-ä»£ç "><a href="#2-ä»£ç " class="headerlink" title="2.ä»£ç "></a>2.ä»£ç </h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">int n;</span><br><span class="line">cin &gt;&gt; n;</span><br><span class="line">cout &lt;&lt; &#x27;L&#x27;;</span><br><span class="line">for (int i = 0; i &lt; n; i++)</span><br><span class="line">cout &lt;&lt; &#x27;o&#x27;;</span><br><span class="line">cout &lt;&lt; &quot;ng&quot;;</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="3-å­¦ä¹ æ€»ç»“"><a href="#3-å­¦ä¹ æ€»ç»“" class="headerlink" title="3.å­¦ä¹ æ€»ç»“"></a>3.å­¦ä¹ æ€»ç»“</h3><p>å­¦åˆ°äº†forå¾ªç¯çš„åŸºæœ¬ç”¨æ³•ï¼Œå¯¹æˆ‘å¸®åŠ©æå¤§ï¼Œå—ç›Šè‰¯å¤šã€‚</p><h2 id="äºŒ-YES-or-YES"><a href="#äºŒ-YES-or-YES" class="headerlink" title="äºŒ.YES or YES?"></a>äºŒ.YES or YES?</h2><h3 id="1-å¯¹åº”æ€è·¯-1"><a href="#1-å¯¹åº”æ€è·¯-1" class="headerlink" title="1.å¯¹åº”æ€è·¯"></a>1.å¯¹åº”æ€è·¯</h3><p>æ€è·¯å°±æ˜¯å°†è¾“å…¥çš„å­—ç¬¦ä¸²å…¨éƒ¨å¤§å†™ï¼Œç„¶ååˆ¤æ–­æ˜¯å¦ç­‰äºYESï¼Œå¦‚æœç­‰äºå°±è¾“å‡ºYESï¼Œä¸ç­‰äºå°±è¾“å‡ºNOã€‚</p><h3 id="2-ä»£ç -1"><a href="#2-ä»£ç -1" class="headerlink" title="2.ä»£ç "></a>2.ä»£ç </h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;string&gt;</span><br><span class="line">#include &lt;algorithm&gt; </span><br><span class="line">using namespace std;</span><br><span class="line">int main() &#123;</span><br><span class="line">    int t; </span><br><span class="line">    cin &gt;&gt; t;</span><br><span class="line">    while (t--) &#123;</span><br><span class="line">        string s;</span><br><span class="line">        cin &gt;&gt; s;</span><br><span class="line">        transform(s.begin(), s.end(), s.begin(), ::toupper);</span><br><span class="line">        if (s == &quot;YES&quot;) &#123;</span><br><span class="line">            cout &lt;&lt; &quot;YES&quot; &lt;&lt; endl;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            cout &lt;&lt; &quot;NO&quot; &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="3-å­¦ä¹ æ€»ç»“-1"><a href="#3-å­¦ä¹ æ€»ç»“-1" class="headerlink" title="3.å­¦ä¹ æ€»ç»“"></a>3.å­¦ä¹ æ€»ç»“</h3><ol><li>å­—ç¬¦ä¸²å¤„ç†ï¼šé€šè¿‡ <code>transform</code> é…åˆ <code>tolower</code> æˆ– <code>toupper</code>ï¼Œå¯ä»¥å¿«é€Ÿå°†å­—ç¬¦ä¸²ç»Ÿä¸€ä¸ºå°å†™æˆ–å¤§å†™ï¼Œä¾¿äºæ¯”è¾ƒã€‚</li><li>å¾ªç¯ä¸åˆ†æ”¯ï¼šåˆ©ç”¨ <code>while (t--)</code> å¾ªç¯é«˜æ•ˆå¤„ç†å¤šç»„è¾“å…¥ï¼Œç»“åˆ <code>if-else</code> åˆ¤æ–­åˆ†ç±»å¤„ç†é€»è¾‘ã€‚</li><li>æ—¶é—´å¤æ‚åº¦ï¼šè½¬æ¢å¤§å°å†™æˆ–æ¯”è¾ƒå­—ç¬¦ä¸²çš„å¤æ‚åº¦ä¸º O(å­—ç¬¦ä¸²é•¿åº¦)O(\text{å­—ç¬¦ä¸²é•¿åº¦})O(å­—ç¬¦ä¸²é•¿åº¦)ã€‚æ•´ä½“å¤æ‚åº¦ä¸º O(t)O(t)O(t)ï¼Œé€‚ç”¨äºæµ‹è¯•ç”¨ä¾‹è¾ƒå¤šçš„æƒ…å†µã€‚</li><li>STL ä½¿ç”¨ï¼šæ ‡å‡†åº“å‡½æ•°å¦‚ <code>transform</code> å’Œå­—ç¬¦ä¸²ç›´æ¥æ¯”è¾ƒæå‡äº†ä»£ç ç®€æ´æ€§å’Œå¯é æ€§ã€‚</li></ol><h2 id="ä¸‰-Even-Odd-G"><a href="#ä¸‰-Even-Odd-G" class="headerlink" title="ä¸‰.Even? Odd? G"></a>ä¸‰.Even? Odd? G</h2><h3 id="1-å¯¹åº”æ€è·¯-2"><a href="#1-å¯¹åº”æ€è·¯-2" class="headerlink" title="1.å¯¹åº”æ€è·¯"></a>1.å¯¹åº”æ€è·¯</h3><p>è¿™ä¸ªç¨‹åºçš„ä¸»è¦ä»»åŠ¡æ˜¯æ ¹æ®è¾“å…¥çš„ä¸€ç»„è¶…å¤§æ•´æ•°ï¼Œåˆ¤æ–­æ¯ä¸ªæ•´æ•°çš„å¥‡å¶æ€§ï¼ˆå³æœ€åä¸€ä½æ•°å­—æ˜¯å¶æ•°è¿˜æ˜¯å¥‡æ•°ï¼‰ã€‚ç”±äºæ•°çš„èŒƒå›´å¯èƒ½éå¸¸å¤§ï¼ˆé«˜è¾¾ 106010^{60}1060ï¼‰ï¼Œæ— æ³•ç›´æ¥ä½¿ç”¨æ™®é€šæ•´æ•°ç±»å‹ï¼ˆå¦‚ <code>int</code> æˆ– <code>long long</code>ï¼‰ï¼Œæ‰€ä»¥é‡‡ç”¨å­—ç¬¦ä¸²å¤„ç†çš„æ–¹å¼ã€‚</p><h3 id="2-ä»£ç -2"><a href="#2-ä»£ç -2" class="headerlink" title="2.ä»£ç "></a>2.ä»£ç </h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;string&gt;</span><br><span class="line">#include &lt;vector&gt;</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line"></span><br><span class="line">    int N;</span><br><span class="line">    cin &gt;&gt; N;</span><br><span class="line"></span><br><span class="line">    vector&lt;string&gt; results;</span><br><span class="line"></span><br><span class="line">    for (int i = 0; i &lt; N; ++i) &#123;</span><br><span class="line">        string number;</span><br><span class="line">        cin &gt;&gt; number;</span><br><span class="line"></span><br><span class="line">        char lastDigit = number[number.length() - 1];</span><br><span class="line">        if ((lastDigit - &#x27;0&#x27;) % 2 == 0) &#123;</span><br><span class="line">            results.push_back(&quot;even&quot;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            results.push_back(&quot;odd&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    for (const string&amp; result : results) &#123;</span><br><span class="line">        cout &lt;&lt; result &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="3-å­¦ä¹ æ€»ç»“-2"><a href="#3-å­¦ä¹ æ€»ç»“-2" class="headerlink" title="3.å­¦ä¹ æ€»ç»“"></a>3.å­¦ä¹ æ€»ç»“</h3><p><strong>å­—ç¬¦ä¸²å¤„ç†å¤§æ•°</strong>ï¼š</p><ul><li>å½“æ•°å­—çš„èŒƒå›´è¶…è¿‡å†…ç½®ç±»å‹çš„æ”¯æŒæ—¶ï¼Œå¯ä»¥ç”¨å­—ç¬¦ä¸²è¡¨ç¤ºå¹¶å¤„ç†ã€‚</li><li>åˆ¤æ–­å¥‡å¶æ€§åªéœ€å…³æ³¨æ•°å­—çš„æœ€åä¸€ä½ï¼Œç®€åŒ–äº†å¤§æ•°çš„æ“ä½œã€‚</li></ul><p><strong>æ¨¡è¿ç®—çš„åº”ç”¨</strong>ï¼š</p><ul><li>å¥‡å¶æ€§çš„æœ¬è´¨æ˜¯çœ‹æ•°å­—èƒ½å¦è¢« 222 æ•´é™¤ï¼Œé€šè¿‡ modâ€‰â€‰2\mod 2mod2 è¿ç®—å³å¯å®ç°ã€‚</li></ul><h2 id="å››-Problem-Generator"><a href="#å››-Problem-Generator" class="headerlink" title="å››.Problem Generator"></a>å››.Problem Generator</h2><h3 id="1-å¯¹åº”æ€è·¯-3"><a href="#1-å¯¹åº”æ€è·¯-3" class="headerlink" title="1.å¯¹åº”æ€è·¯"></a>1.å¯¹åº”æ€è·¯</h3><ol><li>è¾“å…¥å¤„ç†</li></ol><ul><li>è¯»å–æµ‹è¯•ç”¨ä¾‹æ•°é‡ <code>t</code>ã€‚</li><li>å¯¹äºæ¯ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œè¯»å–ä¸¤ä¸ªæ•´æ•° <code>n</code>ï¼ˆé¢˜åº“é¢˜ç›®æ•°é‡ï¼‰å’Œ <code>m</code>ï¼ˆæ¯”èµ›è½®æ¬¡ï¼‰ï¼Œä»¥åŠä¸€ä¸ªå­—ç¬¦ä¸² <code>a</code> è¡¨ç¤ºé¢˜åº“ä¸­çš„é¢˜ç›®éš¾åº¦ã€‚</li></ul><ol start="2"><li>ç»Ÿè®¡é¢˜ç›®æ•°é‡</li></ol><ul><li>ä½¿ç”¨7ä¸ªå˜é‡ <code>n1</code> åˆ° <code>n7</code> åˆ†åˆ«è®°å½•æ¯ç§éš¾åº¦ï¼ˆAåˆ°Gï¼‰çš„é¢˜ç›®æ•°é‡ã€‚</li><li>éå†å­—ç¬¦ä¸² <code>a</code>ï¼Œé€šè¿‡æ¯”è¾ƒå­—ç¬¦ <code>c</code> æ˜¯å¦ä¸º â€˜Aâ€™ åˆ° â€˜Gâ€™ æ¥å¯¹æ¯ç§éš¾åº¦çš„é¢˜ç›®è®¡æ•°ã€‚</li></ul><ol start="3"><li>æ¯ç§éš¾åº¦çš„æœ€å¤§éœ€æ±‚</li></ol><ul><li>æ¯è½®æ¯”èµ›éœ€è¦ä¸€ä¸ªå®Œæ•´çš„éš¾åº¦çº§åˆ«ï¼ˆAåˆ°Gï¼‰ï¼Œå³æ¯ç§éš¾åº¦æœ€å¤šéœ€è¦ mmm é“é¢˜ã€‚</li></ul><ol start="4"><li>è®¡ç®—éœ€è¦è¡¥å……çš„é¢˜ç›®æ•°é‡</li></ol><ul><li><p>æ¯è½®æ¯”èµ›éœ€è¦7ç§éš¾åº¦çš„é¢˜ç›®ï¼Œå› æ­¤æ€»éœ€æ±‚ä¸º 7Ã—m7 \times m7Ã—mã€‚</p></li><li><p>å½“å‰å·²æœ‰çš„é¢˜ç›®æ€»é‡ä¸º n1+n2+â‹¯+n7n1 + n2 + \dots + n7n1+n2+â‹¯+n7ã€‚</p></li><li><p>éœ€è¦è¡¥å……çš„é¢˜ç›®æ•°é‡ä¸ºï¼š éœ€è¦è¡¥å……&#x3D;maxâ¡(0,7Ã—mâˆ’å½“å‰å·²æœ‰çš„é¢˜ç›®æ€»é‡)\text{éœ€è¦è¡¥å……} &#x3D; \max(0, 7 \times m - \text{å½“å‰å·²æœ‰çš„é¢˜ç›®æ€»é‡})éœ€è¦è¡¥å……&#x3D;max(0,7Ã—mâˆ’å½“å‰å·²æœ‰çš„é¢˜ç›®æ€»é‡)</p></li><li><p>å¦‚æœå·²æœ‰é¢˜ç›®è¶³å¤Ÿï¼Œåˆ™è¡¥å……ä¸º0ï¼›å¦åˆ™è¡¥å……ç¼ºå°‘çš„é¢˜ç›®æ•°é‡ã€‚</p></li></ul><ol start="5"><li>è¾“å‡ºç»“æœ</li></ol><ul><li>å°†æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹çš„ç»“æœè¾“å‡ºåœ¨å•ç‹¬çš„ä¸€è¡Œã€‚</li></ul><h3 id="2-ä»£ç -3"><a href="#2-ä»£ç -3" class="headerlink" title="2.ä»£ç "></a>2.ä»£ç </h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;string&gt;</span><br><span class="line">#include &lt;algorithm&gt;</span><br><span class="line">using namespace std;</span><br><span class="line"> </span><br><span class="line">int main() &#123;</span><br><span class="line">    int t;</span><br><span class="line">    cin &gt;&gt; t;   </span><br><span class="line"> </span><br><span class="line">    while (t--) &#123;</span><br><span class="line">        int n, m;</span><br><span class="line">        cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">        string a;</span><br><span class="line">        cin &gt;&gt; a;</span><br><span class="line">        int n1 = 0, n2 = 0, n3 = 0, n4 = 0, n5 = 0, n6 = 0, n7 = 0;</span><br><span class="line">        for (char c : a)</span><br><span class="line">        &#123;</span><br><span class="line">            if (c == &#x27;A&#x27;)</span><br><span class="line">                n1++;</span><br><span class="line">            if (c == &#x27;B&#x27;)</span><br><span class="line">                n2++;</span><br><span class="line">            if (c == &#x27;C&#x27;)</span><br><span class="line">                n3++;</span><br><span class="line">            if (c == &#x27;D&#x27;)</span><br><span class="line">                n4++;</span><br><span class="line">            if (c == &#x27;E&#x27;)</span><br><span class="line">                n5++;</span><br><span class="line">            if (c == &#x27;F&#x27;)</span><br><span class="line">                n6++;</span><br><span class="line">            if (c == &#x27;G&#x27;)</span><br><span class="line">                n7++;</span><br><span class="line">        &#125;</span><br><span class="line">        if (n1 &gt; m)</span><br><span class="line">            n1 = m;</span><br><span class="line">        if (n2 &gt; m)</span><br><span class="line">            n2 = m;</span><br><span class="line">        if (n3 &gt; m)</span><br><span class="line">            n3 = m;</span><br><span class="line">        if (n4 &gt; m)</span><br><span class="line">            n4 = m;</span><br><span class="line">        if (n5 &gt; m)</span><br><span class="line">            n5 = m;</span><br><span class="line">        if (n6 &gt; m)</span><br><span class="line">            n6 = m;</span><br><span class="line">        if (n7 &gt; m)</span><br><span class="line">            n7 = m;</span><br><span class="line">        cout &lt;&lt; max(0, 7 * m - n1 - n2 - n3 - n4 - n5 - n6 - n7) &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="3-å­¦ä¹ æ€»ç»“-3"><a href="#3-å­¦ä¹ æ€»ç»“-3" class="headerlink" title="3.å­¦ä¹ æ€»ç»“"></a>3.å­¦ä¹ æ€»ç»“</h3><ul><li><p>æœ¬é¢˜é€šè¿‡ç»Ÿè®¡æ¯ç§éš¾åº¦é¢˜ç›®çš„æ•°é‡è§£å†³é—®é¢˜ã€‚è¿™æ˜¯å­—ç¬¦é¢‘ç‡ç»Ÿè®¡çš„å…¸å‹åº”ç”¨ã€‚</p></li><li><p>é€šè¿‡éå†å­—ç¬¦ä¸²å¹¶æ¯”è¾ƒå­—ç¬¦ï¼Œå¯ä»¥æœ‰æ•ˆç»Ÿè®¡å„ç±»åˆ«å‡ºç°æ¬¡æ•°ã€‚</p></li></ul><h2 id="äº”-rules"><a href="#äº”-rules" class="headerlink" title="äº”.rules"></a>äº”.rules</h2><h3 id="1-å¯¹åº”æ€è·¯-4"><a href="#1-å¯¹åº”æ€è·¯-4" class="headerlink" title="1.å¯¹åº”æ€è·¯"></a>1.å¯¹åº”æ€è·¯</h3><p>è¿™æ®µä»£ç è§£å†³çš„é—®é¢˜æ˜¯è€ƒå¯Ÿè§„åˆ™æ˜¯å¦ç¬¦åˆæ°‘æ„ï¼Œä¸»è¦æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p>è¾“å…¥æ•°æ®ï¼šé¦–å…ˆè¯»å–å±…æ°‘æ€»æ•° <code>n</code>ã€è®°å½•å¤©æ•° <code>m</code> ä»¥åŠè§„åˆ™ä»£å· <code>k</code>ã€‚</p></li><li><p>ç»Ÿè®¡ç¬¦åˆæ°‘æ„çš„å¤©æ•°ï¼š</p><p>å¾ªç¯ <code>m</code> æ¬¡ï¼Œè¡¨ç¤ºé€å¤©å¤„ç†è®°å½•ã€‚</p><p>å¯¹æ¯ä¸€å¤©ï¼Œç»Ÿè®¡æœ‰å¤šå°‘å±…æ°‘éµå®ˆäº†è§„åˆ™ <code>k</code>ï¼ˆè®¡æ•°å™¨ <code>c2</code>ï¼‰ã€‚</p><p>å¦‚æœéµå®ˆè§„åˆ™ <code>k</code> çš„äººæ•°å¤§äºç­‰äºä¸€åŠ (<code>c2 * 2 &gt;= n</code>)ï¼Œåˆ™è¯¥å¤©è§„åˆ™ç¬¦åˆæ°‘æ„ï¼Œç¬¦åˆæ°‘æ„çš„å¤©æ•°è®¡æ•°å™¨ <code>c1</code> åŠ ä¸€ã€‚</p></li><li><p>åˆ¤æ–­è§„åˆ™æ­£ç¡®æ€§</p><p>ï¼šå¦‚æœç¬¦åˆæ°‘æ„çš„å¤©æ•°å¤§äºç­‰äºè®°å½•å¤©æ•°çš„ä¸€åŠ (<code>c1 * 2 &gt;= m</code>)ï¼Œè¾“å‡º â€œYESâ€ è¡¨ç¤ºè§„åˆ™æ­£ç¡®ï¼Œå¦åˆ™è¾“å‡º â€œNOâ€ã€‚</p></li></ol><h3 id="2-ä»£ç -4"><a href="#2-ä»£ç -4" class="headerlink" title="2.ä»£ç "></a>2.ä»£ç </h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">int m, n, k;</span><br><span class="line">int c1 = 0, c2 = 0;</span><br><span class="line">cin &gt;&gt; n &gt;&gt; m &gt;&gt; k;</span><br><span class="line">for (int i = 0; i &lt; m; i++)</span><br><span class="line">&#123;</span><br><span class="line">c2 = 0;</span><br><span class="line">for (int j = 0; j &lt; n; j++) &#123;</span><br><span class="line">int t;</span><br><span class="line">cin &gt;&gt; t;</span><br><span class="line">if (t == k)</span><br><span class="line">&#123;</span><br><span class="line">c2++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">if ( c2*2 &gt;=  n)</span><br><span class="line">&#123;</span><br><span class="line">c1++;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;if ( c1*2 &gt;=  m)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; &quot;YES&quot;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">cout &lt;&lt; &quot;NO&quot;;</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="3-å­¦ä¹ æ€»ç»“-4"><a href="#3-å­¦ä¹ æ€»ç»“-4" class="headerlink" title="3.å­¦ä¹ æ€»ç»“"></a>3.å­¦ä¹ æ€»ç»“</h3><p>è¿™é“é¢˜ç›®æ¶‰åŠå¤šé‡å¾ªç¯çš„å¤„ç†ï¼Œæ˜¯å­¦ä¹ æ•°ç»„ä¸æ¡ä»¶åˆ¤æ–­çš„é‡è¦ç»ƒä¹ ã€‚é€šè¿‡è¿™æ®µä»£ç å¯ä»¥æ€»ç»“å¦‚ä¸‹ï¼š</p><ol><li><p>ç†è§£æ ¸å¿ƒé€»è¾‘</p><p>é—®é¢˜çš„æ ¸å¿ƒåœ¨äºä¸¤å±‚åˆ¤æ–­ï¼šä¸€æ˜¯æŸå¤©è§„åˆ™æ˜¯å¦ç¬¦åˆæ°‘æ„ï¼ŒäºŒæ˜¯ç»Ÿè®¡ç¬¦åˆæ°‘æ„çš„å¤©æ•°æ˜¯å¦è¾¾åˆ°è¦æ±‚ã€‚è¿™ç§å¤šå±‚åµŒå¥—æ¡ä»¶æ˜¯å¸¸è§çš„ç¼–ç¨‹æ¨¡å¼ã€‚</p></li><li><p>ä¼˜åŒ–å¾ªç¯æ•ˆç‡</p><p>æœ¬ä»£ç é€šè¿‡åŒé‡å¾ªç¯æŒ‰å¤©å’ŒæŒ‰äººå¤„ç†é—®é¢˜ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(mÃ—n)O(m \times n)O(mÃ—n)ã€‚è¿™ç§ç»“æ„åœ¨å¤„ç†èŒƒå›´è¾ƒå¤§æ—¶å¯èƒ½éœ€è¦ä¼˜åŒ–ã€‚</p></li><li><p>æŒæ¡è®¡æ•°é€»è¾‘</p><p>ä½¿ç”¨è®¡æ•°å™¨ <code>c2</code> å’Œ <code>c1</code> é€æ­¥ç´¯ç§¯æ•°æ®ï¼Œå¹¶é€šè¿‡æ¡ä»¶åˆ¤æ–­æ›´æ–°çŠ¶æ€ã€‚è¿™ç§é€»è¾‘æ¸…æ™°ã€ç®€æ´ï¼Œé€‚åˆå¤æ‚é—®é¢˜åˆ†æ­¥è§£å†³ã€‚</p></li></ol><h2 id="å…­-Many-Replacement"><a href="#å…­-Many-Replacement" class="headerlink" title="å…­.Many Replacement"></a>å…­.Many Replacement</h2><h3 id="1-å¯¹åº”æ€è·¯-5"><a href="#1-å¯¹åº”æ€è·¯-5" class="headerlink" title="1.å¯¹åº”æ€è·¯"></a>1.å¯¹åº”æ€è·¯</h3><ol><li><p>åˆå§‹åŒ–æ˜ å°„è¡¨ï¼š</p><p>åˆ›å»ºä¸€ä¸ª <code>mapping</code> æ•°ç»„ï¼Œé•¿åº¦ä¸º 26ï¼ˆè¡¨ç¤ºå­—æ¯è¡¨ï¼‰ï¼Œåˆå§‹åŒ–ä¸º <code>&#39;a&#39;</code> åˆ° <code>&#39;z&#39;</code> çš„å¯¹åº”å­—æ¯ã€‚è¿™ä¸ªè¡¨å°†ç”¨äºè®°å½•å­—æ¯æ›¿æ¢å…³ç³»ã€‚</p></li><li><p>å¤„ç†æ›¿æ¢æ“ä½œï¼š</p><p>å¯¹æ¯ä¸ªæ›¿æ¢æŒ‡ä»¤ <code>(c, d)</code>ï¼Œéå† <code>mapping</code> æ•°ç»„ï¼Œå°†æ‰€æœ‰å€¼ç­‰äº <code>c</code> çš„é¡¹æ›¿æ¢ä¸º <code>d</code>ã€‚</p><p>è¿™ç§æ–¹å¼ç¡®ä¿äº†é—´æ¥æ›¿æ¢é“¾æ¡ä¹Ÿèƒ½æ­£ç¡®ç”Ÿæ•ˆã€‚ä¾‹å¦‚ï¼Œå¦‚æœå…ˆå°† <code>a</code> æ›¿æ¢ä¸º <code>b</code>ï¼Œå†å°† <code>b</code> æ›¿æ¢ä¸º <code>c</code>ï¼Œæœ€ç»ˆ <code>a</code> ä¹Ÿä¼šè¢«æ›¿æ¢ä¸º <code>c</code>ã€‚</p></li><li><p>ä¿®æ”¹å­—ç¬¦ä¸²ï¼š</p><p>éå†å­—ç¬¦ä¸² <code>S</code> çš„æ¯ä¸ªå­—ç¬¦ï¼Œæ ¹æ® <code>mapping</code> æ•°ç»„ä¸­çš„æ˜ å°„å…³ç³»ï¼Œå°†å­—ç¬¦æ›¿æ¢ä¸ºæœ€ç»ˆæ˜ å°„çš„ç›®æ ‡å­—ç¬¦ã€‚</p></li><li><p>è¾“å‡ºç»“æœï¼š</p><p>è¾“å‡ºä¿®æ”¹åçš„å­—ç¬¦ä¸² <code>S</code>ã€‚</p></li></ol><p>é€šè¿‡ä½¿ç”¨ <code>mapping</code> æ•°ç»„è®°å½•å…¨å±€æ˜ å°„å…³ç³»ï¼Œé¿å…ç›´æ¥ä¿®æ”¹å­—ç¬¦ä¸²å¤šæ¬¡ï¼Œæé«˜äº†å¤„ç†æ•ˆç‡ã€‚</p><h3 id="2-ä»£ç -5"><a href="#2-ä»£ç -5" class="headerlink" title="2.ä»£ç "></a>2.ä»£ç </h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;string&gt;</span><br><span class="line">#include &lt;vector&gt;</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">    int N, Q;</span><br><span class="line">    cin &gt;&gt; N;</span><br><span class="line">    string S;</span><br><span class="line">    cin &gt;&gt; S;</span><br><span class="line">    cin &gt;&gt; Q;</span><br><span class="line"></span><br><span class="line">    vector&lt;char&gt; mapping(26);</span><br><span class="line">    for (int i = 0; i &lt; 26; i++) &#123;</span><br><span class="line">        mapping[i] = &#x27;a&#x27; + i; </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    for (int i = 0; i &lt; Q; i++) &#123;</span><br><span class="line">        char c, d;</span><br><span class="line">        cin &gt;&gt; c &gt;&gt; d;</span><br><span class="line">        for (int j = 0; j &lt; 26; j++) &#123;</span><br><span class="line">            if (mapping[j] == c) &#123;</span><br><span class="line">                mapping[j] = d;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    for (char &amp;ch : S) &#123;</span><br><span class="line">        ch = mapping[ch - &#x27;a&#x27;]; </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; S &lt;&lt; endl;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h3 id="3-å­¦ä¹ æ€»ç»“-5"><a href="#3-å­¦ä¹ æ€»ç»“-5" class="headerlink" title="3.å­¦ä¹ æ€»ç»“"></a>3.å­¦ä¹ æ€»ç»“</h3><p>1.é«˜æ•ˆå¤„ç†æ›¿æ¢é“¾ï¼š</p><p>  ä½¿ç”¨ä¸€ä¸ªæ˜ å°„è¡¨ (<code>mapping</code> æ•°ç»„) å°†å­—ç¬¦æ›¿æ¢é€»è¾‘ç»Ÿä¸€ç®¡ç†ï¼Œé¿å…äº†ç›´æ¥åœ¨å­—ç¬¦ä¸²ä¸­è¿›è¡Œå¤šæ¬¡æ›¿æ¢æ“ä½œï¼Œé™ä½äº†æ—¶é—´å¤æ‚åº¦ã€‚</p><p>2.é—´æ¥æ›¿æ¢é“¾çš„å¤„ç†ï¼š</p><p>  é€šè¿‡åœ¨å¤„ç†æ›¿æ¢æŒ‡ä»¤æ—¶éå†æ•´ä¸ªæ˜ å°„è¡¨ï¼Œç¡®ä¿é“¾å¼æ›¿æ¢å¾—åˆ°æ­£ç¡®ç»“æœã€‚è¿™ç§æ–¹æ³•é€‚ç”¨äºæœ‰ä¾èµ–å…³ç³»çš„æ›¿æ¢é—®é¢˜ã€‚</p><p>3.å¤æ‚åº¦ä¼˜åŒ–ï¼š</p><p>  æ›¿æ¢æ“ä½œéå† <code>mapping</code> çš„å¤æ‚åº¦ä¸º O(QÃ—26)O(Q \times 26)O(QÃ—26)ï¼Œå­—ç¬¦ä¸²æ›¿æ¢ä¸º O(N)O(N)O(N)ï¼Œæ•´ä½“å¤æ‚åº¦çº¦ä¸º O(Q+N)O(Q + N)O(Q+N)ï¼Œè¶³ä»¥å¤„ç†è¾ƒå¤§è¾“å…¥è§„æ¨¡ã€‚</p><p>4.è¾¹ç•Œæ¡ä»¶è€ƒè™‘ï¼š</p><p>  æ›¿æ¢å­—ç¬¦å¯ä»¥æ˜¯ç›¸åŒçš„ï¼ˆ<code>c = d</code>ï¼‰ï¼Œè¿™ç§æƒ…å†µä¸ä¼šå½±å“æ˜ å°„è¡¨ã€‚</p><p>  æŸäº›å­—ç¬¦å¯èƒ½ä¸å­˜åœ¨äºå­—ç¬¦ä¸²ä¸­ï¼Œä½†æ›¿æ¢é€»è¾‘ä¾ç„¶å¯ä»¥æ­£å¸¸å¤„ç†ã€‚</p><h2 id="æ›´å¥½çš„äº¤æ¢"><a href="#æ›´å¥½çš„äº¤æ¢" class="headerlink" title="æ›´å¥½çš„äº¤æ¢"></a>æ›´å¥½çš„äº¤æ¢</h2><h3 id="1-å¯¹åº”æ€è·¯-6"><a href="#1-å¯¹åº”æ€è·¯-6" class="headerlink" title="1.å¯¹åº”æ€è·¯"></a>1.å¯¹åº”æ€è·¯</h3><ol><li><p>è¾“å…¥ä¸åˆå§‹åŒ–ï¼š</p><p>è¯»å–çŸ©é˜µå¤§å° <code>n</code> å’Œæ“ä½œæ¬¡æ•° <code>m</code>ã€‚</p><p>è¯»å–çŸ©é˜µå†…å®¹å¹¶å­˜å‚¨åœ¨ <code>matrix</code> ä¸­ã€‚</p><p>åˆå§‹åŒ–ä¸¤ä¸ªæ•°ç»„ <code>row_map</code> å’Œ <code>col_map</code>ï¼Œåˆ†åˆ«è®°å½•è¡Œå’Œåˆ—çš„æ˜ å°„å…³ç³»ï¼Œåˆå§‹å€¼ä¸º <code>[0, 1, 2, ..., n-1]</code>ã€‚</p></li><li><p>æ“ä½œå¤„ç†ï¼š</p><p>éå†æ¯ä¸ªæ“ä½œï¼Œæ ¹æ®æ“ä½œç±»å‹ï¼š</p><p>  è‹¥ <code>op == 1</code>ï¼ˆäº¤æ¢è¡Œï¼‰ï¼Œåˆ™äº¤æ¢ <code>row_map[x]</code> å’Œ <code>row_map[y]</code>ã€‚</p><p>  è‹¥ <code>op == 0</code>ï¼ˆäº¤æ¢åˆ—ï¼‰ï¼Œåˆ™äº¤æ¢ <code>col_map[x]</code> å’Œ <code>col_map[y]</code>ã€‚</p><p>é€šè¿‡ä¿®æ”¹ <code>row_map</code> å’Œ <code>col_map</code> çš„æ˜ å°„å…³ç³»ï¼Œè€Œéç›´æ¥ä¿®æ”¹çŸ©é˜µï¼ŒèŠ‚çœäº†æ—¶é—´å¤æ‚åº¦ã€‚</p></li><li><p>è¾“å‡ºçŸ©é˜µï¼š</p><p>æ ¹æ®æœ€ç»ˆçš„ <code>row_map</code> å’Œ <code>col_map</code>ï¼Œé‡æ–°æŒ‰æ˜ å°„é¡ºåºè¾“å‡ºçŸ©é˜µã€‚<code>matrix[row_map[i]][col_map[j]]</code> å¾—åˆ°æ­£ç¡®çš„æ˜ å°„å€¼ã€‚</p></li></ol><p>é€šè¿‡è¿™ç§é—´æ¥æ˜ å°„æ³•ï¼Œé¿å…äº†æ¯æ¬¡äº¤æ¢ç›´æ¥æ“ä½œçŸ©é˜µï¼Œæé«˜äº†æ•ˆç‡ï¼Œé€‚åˆå¤§è§„æ¨¡è¾“å…¥ã€‚</p><h3 id="2-ä»£ç -6"><a href="#2-ä»£ç -6" class="headerlink" title="2.ä»£ç "></a>2.ä»£ç </h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;vector&gt;</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">    int n, m;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    vector&lt;vector&lt;int&gt;&gt; matrix(n, vector&lt;int&gt;(n));</span><br><span class="line">    for (int i = 0; i &lt; n; ++i) &#123;</span><br><span class="line">        for (int j = 0; j &lt; n; ++j) &#123;</span><br><span class="line">            cin &gt;&gt; matrix[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    vector&lt;int&gt; row_map(n), col_map(n);</span><br><span class="line">    for (int i = 0; i &lt; n; ++i) &#123;</span><br><span class="line">        row_map[i] = i; </span><br><span class="line">        col_map[i] = i; </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    for (int i = 0; i &lt; m; ++i) &#123;</span><br><span class="line">        int op, x, y;</span><br><span class="line">        cin &gt;&gt; op &gt;&gt; x &gt;&gt; y;</span><br><span class="line">        --x; </span><br><span class="line">        --y;</span><br><span class="line">        if (op == 1) &#123;</span><br><span class="line">            swap(row_map[x], row_map[y]); </span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            swap(col_map[x], col_map[y]); </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    for (int i = 0; i &lt; n; ++i) &#123;</span><br><span class="line">        for (int j = 0; j &lt; n; ++j) &#123;</span><br><span class="line">            cout &lt;&lt; matrix[row_map[i]][col_map[j]] &lt;&lt; &quot; &quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="3-å­¦ä¹ æ€»ç»“-6"><a href="#3-å­¦ä¹ æ€»ç»“-6" class="headerlink" title="3.å­¦ä¹ æ€»ç»“"></a>3.å­¦ä¹ æ€»ç»“</h3><p>é—´æ¥æ˜ å°„ä¼˜åŒ–ï¼š</p><p>â€‹    ç›´æ¥äº¤æ¢çŸ©é˜µè¡Œåˆ—ä¼šå¸¦æ¥é«˜æ˜‚çš„æ—¶é—´å¤æ‚åº¦ï¼Œé—´æ¥é€šè¿‡æ˜ å°„æ•°ç»„è°ƒæ•´é¡ºåºæ˜¯ä¸€ç§é«˜æ•ˆçš„è§£å†³æ–¹å¼ã€‚</p><p>ç©ºé—´ä¸æ—¶é—´çš„å¹³è¡¡ï¼š</p><p>â€‹    å¢åŠ ä¸¤ä¸ªæ˜ å°„æ•°ç»„ <code>row_map</code> å’Œ <code>col_map</code>ï¼Œç”¨ç©ºé—´æ¢å–äº†æ—¶é—´çš„ä¼˜åŒ–ã€‚</p><p>â€‹    åœ¨ mmm æ¬¡æ“ä½œå’Œ n2n^2n2 æ¬¡çŸ©é˜µè®¿é—®ä¸­ï¼Œå¤æ‚åº¦é™ä½ä¸º O(n2+m)O(n^2 + m)O(n2+m)ï¼Œé€‚åˆå¤„ç†å¤§è§„æ¨¡ n,mn, mn,mã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>blogç”¨æ³•</title>
      <link href="/2025/02/06/blog%E7%94%A8%E6%B3%95/"/>
      <url>/2025/02/06/blog%E7%94%A8%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h2 id="æäº¤æ›´æ”¹"><a href="#æäº¤æ›´æ”¹" class="headerlink" title="æäº¤æ›´æ”¹"></a>æäº¤æ›´æ”¹</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo g -d</span><br></pre></td></tr></table></figure><h1 id="æœ¬åœ°ç½‘ç«™"><a href="#æœ¬åœ°ç½‘ç«™" class="headerlink" title="æœ¬åœ°ç½‘ç«™"></a>æœ¬åœ°ç½‘ç«™</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo s</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2025/02/06/hello-world/"/>
      <url>/2025/02/06/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a class="link"   href="https://hexo.io/" >Hexo<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>! This is your very first post. Check <a class="link"   href="https://hexo.io/docs/" >documentation<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a> for more info. If you get any problems when using Hexo, you can find the answer in <a class="link"   href="https://hexo.io/docs/troubleshooting.html" >troubleshooting<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a> or you can ask me on <a class="link"   href="https://github.com/hexojs/hexo/issues" >GitHub<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure></div><p>More info: <a class="link"   href="https://hexo.io/docs/writing.html" >Writing<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure></div><p>More info: <a class="link"   href="https://hexo.io/docs/server.html" >Server<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure></div><p>More info: <a class="link"   href="https://hexo.io/docs/generating.html" >Generating<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure></div><p>More info: <a class="link"   href="https://hexo.io/docs/one-command-deployment.html" >Deployment<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
    
  
</search>
